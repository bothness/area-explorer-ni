import{S as ea,i as ta,s as ra,e as Br,b as Fe,f as vt,g as Ha,t as zt,d as Ja,h as ie,o as Fm,U as Vt,V as Tr,j as Om,O as Vu,l as De,m as Le,n as Ve,p as ce,W as Np,q as Qt,X as Up,Q as ju,R as qu,T as Zu,Y as sl,M as Ya,N as Qa,I as re,K as Lc,E as ka,Z as ds,r as Pe,u as Ce,v as yt,J as Pi,w as jr,x as qr,y as Zr,B as Gr,a as st,c as lt,_ as Il,$ as Ea,G as Ku,a0 as Nm,a1 as gd,P as qg,a2 as Zg,a3 as Gg,a4 as Um,a5 as Vm,C as kl,z as El,A as Tl}from"../../chunks/index-9345276e.js";import{a as Ui,u as jm,m as Yo,c as _d,b as Kg,d as Ar,e as Lh}from"../../chunks/config-05e955be.js";import{b as Bs}from"../../chunks/paths-1c47712a.js";import{c as tu,w as Ir,d as Ni}from"../../chunks/singletons-a869b375.js";import{S as Xg}from"../../chunks/Section-a9360eb4.js";var vd={},Sp={},kp=34,Ic=10,Ep=13;function qm(c){return new Function("d","return {"+c.map(function(h,f){return JSON.stringify(h)+": d["+f+'] || ""'}).join(",")+"}")}function Wg(c,h){var f=qm(c);return function(y,v){return h(f(y),v,c)}}function xd(c){var h=Object.create(null),f=[];return c.forEach(function(y){for(var v in y)v in h||f.push(h[v]=v)}),f}function Jo(c,h){var f=c+"",y=f.length;return y<h?new Array(h-y+1).join(0)+f:f}function Hg(c){return c<0?"-"+Jo(-c,6):c>9999?"+"+Jo(c,6):Jo(c,4)}function Jg(c){var h=c.getUTCHours(),f=c.getUTCMinutes(),y=c.getUTCSeconds(),v=c.getUTCMilliseconds();return isNaN(c)?"Invalid Date":Hg(c.getUTCFullYear())+"-"+Jo(c.getUTCMonth()+1,2)+"-"+Jo(c.getUTCDate(),2)+(v?"T"+Jo(h,2)+":"+Jo(f,2)+":"+Jo(y,2)+"."+Jo(v,3)+"Z":y?"T"+Jo(h,2)+":"+Jo(f,2)+":"+Jo(y,2)+"Z":f||h?"T"+Jo(h,2)+":"+Jo(f,2)+"Z":"")}function Yg(c){var h=new RegExp('["'+c+`
\r]`),f=c.charCodeAt(0);function y(V,B){var N,ue,ze=v(V,function(Ae,Ie){if(N)return N(Ae,Ie-1);ue=Ae,N=B?Wg(Ae,B):qm(Ae)});return ze.columns=ue||[],ze}function v(V,B){var N=[],ue=V.length,ze=0,Ae=0,Ie,Me=ue<=0,ft=!1;V.charCodeAt(ue-1)===Ic&&--ue,V.charCodeAt(ue-1)===Ep&&--ue;function Pt(){if(Me)return Sp;if(ft)return ft=!1,vd;var je,ur=ze,cr;if(V.charCodeAt(ur)===kp){for(;ze++<ue&&V.charCodeAt(ze)!==kp||V.charCodeAt(++ze)===kp;);return(je=ze)>=ue?Me=!0:(cr=V.charCodeAt(ze++))===Ic?ft=!0:cr===Ep&&(ft=!0,V.charCodeAt(ze)===Ic&&++ze),V.slice(ur+1,je-1).replace(/""/g,'"')}for(;ze<ue;){if((cr=V.charCodeAt(je=ze++))===Ic)ft=!0;else if(cr===Ep)ft=!0,V.charCodeAt(ze)===Ic&&++ze;else if(cr!==f)continue;return V.slice(ur,je)}return Me=!0,V.slice(ur,ue)}for(;(Ie=Pt())!==Sp;){for(var ve=[];Ie!==vd&&Ie!==Sp;)ve.push(Ie),Ie=Pt();B&&(ve=B(ve,Ae++))==null||N.push(ve)}return N}function w(V,B){return V.map(function(N){return B.map(function(ue){return M(N[ue])}).join(c)})}function a(V,B){return B==null&&(B=xd(V)),[B.map(M).join(c)].concat(w(V,B)).join(`
`)}function A(V,B){return B==null&&(B=xd(V)),w(V,B).join(`
`)}function E(V){return V.map(P).join(`
`)}function P(V){return V.map(M).join(c)}function M(V){return V==null?"":V instanceof Date?Jg(V):h.test(V+="")?'"'+V.replace(/"/g,'""')+'"':V}return{parse:y,parseRows:v,format:a,formatBody:A,formatRows:E,formatRow:P,formatValue:M}}var Qg=Yg(","),$g=Qg.parse;function e_(c){for(var h in c){var f=c[h].trim(),y,v;if(!f)f=null;else if(f==="true")f=!0;else if(f==="false")f=!1;else if(f==="NaN")f=NaN;else if(!isNaN(y=+f))f=y;else if(v=f.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))t_&&!!v[4]&&!v[7]&&(f=f.replace(/-/g,"/").replace(/T/," ")),f=new Date(f);else continue;c[h]=f}return c}const t_=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();async function r_(c,h=window.fetch){let y=await(await h(c)).text();return await $g(y,e_)}function $o(c){let h=Math.round(c)%10;return h==1?"st":h==2?"nd":h==3?"rd":"th"}function Al(c){return c>0?"increase":c<0?"decrease":"nochange"}function Fs(c,h="",f=0){return c!=0?Math.abs(c).toFixed(f)+h:h=="pp"?"n/c":"no change"}function Rh(c,h,f=["higher","lower"]){let y=[c*.2,c*.4,c*.6,c*.8];return h<y[0]?`Much ${f[0]} than`:h<y[1]?`Slightly ${f[0]} than`:h<y[2]?"Close to":h<y[3]?`Slightly ${f[1]} than`:`Much ${f[1]} than`}tu.disable_scroll_handling;const bd=tu.goto;tu.invalidate;tu.prefetch;tu.prefetch_routes;tu.before_navigate;tu.after_navigate;function i_(c){return c===0?!0:c}function Sl(c){return i_(c)?Array.isArray(c)?h=>c.map(f=>typeof f!="function"?h[f]:f(h)):typeof c!="function"?h=>h[c]:c:null}function n_(c){const h={};for(const f of c){if(Object(f)!==f)throw new TypeError("iterable for fromEntries should yield objects");const{"0":y,"1":v}=f;Object.defineProperty(h,y,{configurable:!0,enumerable:!0,writable:!0,value:v})}return h}function Tp(c,h={}){return n_(Object.entries(c).filter(([f,y])=>y!==void 0&&h[f]===void 0))}function o_(c,h){if(!Array.isArray(c))throw new TypeError(`The first argument of calcExtents() must be an array. You passed in a ${typeof c}. Consider passing a flat array to the \`flatData\` prop. More info: https://layercake.graphics/guide/#flatdata`);if(Array.isArray(h)||h===void 0||h===null)throw new TypeError("The second argument of calcExtents() must be an object with field names as keys as accessor functions as values.");const f={},y=Object.keys(h),v=y.length;let w,a,A,E,P,M,V,B;const N=c.length;for(w=0;w<v;w+=1){for(E=y[w],V=h[E],P=null,M=null,a=0;a<N;a+=1)if(B=V(c[a]),Array.isArray(B)){const ue=B.length;for(A=0;A<ue;A+=1)B[A]!==void 0&&B[A]!==null&&Number.isNaN(B[A])===!1&&((P===null||B[A]<P)&&(P=B[A]),(M===null||B[A]>M)&&(M=B[A]))}else B!=null&&Number.isNaN(B)===!1&&((P===null||B<P)&&(P=B),(M===null||B>M)&&(M=B));f[E]=[P,M]}return f}function Zm(c=[],h){return Array.isArray(h)===!0?h.map((f,y)=>f===null?c[y]:f):c}function Sh(c){return function([f,y]){return f?Zm(f[c],y):y}}function Mh(c,h){return c==null||h==null?NaN:c<h?-1:c>h?1:c>=h?0:NaN}function a_(c,h){return c==null||h==null?NaN:h<c?-1:h>c?1:h>=c?0:NaN}function Gm(c){let h,f,y;c.length!==2?(h=Mh,f=(A,E)=>Mh(c(A),E),y=(A,E)=>c(A)-E):(h=c===Mh||c===a_?c:s_,f=c,y=c);function v(A,E,P=0,M=A.length){if(P<M){if(h(E,E)!==0)return M;do{const V=P+M>>>1;f(A[V],E)<0?P=V+1:M=V}while(P<M)}return P}function w(A,E,P=0,M=A.length){if(P<M){if(h(E,E)!==0)return M;do{const V=P+M>>>1;f(A[V],E)<=0?P=V+1:M=V}while(P<M)}return P}function a(A,E,P=0,M=A.length){const V=v(A,E,P,M-1);return V>P&&y(A[V-1],E)>-y(A[V],E)?V-1:V}return{left:v,center:a,right:w}}function s_(){return 0}function l_(c){return c===null?NaN:+c}const u_=Gm(Mh),c_=u_.right;Gm(l_).center;const h_=c_;class wd extends Map{constructor(h,f=d_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:f}}),h!=null)for(const[y,v]of h)this.set(y,v)}get(h){return super.get(Sd(this,h))}has(h){return super.has(Sd(this,h))}set(h,f){return super.set(p_(this,h),f)}delete(h){return super.delete(f_(this,h))}}function Sd({_intern:c,_key:h},f){const y=h(f);return c.has(y)?c.get(y):f}function p_({_intern:c,_key:h},f){const y=h(f);return c.has(y)?c.get(y):(c.set(y,f),f)}function f_({_intern:c,_key:h},f){const y=h(f);return c.has(y)&&(f=c.get(y),c.delete(y)),f}function d_(c){return c!==null&&typeof c=="object"?c.valueOf():c}var Mp=Math.sqrt(50),Dp=Math.sqrt(10),Lp=Math.sqrt(2);function m_(c,h,f){var y,v=-1,w,a,A;if(h=+h,c=+c,f=+f,c===h&&f>0)return[c];if((y=h<c)&&(w=c,c=h,h=w),(A=Km(c,h,f))===0||!isFinite(A))return[];if(A>0){let E=Math.round(c/A),P=Math.round(h/A);for(E*A<c&&++E,P*A>h&&--P,a=new Array(w=P-E+1);++v<w;)a[v]=(E+v)*A}else{A=-A;let E=Math.round(c*A),P=Math.round(h*A);for(E/A<c&&++E,P/A>h&&--P,a=new Array(w=P-E+1);++v<w;)a[v]=(E+v)/A}return y&&a.reverse(),a}function Km(c,h,f){var y=(h-c)/Math.max(0,f),v=Math.floor(Math.log(y)/Math.LN10),w=y/Math.pow(10,v);return v>=0?(w>=Mp?10:w>=Dp?5:w>=Lp?2:1)*Math.pow(10,v):-Math.pow(10,-v)/(w>=Mp?10:w>=Dp?5:w>=Lp?2:1)}function y_(c,h,f){var y=Math.abs(h-c)/Math.max(0,f),v=Math.pow(10,Math.floor(Math.log(y)/Math.LN10)),w=y/v;return w>=Mp?v*=10:w>=Dp?v*=5:w>=Lp&&(v*=2),h<c?-v:v}function g_(c,h,f){c=+c,h=+h,f=(v=arguments.length)<2?(h=c,c=0,1):v<3?1:+f;for(var y=-1,v=Math.max(0,Math.ceil((h-c)/f))|0,w=new Array(v);++y<v;)w[y]=c+y*f;return w}function Vh(c,h){switch(arguments.length){case 0:break;case 1:this.range(c);break;default:this.range(h).domain(c);break}return this}const kd=Symbol("implicit");function Xm(){var c=new wd,h=[],f=[],y=kd;function v(w){let a=c.get(w);if(a===void 0){if(y!==kd)return y;c.set(w,a=h.push(w)-1)}return f[a%f.length]}return v.domain=function(w){if(!arguments.length)return h.slice();h=[],c=new wd;for(const a of w)c.has(a)||c.set(a,h.push(a)-1);return v},v.range=function(w){return arguments.length?(f=Array.from(w),v):f.slice()},v.unknown=function(w){return arguments.length?(y=w,v):y},v.copy=function(){return Xm(h,f).unknown(y)},Vh.apply(v,arguments),v}function Wm(){var c=Xm().unknown(void 0),h=c.domain,f=c.range,y=0,v=1,w,a,A=!1,E=0,P=0,M=.5;delete c.unknown;function V(){var B=h().length,N=v<y,ue=N?v:y,ze=N?y:v;w=(ze-ue)/Math.max(1,B-E+P*2),A&&(w=Math.floor(w)),ue+=(ze-ue-w*(B-E))*M,a=w*(1-E),A&&(ue=Math.round(ue),a=Math.round(a));var Ae=g_(B).map(function(Ie){return ue+w*Ie});return f(N?Ae.reverse():Ae)}return c.domain=function(B){return arguments.length?(h(B),V()):h()},c.range=function(B){return arguments.length?([y,v]=B,y=+y,v=+v,V()):[y,v]},c.rangeRound=function(B){return[y,v]=B,y=+y,v=+v,A=!0,V()},c.bandwidth=function(){return a},c.step=function(){return w},c.round=function(B){return arguments.length?(A=!!B,V()):A},c.padding=function(B){return arguments.length?(E=Math.min(1,P=+B),V()):E},c.paddingInner=function(B){return arguments.length?(E=Math.min(1,B),V()):E},c.paddingOuter=function(B){return arguments.length?(P=+B,V()):P},c.align=function(B){return arguments.length?(M=Math.max(0,Math.min(1,B)),V()):M},c.copy=function(){return Wm(h(),[y,v]).round(A).paddingInner(E).paddingOuter(P).align(M)},Vh.apply(V(),arguments)}function Vp(c,h,f){c.prototype=h.prototype=f,f.constructor=c}function Hm(c,h){var f=Object.create(c.prototype);for(var y in h)f[y]=h[y];return f}function Rc(){}var Cc=.7,Bh=1/Cc,Nu="\\s*([+-]?\\d+)\\s*",Mc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Rs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",__=/^#([0-9a-f]{3,8})$/,v_=new RegExp(`^rgb\\(${Nu},${Nu},${Nu}\\)$`),x_=new RegExp(`^rgb\\(${Rs},${Rs},${Rs}\\)$`),b_=new RegExp(`^rgba\\(${Nu},${Nu},${Nu},${Mc}\\)$`),w_=new RegExp(`^rgba\\(${Rs},${Rs},${Rs},${Mc}\\)$`),S_=new RegExp(`^hsl\\(${Mc},${Rs},${Rs}\\)$`),k_=new RegExp(`^hsla\\(${Mc},${Rs},${Rs},${Mc}\\)$`),Ed={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Vp(Rc,Dc,{copy(c){return Object.assign(new this.constructor,this,c)},displayable(){return this.rgb().displayable()},hex:Td,formatHex:Td,formatHex8:E_,formatHsl:T_,formatRgb:Id,toString:Id});function Td(){return this.rgb().formatHex()}function E_(){return this.rgb().formatHex8()}function T_(){return Jm(this).formatHsl()}function Id(){return this.rgb().formatRgb()}function Dc(c){var h,f;return c=(c+"").trim().toLowerCase(),(h=__.exec(c))?(f=h[1].length,h=parseInt(h[1],16),f===6?Ad(h):f===3?new Qo(h>>8&15|h>>4&240,h>>4&15|h&240,(h&15)<<4|h&15,1):f===8?kh(h>>24&255,h>>16&255,h>>8&255,(h&255)/255):f===4?kh(h>>12&15|h>>8&240,h>>8&15|h>>4&240,h>>4&15|h&240,((h&15)<<4|h&15)/255):null):(h=v_.exec(c))?new Qo(h[1],h[2],h[3],1):(h=x_.exec(c))?new Qo(h[1]*255/100,h[2]*255/100,h[3]*255/100,1):(h=b_.exec(c))?kh(h[1],h[2],h[3],h[4]):(h=w_.exec(c))?kh(h[1]*255/100,h[2]*255/100,h[3]*255/100,h[4]):(h=S_.exec(c))?Cd(h[1],h[2]/100,h[3]/100,1):(h=k_.exec(c))?Cd(h[1],h[2]/100,h[3]/100,h[4]):Ed.hasOwnProperty(c)?Ad(Ed[c]):c==="transparent"?new Qo(NaN,NaN,NaN,0):null}function Ad(c){return new Qo(c>>16&255,c>>8&255,c&255,1)}function kh(c,h,f,y){return y<=0&&(c=h=f=NaN),new Qo(c,h,f,y)}function I_(c){return c instanceof Rc||(c=Dc(c)),c?(c=c.rgb(),new Qo(c.r,c.g,c.b,c.opacity)):new Qo}function Rp(c,h,f,y){return arguments.length===1?I_(c):new Qo(c,h,f,y==null?1:y)}function Qo(c,h,f,y){this.r=+c,this.g=+h,this.b=+f,this.opacity=+y}Vp(Qo,Rp,Hm(Rc,{brighter(c){return c=c==null?Bh:Math.pow(Bh,c),new Qo(this.r*c,this.g*c,this.b*c,this.opacity)},darker(c){return c=c==null?Cc:Math.pow(Cc,c),new Qo(this.r*c,this.g*c,this.b*c,this.opacity)},rgb(){return this},clamp(){return new Qo(eu(this.r),eu(this.g),eu(this.b),Fh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zd,formatHex:zd,formatHex8:A_,formatRgb:Pd,toString:Pd}));function zd(){return`#${$l(this.r)}${$l(this.g)}${$l(this.b)}`}function A_(){return`#${$l(this.r)}${$l(this.g)}${$l(this.b)}${$l((isNaN(this.opacity)?1:this.opacity)*255)}`}function Pd(){const c=Fh(this.opacity);return`${c===1?"rgb(":"rgba("}${eu(this.r)}, ${eu(this.g)}, ${eu(this.b)}${c===1?")":`, ${c})`}`}function Fh(c){return isNaN(c)?1:Math.max(0,Math.min(1,c))}function eu(c){return Math.max(0,Math.min(255,Math.round(c)||0))}function $l(c){return c=eu(c),(c<16?"0":"")+c.toString(16)}function Cd(c,h,f,y){return y<=0?c=h=f=NaN:f<=0||f>=1?c=h=NaN:h<=0&&(c=NaN),new fs(c,h,f,y)}function Jm(c){if(c instanceof fs)return new fs(c.h,c.s,c.l,c.opacity);if(c instanceof Rc||(c=Dc(c)),!c)return new fs;if(c instanceof fs)return c;c=c.rgb();var h=c.r/255,f=c.g/255,y=c.b/255,v=Math.min(h,f,y),w=Math.max(h,f,y),a=NaN,A=w-v,E=(w+v)/2;return A?(h===w?a=(f-y)/A+(f<y)*6:f===w?a=(y-h)/A+2:a=(h-f)/A+4,A/=E<.5?w+v:2-w-v,a*=60):A=E>0&&E<1?0:a,new fs(a,A,E,c.opacity)}function z_(c,h,f,y){return arguments.length===1?Jm(c):new fs(c,h,f,y==null?1:y)}function fs(c,h,f,y){this.h=+c,this.s=+h,this.l=+f,this.opacity=+y}Vp(fs,z_,Hm(Rc,{brighter(c){return c=c==null?Bh:Math.pow(Bh,c),new fs(this.h,this.s,this.l*c,this.opacity)},darker(c){return c=c==null?Cc:Math.pow(Cc,c),new fs(this.h,this.s,this.l*c,this.opacity)},rgb(){var c=this.h%360+(this.h<0)*360,h=isNaN(c)||isNaN(this.s)?0:this.s,f=this.l,y=f+(f<.5?f:1-f)*h,v=2*f-y;return new Qo(Ip(c>=240?c-240:c+120,v,y),Ip(c,v,y),Ip(c<120?c+240:c-120,v,y),this.opacity)},clamp(){return new fs(Md(this.h),Eh(this.s),Eh(this.l),Fh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const c=Fh(this.opacity);return`${c===1?"hsl(":"hsla("}${Md(this.h)}, ${Eh(this.s)*100}%, ${Eh(this.l)*100}%${c===1?")":`, ${c})`}`}}));function Md(c){return c=(c||0)%360,c<0?c+360:c}function Eh(c){return Math.max(0,Math.min(1,c||0))}function Ip(c,h,f){return(c<60?h+(f-h)*c/60:c<180?f:c<240?h+(f-h)*(240-c)/60:h)*255}const jp=c=>()=>c;function P_(c,h){return function(f){return c+f*h}}function C_(c,h,f){return c=Math.pow(c,f),h=Math.pow(h,f)-c,f=1/f,function(y){return Math.pow(c+y*h,f)}}function M_(c){return(c=+c)==1?Ym:function(h,f){return f-h?C_(h,f,c):jp(isNaN(h)?f:h)}}function Ym(c,h){var f=h-c;return f?P_(c,f):jp(isNaN(c)?h:c)}const Dd=function c(h){var f=M_(h);function y(v,w){var a=f((v=Rp(v)).r,(w=Rp(w)).r),A=f(v.g,w.g),E=f(v.b,w.b),P=Ym(v.opacity,w.opacity);return function(M){return v.r=a(M),v.g=A(M),v.b=E(M),v.opacity=P(M),v+""}}return y.gamma=c,y}(1);function D_(c,h){h||(h=[]);var f=c?Math.min(h.length,c.length):0,y=h.slice(),v;return function(w){for(v=0;v<f;++v)y[v]=c[v]*(1-w)+h[v]*w;return y}}function L_(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}function R_(c,h){var f=h?h.length:0,y=c?Math.min(f,c.length):0,v=new Array(y),w=new Array(f),a;for(a=0;a<y;++a)v[a]=qp(c[a],h[a]);for(;a<f;++a)w[a]=h[a];return function(A){for(a=0;a<y;++a)w[a]=v[a](A);return w}}function B_(c,h){var f=new Date;return c=+c,h=+h,function(y){return f.setTime(c*(1-y)+h*y),f}}function Oh(c,h){return c=+c,h=+h,function(f){return c*(1-f)+h*f}}function F_(c,h){var f={},y={},v;(c===null||typeof c!="object")&&(c={}),(h===null||typeof h!="object")&&(h={});for(v in h)v in c?f[v]=qp(c[v],h[v]):y[v]=h[v];return function(w){for(v in f)y[v]=f[v](w);return y}}var Bp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ap=new RegExp(Bp.source,"g");function O_(c){return function(){return c}}function N_(c){return function(h){return c(h)+""}}function U_(c,h){var f=Bp.lastIndex=Ap.lastIndex=0,y,v,w,a=-1,A=[],E=[];for(c=c+"",h=h+"";(y=Bp.exec(c))&&(v=Ap.exec(h));)(w=v.index)>f&&(w=h.slice(f,w),A[a]?A[a]+=w:A[++a]=w),(y=y[0])===(v=v[0])?A[a]?A[a]+=v:A[++a]=v:(A[++a]=null,E.push({i:a,x:Oh(y,v)})),f=Ap.lastIndex;return f<h.length&&(w=h.slice(f),A[a]?A[a]+=w:A[++a]=w),A.length<2?E[0]?N_(E[0].x):O_(h):(h=E.length,function(P){for(var M=0,V;M<h;++M)A[(V=E[M]).i]=V.x(P);return A.join("")})}function qp(c,h){var f=typeof h,y;return h==null||f==="boolean"?jp(h):(f==="number"?Oh:f==="string"?(y=Dc(h))?(h=y,Dd):U_:h instanceof Dc?Dd:h instanceof Date?B_:L_(h)?D_:Array.isArray(h)?R_:typeof h.valueOf!="function"&&typeof h.toString!="function"||isNaN(h)?F_:Oh)(c,h)}function V_(c,h){return c=+c,h=+h,function(f){return Math.round(c*(1-f)+h*f)}}function j_(c){return function(){return c}}function q_(c){return+c}var Ld=[0,1];function Ls(c){return c}function Fp(c,h){return(h-=c=+c)?function(f){return(f-c)/h}:j_(isNaN(h)?NaN:.5)}function Z_(c,h){var f;return c>h&&(f=c,c=h,h=f),function(y){return Math.max(c,Math.min(h,y))}}function G_(c,h,f){var y=c[0],v=c[1],w=h[0],a=h[1];return v<y?(y=Fp(v,y),w=f(a,w)):(y=Fp(y,v),w=f(w,a)),function(A){return w(y(A))}}function K_(c,h,f){var y=Math.min(c.length,h.length)-1,v=new Array(y),w=new Array(y),a=-1;for(c[y]<c[0]&&(c=c.slice().reverse(),h=h.slice().reverse());++a<y;)v[a]=Fp(c[a],c[a+1]),w[a]=f(h[a],h[a+1]);return function(A){var E=h_(c,A,1,y)-1;return w[E](v[E](A))}}function Qm(c,h){return h.domain(c.domain()).range(c.range()).interpolate(c.interpolate()).clamp(c.clamp()).unknown(c.unknown())}function $m(){var c=Ld,h=Ld,f=qp,y,v,w,a=Ls,A,E,P;function M(){var B=Math.min(c.length,h.length);return a!==Ls&&(a=Z_(c[0],c[B-1])),A=B>2?K_:G_,E=P=null,V}function V(B){return B==null||isNaN(B=+B)?w:(E||(E=A(c.map(y),h,f)))(y(a(B)))}return V.invert=function(B){return a(v((P||(P=A(h,c.map(y),Oh)))(B)))},V.domain=function(B){return arguments.length?(c=Array.from(B,q_),M()):c.slice()},V.range=function(B){return arguments.length?(h=Array.from(B),M()):h.slice()},V.rangeRound=function(B){return h=Array.from(B),f=V_,M()},V.clamp=function(B){return arguments.length?(a=B?!0:Ls,M()):a!==Ls},V.interpolate=function(B){return arguments.length?(f=B,M()):f},V.unknown=function(B){return arguments.length?(w=B,V):w},function(B,N){return y=B,v=N,M()}}function X_(){return $m()(Ls,Ls)}function W_(c){return Math.abs(c=Math.round(c))>=1e21?c.toLocaleString("en").replace(/,/g,""):c.toString(10)}function Nh(c,h){if((f=(c=h?c.toExponential(h-1):c.toExponential()).indexOf("e"))<0)return null;var f,y=c.slice(0,f);return[y.length>1?y[0]+y.slice(2):y,+c.slice(f+1)]}function Gu(c){return c=Nh(Math.abs(c)),c?c[1]:NaN}function H_(c,h){return function(f,y){for(var v=f.length,w=[],a=0,A=c[0],E=0;v>0&&A>0&&(E+A+1>y&&(A=Math.max(1,y-E)),w.push(f.substring(v-=A,v+A)),!((E+=A+1)>y));)A=c[a=(a+1)%c.length];return w.reverse().join(h)}}function J_(c){return function(h){return h.replace(/[0-9]/g,function(f){return c[+f]})}}var Y_=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Uh(c){if(!(h=Y_.exec(c)))throw new Error("invalid format: "+c);var h;return new Zp({fill:h[1],align:h[2],sign:h[3],symbol:h[4],zero:h[5],width:h[6],comma:h[7],precision:h[8]&&h[8].slice(1),trim:h[9],type:h[10]})}Uh.prototype=Zp.prototype;function Zp(c){this.fill=c.fill===void 0?" ":c.fill+"",this.align=c.align===void 0?">":c.align+"",this.sign=c.sign===void 0?"-":c.sign+"",this.symbol=c.symbol===void 0?"":c.symbol+"",this.zero=!!c.zero,this.width=c.width===void 0?void 0:+c.width,this.comma=!!c.comma,this.precision=c.precision===void 0?void 0:+c.precision,this.trim=!!c.trim,this.type=c.type===void 0?"":c.type+""}Zp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Q_(c){e:for(var h=c.length,f=1,y=-1,v;f<h;++f)switch(c[f]){case".":y=v=f;break;case"0":y===0&&(y=f),v=f;break;default:if(!+c[f])break e;y>0&&(y=0);break}return y>0?c.slice(0,y)+c.slice(v+1):c}var ey;function $_(c,h){var f=Nh(c,h);if(!f)return c+"";var y=f[0],v=f[1],w=v-(ey=Math.max(-8,Math.min(8,Math.floor(v/3)))*3)+1,a=y.length;return w===a?y:w>a?y+new Array(w-a+1).join("0"):w>0?y.slice(0,w)+"."+y.slice(w):"0."+new Array(1-w).join("0")+Nh(c,Math.max(0,h+w-1))[0]}function Rd(c,h){var f=Nh(c,h);if(!f)return c+"";var y=f[0],v=f[1];return v<0?"0."+new Array(-v).join("0")+y:y.length>v+1?y.slice(0,v+1)+"."+y.slice(v+1):y+new Array(v-y.length+2).join("0")}const Bd={"%":(c,h)=>(c*100).toFixed(h),b:c=>Math.round(c).toString(2),c:c=>c+"",d:W_,e:(c,h)=>c.toExponential(h),f:(c,h)=>c.toFixed(h),g:(c,h)=>c.toPrecision(h),o:c=>Math.round(c).toString(8),p:(c,h)=>Rd(c*100,h),r:Rd,s:$_,X:c=>Math.round(c).toString(16).toUpperCase(),x:c=>Math.round(c).toString(16)};function Fd(c){return c}var Od=Array.prototype.map,Nd=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function ev(c){var h=c.grouping===void 0||c.thousands===void 0?Fd:H_(Od.call(c.grouping,Number),c.thousands+""),f=c.currency===void 0?"":c.currency[0]+"",y=c.currency===void 0?"":c.currency[1]+"",v=c.decimal===void 0?".":c.decimal+"",w=c.numerals===void 0?Fd:J_(Od.call(c.numerals,String)),a=c.percent===void 0?"%":c.percent+"",A=c.minus===void 0?"\u2212":c.minus+"",E=c.nan===void 0?"NaN":c.nan+"";function P(V){V=Uh(V);var B=V.fill,N=V.align,ue=V.sign,ze=V.symbol,Ae=V.zero,Ie=V.width,Me=V.comma,ft=V.precision,Pt=V.trim,ve=V.type;ve==="n"?(Me=!0,ve="g"):Bd[ve]||(ft===void 0&&(ft=12),Pt=!0,ve="g"),(Ae||B==="0"&&N==="=")&&(Ae=!0,B="0",N="=");var je=ze==="$"?f:ze==="#"&&/[boxX]/.test(ve)?"0"+ve.toLowerCase():"",ur=ze==="$"?y:/[%p]/.test(ve)?a:"",cr=Bd[ve],pt=/[defgprs%]/.test(ve);ft=ft===void 0?6:/[gprs]/.test(ve)?Math.max(1,Math.min(21,ft)):Math.max(0,Math.min(20,ft));function hr(gt){var nt=je,xt=ur,er,We,nr;if(ve==="c")xt=cr(gt)+xt,gt="";else{gt=+gt;var wr=gt<0||1/gt<0;if(gt=isNaN(gt)?E:cr(Math.abs(gt),ft),Pt&&(gt=Q_(gt)),wr&&+gt==0&&ue!=="+"&&(wr=!1),nt=(wr?ue==="("?ue:A:ue==="-"||ue==="("?"":ue)+nt,xt=(ve==="s"?Nd[8+ey/3]:"")+xt+(wr&&ue==="("?")":""),pt){for(er=-1,We=gt.length;++er<We;)if(nr=gt.charCodeAt(er),48>nr||nr>57){xt=(nr===46?v+gt.slice(er+1):gt.slice(er))+xt,gt=gt.slice(0,er);break}}}Me&&!Ae&&(gt=h(gt,1/0));var Nt=nt.length+gt.length+xt.length,qt=Nt<Ie?new Array(Ie-Nt+1).join(B):"";switch(Me&&Ae&&(gt=h(qt+gt,qt.length?Ie-xt.length:1/0),qt=""),N){case"<":gt=nt+gt+xt+qt;break;case"=":gt=nt+qt+gt+xt;break;case"^":gt=qt.slice(0,Nt=qt.length>>1)+nt+gt+xt+qt.slice(Nt);break;default:gt=qt+nt+gt+xt;break}return w(gt)}return hr.toString=function(){return V+""},hr}function M(V,B){var N=P((V=Uh(V),V.type="f",V)),ue=Math.max(-8,Math.min(8,Math.floor(Gu(B)/3)))*3,ze=Math.pow(10,-ue),Ae=Nd[8+ue/3];return function(Ie){return N(ze*Ie)+Ae}}return{format:P,formatPrefix:M}}var Th,ty,ry;tv({thousands:",",grouping:[3],currency:["$",""]});function tv(c){return Th=ev(c),ty=Th.format,ry=Th.formatPrefix,Th}function rv(c){return Math.max(0,-Gu(Math.abs(c)))}function iv(c,h){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Gu(h)/3)))*3-Gu(Math.abs(c)))}function nv(c,h){return c=Math.abs(c),h=Math.abs(h)-c,Math.max(0,Gu(h)-Gu(c))+1}function ov(c,h,f,y){var v=y_(c,h,f),w;switch(y=Uh(y==null?",f":y),y.type){case"s":{var a=Math.max(Math.abs(c),Math.abs(h));return y.precision==null&&!isNaN(w=iv(v,a))&&(y.precision=w),ry(y,a)}case"":case"e":case"g":case"p":case"r":{y.precision==null&&!isNaN(w=nv(v,Math.max(Math.abs(c),Math.abs(h))))&&(y.precision=w-(y.type==="e"));break}case"f":case"%":{y.precision==null&&!isNaN(w=rv(v))&&(y.precision=w-(y.type==="%")*2);break}}return ty(y)}function iy(c){var h=c.domain;return c.ticks=function(f){var y=h();return m_(y[0],y[y.length-1],f==null?10:f)},c.tickFormat=function(f,y){var v=h();return ov(v[0],v[v.length-1],f==null?10:f,y)},c.nice=function(f){f==null&&(f=10);var y=h(),v=0,w=y.length-1,a=y[v],A=y[w],E,P,M=10;for(A<a&&(P=a,a=A,A=P,P=v,v=w,w=P);M-- >0;){if(P=Km(a,A,f),P===E)return y[v]=a,y[w]=A,h(y);if(P>0)a=Math.floor(a/P)*P,A=Math.ceil(A/P)*P;else if(P<0)a=Math.ceil(a*P)/P,A=Math.floor(A*P)/P;else break;E=P}return c},c}function Dh(){var c=X_();return c.copy=function(){return Qm(c,Dh())},Vh.apply(c,arguments),iy(c)}function Ud(c){return function(h){return h<0?-Math.pow(-h,c):Math.pow(h,c)}}function av(c){return c<0?-Math.sqrt(-c):Math.sqrt(c)}function sv(c){return c<0?-c*c:c*c}function lv(c){var h=c(Ls,Ls),f=1;function y(){return f===1?c(Ls,Ls):f===.5?c(av,sv):c(Ud(f),Ud(1/f))}return h.exponent=function(v){return arguments.length?(f=+v,y()):f},iy(h)}function ny(){var c=lv($m());return c.copy=function(){return Qm(c,ny()).exponent(c.exponent())},Vh.apply(c,arguments),c}function uv(){return ny.apply(null,arguments).exponent(.5)}const zc={x:Dh,y:Dh,z:Dh,r:uv};function cv(c){return c.constant?"symlog":c.base?"log":c.exponent?c.exponent()===.5?"sqrt":"pow":"other"}function Vd(c){return c}function hv(c){return h=>Math.log(c*h)}function pv(c){return h=>c*Math.exp(h)}function fv(c){return h=>Math.sign(h)*Math.log1p(Math.abs(h/c))}function dv(c){return h=>Math.sign(h)*Math.expm1(Math.abs(h))*c}function Ih(c){return function(f){return f<0?-Math.pow(-f,c):Math.pow(f,c)}}function mv(c){const h=cv(c);if(h==="log"){const f=Math.sign(c.domain()[0]);return{lift:hv(f),ground:pv(f),scaleType:h}}return h==="pow"?{lift:Ih(1),ground:Ih(1/1),scaleType:h}:h==="sqrt"?{lift:Ih(.5),ground:Ih(1/.5),scaleType:h}:h==="symlog"?{lift:fv(1),ground:dv(1),scaleType:h}:{lift:Vd,ground:Vd,scaleType:h}}function yv(c,h){if(typeof c.range!="function")throw new Error("Scale method `range` must be a function");if(typeof c.domain!="function")throw new Error("Scale method `domain` must be a function");if(!Array.isArray(h))return c.domain();c.domain().length!==2&&console.warn("[LayerCake] The scale is expected to have a domain of length 2 to use padding. Are you sure you want to use padding? Your scale's domain is:",c.domain()),c.range().length!==2&&console.warn("[LayerCake] The scale is expected to have a range of length 2 to use padding. Are you sure you want to use padding? Your scale's range is:",c.range());const{lift:f,ground:y}=mv(c),v=c.domain()[0],w=Object.prototype.toString.call(v)==="[object Date]",[a,A]=c.domain().map(N=>f(w?N.getTime():N)),[E,P]=c.range(),M=h[0]||0,V=h[1]||0,B=(A-a)/(Math.abs(P-E)-M-V);return[a-M*B,V*B+A].map(N=>y(w?new Date(N):N))}function gv(c,h,f,y,v){let w,a;return v===!0?(w=0,a=100):(w=c==="r"?1:0,a=c==="y"?f:c==="r"?25:h),y===!0?[a,w]:[w,a]}function _v(c,h,f,y,v,w){return v?typeof v=="function"?v({width:h,height:f}):v:gv(c,h,f,y,w)}function Ah(c){return function([f,y,v,w,a,A,E,P,M,V]){if(y===null)return null;const B=_v(c,E,P,A,M,V),N=f===zc[c]?f():f.copy();return N.domain(Zm(y[c],v)).range(B),w&&N.domain(yv(N,w)),a===!0&&(typeof N.nice=="function"?N.nice():console.error(`[Layer Cake] You set \`${c}Nice: true\` but the ${c}Scale does not have a \`.nice\` method. Ignoring...`)),N}}function zh([c,h]){return f=>{const y=c(f);return Array.isArray(y)?y.map(v=>h(v)):h(y)}}function Ph([c]){if(typeof c=="function"){if(typeof c.range=="function")return c.range();console.error("[LayerCake] Your scale doesn't have a `.range` method?")}return null}const Ch={x:!1,y:!0,z:!1,r:!1};const vv=c=>({element:c[0]&4,width:c[0]&256,height:c[0]&512,aspectRatio:c[0]&1024,containerWidth:c[0]&128,containerHeight:c[0]&64}),jd=c=>({element:c[2],width:c[8],height:c[9],aspectRatio:c[10],containerWidth:c[7],containerHeight:c[6]});function qd(c){let h,f,y;const v=c[90].default,w=Vu(v,c,c[89],jd);return{c(){h=De("div"),w&&w.c(),this.h()},l(a){h=Le(a,"DIV",{class:!0});var A=Ve(h);w&&w.l(A),A.forEach(ie),this.h()},h(){ce(h,"class","layercake-container svelte-vhzpsp"),Np(()=>c[92].call(h)),Qt(h,"position",c[5],!1),Qt(h,"top",c[5]==="absolute"?"0":null,!1),Qt(h,"right",c[5]==="absolute"?"0":null,!1),Qt(h,"bottom",c[5]==="absolute"?"0":null,!1),Qt(h,"left",c[5]==="absolute"?"0":null,!1),Qt(h,"pointer-events",c[4]===!1?"none":null,!1)},m(a,A){Fe(a,h,A),w&&w.m(h,null),c[91](h),f=Up(h,c[92].bind(h)),y=!0},p(a,A){w&&w.p&&(!y||A[0]&1988|A[2]&134217728)&&ju(w,v,a,a[89],y?Zu(v,a[89],A,vv):qu(a[89]),jd),A[0]&32&&Qt(h,"position",a[5],!1),A[0]&32&&Qt(h,"top",a[5]==="absolute"?"0":null,!1),A[0]&32&&Qt(h,"right",a[5]==="absolute"?"0":null,!1),A[0]&32&&Qt(h,"bottom",a[5]==="absolute"?"0":null,!1),A[0]&32&&Qt(h,"left",a[5]==="absolute"?"0":null,!1),A[0]&16&&Qt(h,"pointer-events",a[4]===!1?"none":null,!1)},i(a){y||(vt(w,a),y=!0)},o(a){zt(w,a),y=!1},d(a){a&&ie(h),w&&w.d(a),c[91](null),f()}}}function xv(c){let h,f,y=(c[3]===!0||typeof window<"u")&&qd(c);return{c(){y&&y.c(),h=Br()},l(v){y&&y.l(v),h=Br()},m(v,w){y&&y.m(v,w),Fe(v,h,w),f=!0},p(v,w){v[3]===!0||typeof window<"u"?y?(y.p(v,w),w[0]&8&&vt(y,1)):(y=qd(v),y.c(),vt(y,1),y.m(h.parentNode,h)):y&&(Ha(),zt(y,1,1,()=>{y=null}),Ja())},i(v){f||(vt(y),f=!0)},o(v){zt(y),f=!1},d(v){y&&y.d(v),v&&ie(h)}}}function bv(c,h,f){let y,v,w,a,A,E,P,M,V,B,N,ue,ze,Ae,Ie,Me,ft,Pt,ve,je,ur,cr,pt,hr,gt,nt,xt,er,We,nr,wr,Nt,qt,ht,He,Sr,Hi,Zn,Gn,mi,vr,{$$slots:Kn={},$$scope:Zt}=h,{ssr:Vi=!1}=h,{pointerEvents:So=!0}=h,{position:on="relative"}=h,{percentRange:Gt=!1}=h,{width:Cn=void 0}=h,{height:ti=void 0}=h,{containerWidth:oi=Cn||100}=h,{containerHeight:Xn=ti||100}=h,{element:ji=void 0}=h,{x:Ci=void 0}=h,{y:yi=void 0}=h,{z:an=void 0}=h,{r:mn=void 0}=h,{data:gi=[]}=h,{xDomain:_i=void 0}=h,{yDomain:Fr=void 0}=h,{zDomain:kr=void 0}=h,{rDomain:Wn=void 0}=h,{xNice:yn=!1}=h,{yNice:gn=!1}=h,{zNice:lo=!1}=h,{rNice:Hn=!1}=h,{xReverse:Ji=Ch.x}=h,{yReverse:Mi=Ch.y}=h,{zReverse:uo=Ch.z}=h,{rReverse:Mn=Ch.r}=h,{xPadding:Yi=void 0}=h,{yPadding:sn=void 0}=h,{zPadding:ko=void 0}=h,{rPadding:Jn=void 0}=h,{xScale:_n=zc.x}=h,{yScale:ln=zc.y}=h,{zScale:un=zc.z}=h,{rScale:Qi=zc.r}=h,{xRange:Dn=void 0}=h,{yRange:pr=void 0}=h,{zRange:L=void 0}=h,{rRange:O=void 0}=h,{padding:q={}}=h,{extents:W={}}=h,{flatData:J=void 0}=h,{custom:se={}}=h,he=!1;Fm(()=>{he=!0});const j={},Q=Ir(Gt);Vt(c,Q,de=>f(128,Zn=de));const me=Ir(oi);Vt(c,me,de=>f(7,Hi=de));const Be=Ir(Xn);Vt(c,Be,de=>f(6,Sr=de));const Ne=Ir(Tp(W));Vt(c,Ne,de=>f(127,He=de));const Se=Ir(gi);Vt(c,Se,de=>f(126,ht=de));const Oe=Ir(J||gi);Vt(c,Oe,de=>f(125,qt=de));const rt=Ir(q);Vt(c,rt,de=>f(124,Nt=de));const et=Ir(Sl(Ci));Vt(c,et,de=>f(123,wr=de));const we=Ir(Sl(yi));Vt(c,we,de=>f(122,nr=de));const Qe=Ir(Sl(an));Vt(c,Qe,de=>f(121,We=de));const Ge=Ir(Sl(mn));Vt(c,Ge,de=>f(120,er=de));const Ze=Ir(_i);Vt(c,Ze,de=>f(119,xt=de));const Ct=Ir(Fr);Vt(c,Ct,de=>f(118,nt=de));const $e=Ir(kr);Vt(c,$e,de=>f(117,gt=de));const Kt=Ir(Wn);Vt(c,Kt,de=>f(116,hr=de));const sr=Ir(yn);Vt(c,sr,de=>f(115,pt=de));const Ft=Ir(gn);Vt(c,Ft,de=>f(114,cr=de));const Ot=Ir(lo);Vt(c,Ot,de=>f(113,ur=de));const Xt=Ir(Hn);Vt(c,Xt,de=>f(112,je=de));const Xr=Ir(Ji);Vt(c,Xr,de=>f(111,ve=de));const tr=Ir(Mi);Vt(c,tr,de=>f(110,Pt=de));const Cr=Ir(uo);Vt(c,Cr,de=>f(109,ft=de));const or=Ir(Mn);Vt(c,or,de=>f(108,Me=de));const Ut=Ir(Yi);Vt(c,Ut,de=>f(107,Ie=de));const Dt=Ir(sn);Vt(c,Dt,de=>f(106,Ae=de));const Wr=Ir(ko);Vt(c,Wr,de=>f(105,ze=de));const Yn=Ir(Jn);Vt(c,Yn,de=>f(104,ue=de));const Hr=Ir(Dn);Vt(c,Hr,de=>f(103,N=de));const hi=Ir(pr);Vt(c,hi,de=>f(102,B=de));const Lo=Ir(L);Vt(c,Lo,de=>f(101,V=de));const vn=Ir(O);Vt(c,vn,de=>f(100,M=de));const zr=Ir(_n);Vt(c,zr,de=>f(99,P=de));const Qn=Ir(ln);Vt(c,Qn,de=>f(98,E=de));const ai=Ir(un);Vt(c,ai,de=>f(97,A=de));const Or=Ir(Qi);Vt(c,Or,de=>f(96,a=de));const Di=Ir(j);Vt(c,Di,de=>f(94,v=de));const xr=Ir(se);Vt(c,xr,de=>f(95,w=de));const cn=Ni([et,we,Qe,Ge],([de,ri,xi,yr])=>{const bn={};return de&&(bn.x=de),ri&&(bn.y=ri),xi&&(bn.z=xi),yr&&(bn.r=yr),bn}),Li=Ni([rt,me,Be],([de])=>Object.assign({top:0,right:0,bottom:0,left:0},de)),Ti=Ni([me,Be,Li],([de,ri,xi])=>{const yr={};return yr.top=xi.top,yr.right=de-xi.right,yr.bottom=ri-xi.bottom,yr.left=xi.left,yr.width=yr.right-yr.left,yr.height=yr.bottom-yr.top,yr.width<=0&&he===!0&&console.warn("[LayerCake] Target div has zero or negative width. Did you forget to set an explicit width in CSS on the container?"),yr.height<=0&&he===!0&&console.warn("[LayerCake] Target div has zero or negative height. Did you forget to set an explicit height in CSS on the container?"),yr}),mr=Ni([Ti],([de])=>de.width);Vt(c,mr,de=>f(8,Gn=de));const co=Ni([Ti],([de])=>de.height);Vt(c,co,de=>f(9,mi=de));const Nr=Ni([Oe,cn,Ne],([de,ri,xi])=>{const yr=Tp(ri,xi);return Object.keys(yr).length>0?{...o_(de,yr),...xi}:{}}),Jr=Ni([Nr,Ze],Sh("x")),xn=Ni([Nr,Ct],Sh("y")),vi=Ni([Nr,$e],Sh("z")),ho=Ni([Nr,Kt],Sh("r")),Eo=Ni([zr,Nr,Jr,Ut,sr,Xr,mr,co,Hr,Q],Ah("x")),Ro=Ni([et,Eo],zh),ia=Ni([Qn,Nr,xn,Dt,Ft,tr,mr,co,hi,Q],Ah("y")),Os=Ni([we,ia],zh),$n=Ni([ai,Nr,vi,Wr,Ot,Cr,mr,co,Lo,Q],Ah("z")),Ta=Ni([Qe,$n],zh),Ia=Ni([Or,Nr,ho,Yn,Xt,or,mr,co,vn,Q],Ah("r")),ms=Ni([Ge,Ia],zh),Bo=Ni([Eo],Ph),po=Ni([ia],Ph),na=Ni([$n],Ph),To=Ni([Ia],Ph),eo=Ni([mr,co],([de,ri])=>de/ri);Vt(c,eo,de=>f(10,vr=de));function hn(de){sl[de?"unshift":"push"](()=>{ji=de,f(2,ji)})}function fo(){oi=this.clientWidth,Xn=this.clientHeight,f(0,oi),f(1,Xn)}return c.$$set=de=>{"ssr"in de&&f(3,Vi=de.ssr),"pointerEvents"in de&&f(4,So=de.pointerEvents),"position"in de&&f(5,on=de.position),"percentRange"in de&&f(51,Gt=de.percentRange),"width"in de&&f(52,Cn=de.width),"height"in de&&f(53,ti=de.height),"containerWidth"in de&&f(0,oi=de.containerWidth),"containerHeight"in de&&f(1,Xn=de.containerHeight),"element"in de&&f(2,ji=de.element),"x"in de&&f(54,Ci=de.x),"y"in de&&f(55,yi=de.y),"z"in de&&f(56,an=de.z),"r"in de&&f(57,mn=de.r),"data"in de&&f(58,gi=de.data),"xDomain"in de&&f(59,_i=de.xDomain),"yDomain"in de&&f(60,Fr=de.yDomain),"zDomain"in de&&f(61,kr=de.zDomain),"rDomain"in de&&f(62,Wn=de.rDomain),"xNice"in de&&f(63,yn=de.xNice),"yNice"in de&&f(64,gn=de.yNice),"zNice"in de&&f(65,lo=de.zNice),"rNice"in de&&f(66,Hn=de.rNice),"xReverse"in de&&f(67,Ji=de.xReverse),"yReverse"in de&&f(68,Mi=de.yReverse),"zReverse"in de&&f(69,uo=de.zReverse),"rReverse"in de&&f(70,Mn=de.rReverse),"xPadding"in de&&f(71,Yi=de.xPadding),"yPadding"in de&&f(72,sn=de.yPadding),"zPadding"in de&&f(73,ko=de.zPadding),"rPadding"in de&&f(74,Jn=de.rPadding),"xScale"in de&&f(75,_n=de.xScale),"yScale"in de&&f(76,ln=de.yScale),"zScale"in de&&f(77,un=de.zScale),"rScale"in de&&f(78,Qi=de.rScale),"xRange"in de&&f(79,Dn=de.xRange),"yRange"in de&&f(80,pr=de.yRange),"zRange"in de&&f(81,L=de.zRange),"rRange"in de&&f(82,O=de.rRange),"padding"in de&&f(83,q=de.padding),"extents"in de&&f(84,W=de.extents),"flatData"in de&&f(85,J=de.flatData),"custom"in de&&f(86,se=de.custom),"$$scope"in de&&f(89,Zt=de.$$scope)},c.$$.update=()=>{c.$$.dirty[1]&8388608&&Ci&&f(87,j.x=Ci,j),c.$$.dirty[1]&16777216&&yi&&f(87,j.y=yi,j),c.$$.dirty[1]&33554432&&an&&f(87,j.z=an,j),c.$$.dirty[1]&67108864&&mn&&f(87,j.r=mn,j),c.$$.dirty[1]&268435456&&_i&&f(87,j.xDomain=_i,j),c.$$.dirty[1]&536870912&&Fr&&f(87,j.yDomain=Fr,j),c.$$.dirty[1]&1073741824&&kr&&f(87,j.zDomain=kr,j),c.$$.dirty[2]&1&&Wn&&f(87,j.rDomain=Wn,j),c.$$.dirty[2]&131072&&Dn&&f(87,j.xRange=Dn,j),c.$$.dirty[2]&262144&&pr&&f(87,j.yRange=pr,j),c.$$.dirty[2]&524288&&L&&f(87,j.zRange=L,j),c.$$.dirty[2]&1048576&&O&&f(87,j.rRange=O,j),c.$$.dirty[1]&1048576&&Tr(Q,Zn=Gt,Zn),c.$$.dirty[0]&1&&Tr(me,Hi=oi,Hi),c.$$.dirty[0]&2&&Tr(Be,Sr=Xn,Sr),c.$$.dirty[2]&4194304&&Tr(Ne,He=Tp(W),He),c.$$.dirty[1]&134217728&&Tr(Se,ht=gi,ht),c.$$.dirty[1]&134217728|c.$$.dirty[2]&8388608&&Tr(Oe,qt=J||gi,qt),c.$$.dirty[2]&2097152&&Tr(rt,Nt=q,Nt),c.$$.dirty[1]&8388608&&Tr(et,wr=Sl(Ci),wr),c.$$.dirty[1]&16777216&&Tr(we,nr=Sl(yi),nr),c.$$.dirty[1]&33554432&&Tr(Qe,We=Sl(an),We),c.$$.dirty[1]&67108864&&Tr(Ge,er=Sl(mn),er),c.$$.dirty[1]&268435456&&Tr(Ze,xt=_i,xt),c.$$.dirty[1]&536870912&&Tr(Ct,nt=Fr,nt),c.$$.dirty[1]&1073741824&&Tr($e,gt=kr,gt),c.$$.dirty[2]&1&&Tr(Kt,hr=Wn,hr),c.$$.dirty[2]&2&&Tr(sr,pt=yn,pt),c.$$.dirty[2]&4&&Tr(Ft,cr=gn,cr),c.$$.dirty[2]&8&&Tr(Ot,ur=lo,ur),c.$$.dirty[2]&16&&Tr(Xt,je=Hn,je),c.$$.dirty[2]&32&&Tr(Xr,ve=Ji,ve),c.$$.dirty[2]&64&&Tr(tr,Pt=Mi,Pt),c.$$.dirty[2]&128&&Tr(Cr,ft=uo,ft),c.$$.dirty[2]&256&&Tr(or,Me=Mn,Me),c.$$.dirty[2]&512&&Tr(Ut,Ie=Yi,Ie),c.$$.dirty[2]&1024&&Tr(Dt,Ae=sn,Ae),c.$$.dirty[2]&2048&&Tr(Wr,ze=ko,ze),c.$$.dirty[2]&4096&&Tr(Yn,ue=Jn,ue),c.$$.dirty[2]&131072&&Tr(Hr,N=Dn,N),c.$$.dirty[2]&262144&&Tr(hi,B=pr,B),c.$$.dirty[2]&524288&&Tr(Lo,V=L,V),c.$$.dirty[2]&1048576&&Tr(vn,M=O,M),c.$$.dirty[2]&8192&&Tr(zr,P=_n,P),c.$$.dirty[2]&16384&&Tr(Qn,E=ln,E),c.$$.dirty[2]&32768&&Tr(ai,A=un,A),c.$$.dirty[2]&65536&&Tr(Or,a=Qi,a),c.$$.dirty[2]&16777216&&Tr(xr,w=se,w),c.$$.dirty[2]&33554432&&Tr(Di,v=j,v),c.$$.dirty[2]&67108864&&Om("LayerCake",y)},f(88,y={activeGetters:cn,width:mr,height:co,percentRange:Q,aspectRatio:eo,containerWidth:me,containerHeight:Be,x:et,y:we,z:Qe,r:Ge,custom:xr,data:Se,xNice:sr,yNice:Ft,zNice:Ot,rNice:Xt,xReverse:Xr,yReverse:tr,zReverse:Cr,rReverse:or,xPadding:Ut,yPadding:Dt,zPadding:Wr,rPadding:Yn,padding:Li,flatData:Oe,extents:Nr,xDomain:Jr,yDomain:xn,zDomain:vi,rDomain:ho,xRange:Bo,yRange:po,zRange:na,rRange:To,config:Di,xScale:Eo,xGet:Ro,yScale:ia,yGet:Os,zScale:$n,zGet:Ta,rScale:Ia,rGet:ms}),[oi,Xn,ji,Vi,So,on,Sr,Hi,Gn,mi,vr,Q,me,Be,Ne,Se,Oe,rt,et,we,Qe,Ge,Ze,Ct,$e,Kt,sr,Ft,Ot,Xt,Xr,tr,Cr,or,Ut,Dt,Wr,Yn,Hr,hi,Lo,vn,zr,Qn,ai,Or,Di,xr,mr,co,eo,Gt,Cn,ti,Ci,yi,an,mn,gi,_i,Fr,kr,Wn,yn,gn,lo,Hn,Ji,Mi,uo,Mn,Yi,sn,ko,Jn,_n,ln,un,Qi,Dn,pr,L,O,q,W,J,se,j,y,Zt,Kn,hn,fo]}class wv extends ea{constructor(h){super(),ta(this,h,bv,xv,ra,{ssr:3,pointerEvents:4,position:5,percentRange:51,width:52,height:53,containerWidth:0,containerHeight:1,element:2,x:54,y:55,z:56,r:57,data:58,xDomain:59,yDomain:60,zDomain:61,rDomain:62,xNice:63,yNice:64,zNice:65,rNice:66,xReverse:67,yReverse:68,zReverse:69,rReverse:70,xPadding:71,yPadding:72,zPadding:73,rPadding:74,xScale:75,yScale:76,zScale:77,rScale:78,xRange:79,yRange:80,zRange:81,rRange:82,padding:83,extents:84,flatData:85,custom:86},null,[-1,-1,-1,-1,-1])}}const Sv=c=>({element:c&1}),Zd=c=>({element:c[0]}),kv=c=>({element:c&1}),Gd=c=>({element:c[0]});function Ev(c){let h,f,y,v,w;const a=c[12].defs,A=Vu(a,c,c[11],Gd),E=c[12].default,P=Vu(E,c,c[11],Zd);return{c(){h=Ya("svg"),f=Ya("defs"),A&&A.c(),y=Ya("g"),P&&P.c(),this.h()},l(M){h=Qa(M,"svg",{class:!0,viewBox:!0,width:!0,height:!0});var V=Ve(h);f=Qa(V,"defs",{});var B=Ve(f);A&&A.l(B),B.forEach(ie),y=Qa(V,"g",{class:!0,transform:!0});var N=Ve(y);P&&P.l(N),N.forEach(ie),V.forEach(ie),this.h()},h(){ce(y,"class","layercake-layout-svg_g"),ce(y,"transform",v="translate("+c[7].left+", "+c[7].top+")"),ce(h,"class","layercake-layout-svg svelte-u84d8d"),ce(h,"viewBox",c[4]),ce(h,"width",c[5]),ce(h,"height",c[6]),Qt(h,"z-index",c[2],!1),Qt(h,"pointer-events",c[3]===!1?"none":null,!1)},m(M,V){Fe(M,h,V),re(h,f),A&&A.m(f,null),re(h,y),P&&P.m(y,null),c[13](y),c[14](h),w=!0},p(M,[V]){A&&A.p&&(!w||V&2049)&&ju(A,a,M,M[11],w?Zu(a,M[11],V,kv):qu(M[11]),Gd),P&&P.p&&(!w||V&2049)&&ju(P,E,M,M[11],w?Zu(E,M[11],V,Sv):qu(M[11]),Zd),(!w||V&128&&v!==(v="translate("+M[7].left+", "+M[7].top+")"))&&ce(y,"transform",v),(!w||V&16)&&ce(h,"viewBox",M[4]),(!w||V&32)&&ce(h,"width",M[5]),(!w||V&64)&&ce(h,"height",M[6]),V&4&&Qt(h,"z-index",M[2],!1),V&8&&Qt(h,"pointer-events",M[3]===!1?"none":null,!1)},i(M){w||(vt(A,M),vt(P,M),w=!0)},o(M){zt(A,M),zt(P,M),w=!1},d(M){M&&ie(h),A&&A.d(M),P&&P.d(M),c[13](null),c[14](null)}}}function Tv(c,h,f){let y,v,w,{$$slots:a={},$$scope:A}=h,{element:E=void 0}=h,{innerElement:P=void 0}=h,{zIndex:M=void 0}=h,{pointerEvents:V=void 0}=h,{viewBox:B=void 0}=h;const{containerWidth:N,containerHeight:ue,padding:ze}=Lc("LayerCake");Vt(c,N,Me=>f(5,y=Me)),Vt(c,ue,Me=>f(6,v=Me)),Vt(c,ze,Me=>f(7,w=Me));function Ae(Me){sl[Me?"unshift":"push"](()=>{P=Me,f(1,P)})}function Ie(Me){sl[Me?"unshift":"push"](()=>{E=Me,f(0,E)})}return c.$$set=Me=>{"element"in Me&&f(0,E=Me.element),"innerElement"in Me&&f(1,P=Me.innerElement),"zIndex"in Me&&f(2,M=Me.zIndex),"pointerEvents"in Me&&f(3,V=Me.pointerEvents),"viewBox"in Me&&f(4,B=Me.viewBox),"$$scope"in Me&&f(11,A=Me.$$scope)},[E,P,M,V,B,y,v,w,N,ue,ze,A,a,Ae,Ie]}class Iv extends ea{constructor(h){super(),ta(this,h,Tv,Ev,ra,{element:0,innerElement:1,zIndex:2,pointerEvents:3,viewBox:4})}}function Kd(c,h,f){const y=c.slice();return y[25]=h[f],y[27]=f,y}function Xd(c){let h,f,y,v;return{c(){h=Ya("rect"),this.h()},l(w){h=Qa(w,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ve(h).forEach(ie),this.h()},h(){ce(h,"class","group-rect"),ce(h,"data-id",c[27]),ce(h,"x",f=c[12].bandwidth?c[8](c[25]):c[8](c[25])[0]),ce(h,"y",y=c[14](c[13](c[25]))-1),ce(h,"width",v=c[12].bandwidth?c[12].bandwidth():c[10](c[25])),ce(h,"height","2"),ce(h,"fill","#27A0CC"),ce(h,"stroke",c[0]),ce(h,"stroke-width",c[1])},m(w,a){Fe(w,h,a)},p(w,a){a&6400&&f!==(f=w[12].bandwidth?w[8](w[25]):w[8](w[25])[0])&&ce(h,"x",f),a&26624&&y!==(y=w[14](w[13](w[25]))-1)&&ce(h,"y",y),a&7168&&v!==(v=w[12].bandwidth?w[12].bandwidth():w[10](w[25]))&&ce(h,"width",v),a&1&&ce(h,"stroke",w[0]),a&2&&ce(h,"stroke-width",w[1])},d(w){w&&ie(h)}}}function Wd(c){let h,f,y,v,w,a,A=c[4](c[15](c[25]))+"",E,P,M,V=c[13]&&Xd(c);return{c(){h=Ya("rect"),V&&V.c(),a=Ya("text"),E=Pe(A),this.h()},l(B){h=Qa(B,"rect",{class:!0,"data-id":!0,x:!0,y:!0,width:!0,height:!0,fill:!0,stroke:!0,"stroke-width":!0}),Ve(h).forEach(ie),V&&V.l(B),a=Qa(B,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0});var N=Ve(a);E=Ce(N,A),N.forEach(ie),this.h()},h(){ce(h,"class","group-rect"),ce(h,"data-id",c[27]),ce(h,"x",f=c[12].bandwidth?c[8](c[25]):c[8](c[25])[0]),ce(h,"y",y=c[7](c[25])),ce(h,"width",v=c[12].bandwidth?c[12].bandwidth():c[10](c[25])),ce(h,"height",w=c[9](c[25])),ce(h,"fill",c[5]),ce(h,"stroke",c[0]),ce(h,"stroke-width",c[1]),ce(a,"x",P=c[12].bandwidth?c[8](c[25])+c[12].bandwidth()/2:c[8](c[25])[0]),ce(a,"y",M=c[7](c[25])-4),ce(a,"dx",c[2]),ce(a,"dy",c[3]),ce(a,"text-anchor",c[6])},m(B,N){Fe(B,h,N),V&&V.m(B,N),Fe(B,a,N),re(a,E)},p(B,N){N&6400&&f!==(f=B[12].bandwidth?B[8](B[25]):B[8](B[25])[0])&&ce(h,"x",f),N&2176&&y!==(y=B[7](B[25]))&&ce(h,"y",y),N&7168&&v!==(v=B[12].bandwidth?B[12].bandwidth():B[10](B[25]))&&ce(h,"width",v),N&2560&&w!==(w=B[9](B[25]))&&ce(h,"height",w),N&32&&ce(h,"fill",B[5]),N&1&&ce(h,"stroke",B[0]),N&2&&ce(h,"stroke-width",B[1]),B[13]?V?V.p(B,N):(V=Xd(B),V.c(),V.m(a.parentNode,a)):V&&(V.d(1),V=null),N&34832&&A!==(A=B[4](B[15](B[25]))+"")&&yt(E,A),N&6400&&P!==(P=B[12].bandwidth?B[8](B[25])+B[12].bandwidth()/2:B[8](B[25])[0])&&ce(a,"x",P),N&2176&&M!==(M=B[7](B[25])-4)&&ce(a,"y",M),N&4&&ce(a,"dx",B[2]),N&8&&ce(a,"dy",B[3]),N&64&&ce(a,"text-anchor",B[6])},d(B){B&&ie(h),V&&V.d(B),B&&ie(a)}}}function Av(c){let h,f=c[11],y=[];for(let v=0;v<f.length;v+=1)y[v]=Wd(Kd(c,f,v));return{c(){h=Ya("g");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=Qa(v,"g",{class:!0});var w=Ve(h);for(let a=0;a<y.length;a+=1)y[a].l(w);w.forEach(ie),this.h()},h(){ce(h,"class","column-group svelte-wgzwsk")},m(v,w){Fe(v,h,w);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,[w]){if(w&65535){f=v[11];let a;for(a=0;a<f.length;a+=1){const A=Kd(v,f,a);y[a]?y[a].p(A,w):(y[a]=Wd(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},i:ka,o:ka,d(v){v&&ie(h),ds(y,v)}}}function zv(c,h,f){let y,v,w,a,A,E,P,M,V,B;const{data:N,xGet:ue,yGet:ze,yRange:Ae,xScale:Ie,yScale:Me,y:ft,z:Pt}=Lc("LayerCake");Vt(c,N,nt=>f(11,E=nt)),Vt(c,ue,nt=>f(8,A=nt)),Vt(c,ze,nt=>f(7,w=nt)),Vt(c,Ae,nt=>f(24,a=nt)),Vt(c,Ie,nt=>f(12,P=nt)),Vt(c,Me,nt=>f(14,V=nt)),Vt(c,ft,nt=>f(15,B=nt)),Vt(c,Pt,nt=>f(13,M=nt));let{stroke:ve=""}=h,{strokeWidth:je=0}=h,{dxTick:ur=0}=h,{dyTick:cr=0}=h,{formatVal:pt=nt=>nt}=h,{fill:hr="#206095"}=h,{textAnchor:gt="middle"}=h;return c.$$set=nt=>{"stroke"in nt&&f(0,ve=nt.stroke),"strokeWidth"in nt&&f(1,je=nt.strokeWidth),"dxTick"in nt&&f(2,ur=nt.dxTick),"dyTick"in nt&&f(3,cr=nt.dyTick),"formatVal"in nt&&f(4,pt=nt.formatVal),"fill"in nt&&f(5,hr=nt.fill),"textAnchor"in nt&&f(6,gt=nt.textAnchor)},c.$$.update=()=>{c.$$.dirty&256&&f(10,y=nt=>{const xt=A(nt);return Math.max(0,xt[1]-xt[0])}),c.$$.dirty&16777344&&f(9,v=nt=>a[0]-w(nt))},[ve,je,ur,cr,pt,hr,gt,w,A,v,y,E,P,M,V,B,N,ue,ze,Ae,Ie,Me,ft,Pt,a]}class Pv extends ea{constructor(h){super(),ta(this,h,zv,Av,ra,{stroke:0,strokeWidth:1,dxTick:2,dyTick:3,formatVal:4,fill:5,textAnchor:6})}}function Hd(c,h,f){const y=c.slice();return y[28]=h[f],y[30]=f,y}function Jd(c){let h,f,y,v;return{c(){h=Ya("line"),this.h()},l(w){h=Qa(w,"line",{y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0,"stroke-width":!0,class:!0}),Ve(h).forEach(ie),this.h()},h(){ce(h,"y1",f=c[20]*-1),ce(h,"y2",y=c[14]&&c[30]%2==0?c[10]+c[8]+2:c[10]+c[8]-13),ce(h,"x1","0"),ce(h,"x2","0"),ce(h,"stroke",c[11]),ce(h,"stroke-width",v=c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)?2:1),ce(h,"class","svelte-fwjh80"),Pi(h,"baseline",c[13])},m(w,a){Fe(w,h,a)},p(w,a){a&1048576&&f!==(f=w[20]*-1)&&ce(h,"y1",f),a&17664&&y!==(y=w[14]&&w[30]%2==0?w[10]+w[8]+2:w[10]+w[8]-13)&&ce(h,"y2",y),a&2048&&ce(h,"stroke",w[11]),a&32784&&v!==(v=w[15]&&Array.isArray(w[4])&&w[30]==Math.floor(w[4].length/2)?2:1)&&ce(h,"stroke-width",v),a&8192&&Pi(h,"baseline",w[13])},d(w){w&&ie(h)}}}function Cv(c){let h=c[1](c[28])+"",f;return{c(){f=Pe(h)},l(y){f=Ce(y,h)},m(y,v){Fe(y,f,v)},p(y,v){v&262146&&h!==(h=y[1](y[28])+"")&&yt(f,h)},d(y){y&&ie(f)}}}function Mv(c){let h,f=c[1](c[28])+"",y,v;return{c(){h=Pe(c[5]),y=Pe(f),v=Pe(c[6])},l(w){h=Ce(w,c[5]),y=Ce(w,f),v=Ce(w,c[6])},m(w,a){Fe(w,h,a),Fe(w,y,a),Fe(w,v,a)},p(w,a){a&32&&yt(h,w[5]),a&262146&&f!==(f=w[1](w[28])+"")&&yt(y,f),a&64&&yt(v,w[6])},d(w){w&&ie(h),w&&ie(y),w&&ie(v)}}}function Yd(c){let h,f,y,v,w,a,A,E=c[0]!==!1&&Jd(c);function P(B,N){return B[30]==B[18].length-1?Mv:Cv}let M=P(c),V=M(c);return{c(){h=Ya("g"),E&&E.c(),f=Ya("text"),V.c(),this.h()},l(B){h=Qa(B,"g",{class:!0,transform:!0});var N=Ve(h);E&&E.l(N),f=Qa(N,"text",{x:!0,y:!0,dx:!0,dy:!0,"text-anchor":!0,fill:!0,class:!0});var ue=Ve(f);V.l(ue),ue.forEach(ie),N.forEach(ie),this.h()},h(){ce(f,"x",y=c[7]||c[16]?c[17].bandwidth()/2:0),ce(f,"y",v=c[3]?c[20]*-1-6:c[14]&&c[30]%2==0?c[8]+15:c[8]),ce(f,"dx",w=c[24](c[30])=="start"?c[9]-2:c[24](c[30])=="end"?c[9]+2:c[9]),ce(f,"dy",c[10]),ce(f,"text-anchor",c[24](c[30])),ce(f,"fill",c[12]),ce(f,"class","svelte-fwjh80"),Pi(f,"bold",c[15]&&Array.isArray(c[4])&&c[30]==Math.floor(c[4].length/2)),ce(h,"class",a="tick tick-"+c[28]+" svelte-fwjh80"),ce(h,"transform",A="translate("+c[17](c[28])+","+c[19][0]+")")},m(B,N){Fe(B,h,N),E&&E.m(h,null),re(h,f),V.m(f,null)},p(B,N){B[0]!==!1?E?E.p(B,N):(E=Jd(B),E.c(),E.m(h,f)):E&&(E.d(1),E=null),M===(M=P(B))&&V?V.p(B,N):(V.d(1),V=M(B),V&&(V.c(),V.m(f,null))),N&196736&&y!==(y=B[7]||B[16]?B[17].bandwidth()/2:0)&&ce(f,"x",y),N&1065224&&v!==(v=B[3]?B[20]*-1-6:B[14]&&B[30]%2==0?B[8]+15:B[8])&&ce(f,"y",v),N&512&&w!==(w=B[24](B[30])=="start"?B[9]-2:B[24](B[30])=="end"?B[9]+2:B[9])&&ce(f,"dx",w),N&1024&&ce(f,"dy",B[10]),N&4096&&ce(f,"fill",B[12]),N&32784&&Pi(f,"bold",B[15]&&Array.isArray(B[4])&&B[30]==Math.floor(B[4].length/2)),N&262144&&a!==(a="tick tick-"+B[28]+" svelte-fwjh80")&&ce(h,"class",a),N&917504&&A!==(A="translate("+B[17](B[28])+","+B[19][0]+")")&&ce(h,"transform",A)},d(B){B&&ie(h),E&&E.d(),V.d()}}}function Qd(c){let h,f,y;return{c(){h=Ya("line"),this.h()},l(v){h=Qa(v,"line",{class:!0,y1:!0,y2:!0,x1:!0,x2:!0,stroke:!0}),Ve(h).forEach(ie),this.h()},h(){ce(h,"class","baseline svelte-fwjh80"),ce(h,"y1",c[20]),ce(h,"y2","0"),ce(h,"x1",f=c[17](0)),ce(h,"x2",y=c[17](0)),ce(h,"stroke",c[11])},m(v,w){Fe(v,h,w)},p(v,w){w&1048576&&ce(h,"y1",v[20]),w&131072&&f!==(f=v[17](0))&&ce(h,"x1",f),w&131072&&y!==(y=v[17](0))&&ce(h,"x2",y),w&2048&&ce(h,"stroke",v[11])},d(v){v&&ie(h)}}}function Dv(c){let h,f,y=c[18],v=[];for(let a=0;a<y.length;a+=1)v[a]=Yd(Hd(c,y,a));let w=c[2]===!0&&Qd(c);return{c(){h=Ya("g");for(let a=0;a<v.length;a+=1)v[a].c();f=Br(),w&&w.c(),this.h()},l(a){h=Qa(a,"g",{class:!0});var A=Ve(h);for(let E=0;E<v.length;E+=1)v[E].l(A);f=Br(),w&&w.l(A),A.forEach(ie),this.h()},h(){ce(h,"class","axis x-axis")},m(a,A){Fe(a,h,A);for(let E=0;E<v.length;E+=1)v[E].m(h,null);re(h,f),w&&w.m(h,null)},p(a,[A]){if(A&18874363){y=a[18];let E;for(E=0;E<y.length;E+=1){const P=Hd(a,y,E);v[E]?v[E].p(P,A):(v[E]=Yd(P),v[E].c(),v[E].m(h,f))}for(;E<v.length;E+=1)v[E].d(1);v.length=y.length}a[2]===!0?w?w.p(a,A):(w=Qd(a),w.c(),w.m(h,null)):w&&(w.d(1),w=null)},i:ka,o:ka,d(a){a&&ie(h),ds(v,a),w&&w.d()}}}function Lv(c,h,f){let y,v,w,a,A;const{width:E,height:P,xScale:M,yScale:V,yRange:B}=Lc("LayerCake");Vt(c,P,We=>f(20,A=We)),Vt(c,M,We=>f(17,w=We)),Vt(c,B,We=>f(19,a=We));let{gridlines:N=!0}=h,{formatTick:ue=We=>We}=h,{baseline:ze=!1}=h,{flipped:Ae=!1}=h,{snapTicks:Ie=!1}=h,{ticks:Me=void 0}=h,{prefix:ft=""}=h,{suffix:Pt=""}=h,{xTick:ve=void 0}=h,{yTick:je=15}=h,{dxTick:ur=0}=h,{dyTick:cr=0}=h,{lineColor:pt="#999"}=h,{textColor:hr="#555"}=h,{solid:gt=!1}=h,{stagger:nt=!1}=h,{median:xt=!0}=h;function er(We){if(Ie===!0){if(We===0)return"start";if(We===v.length-1)return"end"}return"middle"}return c.$$set=We=>{"gridlines"in We&&f(0,N=We.gridlines),"formatTick"in We&&f(1,ue=We.formatTick),"baseline"in We&&f(2,ze=We.baseline),"flipped"in We&&f(3,Ae=We.flipped),"snapTicks"in We&&f(25,Ie=We.snapTicks),"ticks"in We&&f(4,Me=We.ticks),"prefix"in We&&f(5,ft=We.prefix),"suffix"in We&&f(6,Pt=We.suffix),"xTick"in We&&f(7,ve=We.xTick),"yTick"in We&&f(8,je=We.yTick),"dxTick"in We&&f(9,ur=We.dxTick),"dyTick"in We&&f(10,cr=We.dyTick),"lineColor"in We&&f(11,pt=We.lineColor),"textColor"in We&&f(12,hr=We.textColor),"solid"in We&&f(13,gt=We.solid),"stagger"in We&&f(14,nt=We.stagger),"median"in We&&f(15,xt=We.median)},c.$$.update=()=>{c.$$.dirty&131072&&f(16,y=typeof w.bandwidth=="function"),c.$$.dirty&196624&&f(18,v=Array.isArray(Me)?Me:y?w.domain():w.ticks(Me))},[N,ue,ze,Ae,Me,ft,Pt,ve,je,ur,cr,pt,hr,gt,nt,xt,y,w,v,a,A,P,M,B,er,Ie]}class Rv extends ea{constructor(h){super(),ta(this,h,Lv,Dv,ra,{gridlines:0,formatTick:1,baseline:2,flipped:3,snapTicks:25,ticks:4,prefix:5,suffix:6,xTick:7,yTick:8,dxTick:9,dyTick:10,lineColor:11,textColor:12,solid:13,stagger:14,median:15})}}function Bv(c){let h,f,y,v;return h=new Pv({props:{fill:c[1],formatVal:c[5]}}),y=new Rv({props:{gridlines:!1}}),{c(){jr(h.$$.fragment),f=st(),jr(y.$$.fragment)},l(w){qr(h.$$.fragment,w),f=lt(w),qr(y.$$.fragment,w)},m(w,a){Zr(h,w,a),Fe(w,f,a),Zr(y,w,a),v=!0},p(w,a){const A={};a&2&&(A.fill=w[1]),a&32&&(A.formatVal=w[5]),h.$set(A)},i(w){v||(vt(h.$$.fragment,w),vt(y.$$.fragment,w),v=!0)},o(w){zt(h.$$.fragment,w),zt(y.$$.fragment,w),v=!1},d(w){Gr(h,w),w&&ie(f),Gr(y,w)}}}function Fv(c){let h,f;return h=new Iv({props:{$$slots:{default:[Bv]},$$scope:{ctx:c}}}),{c(){jr(h.$$.fragment)},l(y){qr(h.$$.fragment,y)},m(y,v){Zr(h,y,v),f=!0},p(y,v){const w={};v&1058&&(w.$$scope={dirty:v,ctx:y}),h.$set(w)},i(y){f||(vt(h.$$.fragment,y),f=!0)},o(y){zt(h.$$.fragment,y),f=!1},d(y){Gr(h,y)}}}function Ov(c){let h,f,y;return f=new wv({props:{padding:{top:15,right:0,bottom:20,left:0},x:c[2],y:c[3],z:c[4],xScale:Wm().paddingInner([.02]).round(!0),xDomain:c[7],yDomain:c[6],zDomain:c[6],data:c[0],$$slots:{default:[Fv]},$$scope:{ctx:c}}}),{c(){h=De("div"),jr(f.$$.fragment),this.h()},l(v){h=Le(v,"DIV",{class:!0});var w=Ve(h);qr(f.$$.fragment,w),w.forEach(ie),this.h()},h(){ce(h,"class","chart-container svelte-s9z6lx")},m(v,w){Fe(v,h,w),Zr(f,h,null),y=!0},p(v,[w]){const a={};w&4&&(a.x=v[2]),w&8&&(a.y=v[3]),w&16&&(a.z=v[4]),w&128&&(a.xDomain=v[7]),w&64&&(a.yDomain=v[6]),w&64&&(a.zDomain=v[6]),w&1&&(a.data=v[0]),w&1058&&(a.$$scope={dirty:w,ctx:v}),f.$set(a)},i(v){y||(vt(f.$$.fragment,v),y=!0)},o(v){zt(f.$$.fragment,v),y=!1},d(v){v&&ie(h),Gr(f)}}}function Nv(c,h,f){let y,v,w,{data:a}=h,{suffix:A="%"}=h,{decimals:E=0}=h,{fill:P="#212373"}=h,{xKey:M="x"}=h,{yKey:V="y"}=h,{zKey:B=null}=h;return c.$$set=N=>{"data"in N&&f(0,a=N.data),"suffix"in N&&f(8,A=N.suffix),"decimals"in N&&f(9,E=N.decimals),"fill"in N&&f(1,P=N.fill),"xKey"in N&&f(2,M=N.xKey),"yKey"in N&&f(3,V=N.yKey),"zKey"in N&&f(4,B=N.zKey)},c.$$.update=()=>{c.$$.dirty&5&&f(7,y=a.map(N=>N[M])),c.$$.dirty&9&&f(6,v=[0,Math.max(...a.map(N=>N[V]))]),c.$$.dirty&768&&f(5,w=N=>N.toFixed(E)+A)},[a,P,M,V,B,w,v,y,A,E]}class Uv extends ea{constructor(h){super(),ta(this,h,Nv,Ov,ra,{data:0,suffix:8,decimals:9,fill:1,xKey:2,yKey:3,zKey:4})}}function $d(c,h,f){const y=c.slice();return y[7]=h[f],y[9]=f,y}function em(c){let h,f=c[0],y=[];for(let v=0;v<f.length;v+=1)y[v]=tm($d(c,f,v));return{c(){h=De("div");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=Le(v,"DIV",{class:!0});var w=Ve(h);for(let a=0;a<y.length;a+=1)y[a].l(w);w.forEach(ie),this.h()},h(){ce(h,"class","stack svelte-q6mgyr")},m(v,w){Fe(v,h,w);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,w){if(w&31){f=v[0];let a;for(a=0;a<f.length;a+=1){const A=$d(v,f,a);y[a]?y[a].p(A,w):(y[a]=tm(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){v&&ie(h),ds(y,v)}}}function tm(c){let h;return{c(){h=De("div"),this.h()},l(f){h=Le(f,"DIV",{class:!0,style:!0}),Ve(h).forEach(ie),this.h()},h(){ce(h,"class","cell svelte-q6mgyr"),Qt(h,"left",c[4][c[9]]/c[3]*100+"%"),Qt(h,"width",c[7][c[1]]/c[3]*100+"%"),Qt(h,"background-color",c[2][c[9]])},m(f,y){Fe(f,h,y)},p(f,y){y&24&&Qt(h,"left",f[4][f[9]]/f[3]*100+"%"),y&11&&Qt(h,"width",f[7][f[1]]/f[3]*100+"%"),y&4&&Qt(h,"background-color",f[2][f[9]])},d(f){f&&ie(h)}}}function Vv(c){let h,f=c[3]&&c[4]&&em(c);return{c(){f&&f.c(),h=Br()},l(y){f&&f.l(y),h=Br()},m(y,v){f&&f.m(y,v),Fe(y,h,v)},p(y,[v]){y[3]&&y[4]?f?f.p(y,v):(f=em(y),f.c(),f.m(h.parentNode,h)):f&&(f.d(1),f=null)},i:ka,o:ka,d(y){f&&f.d(y),y&&ie(h)}}}function jv(c,h,f){let{data:y}=h,{xKey:v="x"}=h,{yKey:w="y"}=h,{colors:a=["#212373","#781C87","#0D9AA2","#C11B71","#FB7979","#F66068","#746CB1","#22D0B6","lightgrey"]}=h,A,E;function P(){f(3,A=y.map(V=>V[w]).reduce((V,B)=>V+B,0));let M=[0];y.forEach(V=>M.push(M[M.length-1]+V[w])),f(4,E=M)}return c.$$set=M=>{"data"in M&&f(0,y=M.data),"xKey"in M&&f(5,v=M.xKey),"yKey"in M&&f(1,w=M.yKey),"colors"in M&&f(2,a=M.colors)},c.$$.update=()=>{c.$$.dirty&3&&(y||w)&&P()},[y,w,a,A,E,v]}class oy extends ea{constructor(h){super(),ta(this,h,jv,Vv,ra,{data:0,xKey:5,yKey:1,colors:2})}}function rm(c,h,f){const y=c.slice();return y[12]=h[f],y[14]=f,y}function qv(c){let h,f,y=c[8](c[12][c[3]])+"",v,w;return{c(){h=De("span"),f=Pe("("),v=Pe(y),w=Pe(")"),this.h()},l(a){h=Le(a,"SPAN",{class:!0,style:!0});var A=Ve(h);f=Ce(A,"("),v=Ce(A,y),w=Ce(A,")"),A.forEach(ie),this.h()},h(){ce(h,"class",""),Qt(h,"color",c[6])},m(a,A){Fe(a,h,A),re(h,f),re(h,v),re(h,w)},p(a,A){A&9&&y!==(y=a[8](a[12][a[3]])+"")&&yt(v,y),A&64&&Qt(h,"color",a[6])},d(a){a&&ie(h)}}}function Zv(c){let h,f=Fs(Math.round(c[12][c[2]]-c[12][c[3]]),"pp")+"",y,v;return{c(){h=De("span"),y=Pe(f),this.h()},l(w){h=Le(w,"SPAN",{class:!0});var a=Ve(h);y=Ce(a,f),a.forEach(ie),this.h()},h(){ce(h,"class",v=Il(Al(Math.round(c[12][c[2]]-c[12][c[3]])))+" svelte-w1gwgt")},m(w,a){Fe(w,h,a),re(h,y)},p(w,a){a&13&&f!==(f=Fs(Math.round(w[12][w[2]]-w[12][w[3]]),"pp")+"")&&yt(y,f),a&13&&v!==(v=Il(Al(Math.round(w[12][w[2]]-w[12][w[3]])))+" svelte-w1gwgt")&&ce(h,"class",v)},d(w){w&&ie(h)}}}function im(c){let h,f,y,v=c[12][c[1]]+"",w,a,A=c[8](c[12][c[2]])+"",E,P,M;function V(ue,ze){if(ue[3]=="prev")return Zv;if(ue[3])return qv}let B=V(c),N=B&&B(c);return{c(){h=De("li"),f=De("div"),y=st(),w=Pe(v),a=st(),E=Pe(A),P=st(),N&&N.c(),M=st(),this.h()},l(ue){h=Le(ue,"LI",{style:!0,class:!0});var ze=Ve(h);f=Le(ze,"DIV",{class:!0,style:!0}),Ve(f).forEach(ie),y=lt(ze),w=Ce(ze,v),a=lt(ze),E=Ce(ze,A),P=lt(ze),N&&N.l(ze),M=lt(ze),ze.forEach(ie),this.h()},h(){ce(f,"class","bullet svelte-w1gwgt"),Qt(f,"background-color",c[4][c[14]]),Pi(f,"round",c[7]),Qt(h,"color",c[5]),ce(h,"class","svelte-w1gwgt")},m(ue,ze){Fe(ue,h,ze),re(h,f),re(h,y),re(h,w),re(h,a),re(h,E),re(h,P),N&&N.m(h,null),re(h,M)},p(ue,ze){ze&16&&Qt(f,"background-color",ue[4][ue[14]]),ze&128&&Pi(f,"round",ue[7]),ze&3&&v!==(v=ue[12][ue[1]]+"")&&yt(w,v),ze&5&&A!==(A=ue[8](ue[12][ue[2]])+"")&&yt(E,A),B===(B=V(ue))&&N?N.p(ue,ze):(N&&N.d(1),N=B&&B(ue),N&&(N.c(),N.m(h,M))),ze&32&&Qt(h,"color",ue[5])},d(ue){ue&&ie(h),N&&N.d()}}}function Gv(c){let h,f=c[0],y=[];for(let v=0;v<f.length;v+=1)y[v]=im(rm(c,f,v));return{c(){h=De("ul");for(let v=0;v<y.length;v+=1)y[v].c();this.h()},l(v){h=Le(v,"UL",{class:!0});var w=Ve(h);for(let a=0;a<y.length;a+=1)y[a].l(w);w.forEach(ie),this.h()},h(){ce(h,"class","svelte-w1gwgt")},m(v,w){Fe(v,h,w);for(let a=0;a<y.length;a+=1)y[a].m(h,null)},p(v,[w]){if(w&511){f=v[0];let a;for(a=0;a<f.length;a+=1){const A=rm(v,f,a);y[a]?y[a].p(A,w):(y[a]=im(A),y[a].c(),y[a].m(h,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},i:ka,o:ka,d(v){v&&ie(h),ds(y,v)}}}function Kv(c,h,f){let y,{data:v}=h,{xKey:w="x"}=h,{yKey:a="y"}=h,{zKey:A="ew"}=h,{colors:E=["#212373","#781C87","#0D9AA2","#C11B71","#FB7979","#F66068","#746CB1","#22D0B6","lightgrey"]}=h,{textColor:P="#555"}=h,{mutedColor:M="#999"}=h,{decimals:V=null}=h,{round:B=!1}=h;function N(ue){let ze;return V?ze=(ue/y*100).toFixed(V)+"%":ue/y*100<.1?ze="<0.1%":ue/y*100<1?ze="<1%":ze=(ue/y*100).toFixed(0)+"%",ze}return c.$$set=ue=>{"data"in ue&&f(0,v=ue.data),"xKey"in ue&&f(1,w=ue.xKey),"yKey"in ue&&f(2,a=ue.yKey),"zKey"in ue&&f(3,A=ue.zKey),"colors"in ue&&f(4,E=ue.colors),"textColor"in ue&&f(5,P=ue.textColor),"mutedColor"in ue&&f(6,M=ue.mutedColor),"decimals"in ue&&f(9,V=ue.decimals),"round"in ue&&f(7,B=ue.round)},c.$$.update=()=>{c.$$.dirty&5&&(y=v.map(ue=>ue[a]).reduce((ue,ze)=>ue+ze,0)),c.$$.dirty&9&&v.map(ue=>ue[A]).reduce((ue,ze)=>ue+ze,0)},[v,w,a,A,E,P,M,B,N,V]}class Xv extends ea{constructor(h){super(),ta(this,h,Kv,Gv,ra,{data:0,xKey:1,yKey:2,zKey:3,colors:4,textColor:5,mutedColor:6,decimals:9,round:7})}}function nm(c){let h,f,y,v;f=new oy({props:{data:c[0],yKey:c[4],colors:c[5]}});let w=c[7]&&om(c);return{c(){h=De("div"),jr(f.$$.fragment),y=st(),w&&w.c(),this.h()},l(a){h=Le(a,"DIV",{class:!0,style:!0});var A=Ve(h);qr(f.$$.fragment,A),y=lt(A),w&&w.l(A),A.forEach(ie),this.h()},h(){ce(h,"class","chart svelte-67hhqc"),Qt(h,"height",c[1]*.25+"px")},m(a,A){Fe(a,h,A),Zr(f,h,null),re(h,y),w&&w.m(h,null),v=!0},p(a,A){const E={};A&1&&(E.data=a[0]),A&16&&(E.yKey=a[4]),A&32&&(E.colors=a[5]),f.$set(E),a[7]?w?w.p(a,A):(w=om(a),w.c(),w.m(h,null)):w&&(w.d(1),w=null),(!v||A&2)&&Qt(h,"height",a[1]*.25+"px")},i(a){v||(vt(f.$$.fragment,a),v=!0)},o(a){zt(f.$$.fragment,a),v=!1},d(a){a&&ie(h),Gr(f),w&&w.d()}}}function om(c){let h,f;return{c(){h=De("div"),f=Pe(c[7]),this.h()},l(y){h=Le(y,"DIV",{class:!0});var v=Ve(h);f=Ce(v,c[7]),v.forEach(ie),this.h()},h(){ce(h,"class","label svelte-67hhqc")},m(y,v){Fe(y,h,v),re(h,f)},p(y,v){v&128&&yt(f,y[7])},d(y){y&&ie(h)}}}function Wv(c){let h,f,y,v,w,a,A;f=new oy({props:{data:c[0],yKey:c[3],colors:c[5]}});let E=c[4]&&nm(c);return a=new Xv({props:{data:c[0],xKey:c[2],yKey:c[3],zKey:c[4],decimals:c[6],colors:c[5]}}),{c(){h=De("div"),jr(f.$$.fragment),y=st(),E&&E.c(),v=st(),w=De("div"),jr(a.$$.fragment),this.h()},l(P){h=Le(P,"DIV",{class:!0,style:!0});var M=Ve(h);qr(f.$$.fragment,M),M.forEach(ie),y=lt(P),E&&E.l(P),v=lt(P),w=Le(P,"DIV",{class:!0});var V=Ve(w);qr(a.$$.fragment,V),V.forEach(ie),this.h()},h(){ce(h,"class","chart svelte-67hhqc"),Qt(h,"height",(c[4]?c[1]*.75:c[1])+"px"),ce(w,"class","legend svelte-67hhqc")},m(P,M){Fe(P,h,M),Zr(f,h,null),Fe(P,y,M),E&&E.m(P,M),Fe(P,v,M),Fe(P,w,M),Zr(a,w,null),A=!0},p(P,[M]){const V={};M&1&&(V.data=P[0]),M&8&&(V.yKey=P[3]),M&32&&(V.colors=P[5]),f.$set(V),(!A||M&18)&&Qt(h,"height",(P[4]?P[1]*.75:P[1])+"px"),P[4]?E?(E.p(P,M),M&16&&vt(E,1)):(E=nm(P),E.c(),vt(E,1),E.m(v.parentNode,v)):E&&(Ha(),zt(E,1,1,()=>{E=null}),Ja());const B={};M&1&&(B.data=P[0]),M&4&&(B.xKey=P[2]),M&8&&(B.yKey=P[3]),M&16&&(B.zKey=P[4]),M&64&&(B.decimals=P[6]),M&32&&(B.colors=P[5]),a.$set(B)},i(P){A||(vt(f.$$.fragment,P),vt(E),vt(a.$$.fragment,P),A=!0)},o(P){zt(f.$$.fragment,P),zt(E),zt(a.$$.fragment,P),A=!1},d(P){P&&ie(h),Gr(f),P&&ie(y),E&&E.d(P),P&&ie(v),P&&ie(w),Gr(a)}}}function Hv(c,h,f){let{data:y}=h,{height:v=80}=h,{xKey:w="x"}=h,{yKey:a="y"}=h,{zKey:A="ew"}=h,{colors:E=["#212373","#781C87","#0D9AA2","#C11B71","#FB7979","#F66068","#746CB1","#22D0B6","lightgrey"]}=h,{decimals:P=null}=h,{label:M=null}=h;return c.$$set=V=>{"data"in V&&f(0,y=V.data),"height"in V&&f(1,v=V.height),"xKey"in V&&f(2,w=V.xKey),"yKey"in V&&f(3,a=V.yKey),"zKey"in V&&f(4,A=V.zKey),"colors"in V&&f(5,E=V.colors),"decimals"in V&&f(6,P=V.decimals),"label"in V&&f(7,M=V.label)},[y,v,w,a,A,E,P,M]}class Yl extends ea{constructor(h){super(),ta(this,h,Hv,Wv,ra,{data:0,height:1,xKey:2,yKey:3,zKey:4,colors:5,decimals:6,label:7})}}var Jv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yv={rgb2hsl:Bc,rgb2hsv:jh,rgb2hwb:Fc,rgb2cmyk:Oc,rgb2keyword:Nc,rgb2xyz:Gp,rgb2lab:Kp,rgb2lch:Qv,hsl2rgb:qh,hsl2hsv:$v,hsl2hwb:e0,hsl2cmyk:t0,hsl2keyword:r0,hsv2rgb:Zh,hsv2hsl:i0,hsv2hwb:n0,hsv2cmyk:o0,hsv2keyword:a0,hwb2rgb:Uc,hwb2hsl:s0,hwb2hsv:l0,hwb2cmyk:u0,hwb2keyword:c0,cmyk2rgb:Vc,cmyk2hsl:h0,cmyk2hsv:p0,cmyk2hwb:f0,cmyk2keyword:d0,keyword2rgb:ru,keyword2hsl:_0,keyword2hsv:v0,keyword2hwb:x0,keyword2cmyk:b0,keyword2lab:w0,keyword2xyz:S0,xyz2rgb:ay,xyz2lab:sy,xyz2lch:m0,lab2xyz:Xp,lab2rgb:ly,lab2lch:Wp,lch2lab:Hp,lch2xyz:y0,lch2rgb:g0};function Bc(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255,v=Math.min(h,f,y),w=Math.max(h,f,y),a=w-v,A,E,P;return w==v?A=0:h==w?A=(f-y)/a:f==w?A=2+(y-h)/a:y==w&&(A=4+(h-f)/a),A=Math.min(A*60,360),A<0&&(A+=360),P=(v+w)/2,w==v?E=0:P<=.5?E=a/(w+v):E=a/(2-w-v),[A,E*100,P*100]}function jh(c){var h=c[0],f=c[1],y=c[2],v=Math.min(h,f,y),w=Math.max(h,f,y),a=w-v,A,E,P;return w==0?E=0:E=a/w*1e3/10,w==v?A=0:h==w?A=(f-y)/a:f==w?A=2+(y-h)/a:y==w&&(A=4+(h-f)/a),A=Math.min(A*60,360),A<0&&(A+=360),P=w/255*1e3/10,[A,E,P]}function Fc(c){var h=c[0],f=c[1],w=c[2],y=Bc(c)[0],v=1/255*Math.min(h,Math.min(f,w)),w=1-1/255*Math.max(h,Math.max(f,w));return[y,v*100,w*100]}function Oc(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255,v,w,a,A;return A=Math.min(1-h,1-f,1-y),v=(1-h-A)/(1-A)||0,w=(1-f-A)/(1-A)||0,a=(1-y-A)/(1-A)||0,[v*100,w*100,a*100,A*100]}function Nc(c){return uy[JSON.stringify(c)]}function Gp(c){var h=c[0]/255,f=c[1]/255,y=c[2]/255;h=h>.04045?Math.pow((h+.055)/1.055,2.4):h/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92,y=y>.04045?Math.pow((y+.055)/1.055,2.4):y/12.92;var v=h*.4124+f*.3576+y*.1805,w=h*.2126+f*.7152+y*.0722,a=h*.0193+f*.1192+y*.9505;return[v*100,w*100,a*100]}function Kp(c){var h=Gp(c),f=h[0],y=h[1],v=h[2],w,a,A;return f/=95.047,y/=100,v/=108.883,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,w=116*y-16,a=500*(f-y),A=200*(y-v),[w,a,A]}function Qv(c){return Wp(Kp(c))}function qh(c){var h=c[0]/360,f=c[1]/100,y=c[2]/100,v,w,a,A,E;if(f==0)return E=y*255,[E,E,E];y<.5?w=y*(1+f):w=y+f-y*f,v=2*y-w,A=[0,0,0];for(var P=0;P<3;P++)a=h+1/3*-(P-1),a<0&&a++,a>1&&a--,6*a<1?E=v+(w-v)*6*a:2*a<1?E=w:3*a<2?E=v+(w-v)*(2/3-a)*6:E=v,A[P]=E*255;return A}function $v(c){var h=c[0],f=c[1]/100,y=c[2]/100,v,w;return y===0?[0,0,0]:(y*=2,f*=y<=1?y:2-y,w=(y+f)/2,v=2*f/(y+f),[h,v*100,w*100])}function e0(c){return Fc(qh(c))}function t0(c){return Oc(qh(c))}function r0(c){return Nc(qh(c))}function Zh(c){var h=c[0]/60,f=c[1]/100,E=c[2]/100,y=Math.floor(h)%6,v=h-Math.floor(h),w=255*E*(1-f),a=255*E*(1-f*v),A=255*E*(1-f*(1-v)),E=255*E;switch(y){case 0:return[E,A,w];case 1:return[a,E,w];case 2:return[w,E,A];case 3:return[w,a,E];case 4:return[A,w,E];case 5:return[E,w,a]}}function i0(c){var h=c[0],f=c[1]/100,y=c[2]/100,v,w;return w=(2-f)*y,v=f*y,v/=w<=1?w:2-w,v=v||0,w/=2,[h,v*100,w*100]}function n0(c){return Fc(Zh(c))}function o0(c){return Oc(Zh(c))}function a0(c){return Nc(Zh(c))}function Uc(c){var h=c[0]/360,f=c[1]/100,y=c[2]/100,v=f+y,w,a,A,E;switch(v>1&&(f/=v,y/=v),w=Math.floor(6*h),a=1-y,A=6*h-w,(w&1)!=0&&(A=1-A),E=f+A*(a-f),w){default:case 6:case 0:r=a,g=E,b=f;break;case 1:r=E,g=a,b=f;break;case 2:r=f,g=a,b=E;break;case 3:r=f,g=E,b=a;break;case 4:r=E,g=f,b=a;break;case 5:r=a,g=f,b=E;break}return[r*255,g*255,b*255]}function s0(c){return Bc(Uc(c))}function l0(c){return jh(Uc(c))}function u0(c){return Oc(Uc(c))}function c0(c){return Nc(Uc(c))}function Vc(c){var h=c[0]/100,f=c[1]/100,y=c[2]/100,v=c[3]/100,w,a,A;return w=1-Math.min(1,h*(1-v)+v),a=1-Math.min(1,f*(1-v)+v),A=1-Math.min(1,y*(1-v)+v),[w*255,a*255,A*255]}function h0(c){return Bc(Vc(c))}function p0(c){return jh(Vc(c))}function f0(c){return Fc(Vc(c))}function d0(c){return Nc(Vc(c))}function ay(c){var h=c[0]/100,f=c[1]/100,y=c[2]/100,v,w,a;return v=h*3.2406+f*-1.5372+y*-.4986,w=h*-.9689+f*1.8758+y*.0415,a=h*.0557+f*-.204+y*1.057,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v=v*12.92,w=w>.0031308?1.055*Math.pow(w,1/2.4)-.055:w=w*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,v=Math.min(Math.max(0,v),1),w=Math.min(Math.max(0,w),1),a=Math.min(Math.max(0,a),1),[v*255,w*255,a*255]}function sy(c){var h=c[0],f=c[1],y=c[2],v,w,a;return h/=95.047,f/=100,y/=108.883,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,v=116*f-16,w=500*(h-f),a=200*(f-y),[v,w,a]}function m0(c){return Wp(sy(c))}function Xp(c){var h=c[0],f=c[1],y=c[2],v,w,a,A;return h<=8?(w=h*100/903.3,A=7.787*(w/100)+16/116):(w=100*Math.pow((h+16)/116,3),A=Math.pow(w/100,1/3)),v=v/95.047<=.008856?v=95.047*(f/500+A-16/116)/7.787:95.047*Math.pow(f/500+A,3),a=a/108.883<=.008859?a=108.883*(A-y/200-16/116)/7.787:108.883*Math.pow(A-y/200,3),[v,w,a]}function Wp(c){var h=c[0],f=c[1],y=c[2],v,w,a;return v=Math.atan2(y,f),w=v*360/2/Math.PI,w<0&&(w+=360),a=Math.sqrt(f*f+y*y),[h,a,w]}function ly(c){return ay(Xp(c))}function Hp(c){var h=c[0],f=c[1],y=c[2],v,w,a;return a=y/360*2*Math.PI,v=f*Math.cos(a),w=f*Math.sin(a),[h,v,w]}function y0(c){return Xp(Hp(c))}function g0(c){return ly(Hp(c))}function ru(c){return Op[c]}function _0(c){return Bc(ru(c))}function v0(c){return jh(ru(c))}function x0(c){return Fc(ru(c))}function b0(c){return Oc(ru(c))}function w0(c){return Kp(ru(c))}function S0(c){return Gp(ru(c))}var Op={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},uy={};for(var am in Op)uy[JSON.stringify(Op[am])]=am;var zp=Yv,Ql=function(){return new jc};for(var Ac in zp){Ql[Ac+"Raw"]=function(c){return function(h){return typeof h=="number"&&(h=Array.prototype.slice.call(arguments)),zp[c](h)}}(Ac);var sm=/(\w+)2(\w+)/.exec(Ac),Pp=sm[1],k0=sm[2];Ql[Pp]=Ql[Pp]||{},Ql[Pp][k0]=Ql[Ac]=function(c){return function(h){typeof h=="number"&&(h=Array.prototype.slice.call(arguments));var f=zp[c](h);if(typeof f=="string"||f===void 0)return f;for(var y=0;y<f.length;y++)f[y]=Math.round(f[y]);return f}}(Ac)}var jc=function(){this.convs={}};jc.prototype.routeSpace=function(c,h){var f=h[0];return f===void 0?this.getValues(c):(typeof f=="number"&&(f=Array.prototype.slice.call(h)),this.setValues(c,f))};jc.prototype.setValues=function(c,h){return this.space=c,this.convs={},this.convs[c]=h,this};jc.prototype.getValues=function(c){var h=this.convs[c];if(!h){var f=this.space,y=this.convs[f];h=Ql[f][c](y),this.convs[c]=h}return h};["rgb","hsl","hsv","cmyk","keyword"].forEach(function(c){jc.prototype[c]=function(h){return this.routeSpace(c,arguments)}});var E0=Ql,Cp=E0,T0=function(c){var h,f,y,v;if(h=/^((?:rgb|hs[lv]|cmyk|xyz|lab)a?)\s*\(([^\)]*)\)/.exec(c)){var w=h[1],a=w.replace(/a$/,""),A=a==="cmyk"?4:3;f=Cp[a],y=h[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map(function(P,M){return/%$/.test(P)&&M===A?parseFloat(P)/100:(/%$/.test(P),parseFloat(P))}),w===a&&y.push(1),v=y[A]===void 0?1:y[A],y=y.slice(0,A),f[a]=function(){return y}}else if(/^#[A-Fa-f0-9]+$/.test(c)){var a=c.replace(/^#/,""),A=a.length;f=Cp.rgb,y=a.split(A===3?/(.)/:/(..)/),y=y.filter(Boolean).map(function(V){return parseInt(A===3?V+V:V,16)}),v=1,f.rgb=function(){return y},y[0]||(y[0]=0),y[1]||(y[1]=0),y[2]||(y[2]=0)}else f=Cp.keyword,f.keyword=function(){return c},y=c,v=1;var E={rgb:void 0,hsl:void 0,hsv:void 0,cmyk:void 0,keyword:void 0,hex:void 0};try{E.rgb=f.rgb(y)}catch{}try{E.hsl=f.hsl(y)}catch{}try{E.hsv=f.hsv(y)}catch{}try{E.cmyk=f.cmyk(y)}catch{}try{E.keyword=f.keyword(y)}catch{}return E.rgb&&(E.hex="#"+E.rgb.map(function(P){var M=P.toString(16);return M.length===1?"0"+M:M}).join("")),E.rgb&&(E.rgba=E.rgb.concat(v)),E.hsl&&(E.hsla=E.hsl.concat(v)),E.hsv&&(E.hsva=E.hsv.concat(v)),E.cmyk&&(E.cmyka=E.cmyk.concat(v)),E};function I0(c){let h,f;const y=c[5].default,v=Vu(y,c,c[4],null);return{c(){h=De("span"),v&&v.c(),this.h()},l(w){h=Le(w,"SPAN",{class:!0,style:!0,role:!0});var a=Ve(h);v&&v.l(a),a.forEach(ie),this.h()},h(){ce(h,"class","em svelte-s1t2y4"),Qt(h,"background-color",c[0]),Qt(h,"color",c[2]),ce(h,"role","presentation"),Pi(h,"nowrap",c[1])},m(w,a){Fe(w,h,a),v&&v.m(h,null),f=!0},p(w,[a]){v&&v.p&&(!f||a&16)&&ju(v,y,w,w[4],f?Zu(y,w[4],a,null):qu(w[4]),null),(!f||a&1)&&Qt(h,"background-color",w[0]),(!f||a&4)&&Qt(h,"color",w[2]),a&2&&Pi(h,"nowrap",w[1])},i(w){f||(vt(v,w),f=!0)},o(w){zt(v,w),f=!1},d(w){w&&ie(h),v&&v.d(w)}}}function A0(c,h,f){let y,{$$slots:v={},$$scope:w}=h,{color:a="lightgrey"}=h,{nowrap:A=!0}=h;function E(M){return(M[0]*299+M[1]*587+M[2]*114)/1e3>125?"black":"white"}let P="black";return c.$$set=M=>{"color"in M&&f(0,a=M.color),"nowrap"in M&&f(1,A=M.nowrap),"$$scope"in M&&f(4,w=M.$$scope)},c.$$.update=()=>{c.$$.dirty&1&&f(3,y=T0(a).rgb),c.$$.dirty&8&&y&&f(2,P=E(y))},[a,A,P,y,w,v]}class Xu extends ea{constructor(h){super(),ta(this,h,A0,I0,ra,{color:0,nowrap:1})}}function lm(c,h,f){const y=c.slice();return y[33]=h[f],y[36]=h,y[35]=f,y}function um(c,h,f){const y=c.slice();return y[33]=h[f],y[34]=h,y[35]=f,y}function z0(c){let h,f,y=(c[0]?c[0]:"Select one")+"",v,w,a,A,E,P;return{c(){h=De("a"),f=De("span"),v=Pe(y),w=st(),a=De("span"),A=Pe("\xA0"),this.h()},l(M){h=Le(M,"A",{id:!0,class:!0});var V=Ve(h);f=Le(V,"SPAN",{class:!0});var B=Ve(f);v=Ce(B,y),B.forEach(ie),w=lt(V),a=Le(V,"SPAN",{class:!0});var N=Ve(a);A=Ce(N,"\xA0"),N.forEach(ie),V.forEach(ie),this.h()},h(){ce(f,"class","svelte-b33h27"),ce(a,"class","button svelte-b33h27"),Pi(a,"search",c[3]),Pi(a,"down",!c[3]),ce(h,"id","toggle"),ce(h,"class","svelte-b33h27")},m(M,V){Fe(M,h,V),re(h,f),re(f,v),re(h,w),re(h,a),re(a,A),E||(P=Ea(h,"click",c[12]),E=!0)},p(M,V){V[0]&1&&y!==(y=(M[0]?M[0]:"Select one")+"")&&yt(v,y),V[0]&8&&Pi(a,"search",M[3]),V[0]&8&&Pi(a,"down",!M[3])},d(M){M&&ie(h),E=!1,P()}}}function P0(c){let h,f,y=c[5][c[1]]+"",v,w,a,A,E,P,M,V=c[2]&&cm(c);return{c(){h=De("a"),f=De("span"),v=Pe(y),w=st(),V&&V.c(),a=st(),A=De("span"),E=Pe("\xA0"),this.h()},l(B){h=Le(B,"A",{id:!0,class:!0});var N=Ve(h);f=Le(N,"SPAN",{class:!0});var ue=Ve(f);v=Ce(ue,y),w=lt(ue),V&&V.l(ue),ue.forEach(ie),a=lt(N),A=Le(N,"SPAN",{class:!0});var ze=Ve(A);E=Ce(ze,"\xA0"),ze.forEach(ie),N.forEach(ie),this.h()},h(){ce(f,"class","selection svelte-b33h27"),ce(A,"class","button close svelte-b33h27"),ce(h,"id","toggle"),ce(h,"class","selected svelte-b33h27")},m(B,N){Fe(B,h,N),re(h,f),re(f,v),re(f,w),V&&V.m(f,null),re(h,a),re(h,A),re(A,E),P||(M=[Ea(A,"click",c[14]),Ea(h,"click",c[12])],P=!0)},p(B,N){N[0]&34&&y!==(y=B[5][B[1]]+"")&&yt(v,y),B[2]?V?V.p(B,N):(V=cm(B),V.c(),V.m(f,null)):V&&(V.d(1),V=null)},d(B){B&&ie(h),V&&V.d(),P=!1,Ku(M)}}}function cm(c){let h,f=c[5][c[2]]+"",y;return{c(){h=De("small"),y=Pe(f),this.h()},l(v){h=Le(v,"SMALL",{class:!0});var w=Ve(h);y=Ce(w,f),w.forEach(ie),this.h()},h(){ce(h,"class","svelte-b33h27")},m(v,w){Fe(v,h,w),re(h,y)},p(v,w){w[0]&36&&f!==(f=v[5][v[2]]+"")&&yt(y,f)},d(v){v&&ie(h)}}}function hm(c){let h,f,y,v,w,a;function A(M,V){return M[4].length<3?L0:M[8][0]&&M[2]?D0:M[8][0]?M0:C0}let E=A(c),P=E(c);return{c(){h=De("div"),f=De("input"),y=st(),v=De("ul"),P.c(),this.h()},l(M){h=Le(M,"DIV",{id:!0,style:!0,class:!0});var V=Ve(h);f=Le(V,"INPUT",{type:!0,placeholder:!0,autocomplete:!0,class:!0}),y=lt(V),v=Le(V,"UL",{class:!0});var B=Ve(v);P.l(B),B.forEach(ie),V.forEach(ie),this.h()},h(){ce(f,"type","text"),ce(f,"placeholder",""),ce(f,"autocomplete","false"),ce(f,"class","svelte-b33h27"),ce(v,"class","svelte-b33h27"),ce(h,"id","dropdown"),Qt(h,"top","0"),ce(h,"class","svelte-b33h27")},m(M,V){Fe(M,h,V),re(h,f),gd(f,c[4]),c[24](f),re(h,y),re(h,v),P.m(v,null),c[31](h),w||(a=[Ea(f,"input",c[23]),Ea(f,"keyup",c[16])],w=!0)},p(M,V){V[0]&16&&f.value!==M[4]&&gd(f,M[4]),E===(E=A(M))&&P?P.p(M,V):(P.d(1),P=E(M),P&&(P.c(),P.m(v,null)))},d(M){M&&ie(h),c[24](null),P.d(),c[31](null),w=!1,Ku(a)}}}function C0(c){let h,f;return{c(){h=De("li"),f=Pe("No results"),this.h()},l(y){h=Le(y,"LI",{class:!0});var v=Ve(h);f=Ce(v,"No results"),v.forEach(ie),this.h()},h(){ce(h,"class","svelte-b33h27")},m(y,v){Fe(y,h,v),re(h,f)},p:ka,d(y){y&&ie(h)}}}function M0(c){let h,f=c[8],y=[];for(let v=0;v<f.length;v+=1)y[v]=pm(lm(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Br()},l(v){for(let w=0;w<y.length;w+=1)y[w].l(v);h=Br()},m(v,w){for(let a=0;a<y.length;a+=1)y[a].m(v,w);Fe(v,h,w)},p(v,w){if(w[0]&10626){f=v[8];let a;for(a=0;a<f.length;a+=1){const A=lm(v,f,a);y[a]?y[a].p(A,w):(y[a]=pm(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){ds(y,v),v&&ie(h)}}}function D0(c){let h,f=c[8],y=[];for(let v=0;v<f.length;v+=1)y[v]=fm(um(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Br()},l(v){for(let w=0;w<y.length;w+=1)y[w].l(v);h=Br()},m(v,w){for(let a=0;a<y.length;a+=1)y[a].m(v,w);Fe(v,h,w)},p(v,w){if(w[0]&10630){f=v[8];let a;for(a=0;a<f.length;a+=1){const A=um(v,f,a);y[a]?y[a].p(A,w):(y[a]=fm(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){ds(y,v),v&&ie(h)}}}function L0(c){let h,f;return{c(){h=De("li"),f=Pe("Type a name..."),this.h()},l(y){h=Le(y,"LI",{class:!0});var v=Ve(h);f=Ce(v,"Type a name..."),v.forEach(ie),this.h()},h(){ce(h,"class","svelte-b33h27")},m(y,v){Fe(y,h,v),re(h,f)},p:ka,d(y){y&&ie(h)}}}function pm(c){let h,f=c[33][c[1]]+"",y,v,w=c[35],a,A;function E(){return c[28](c[33])}function P(){return c[29](c[35])}const M=()=>c[30](h,w),V=()=>c[30](null,w);return{c(){h=De("li"),y=Pe(f),v=st(),this.h()},l(B){h=Le(B,"LI",{class:!0});var N=Ve(h);y=Ce(N,f),v=lt(N),N.forEach(ie),this.h()},h(){ce(h,"class","svelte-b33h27"),Pi(h,"highlight",c[7]==c[35])},m(B,N){Fe(B,h,N),re(h,y),re(h,v),M(),a||(A=[Ea(h,"click",E),Ea(h,"mouseover",P)],a=!0)},p(B,N){c=B,N[0]&258&&f!==(f=c[33][c[1]]+"")&&yt(y,f),w!==c[35]&&(V(),w=c[35],M()),N[0]&128&&Pi(h,"highlight",c[7]==c[35])},d(B){B&&ie(h),V(),a=!1,Ku(A)}}}function fm(c){let h,f=c[33][c[1]]+"",y,v,w,a=c[33][c[2]]+"",A,E,P=c[35],M,V;function B(){return c[25](c[33])}function N(){return c[26](c[35])}const ue=()=>c[27](h,P),ze=()=>c[27](null,P);return{c(){h=De("li"),y=Pe(f),v=st(),w=De("small"),A=Pe(a),E=st(),this.h()},l(Ae){h=Le(Ae,"LI",{class:!0});var Ie=Ve(h);y=Ce(Ie,f),v=lt(Ie),w=Le(Ie,"SMALL",{class:!0});var Me=Ve(w);A=Ce(Me,a),Me.forEach(ie),E=lt(Ie),Ie.forEach(ie),this.h()},h(){ce(w,"class","svelte-b33h27"),ce(h,"class","svelte-b33h27"),Pi(h,"highlight",c[7]==c[35])},m(Ae,Ie){Fe(Ae,h,Ie),re(h,y),re(h,v),re(h,w),re(w,A),re(h,E),ue(),M||(V=[Ea(h,"click",B),Ea(h,"mouseover",N)],M=!0)},p(Ae,Ie){c=Ae,Ie[0]&258&&f!==(f=c[33][c[1]]+"")&&yt(y,f),Ie[0]&260&&a!==(a=c[33][c[2]]+"")&&yt(A,a),P!==c[35]&&(ze(),P=c[35],ue()),Ie[0]&128&&Pi(h,"highlight",c[7]==c[35])},d(Ae){Ae&&ie(h),ze(),M=!1,Ku(V)}}}function R0(c){let h,f,y,v;function w(P,M){return P[5]&&!P[3]?P0:z0}let a=w(c),A=a(c),E=c[6]&&hm(c);return{c(){h=De("div"),A.c(),f=st(),E&&E.c(),this.h()},l(P){h=Le(P,"DIV",{id:!0,class:!0});var M=Ve(h);A.l(M),f=lt(M),E&&E.l(M),M.forEach(ie),this.h()},h(){ce(h,"id","select"),ce(h,"class","svelte-b33h27"),Pi(h,"active",c[6])},m(P,M){Fe(P,h,M),A.m(h,null),re(h,f),E&&E.m(h,null),y||(v=[Ea(window,"click",c[17]),Ea(h,"keydown",c[15])],y=!0)},p(P,M){a===(a=w(P))&&A?A.p(P,M):(A.d(1),A=a(P),A&&(A.c(),A.m(h,f))),P[6]?E?E.p(P,M):(E=hm(P),E.c(),E.m(h,null)):E&&(E.d(1),E=null),M[0]&64&&Pi(h,"active",P[6])},i:ka,o:ka,d(P){P&&ie(h),A.d(),E&&E.d(),y=!1,Ku(v)}}}function B0(c){return new Promise(h=>setTimeout(h,c))}function F0(c,h,f){let y;const v=Nm();let{options:w}=h,{selected:a=null}=h,{placeholder:A="Find an area"}=h,{value:E="code"}=h,{label:P="name"}=h,{group:M=null}=h,{search:V=!1}=h,B=a,N=a?w.find(ht=>{ht[E]==a[E]}):null,ue=!1,ze="",Ae=null,Ie,Me,ft,Pt=[];function ve(ht){ht.stopPropagation(),f(4,ze=""),f(6,ue=!ue),B0(10).then(()=>{ft&&ue&&ft.focus()})}function je(ht){f(18,a=ht),f(6,ue=!1),v("select",{selected:ht,value:ht[E]})}function ur(ht){ht.stopPropagation(),f(18,a=null),f(21,B=null),f(5,N=null),v("select",{selected:null,value:null})}function cr(ht){ue&&Ie[0]&&Number.isInteger(Ae)&&(ht.keyCode===38?(f(7,Ae-=Ae>0?1:0),Pt[Ae].scrollIntoView({block:"nearest",inline:"start"})):ht.keyCode===40&&(f(7,Ae+=Ae<Ie.length-1?1:0),Pt[Ae].scrollIntoView({block:"nearest",inline:"end"})))}function pt(ht){Ie[0]&&Number.isInteger(Ae)&&ht.keyCode===13&&je(Ie[Ae])}function hr(ht){ht.target!==Me&&(f(6,ue=!1),f(7,Ae=0))}function gt(){ze=this.value,f(4,ze)}function nt(ht){sl[ht?"unshift":"push"](()=>{ft=ht,f(10,ft)})}const xt=ht=>je(ht),er=ht=>f(7,Ae=ht);function We(ht,He){sl[ht?"unshift":"push"](()=>{Pt[He]=ht,f(11,Pt)})}const nr=ht=>je(ht),wr=ht=>f(7,Ae=ht);function Nt(ht,He){sl[ht?"unshift":"push"](()=>{Pt[He]=ht,f(11,Pt)})}function qt(ht){sl[ht?"unshift":"push"](()=>{Me=ht,f(9,Me)})}return c.$$set=ht=>{"options"in ht&&f(19,w=ht.options),"selected"in ht&&f(18,a=ht.selected),"placeholder"in ht&&f(0,A=ht.placeholder),"value"in ht&&f(20,E=ht.value),"label"in ht&&f(1,P=ht.label),"group"in ht&&f(2,M=ht.group),"search"in ht&&f(3,V=ht.search)},c.$$.update=()=>{c.$$.dirty[0]&16&&f(22,y=ze?new RegExp(ze,"i"):null),c.$$.dirty[0]&4718594&&(f(8,Ie=y?w.filter(ht=>y.test(ht[P])):w),f(7,Ae=0)),c.$$.dirty[0]&3932160&&B!=a&&(f(5,N=w.find(ht=>ht[E]==a[E])),f(21,B=a))},[A,P,M,V,ze,N,ue,Ae,Ie,Me,ft,Pt,ve,je,ur,cr,pt,hr,a,w,E,B,y,gt,nt,xt,er,We,nr,wr,Nt,qt]}class O0 extends ea{constructor(h){super(),ta(this,h,F0,R0,ra,{options:19,selected:18,placeholder:0,value:20,label:1,group:2,search:3},null,[-1,-1])}}var Pc={exports:{}};(function(c,h){(function(f,y){c.exports=y()})(Jv,function(){var f,y,v;function w(a,A){if(!f)f=A;else if(!y)y=A;else{var E="var sharedChunk = {}; ("+f+")(sharedChunk); ("+y+")(sharedChunk);",P={};f(P),v=A(P),typeof window<"u"&&(v.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}return w(["exports"],function(a){function A(e,t){return e(t={exports:{}},t.exports),t.exports}var E=P;function P(e,t,i,l){this.cx=3*e,this.bx=3*(i-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=l,this.p2x=i,this.p2y=l}P.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},P.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},P.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},P.prototype.solveCurveX=function(e,t){var i,l,p,d,_;for(t===void 0&&(t=1e-6),p=e,_=0;_<8;_++){if(d=this.sampleCurveX(p)-e,Math.abs(d)<t)return p;var k=this.sampleCurveDerivativeX(p);if(Math.abs(k)<1e-6)break;p-=d/k}if((p=e)<(i=0))return i;if(p>(l=1))return l;for(;i<l;){if(d=this.sampleCurveX(p),Math.abs(d-e)<t)return p;e>d?i=p:l=p,p=.5*(l-i)+i}return p},P.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var M=V;function V(e,t){this.x=e,this.y=t}V.prototype={clone:function(){return new V(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),i=Math.sin(e),l=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=l,this},_rotateAround:function(e,t){var i=Math.cos(e),l=Math.sin(e),p=t.y+l*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-l*(this.y-t.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},V.convert=function(e){return e instanceof V?e:Array.isArray(e)?new V(e[0],e[1]):e};var B=typeof self<"u"?self:{},N=Math.pow(2,53)-1;function ue(e,t,i,l){var p=new E(e,t,i,l);return function(d){return p.solve(d)}}var ze=ue(.25,.1,.25,1);function Ae(e,t,i){return Math.min(i,Math.max(t,e))}function Ie(e,t,i){var l=i-t,p=((e-t)%l+l)%l+t;return p===t?i:p}function Me(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var d=p[l];for(var _ in d)e[_]=d[_]}return e}var ft=1;function Pt(){return ft++}function ve(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function je(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function ur(e,t){e.forEach(function(i){t[i]&&(t[i]=t[i].bind(t))})}function cr(e,t){return e.indexOf(t,e.length-t.length)!==-1}function pt(e,t,i){var l={};for(var p in e)l[p]=t.call(i||this,e[p],p,e);return l}function hr(e,t,i){var l={};for(var p in e)t.call(i||this,e[p],p,e)&&(l[p]=e[p]);return l}function gt(e){return Array.isArray(e)?e.map(gt):typeof e=="object"&&e?pt(e,gt):e}var nt={};function xt(e){nt[e]||(typeof console<"u"&&console.warn(e),nt[e]=!0)}function er(e,t,i){return(i.y-e.y)*(t.x-e.x)>(t.y-e.y)*(i.x-e.x)}function We(e){for(var t=0,i=0,l=e.length,p=l-1,d=void 0,_=void 0;i<l;p=i++)t+=((_=e[p]).x-(d=e[i]).x)*(d.y+_.y);return t}function nr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function wr(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(l,p,d,_){var k=d||_;return t[p]=!k||k.toLowerCase(),""}),t["max-age"]){var i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}var Nt=null;function qt(e){if(Nt==null){var t=e.navigator?e.navigator.userAgent:null;Nt=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Nt}function ht(e){try{var t=B[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}var He,Sr,Hi,Zn,Gn=B.performance&&B.performance.now?B.performance.now.bind(B.performance):Date.now.bind(Date),mi=B.requestAnimationFrame||B.mozRequestAnimationFrame||B.webkitRequestAnimationFrame||B.msRequestAnimationFrame,vr=B.cancelAnimationFrame||B.mozCancelAnimationFrame||B.webkitCancelAnimationFrame||B.msCancelAnimationFrame,Kn={now:Gn,frame:function(e){var t=mi(e);return{cancel:function(){return vr(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var i=B.document.createElement("canvas"),l=i.getContext("2d");if(!l)throw new Error("failed to create canvas 2d context");return i.width=e.width,i.height=e.height,l.drawImage(e,0,0,e.width,e.height),l.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return He||(He=B.document.createElement("a")),He.href=e,He.href},hardwareConcurrency:B.navigator&&B.navigator.hardwareConcurrency||4,get devicePixelRatio(){return B.devicePixelRatio},get prefersReducedMotion(){return!!B.matchMedia&&(Sr==null&&(Sr=B.matchMedia("(prefers-reduced-motion: reduce)")),Sr.matches)}},Zt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Vi={supported:!1,testSupport:function(e){!So&&Zn&&(on?Gt(e):Hi=e)}},So=!1,on=!1;function Gt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Zn),e.isContextLost())return;Vi.supported=!0}catch{}e.deleteTexture(t),So=!0}B.document&&((Zn=B.document.createElement("img")).onload=function(){Hi&&Gt(Hi),Hi=null,on=!0},Zn.onerror=function(){So=!0,Hi=null},Zn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Cn="01",ti=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function oi(e){return e.indexOf("mapbox:")===0}ti.prototype._createSkuToken=function(){var e=function(){for(var t="",i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Cn,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},ti.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ti.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},ti.prototype.normalizeStyleURL=function(e,t){if(!oi(e))return e;var i=yi(e);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},ti.prototype.normalizeGlyphsURL=function(e,t){if(!oi(e))return e;var i=yi(e);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||t)},ti.prototype.normalizeSourceURL=function(e,t){if(!oi(e))return e;var i=yi(e);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||t)},ti.prototype.normalizeSpriteURL=function(e,t,i,l){var p=yi(e);return oi(e)?(p.path="/styles/v1"+p.path+"/sprite"+t+i,this._makeAPIURL(p,this._customAccessToken||l)):(p.path+=""+t+i,an(p))},ti.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!oi(e))return e;var i=yi(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Kn.devicePixelRatio>=2||t===512?"@2x":"")+(Vi.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var l=this._customAccessToken||function(p){for(var d=0,_=p;d<_.length;d+=1){var k=_[d].match(/^access_token=(.*)$/);if(k)return k[1]}return null}(i.params)||Zt.ACCESS_TOKEN;return Zt.REQUIRE_ACCESS_TOKEN&&l&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,l)},ti.prototype.canonicalizeTileURL=function(e,t){var i=yi(e);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return e;var l="mapbox://tiles/";l+=i.path.replace("/v4/","");var p=i.params;return t&&(p=p.filter(function(d){return!d.match(/^access_token=/)})),p.length&&(l+="?"+p.join("&")),l},ti.prototype.canonicalizeTileset=function(e,t){for(var i=!!t&&oi(t),l=[],p=0,d=e.tiles||[];p<d.length;p+=1){var _=d[p];ji(_)?l.push(this.canonicalizeTileURL(_,i)):l.push(_)}return l},ti.prototype._makeAPIURL=function(e,t){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=yi(Zt.API_URL);if(e.protocol=l.protocol,e.authority=l.authority,e.protocol==="http"){var p=e.params.indexOf("secure");p>=0&&e.params.splice(p,1)}if(l.path!=="/"&&(e.path=""+l.path+e.path),!Zt.REQUIRE_ACCESS_TOKEN)return an(e);if(!(t=t||Zt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return e.params=e.params.filter(function(d){return d.indexOf("access_token")===-1}),e.params.push("access_token="+t),an(e)};var Xn=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ji(e){return Xn.test(e)}var Ci=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function yi(e){var t=e.match(Ci);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function an(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function mn(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(B.atob(t[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var gi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};gi.prototype.getStorageKey=function(e){var t,i=mn(Zt.ACCESS_TOKEN);return t=i&&i.u?B.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(l,p){return String.fromCharCode(Number("0x"+p))})):Zt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},gi.prototype.fetchEventData=function(){var e=ht("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{var l=B.localStorage.getItem(t);l&&(this.eventData=JSON.parse(l));var p=B.localStorage.getItem(i);p&&(this.anonId=p)}catch{xt("Unable to read from LocalStorage")}},gi.prototype.saveEventData=function(){var e=ht("localStorage"),t=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{B.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&B.localStorage.setItem(t,JSON.stringify(this.eventData))}catch{xt("Unable to write to LocalStorage")}},gi.prototype.processRequests=function(e){},gi.prototype.postEvent=function(e,t,i,l){var p=this;if(Zt.EVENTS_URL){var d=yi(Zt.EVENTS_URL);d.params.push("access_token="+(l||Zt.ACCESS_TOKEN||""));var _={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Cn,userId:this.anonId},k=t?Me(_,t):_,I={url:an(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([k])};this.pendingRequest=pr(I,function(z){p.pendingRequest=null,i(z),p.saveEventData(),p.processRequests(l)})}},gi.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var _i,Fr,kr=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(i,l,p,d){this.skuToken=p,(Zt.EVENTS_URL&&d||Zt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(_){return oi(_)||ji(_)}))&&this.queueRequest({id:l,timestamp:Date.now()},d)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){var p=this.queue.shift(),d=p.id,_=p.timestamp;d&&this.success[d]||(this.anonId||this.fetchEventData(),je(this.anonId)||(this.anonId=ve()),this.postEvent(_,{skuToken:this.skuToken},function(k){k||d&&(l.success[d]=!0)},i))}},t}(gi),Wn=new(function(e){function t(i){e.call(this,"appUserTurnstile"),this._customAccessToken=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(i,l){Zt.EVENTS_URL&&Zt.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(p){return oi(p)||ji(p)})&&this.queueRequest(Date.now(),l)},t.prototype.processRequests=function(i){var l=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var p=mn(Zt.ACCESS_TOKEN),d=p?p.u:Zt.ACCESS_TOKEN,_=d!==this.eventData.tokenU;je(this.anonId)||(this.anonId=ve(),_=!0);var k=this.queue.shift();if(this.eventData.lastSuccess){var I=new Date(this.eventData.lastSuccess),z=new Date(k),D=(k-this.eventData.lastSuccess)/864e5;_=_||D>=1||D<-1||I.getDate()!==z.getDate()}else _=!0;if(!_)return this.processRequests();this.postEvent(k,{"enabled.telemetry":!1},function(R){R||(l.eventData.lastSuccess=k,l.eventData.tokenU=d)},i)}},t}(gi)),yn=Wn.postTurnstileEvent.bind(Wn),gn=new kr,lo=gn.postMapLoadEvent.bind(gn),Hn=500,Ji=50;function Mi(){B.caches&&!_i&&(_i=B.caches.open("mapbox-tiles"))}function uo(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Mn,Yi=1/0;function sn(){return Mn==null&&(Mn=B.OffscreenCanvas&&new B.OffscreenCanvas(1,1).getContext("2d")&&typeof B.createImageBitmap=="function"),Mn}var ko={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ko);var Jn=function(e){function t(i,l,p){l===401&&ji(p)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,i),this.status=l,this.url=p,this.name=this.constructor.name,this.message=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),_n=nr()?function(){return self.worker&&self.worker.referrer}:function(){return(B.location.protocol==="blob:"?B.parent:B).location.href},ln,un,Qi=function(e,t){if(!(/^file:/.test(i=e.url)||/^file:/.test(_n())&&!/^\w+:/.test(i))){if(B.fetch&&B.Request&&B.AbortController&&B.Request.prototype.hasOwnProperty("signal"))return function(l,p){var d,_=new B.AbortController,k=new B.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:_n(),signal:_.signal}),I=!1,z=!1,D=(d=k.url).indexOf("sku=")>0&&ji(d);l.type==="json"&&k.headers.set("Accept","application/json");var R=function(Z,Y,$){if(!z){if(Z&&Z.message!=="SecurityError"&&xt(Z),Y&&$)return U(Y);var le=Date.now();B.fetch(k).then(function(ne){if(ne.ok){var fe=D?ne.clone():null;return U(ne,fe,le)}return p(new Jn(ne.statusText,ne.status,l.url))}).catch(function(ne){ne.code!==20&&p(new Error(ne.message))})}},U=function(Z,Y,$){(l.type==="arrayBuffer"?Z.arrayBuffer():l.type==="json"?Z.json():Z.text()).then(function(le){z||(Y&&$&&function(ne,fe,_e){if(Mi(),_i){var xe={status:fe.status,statusText:fe.statusText,headers:new B.Headers};fe.headers.forEach(function(Re,qe){return xe.headers.set(qe,Re)});var ke=wr(fe.headers.get("Cache-Control")||"");ke["no-store"]||(ke["max-age"]&&xe.headers.set("Expires",new Date(_e+1e3*ke["max-age"]).toUTCString()),new Date(xe.headers.get("Expires")).getTime()-_e<42e4||function(Re,qe){if(Fr===void 0)try{new Response(new ReadableStream),Fr=!0}catch{Fr=!1}Fr?qe(Re.body):Re.blob().then(qe)}(fe,function(Re){var qe=new B.Response(Re,xe);Mi(),_i&&_i.then(function(Je){return Je.put(uo(ne.url),qe)}).catch(function(Je){return xt(Je.message)})}))}}(k,Y,$),I=!0,p(null,le,Z.headers.get("Cache-Control"),Z.headers.get("Expires")))}).catch(function(le){z||p(new Error(le.message))})};return D?function(Z,Y){if(Mi(),!_i)return Y(null);var $=uo(Z.url);_i.then(function(le){le.match($).then(function(ne){var fe=function(_e){if(!_e)return!1;var xe=new Date(_e.headers.get("Expires")||0),ke=wr(_e.headers.get("Cache-Control")||"");return xe>Date.now()&&!ke["no-cache"]}(ne);le.delete($),fe&&le.put($,ne.clone()),Y(null,ne,fe)}).catch(Y)}).catch(Y)}(k,R):R(null,null),{cancel:function(){z=!0,I||_.abort()}}}(e,t);if(nr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var i;return function(l,p){var d=new B.XMLHttpRequest;for(var _ in d.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(d.responseType="arraybuffer"),l.headers)d.setRequestHeader(_,l.headers[_]);return l.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=l.credentials==="include",d.onerror=function(){p(new Error(d.statusText))},d.onload=function(){if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){var k=d.response;if(l.type==="json")try{k=JSON.parse(d.response)}catch(I){return p(I)}p(null,k,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else p(new Jn(d.statusText,d.status,l.url))},d.send(l.body),{cancel:function(){return d.abort()}}}(e,t)},Dn=function(e,t){return Qi(Me(e,{type:"arrayBuffer"}),t)},pr=function(e,t){return Qi(Me(e,{method:"POST"}),t)},L="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";ln=[],un=0;var O=function(e,t){if(Vi.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),un>=Zt.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return ln.push(i),i}un++;var l=!1,p=function(){if(!l)for(l=!0,un--;ln.length&&un<Zt.MAX_PARALLEL_IMAGE_REQUESTS;){var _=ln.shift();_.cancelled||(_.cancel=O(_.requestParameters,_.callback).cancel)}},d=Dn(e,function(_,k,I,z){p(),_?t(_):k&&(sn()?function(D,R){var U=new B.Blob([new Uint8Array(D)],{type:"image/png"});B.createImageBitmap(U).then(function(Z){R(null,Z)}).catch(function(Z){R(new Error("Could not load image because of "+Z.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(k,t):function(D,R,U,Z){var Y=new B.Image,$=B.URL;Y.onload=function(){R(null,Y),$.revokeObjectURL(Y.src),Y.onload=null,B.requestAnimationFrame(function(){Y.src=L})},Y.onerror=function(){return R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var le=new B.Blob([new Uint8Array(D)],{type:"image/png"});Y.cacheControl=U,Y.expires=Z,Y.src=D.byteLength?$.createObjectURL(le):L}(k,t,I,z))});return{cancel:function(){d.cancel(),p()}}};function q(e,t,i){i[e]&&i[e].indexOf(t)!==-1||(i[e]=i[e]||[],i[e].push(t))}function W(e,t,i){if(i&&i[e]){var l=i[e].indexOf(t);l!==-1&&i[e].splice(l,1)}}var J=function(e,t){t===void 0&&(t={}),Me(this,t),this.type=e},se=function(e){function t(i,l){l===void 0&&(l={}),e.call(this,"error",Me({error:i},l))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(J),he=function(){};he.prototype.on=function(e,t){return this._listeners=this._listeners||{},q(e,t,this._listeners),this},he.prototype.off=function(e,t){return W(e,t,this._listeners),W(e,t,this._oneTimeListeners),this},he.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},q(e,t,this._oneTimeListeners),this},he.prototype.fire=function(e,t){typeof e=="string"&&(e=new J(e,t||{}));var i=e.type;if(this.listens(i)){e.target=this;for(var l=0,p=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];l<p.length;l+=1)p[l].call(this,e);for(var d=0,_=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];d<_.length;d+=1){var k=_[d];W(i,k,this._oneTimeListeners),k.call(this,e)}var I=this._eventedParent;I&&(Me(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(e))}else e instanceof se&&console.error(e.error);return this},he.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},he.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var j={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Q=function(e,t,i,l){this.message=(e?e+": ":"")+i,l&&(this.identifier=l),t!=null&&t.__line__&&(this.line=t.__line__)};function me(e){var t=e.value;return t?[new Q(e.key,t,"constants have been deprecated as of v8")]:[]}function Be(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var l=0,p=t;l<p.length;l+=1){var d=p[l];for(var _ in d)e[_]=d[_]}return e}function Ne(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Se(e){if(Array.isArray(e))return e.map(Se);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var i in e)t[i]=Se(e[i]);return t}return Ne(e)}var Oe=function(e){function t(i,l){e.call(this,l),this.message=l,this.key=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),rt=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var i=0,l=t;i<l.length;i+=1){var p=l[i];this.bindings[p[0]]=p[1]}};rt.prototype.concat=function(e){return new rt(this,e)},rt.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},rt.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var et={kind:"null"},we={kind:"number"},Qe={kind:"string"},Ge={kind:"boolean"},Ze={kind:"color"},Ct={kind:"object"},$e={kind:"value"},Kt={kind:"collator"},sr={kind:"formatted"},Ft={kind:"resolvedImage"};function Ot(e,t){return{kind:"array",itemType:e,N:t}}function Xt(e){if(e.kind==="array"){var t=Xt(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Xr=[et,we,Qe,Ge,Ze,sr,Ct,Ot($e),Ft];function tr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!tr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var i=0,l=Xr;i<l.length;i+=1)if(!tr(l[i],t))return null}}return"Expected "+Xt(e)+" but found "+Xt(t)+" instead."}function Cr(e,t){return t.some(function(i){return i.kind===e.kind})}function or(e,t){return t.some(function(i){return i==="null"?e===null:i==="array"?Array.isArray(e):i==="object"?e&&!Array.isArray(e)&&typeof e=="object":i===typeof e})}var Ut=A(function(e,t){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(k){return(k=Math.round(k))<0?0:k>255?255:k}function p(k){return l(k[k.length-1]==="%"?parseFloat(k)/100*255:parseInt(k))}function d(k){return(I=k[k.length-1]==="%"?parseFloat(k)/100:parseFloat(k))<0?0:I>1?1:I;var I}function _(k,I,z){return z<0?z+=1:z>1&&(z-=1),6*z<1?k+(I-k)*z*6:2*z<1?I:3*z<2?k+(I-k)*(2/3-z)*6:k}try{t.parseCSSColor=function(k){var I,z=k.replace(/ /g,"").toLowerCase();if(z in i)return i[z].slice();if(z[0]==="#")return z.length===4?(I=parseInt(z.substr(1),16))>=0&&I<=4095?[(3840&I)>>4|(3840&I)>>8,240&I|(240&I)>>4,15&I|(15&I)<<4,1]:null:z.length===7&&(I=parseInt(z.substr(1),16))>=0&&I<=16777215?[(16711680&I)>>16,(65280&I)>>8,255&I,1]:null;var D=z.indexOf("("),R=z.indexOf(")");if(D!==-1&&R+1===z.length){var U=z.substr(0,D),Z=z.substr(D+1,R-(D+1)).split(","),Y=1;switch(U){case"rgba":if(Z.length!==4)return null;Y=d(Z.pop());case"rgb":return Z.length!==3?null:[p(Z[0]),p(Z[1]),p(Z[2]),Y];case"hsla":if(Z.length!==4)return null;Y=d(Z.pop());case"hsl":if(Z.length!==3)return null;var $=(parseFloat(Z[0])%360+360)%360/360,le=d(Z[1]),ne=d(Z[2]),fe=ne<=.5?ne*(le+1):ne+le-ne*le,_e=2*ne-fe;return[l(255*_(_e,fe,$+1/3)),l(255*_(_e,fe,$)),l(255*_(_e,fe,$-1/3)),Y];default:return null}}return null}}catch{}}).parseCSSColor,Dt=function(e,t,i,l){l===void 0&&(l=1),this.r=e,this.g=t,this.b=i,this.a=l};Dt.parse=function(e){if(e){if(e instanceof Dt)return e;if(typeof e=="string"){var t=Ut(e);if(t)return new Dt(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Dt.prototype.toString=function(){var e=this.toArray(),t=e[1],i=e[2],l=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(i)+","+l+")"},Dt.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Dt.black=new Dt(0,0,0,1),Dt.white=new Dt(1,1,1,1),Dt.transparent=new Dt(0,0,0,0),Dt.red=new Dt(1,0,0,1);var Wr=function(e,t,i){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Wr.prototype.compare=function(e,t){return this.collator.compare(e,t)},Wr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Yn=function(e,t,i,l,p){this.text=e,this.image=t,this.scale=i,this.fontStack=l,this.textColor=p},Hr=function(e){this.sections=e};Hr.fromString=function(e){return new Hr([new Yn(e,null,null,null,null)])},Hr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Hr.factory=function(e){return e instanceof Hr?e:Hr.fromString(e)},Hr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Hr.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];if(l.image)e.push(["image",l.image.name]);else{e.push(l.text);var p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toArray())),e.push(p)}}return e};var hi=function(e){this.name=e.name,this.available=e.available};function Lo(e,t,i,l){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:"Invalid rgba value ["+[e,t,i,l].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof l=="number"?[e,t,i,l]:[e,t,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function vn(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Dt||e instanceof Wr||e instanceof Hr||e instanceof hi)return!0;if(Array.isArray(e)){for(var t=0,i=e;t<i.length;t+=1)if(!vn(i[t]))return!1;return!0}if(typeof e=="object"){for(var l in e)if(!vn(e[l]))return!1;return!0}return!1}function zr(e){if(e===null)return et;if(typeof e=="string")return Qe;if(typeof e=="boolean")return Ge;if(typeof e=="number")return we;if(e instanceof Dt)return Ze;if(e instanceof Wr)return Kt;if(e instanceof Hr)return sr;if(e instanceof hi)return Ft;if(Array.isArray(e)){for(var t,i=e.length,l=0,p=e;l<p.length;l+=1){var d=zr(p[l]);if(t){if(t===d)continue;t=$e;break}t=d}return Ot(t||$e,i)}return Ct}function Qn(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof Dt||e instanceof Hr||e instanceof hi?e.toString():JSON.stringify(e)}hi.prototype.toString=function(){return this.name},hi.fromString=function(e){return e?new hi({name:e,available:!1}):null},hi.prototype.serialize=function(){return["image",this.name]};var ai=function(e,t){this.type=e,this.value=t};ai.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!vn(e[1]))return t.error("invalid value");var i=e[1],l=zr(i),p=t.expectedType;return l.kind!=="array"||l.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(l=p),new ai(l,i)},ai.prototype.evaluate=function(){return this.value},ai.prototype.eachChild=function(){},ai.prototype.outputDefined=function(){return!0},ai.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Dt?["rgba"].concat(this.value.toArray()):this.value instanceof Hr?this.value.serialize():this.value};var Or=function(e){this.name="ExpressionEvaluationError",this.message=e};Or.prototype.toJSON=function(){return this.message};var Di={string:Qe,number:we,boolean:Ge,object:Ct},xr=function(e,t){this.type=e,this.args=t};xr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i,l=1,p=e[0];if(p==="array"){var d,_;if(e.length>2){var k=e[1];if(typeof k!="string"||!(k in Di)||k==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);d=Di[k],l++}else d=$e;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);_=e[2],l++}i=Ot(d,_)}else i=Di[p];for(var I=[];l<e.length;l++){var z=t.parse(e[l],l,$e);if(!z)return null;I.push(z)}return new xr(i,I)},xr.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var i=this.args[t].evaluate(e);if(!tr(this.type,zr(i)))return i;if(t===this.args.length-1)throw new Or("Expected value to be of type "+Xt(this.type)+", but found "+Xt(zr(i))+" instead.")}return null},xr.prototype.eachChild=function(e){this.args.forEach(e)},xr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},xr.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){t.push(i.kind);var l=e.N;(typeof l=="number"||this.args.length>1)&&t.push(l)}}return t.concat(this.args.map(function(p){return p.serialize()}))};var cn=function(e){this.type=sr,this.sections=e};cn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[1];if(!Array.isArray(i)&&typeof i=="object")return t.error("First argument must be an image or text section.");for(var l=[],p=!1,d=1;d<=e.length-1;++d){var _=e[d];if(p&&typeof _=="object"&&!Array.isArray(_)){p=!1;var k=null;if(_["font-scale"]&&!(k=t.parse(_["font-scale"],1,we)))return null;var I=null;if(_["text-font"]&&!(I=t.parse(_["text-font"],1,Ot(Qe))))return null;var z=null;if(_["text-color"]&&!(z=t.parse(_["text-color"],1,Ze)))return null;var D=l[l.length-1];D.scale=k,D.font=I,D.textColor=z}else{var R=t.parse(e[d],1,$e);if(!R)return null;var U=R.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,l.push({content:R,scale:null,font:null,textColor:null})}}return new cn(l)},cn.prototype.evaluate=function(e){return new Hr(this.sections.map(function(t){var i=t.content.evaluate(e);return zr(i)===Ft?new Yn("",i,null,null,null):new Yn(Qn(i),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},cn.prototype.eachChild=function(e){for(var t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}},cn.prototype.outputDefined=function(){return!1},cn.prototype.serialize=function(){for(var e=["format"],t=0,i=this.sections;t<i.length;t+=1){var l=i[t];e.push(l.content.serialize());var p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),e.push(p)}return e};var Li=function(e){this.type=Ft,this.input=e};Li.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var i=t.parse(e[1],1,Qe);return i?new Li(i):t.error("No image name provided.")},Li.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=hi.fromString(t);return i&&e.availableImages&&(i.available=e.availableImages.indexOf(t)>-1),i},Li.prototype.eachChild=function(e){e(this.input)},Li.prototype.outputDefined=function(){return!1},Li.prototype.serialize=function(){return["image",this.input.serialize()]};var Ti={"to-boolean":Ge,"to-color":Ze,"to-number":we,"to-string":Qe},mr=function(e,t){this.type=e,this.args=t};mr.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var i=e[0];if((i==="to-boolean"||i==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var l=Ti[i],p=[],d=1;d<e.length;d++){var _=t.parse(e[d],d,$e);if(!_)return null;p.push(_)}return new mr(l,p)},mr.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,i,l=0,p=this.args;l<p.length;l+=1){if(i=null,(t=p[l].evaluate(e))instanceof Dt)return t;if(typeof t=="string"){var d=e.parseColor(t);if(d)return d}else if(Array.isArray(t)&&!(i=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Lo(t[0],t[1],t[2],t[3])))return new Dt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Or(i||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var _=null,k=0,I=this.args;k<I.length;k+=1){if((_=I[k].evaluate(e))===null)return 0;var z=Number(_);if(!isNaN(z))return z}throw new Or("Could not convert "+JSON.stringify(_)+" to number.")}return this.type.kind==="formatted"?Hr.fromString(Qn(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?hi.fromString(Qn(this.args[0].evaluate(e))):Qn(this.args[0].evaluate(e))},mr.prototype.eachChild=function(e){this.args.forEach(e)},mr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},mr.prototype.serialize=function(){if(this.type.kind==="formatted")return new cn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Li(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var co=["Unknown","Point","LineString","Polygon"],Nr=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Nr.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Nr.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?co[this.feature.type]:this.feature.type:null},Nr.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Nr.prototype.canonicalID=function(){return this.canonical},Nr.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Nr.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Dt.parse(e)),t};var Jr=function(e,t,i,l){this.name=e,this.type=t,this._evaluate=i,this.args=l};Jr.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Jr.prototype.eachChild=function(e){this.args.forEach(e)},Jr.prototype.outputDefined=function(){return!1},Jr.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Jr.parse=function(e,t){var i,l=e[0],p=Jr.definitions[l];if(!p)return t.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0);for(var d=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,k=_.filter(function(St){var it=St[0];return!Array.isArray(it)||it.length===e.length-1}),I=null,z=0,D=k;z<D.length;z+=1){var R=D[z],U=R[0],Z=R[1];I=new yr(t.registry,t.path,null,t.scope);for(var Y=[],$=!1,le=1;le<e.length;le++){var ne=e[le],fe=Array.isArray(U)?U[le-1]:U.type,_e=I.parse(ne,1+Y.length,fe);if(!_e){$=!0;break}Y.push(_e)}if(!$)if(Array.isArray(U)&&U.length!==Y.length)I.error("Expected "+U.length+" arguments, but found "+Y.length+" instead.");else{for(var xe=0;xe<Y.length;xe++){var ke=Array.isArray(U)?U[xe]:U.type,Re=Y[xe];I.concat(xe+1).checkSubtype(ke,Re.type)}if(I.errors.length===0)return new Jr(l,d,Z,Y)}}if(k.length===1)(i=t.errors).push.apply(i,I.errors);else{for(var qe=(k.length?k:_).map(function(St){var it;return it=St[0],Array.isArray(it)?"("+it.map(Xt).join(", ")+")":"("+Xt(it.type)+"...)"}).join(" | "),Je=[],_t=1;_t<e.length;_t++){var tt=t.parse(e[_t],1+Je.length);if(!tt)return null;Je.push(Xt(tt.type))}t.error("Expected arguments of type "+qe+", but found ("+Je.join(", ")+") instead.")}return null},Jr.register=function(e,t){for(var i in Jr.definitions=t,t)e[i]=Jr};var xn=function(e,t,i){this.type=Kt,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=t};function vi(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function ho(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Eo(e,t){var i=(180+e[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,p=Math.pow(2,t.z);return[Math.round(i*p*8192),Math.round(l*p*8192)]}function Ro(e,t,i){return t[1]>e[1]!=i[1]>e[1]&&e[0]<(i[0]-t[0])*(e[1]-t[1])/(i[1]-t[1])+t[0]}function ia(e,t){for(var i,l,p,d,_,k,I,z=!1,D=0,R=t.length;D<R;D++)for(var U=t[D],Z=0,Y=U.length;Z<Y-1;Z++){if((d=(i=e)[0]-(l=U[Z])[0])*(I=i[1]-(p=U[Z+1])[1])-(k=i[0]-p[0])*(_=i[1]-l[1])==0&&d*k<=0&&_*I<=0)return!1;Ro(e,U[Z],U[Z+1])&&(z=!z)}return z}function Os(e,t){for(var i=0;i<t.length;i++)if(ia(e,t[i]))return!0;return!1}function $n(e,t,i,l){var p=l[0]-i[0],d=l[1]-i[1],_=(e[0]-i[0])*d-p*(e[1]-i[1]),k=(t[0]-i[0])*d-p*(t[1]-i[1]);return _>0&&k<0||_<0&&k>0}function Ta(e,t,i){for(var l=0,p=i;l<p.length;l+=1)for(var d=p[l],_=0;_<d.length-1;++_)if((R=[(D=d[_+1])[0]-(z=d[_])[0],D[1]-z[1]])[0]*(U=[(I=t)[0]-(k=e)[0],I[1]-k[1]])[1]-R[1]*U[0]!=0&&$n(k,I,z,D)&&$n(z,D,k,I))return!0;var k,I,z,D,R,U;return!1}function Ia(e,t){for(var i=0;i<e.length;++i)if(!ia(e[i],t))return!1;for(var l=0;l<e.length-1;++l)if(Ta(e[l],e[l+1],t))return!1;return!0}function ms(e,t){for(var i=0;i<t.length;i++)if(Ia(e,t[i]))return!0;return!1}function Bo(e,t,i){for(var l=[],p=0;p<e.length;p++){for(var d=[],_=0;_<e[p].length;_++){var k=Eo(e[p][_],i);vi(t,k),d.push(k)}l.push(d)}return l}function po(e,t,i){for(var l=[],p=0;p<e.length;p++){var d=Bo(e[p],t,i);l.push(d)}return l}function na(e,t,i,l){if(e[0]<i[0]||e[0]>i[2]){var p=.5*l,d=e[0]-i[0]>p?-l:i[0]-e[0]>p?l:0;d===0&&(d=e[0]-i[2]>p?-l:i[2]-e[0]>p?l:0),e[0]+=d}vi(t,e)}function To(e,t,i,l){for(var p=8192*Math.pow(2,l.z),d=[8192*l.x,8192*l.y],_=[],k=0,I=e;k<I.length;k+=1)for(var z=0,D=I[k];z<D.length;z+=1){var R=D[z],U=[R.x+d[0],R.y+d[1]];na(U,t,i,p),_.push(U)}return _}function eo(e,t,i,l){for(var p,d=8192*Math.pow(2,l.z),_=[8192*l.x,8192*l.y],k=[],I=0,z=e;I<z.length;I+=1){for(var D=[],R=0,U=z[I];R<U.length;R+=1){var Z=U[R],Y=[Z.x+_[0],Z.y+_[1]];vi(t,Y),D.push(Y)}k.push(D)}if(t[2]-t[0]<=d/2){(p=t)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(var $=0,le=k;$<le.length;$+=1)for(var ne=0,fe=le[$];ne<fe.length;ne+=1)na(fe[ne],t,i,d)}return k}xn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var i=e[1];if(typeof i!="object"||Array.isArray(i))return t.error("Collator options argument must be an object.");var l=t.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Ge);if(!l)return null;var p=t.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Ge);if(!p)return null;var d=null;return i.locale&&!(d=t.parse(i.locale,1,Qe))?null:new xn(l,p,d)},xn.prototype.evaluate=function(e){return new Wr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},xn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},xn.prototype.outputDefined=function(){return!1},xn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var hn=function(e,t){this.type=Ge,this.geojson=e,this.geometries=t};function fo(e){if(e instanceof Jr&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof hn)return!1;var t=!0;return e.eachChild(function(i){t&&!fo(i)&&(t=!1)}),t}function de(e){if(e instanceof Jr&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(i){t&&!de(i)&&(t=!1)}),t}function ri(e,t){if(e instanceof Jr&&t.indexOf(e.name)>=0)return!1;var i=!0;return e.eachChild(function(l){i&&!ri(l,t)&&(i=!1)}),i}hn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(vn(e[1])){var i=e[1];if(i.type==="FeatureCollection")for(var l=0;l<i.features.length;++l){var p=i.features[l].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new hn(i,i.features[l].geometry)}else if(i.type==="Feature"){var d=i.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new hn(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new hn(i,i)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},hn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],d=t.canonicalID();if(i.type==="Polygon"){var _=Bo(i.coordinates,p,d),k=To(t.geometry(),l,p,d);if(!ho(l,p))return!1;for(var I=0,z=k;I<z.length;I+=1)if(!ia(z[I],_))return!1}if(i.type==="MultiPolygon"){var D=po(i.coordinates,p,d),R=To(t.geometry(),l,p,d);if(!ho(l,p))return!1;for(var U=0,Z=R;U<Z.length;U+=1)if(!Os(Z[U],D))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,i){var l=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],d=t.canonicalID();if(i.type==="Polygon"){var _=Bo(i.coordinates,p,d),k=eo(t.geometry(),l,p,d);if(!ho(l,p))return!1;for(var I=0,z=k;I<z.length;I+=1)if(!Ia(z[I],_))return!1}if(i.type==="MultiPolygon"){var D=po(i.coordinates,p,d),R=eo(t.geometry(),l,p,d);if(!ho(l,p))return!1;for(var U=0,Z=R;U<Z.length;U+=1)if(!ms(Z[U],D))return!1}return!0}(e,this.geometries)}return!1},hn.prototype.eachChild=function(){},hn.prototype.outputDefined=function(){return!0},hn.prototype.serialize=function(){return["within",this.geojson]};var xi=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};xi.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var i=e[1];return t.scope.has(i)?new xi(i,t.scope.get(i)):t.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},xi.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},xi.prototype.eachChild=function(){},xi.prototype.outputDefined=function(){return!1},xi.prototype.serialize=function(){return["var",this.name]};var yr=function(e,t,i,l,p){t===void 0&&(t=[]),l===void 0&&(l=new rt),p===void 0&&(p=[]),this.registry=e,this.path=t,this.key=t.map(function(d){return"["+d+"]"}).join(""),this.scope=l,this.errors=p,this.expectedType=i};function bn(e,t){for(var i,l=e.length-1,p=0,d=l,_=0;p<=d;)if((i=e[_=Math.floor((p+d)/2)])<=t){if(_===l||t<e[_+1])return _;p=_+1}else{if(!(i>t))throw new Or("Input is not a number.");d=_-1}return 0}yr.prototype.parse=function(e,t,i,l,p){return p===void 0&&(p={}),t?this.concat(t,i,l)._parse(e,p):this._parse(e,p)},yr.prototype._parse=function(e,t){function i(z,D,R){return R==="assert"?new xr(D,[z]):R==="coerce"?new mr(D,[z]):z}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var l=e[0];if(typeof l!="string")return this.error("Expression name must be a string, but found "+typeof l+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var p=this.registry[l];if(p){var d=p.parse(e,this);if(!d)return null;if(this.expectedType){var _=this.expectedType,k=d.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||k.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(_,k))return null}else d=i(d,_,t.typeAnnotation||"coerce");else d=i(d,_,t.typeAnnotation||"assert")}if(!(d instanceof ai)&&d.type.kind!=="resolvedImage"&&function z(D){if(D instanceof xi)return z(D.boundExpression);if(D instanceof Jr&&D.name==="error"||D instanceof xn||D instanceof hn)return!1;var R=D instanceof mr||D instanceof xr,U=!0;return D.eachChild(function(Z){U=R?U&&z(Z):U&&Z instanceof ai}),!!U&&fo(D)&&ri(D,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(d)){var I=new Nr;try{d=new ai(d.type,d.evaluate(I))}catch(z){return this.error(z.message),null}}return d}return this.error('Unknown expression "'+l+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},yr.prototype.concat=function(e,t,i){var l=typeof e=="number"?this.path.concat(e):this.path,p=i?this.scope.concat(i):this.scope;return new yr(this.registry,l,t||null,p,this.errors)},yr.prototype.error=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var l=""+this.key+t.map(function(p){return"["+p+"]"}).join("");this.errors.push(new Oe(l,e))},yr.prototype.checkSubtype=function(e,t){var i=tr(e,t);return i&&this.error(i),i};var pn=function(e,t,i){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var l=0,p=i;l<p.length;l+=1){var d=p[l],_=d[1];this.labels.push(d[0]),this.outputs.push(_)}};function ii(e,t,i){return e*(1-i)+t*i}pn.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var i=t.parse(e[1],1,we);if(!i)return null;var l=[],p=null;t.expectedType&&t.expectedType.kind!=="value"&&(p=t.expectedType);for(var d=1;d<e.length;d+=2){var _=d===1?-1/0:e[d],k=e[d+1],I=d,z=d+1;if(typeof _!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(l.length&&l[l.length-1][0]>=_)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);var D=t.parse(k,z,p);if(!D)return null;p=p||D.type,l.push([_,D])}return new pn(p,i,l)},pn.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;return l>=t[p-1]?i[p-1].evaluate(e):i[bn(t,l)].evaluate(e)},pn.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},pn.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},pn.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Aa=Object.freeze({__proto__:null,number:ii,color:function(e,t,i){return new Dt(ii(e.r,t.r,i),ii(e.g,t.g,i),ii(e.b,t.b,i),ii(e.a,t.a,i))},array:function(e,t,i){return e.map(function(l,p){return ii(l,t[p],i)})}}),oa=6/29*3*(6/29),zl=Math.PI/180,za=180/Math.PI;function Pa(e){return e>.008856451679035631?Math.pow(e,1/3):e/oa+4/29}function Ns(e){return e>6/29?e*e*e:oa*(e-4/29)}function Us(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Vs(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function aa(e){var t=Vs(e.r),i=Vs(e.g),l=Vs(e.b),p=Pa((.4124564*t+.3575761*i+.1804375*l)/.95047),d=Pa((.2126729*t+.7151522*i+.072175*l)/1);return{l:116*d-16,a:500*(p-d),b:200*(d-Pa((.0193339*t+.119192*i+.9503041*l)/1.08883)),alpha:e.a}}function ll(e){var t=(e.l+16)/116,i=isNaN(e.a)?t:t+e.a/500,l=isNaN(e.b)?t:t-e.b/200;return t=1*Ns(t),i=.95047*Ns(i),l=1.08883*Ns(l),new Dt(Us(3.2404542*i-1.5371385*t-.4985314*l),Us(-.969266*i+1.8760108*t+.041556*l),Us(.0556434*i-.2040259*t+1.0572252*l),e.alpha)}function Ca(e,t,i){var l=t-e;return e+i*(l>180||l<-180?l-360*Math.round(l/360):l)}var Fo={forward:aa,reverse:ll,interpolate:function(e,t,i){return{l:ii(e.l,t.l,i),a:ii(e.a,t.a,i),b:ii(e.b,t.b,i),alpha:ii(e.alpha,t.alpha,i)}}},$a={forward:function(e){var t=aa(e),i=t.l,l=t.a,p=t.b,d=Math.atan2(p,l)*za;return{h:d<0?d+360:d,c:Math.sqrt(l*l+p*p),l:i,alpha:e.a}},reverse:function(e){var t=e.h*zl,i=e.c;return ll({l:e.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:e.alpha})},interpolate:function(e,t,i){return{h:Ca(e.h,t.h,i),c:ii(e.c,t.c,i),l:ii(e.l,t.l,i),alpha:ii(e.alpha,t.alpha,i)}}},ul=Object.freeze({__proto__:null,lab:Fo,hcl:$a}),Ii=function(e,t,i,l,p){this.type=e,this.operator=t,this.interpolation=i,this.input=l,this.labels=[],this.outputs=[];for(var d=0,_=p;d<_.length;d+=1){var k=_[d],I=k[1];this.labels.push(k[0]),this.outputs.push(I)}};function Oo(e,t,i,l){var p=l-i,d=e-i;return p===0?0:t===1?d/p:(Math.pow(t,d)-1)/(Math.pow(t,p)-1)}Ii.interpolationFactor=function(e,t,i,l){var p=0;if(e.name==="exponential")p=Oo(t,e.base,i,l);else if(e.name==="linear")p=Oo(t,1,i,l);else if(e.name==="cubic-bezier"){var d=e.controlPoints;p=new E(d[0],d[1],d[2],d[3]).solve(Oo(t,1,i,l))}return p},Ii.parse=function(e,t){var i=e[0],l=e[1],p=e[2],d=e.slice(3);if(!Array.isArray(l)||l.length===0)return t.error("Expected an interpolation type expression.",1);if(l[0]==="linear")l={name:"linear"};else if(l[0]==="exponential"){var _=l[1];if(typeof _!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);l={name:"exponential",base:_}}else{if(l[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(l[0]),1,0);var k=l.slice(1);if(k.length!==4||k.some(function(le){return typeof le!="number"||le<0||le>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);l={name:"cubic-bezier",controlPoints:k}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(p=t.parse(p,2,we)))return null;var I=[],z=null;i==="interpolate-hcl"||i==="interpolate-lab"?z=Ze:t.expectedType&&t.expectedType.kind!=="value"&&(z=t.expectedType);for(var D=0;D<d.length;D+=2){var R=d[D],U=d[D+1],Z=D+3,Y=D+4;if(typeof R!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(I.length&&I[I.length-1][0]>=R)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);var $=t.parse(U,Y,z);if(!$)return null;z=z||$.type,I.push([R,$])}return z.kind==="number"||z.kind==="color"||z.kind==="array"&&z.itemType.kind==="number"&&typeof z.N=="number"?new Ii(z,i,l,p,I):t.error("Type "+Xt(z)+" is not interpolatable.")},Ii.prototype.evaluate=function(e){var t=this.labels,i=this.outputs;if(t.length===1)return i[0].evaluate(e);var l=this.input.evaluate(e);if(l<=t[0])return i[0].evaluate(e);var p=t.length;if(l>=t[p-1])return i[p-1].evaluate(e);var d=bn(t,l),_=Ii.interpolationFactor(this.interpolation,l,t[d],t[d+1]),k=i[d].evaluate(e),I=i[d+1].evaluate(e);return this.operator==="interpolate"?Aa[this.type.kind.toLowerCase()](k,I,_):this.operator==="interpolate-hcl"?$a.reverse($a.interpolate($a.forward(k),$a.forward(I),_)):Fo.reverse(Fo.interpolate(Fo.forward(k),Fo.forward(I),_))},Ii.prototype.eachChild=function(e){e(this.input);for(var t=0,i=this.outputs;t<i.length;t+=1)e(i[t])},Ii.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ii.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],i=0;i<this.labels.length;i++)t.push(this.labels[i],this.outputs[i].serialize());return t};var No=function(e,t){this.type=e,this.args=t};No.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var i=null,l=t.expectedType;l&&l.kind!=="value"&&(i=l);for(var p=[],d=0,_=e.slice(1);d<_.length;d+=1){var k=t.parse(_[d],1+p.length,i,void 0,{typeAnnotation:"omit"});if(!k)return null;i=i||k.type,p.push(k)}var I=l&&p.some(function(z){return tr(l,z.type)});return new No(I?$e:i,p)},No.prototype.evaluate=function(e){for(var t,i=null,l=0,p=0,d=this.args;p<d.length&&(l++,(i=d[p].evaluate(e))&&i instanceof hi&&!i.available&&(t||(t=i.name),i=null,l===this.args.length&&(i=t)),i===null);p+=1);return i},No.prototype.eachChild=function(e){this.args.forEach(e)},No.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},No.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var wn=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};wn.prototype.evaluate=function(e){return this.result.evaluate(e)},wn.prototype.eachChild=function(e){for(var t=0,i=this.bindings;t<i.length;t+=1)e(i[t][1]);e(this.result)},wn.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var i=[],l=1;l<e.length-1;l+=2){var p=e[l];if(typeof p!="string")return t.error("Expected string, but found "+typeof p+" instead.",l);if(/[^a-zA-Z0-9_]/.test(p))return t.error("Variable names must contain only alphanumeric characters or '_'.",l);var d=t.parse(e[l+1],l+1);if(!d)return null;i.push([p,d])}var _=t.parse(e[e.length-1],e.length-1,t.expectedType,i);return _?new wn(i,_):null},wn.prototype.outputDefined=function(){return this.result.outputDefined()},wn.prototype.serialize=function(){for(var e=["let"],t=0,i=this.bindings;t<i.length;t+=1){var l=i[t];e.push(l[0],l[1].serialize())}return e.push(this.result.serialize()),e};var mo=function(e,t,i){this.type=e,this.index=t,this.input=i};mo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,we),l=t.parse(e[2],2,Ot(t.expectedType||$e));return i&&l?new mo(l.type.itemType,i,l):null},mo.prototype.evaluate=function(e){var t=this.index.evaluate(e),i=this.input.evaluate(e);if(t<0)throw new Or("Array index out of bounds: "+t+" < 0.");if(t>=i.length)throw new Or("Array index out of bounds: "+t+" > "+(i.length-1)+".");if(t!==Math.floor(t))throw new Or("Array index must be an integer, but found "+t+" instead.");return i[t]},mo.prototype.eachChild=function(e){e(this.index),e(this.input)},mo.prototype.outputDefined=function(){return!1},mo.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var sa=function(e,t){this.type=Ge,this.needle=e,this.haystack=t};sa.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,$e),l=t.parse(e[2],2,$e);return i&&l?Cr(i.type,[Ge,Qe,we,et,$e])?new sa(i,l):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Xt(i.type)+" instead"):null},sa.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!i)return!1;if(!or(t,["boolean","string","number","null"]))throw new Or("Expected first argument to be of type boolean, string, number or null, but found "+Xt(zr(t))+" instead.");if(!or(i,["string","array"]))throw new Or("Expected second argument to be of type array or string, but found "+Xt(zr(i))+" instead.");return i.indexOf(t)>=0},sa.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},sa.prototype.outputDefined=function(){return!0},sa.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Uo=function(e,t,i){this.type=we,this.needle=e,this.haystack=t,this.fromIndex=i};Uo.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,$e),l=t.parse(e[2],2,$e);if(!i||!l)return null;if(!Cr(i.type,[Ge,Qe,we,et,$e]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Xt(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,we);return p?new Uo(i,l,p):null}return new Uo(i,l)},Uo.prototype.evaluate=function(e){var t=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!or(t,["boolean","string","number","null"]))throw new Or("Expected first argument to be of type boolean, string, number or null, but found "+Xt(zr(t))+" instead.");if(!or(i,["string","array"]))throw new Or("Expected second argument to be of type array or string, but found "+Xt(zr(i))+" instead.");if(this.fromIndex){var l=this.fromIndex.evaluate(e);return i.indexOf(t,l)}return i.indexOf(t)},Uo.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Uo.prototype.outputDefined=function(){return!1},Uo.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var la=function(e,t,i,l,p,d){this.inputType=e,this.type=t,this.input=i,this.cases=l,this.outputs=p,this.otherwise=d};la.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var i,l;t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(var p={},d=[],_=2;_<e.length-1;_+=2){var k=e[_],I=e[_+1];Array.isArray(k)||(k=[k]);var z=t.concat(_);if(k.length===0)return z.error("Expected at least one branch label.");for(var D=0,R=k;D<R.length;D+=1){var U=R[D];if(typeof U!="number"&&typeof U!="string")return z.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return z.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof U=="number"&&Math.floor(U)!==U)return z.error("Numeric branch labels must be integer values.");if(i){if(z.checkSubtype(i,zr(U)))return null}else i=zr(U);if(p[String(U)]!==void 0)return z.error("Branch labels must be unique.");p[String(U)]=d.length}var Z=t.parse(I,_,l);if(!Z)return null;l=l||Z.type,d.push(Z)}var Y=t.parse(e[1],1,$e);if(!Y)return null;var $=t.parse(e[e.length-1],e.length-1,l);return $?Y.type.kind!=="value"&&t.concat(1).checkSubtype(i,Y.type)?null:new la(i,l,Y,p,d,$):null},la.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(zr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},la.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},la.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},la.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],i=[],l={},p=0,d=Object.keys(this.cases).sort();p<d.length;p+=1){var _=d[p];(R=l[this.cases[_]])===void 0?(l[this.cases[_]]=i.length,i.push([this.cases[_],[_]])):i[R][1].push(_)}for(var k=function(Z){return e.inputType.kind==="number"?Number(Z):Z},I=0,z=i;I<z.length;I+=1){var D=z[I],R=D[0],U=D[1];t.push(U.length===1?k(U[0]):U.map(k)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Ln=function(e,t,i){this.type=e,this.branches=t,this.otherwise=i};Ln.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);for(var l=[],p=1;p<e.length-1;p+=2){var d=t.parse(e[p],p,Ge);if(!d)return null;var _=t.parse(e[p+1],p+1,i);if(!_)return null;l.push([d,_]),i=i||_.type}var k=t.parse(e[e.length-1],e.length-1,i);return k?new Ln(i,l,k):null},Ln.prototype.evaluate=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];if(l[0].evaluate(e))return p.evaluate(e)}return this.otherwise.evaluate(e)},Ln.prototype.eachChild=function(e){for(var t=0,i=this.branches;t<i.length;t+=1){var l=i[t],p=l[1];e(l[0]),e(p)}e(this.otherwise)},Ln.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Ln.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Vo=function(e,t,i,l){this.type=e,this.input=t,this.beginIndex=i,this.endIndex=l};function ua(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function es(e,t,i,l){return l.compare(t,i)===0}function Er(e,t,i){var l=e!=="=="&&e!=="!=";return function(){function p(d,_,k){this.type=Ge,this.lhs=d,this.rhs=_,this.collator=k,this.hasUntypedArgument=d.type.kind==="value"||_.type.kind==="value"}return p.parse=function(d,_){if(d.length!==3&&d.length!==4)return _.error("Expected two or three arguments.");var k=d[0],I=_.parse(d[1],1,$e);if(!I)return null;if(!ua(k,I.type))return _.concat(1).error('"'+k+`" comparisons are not supported for type '`+Xt(I.type)+"'.");var z=_.parse(d[2],2,$e);if(!z)return null;if(!ua(k,z.type))return _.concat(2).error('"'+k+`" comparisons are not supported for type '`+Xt(z.type)+"'.");if(I.type.kind!==z.type.kind&&I.type.kind!=="value"&&z.type.kind!=="value")return _.error("Cannot compare types '"+Xt(I.type)+"' and '"+Xt(z.type)+"'.");l&&(I.type.kind==="value"&&z.type.kind!=="value"?I=new xr(z.type,[I]):I.type.kind!=="value"&&z.type.kind==="value"&&(z=new xr(I.type,[z])));var D=null;if(d.length===4){if(I.type.kind!=="string"&&z.type.kind!=="string"&&I.type.kind!=="value"&&z.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(!(D=_.parse(d[3],3,Kt)))return null}return new p(I,z,D)},p.prototype.evaluate=function(d){var _=this.lhs.evaluate(d),k=this.rhs.evaluate(d);if(l&&this.hasUntypedArgument){var I=zr(_),z=zr(k);if(I.kind!==z.kind||I.kind!=="string"&&I.kind!=="number")throw new Or('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+I.kind+", "+z.kind+") instead.")}if(this.collator&&!l&&this.hasUntypedArgument){var D=zr(_),R=zr(k);if(D.kind!=="string"||R.kind!=="string")return t(d,_,k)}return this.collator?i(d,_,k,this.collator.evaluate(d)):t(d,_,k)},p.prototype.eachChild=function(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)},p.prototype.outputDefined=function(){return!0},p.prototype.serialize=function(){var d=[e];return this.eachChild(function(_){d.push(_.serialize())}),d},p}()}Vo.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1,$e),l=t.parse(e[2],2,we);if(!i||!l)return null;if(!Cr(i.type,[Ot($e),Qe,$e]))return t.error("Expected first argument to be of type array or string, but found "+Xt(i.type)+" instead");if(e.length===4){var p=t.parse(e[3],3,we);return p?new Vo(i.type,i,l,p):null}return new Vo(i.type,i,l)},Vo.prototype.evaluate=function(e){var t=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!or(t,["string","array"]))throw new Or("Expected first argument to be of type array or string, but found "+Xt(zr(t))+" instead.");if(this.endIndex){var l=this.endIndex.evaluate(e);return t.slice(i,l)}return t.slice(i)},Vo.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Vo.prototype.outputDefined=function(){return!1},Vo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Pl=Er("==",function(e,t,i){return t===i},es),ys=Er("!=",function(e,t,i){return t!==i},function(e,t,i,l){return!es(0,t,i,l)}),ca=Er("<",function(e,t,i){return t<i},function(e,t,i,l){return l.compare(t,i)<0}),Cl=Er(">",function(e,t,i){return t>i},function(e,t,i,l){return l.compare(t,i)>0}),Ri=Er("<=",function(e,t,i){return t<=i},function(e,t,i,l){return l.compare(t,i)<=0}),cl=Er(">=",function(e,t,i){return t>=i},function(e,t,i,l){return l.compare(t,i)>=0}),Ma=function(e,t,i,l,p){this.type=Qe,this.number=e,this.locale=t,this.currency=i,this.minFractionDigits=l,this.maxFractionDigits=p};Ma.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var i=t.parse(e[1],1,we);if(!i)return null;var l=e[2];if(typeof l!="object"||Array.isArray(l))return t.error("NumberFormat options argument must be an object.");var p=null;if(l.locale&&!(p=t.parse(l.locale,1,Qe)))return null;var d=null;if(l.currency&&!(d=t.parse(l.currency,1,Qe)))return null;var _=null;if(l["min-fraction-digits"]&&!(_=t.parse(l["min-fraction-digits"],1,we)))return null;var k=null;return l["max-fraction-digits"]&&!(k=t.parse(l["max-fraction-digits"],1,we))?null:new Ma(i,p,d,_,k)},Ma.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Ma.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Ma.prototype.outputDefined=function(){return!1},Ma.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var si=function(e){this.type=we,this.input=e};si.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var i=t.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Xt(i.type)+" instead."):new si(i):null},si.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Or("Expected value to be of type string or array, but found "+Xt(zr(t))+" instead.")},si.prototype.eachChild=function(e){e(this.input)},si.prototype.outputDefined=function(){return!1},si.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Da={"==":Pl,"!=":ys,">":Cl,"<":ca,">=":cl,"<=":Ri,array:xr,at:mo,boolean:xr,case:Ln,coalesce:No,collator:xn,format:cn,image:Li,in:sa,"index-of":Uo,interpolate:Ii,"interpolate-hcl":Ii,"interpolate-lab":Ii,length:si,let:wn,literal:ai,match:la,number:xr,"number-format":Ma,object:xr,slice:Vo,step:pn,string:xr,"to-boolean":mr,"to-color":mr,"to-number":mr,"to-string":mr,var:xi,within:hn};function js(e,t){var i=t[0],l=t[1],p=t[2],d=t[3];i=i.evaluate(e),l=l.evaluate(e),p=p.evaluate(e);var _=d?d.evaluate(e):1,k=Lo(i,l,p,_);if(k)throw new Or(k);return new Dt(i/255*_,l/255*_,p/255*_,_)}function yo(e,t){return e in t}function qi(e,t){var i=t[e];return i===void 0?null:i}function La(e){return{type:e}}function ha(e){return{result:"success",value:e}}function Ra(e){return{result:"error",value:e}}function Ba(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function pa(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function gs(e){return!!e.expression&&e.expression.interpolated}function Ur(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function qs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function iu(e){return e}function fa(e,t,i){return e!==void 0?e:t!==void 0?t:i!==void 0?i:void 0}function go(e,t,i,l,p){return fa(typeof i===p?l[i]:void 0,e.default,t.default)}function nu(e,t,i){if(Ur(i)!=="number")return fa(e.default,t.default);var l=e.stops.length;if(l===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[l-1][0])return e.stops[l-1][1];var p=bn(e.stops.map(function(d){return d[0]}),i);return e.stops[p][1]}function Zs(e,t,i){var l=e.base!==void 0?e.base:1;if(Ur(i)!=="number")return fa(e.default,t.default);var p=e.stops.length;if(p===1||i<=e.stops[0][0])return e.stops[0][1];if(i>=e.stops[p-1][0])return e.stops[p-1][1];var d=bn(e.stops.map(function(R){return R[0]}),i),_=function(R,U,Z,Y){var $=Y-Z,le=R-Z;return $===0?0:U===1?le/$:(Math.pow(U,le)-1)/(Math.pow(U,$)-1)}(i,l,e.stops[d][0],e.stops[d+1][0]),k=e.stops[d][1],I=e.stops[d+1][1],z=Aa[t.type]||iu;if(e.colorSpace&&e.colorSpace!=="rgb"){var D=ul[e.colorSpace];z=function(R,U){return D.reverse(D.interpolate(D.forward(R),D.forward(U),_))}}return typeof k.evaluate=="function"?{evaluate:function(){for(var R=[],U=arguments.length;U--;)R[U]=arguments[U];var Z=k.evaluate.apply(void 0,R),Y=I.evaluate.apply(void 0,R);if(Z!==void 0&&Y!==void 0)return z(Z,Y,_)}}:z(k,I,_)}function Rn(e,t,i){return t.type==="color"?i=Dt.parse(i):t.type==="formatted"?i=Hr.fromString(i.toString()):t.type==="resolvedImage"?i=hi.fromString(i.toString()):Ur(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),fa(i,e.default,t.default)}Jr.register(Da,{error:[{kind:"error"},[Qe],function(e,t){throw new Or(t[0].evaluate(e))}],typeof:[Qe,[$e],function(e,t){return Xt(zr(t[0].evaluate(e)))}],"to-rgba":[Ot(we,4),[Ze],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Ze,[we,we,we],js],rgba:[Ze,[we,we,we,we],js],has:{type:Ge,overloads:[[[Qe],function(e,t){return yo(t[0].evaluate(e),e.properties())}],[[Qe,Ct],function(e,t){var i=t[1];return yo(t[0].evaluate(e),i.evaluate(e))}]]},get:{type:$e,overloads:[[[Qe],function(e,t){return qi(t[0].evaluate(e),e.properties())}],[[Qe,Ct],function(e,t){var i=t[1];return qi(t[0].evaluate(e),i.evaluate(e))}]]},"feature-state":[$e,[Qe],function(e,t){return qi(t[0].evaluate(e),e.featureState||{})}],properties:[Ct,[],function(e){return e.properties()}],"geometry-type":[Qe,[],function(e){return e.geometryType()}],id:[$e,[],function(e){return e.id()}],zoom:[we,[],function(e){return e.globals.zoom}],"heatmap-density":[we,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[we,[],function(e){return e.globals.lineProgress||0}],accumulated:[$e,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[we,La(we),function(e,t){for(var i=0,l=0,p=t;l<p.length;l+=1)i+=p[l].evaluate(e);return i}],"*":[we,La(we),function(e,t){for(var i=1,l=0,p=t;l<p.length;l+=1)i*=p[l].evaluate(e);return i}],"-":{type:we,overloads:[[[we,we],function(e,t){var i=t[1];return t[0].evaluate(e)-i.evaluate(e)}],[[we],function(e,t){return-t[0].evaluate(e)}]]},"/":[we,[we,we],function(e,t){var i=t[1];return t[0].evaluate(e)/i.evaluate(e)}],"%":[we,[we,we],function(e,t){var i=t[1];return t[0].evaluate(e)%i.evaluate(e)}],ln2:[we,[],function(){return Math.LN2}],pi:[we,[],function(){return Math.PI}],e:[we,[],function(){return Math.E}],"^":[we,[we,we],function(e,t){var i=t[1];return Math.pow(t[0].evaluate(e),i.evaluate(e))}],sqrt:[we,[we],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[we,[we],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[we,[we],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[we,[we],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[we,[we],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[we,[we],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[we,[we],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[we,[we],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[we,[we],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[we,[we],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[we,La(we),function(e,t){return Math.min.apply(Math,t.map(function(i){return i.evaluate(e)}))}],max:[we,La(we),function(e,t){return Math.max.apply(Math,t.map(function(i){return i.evaluate(e)}))}],abs:[we,[we],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[we,[we],function(e,t){var i=t[0].evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[we,[we],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[we,[we],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Ge,[Qe,$e],function(e,t){var i=t[0],l=t[1];return e.properties()[i.value]===l.value}],"filter-id-==":[Ge,[$e],function(e,t){var i=t[0];return e.id()===i.value}],"filter-type-==":[Ge,[Qe],function(e,t){var i=t[0];return e.geometryType()===i.value}],"filter-<":[Ge,[Qe,$e],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p<d}],"filter-id-<":[Ge,[$e],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[Ge,[Qe,$e],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p>d}],"filter-id->":[Ge,[$e],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[Ge,[Qe,$e],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p<=d}],"filter-id-<=":[Ge,[$e],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[Ge,[Qe,$e],function(e,t){var i=t[0],l=t[1],p=e.properties()[i.value],d=l.value;return typeof p==typeof d&&p>=d}],"filter-id->=":[Ge,[$e],function(e,t){var i=t[0],l=e.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[Ge,[$e],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Ge,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Ge,[Ot(Qe)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ge,[Ot($e)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ge,[Qe,Ot($e)],function(e,t){var i=t[0];return t[1].value.indexOf(e.properties()[i.value])>=0}],"filter-in-large":[Ge,[Qe,Ot($e)],function(e,t){var i=t[0],l=t[1];return function(p,d,_,k){for(;_<=k;){var I=_+k>>1;if(d[I]===p)return!0;d[I]>p?k=I-1:_=I+1}return!1}(e.properties()[i.value],l.value,0,l.value.length-1)}],all:{type:Ge,overloads:[[[Ge,Ge],function(e,t){var i=t[1];return t[0].evaluate(e)&&i.evaluate(e)}],[La(Ge),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(!l[i].evaluate(e))return!1;return!0}]]},any:{type:Ge,overloads:[[[Ge,Ge],function(e,t){var i=t[1];return t[0].evaluate(e)||i.evaluate(e)}],[La(Ge),function(e,t){for(var i=0,l=t;i<l.length;i+=1)if(l[i].evaluate(e))return!0;return!1}]]},"!":[Ge,[Ge],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Ge,[Qe],function(e,t){var i=e.globals&&e.globals.isSupportedScript;return!i||i(t[0].evaluate(e))}],upcase:[Qe,[Qe],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Qe,[Qe],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Qe,La($e),function(e,t){return t.map(function(i){return Qn(i.evaluate(e))}).join("")}],"resolved-locale":[Qe,[Kt],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var ts=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Nr,this._defaultValue=t?function(i){return i.type==="color"&&qs(i.default)?new Dt(0,0,0,0):i.type==="color"?Dt.parse(i.default)||null:i.default===void 0?null:i.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function Fa(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Da}function Bn(e,t){var i=new yr(Da,[],t?function(p){var d={color:Ze,string:Qe,number:we,enum:Qe,boolean:Ge,formatted:sr,resolvedImage:Ft};return p.type==="array"?Ot(d[p.value]||$e,p.length):d[p.type]}(t):void 0),l=i.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?ha(new ts(l,t)):Ra(i.errors)}ts.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=i,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=d,this.expression.evaluate(this._evaluator)},ts.prototype.evaluate=function(e,t,i,l,p,d){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=i||null,this._evaluator.canonical=l,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=d||null;try{var _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new Or("Expected value to be one of "+Object.keys(this._enumValues).map(function(k){return JSON.stringify(k)}).join(", ")+", but found "+JSON.stringify(_)+" instead.");return _}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}};var _s=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!de(t.expression)};_s.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,d)},_s.prototype.evaluate=function(e,t,i,l,p,d){return this._styleExpression.evaluate(e,t,i,l,p,d)};var to=function(e,t,i,l){this.kind=e,this.zoomStops=i,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!de(t.expression),this.interpolationType=l};function Ml(e,t){if((e=Bn(e,t)).result==="error")return e;var i=e.value.expression,l=fo(i);if(!l&&!Ba(t))return Ra([new Oe("","data expressions not supported")]);var p=ri(i,["zoom"]);if(!p&&!pa(t))return Ra([new Oe("","zoom expressions not supported")]);var d=function _(k){var I=null;if(k instanceof wn)I=_(k.result);else if(k instanceof No)for(var z=0,D=k.args;z<D.length&&!(I=_(D[z]));z+=1);else(k instanceof pn||k instanceof Ii)&&k.input instanceof Jr&&k.input.name==="zoom"&&(I=k);return I instanceof Oe||k.eachChild(function(R){var U=_(R);U instanceof Oe?I=U:!I&&U?I=new Oe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):I&&U&&I!==U&&(I=new Oe("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),I}(i);return d||p?d instanceof Oe?Ra([d]):d instanceof Ii&&!gs(t)?Ra([new Oe("",'"interpolate" expressions cannot be used with this property')]):ha(d?new to(l?"camera":"composite",e.value,d.labels,d instanceof Ii?d.interpolation:void 0):new _s(l?"constant":"source",e.value)):Ra([new Oe("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}to.prototype.evaluateWithoutErrorHandling=function(e,t,i,l,p,d){return this._styleExpression.evaluateWithoutErrorHandling(e,t,i,l,p,d)},to.prototype.evaluate=function(e,t,i,l,p,d){return this._styleExpression.evaluate(e,t,i,l,p,d)},to.prototype.interpolationFactor=function(e,t,i){return this.interpolationType?Ii.interpolationFactor(this.interpolationType,e,t,i):0};var bi=function(e,t){this._parameters=e,this._specification=t,Be(this,function i(l,p){var d,_,k,I=p.type==="color",z=l.stops&&typeof l.stops[0][0]=="object",D=z||!(z||l.property!==void 0),R=l.type||(gs(p)?"exponential":"interval");if(I&&((l=Be({},l)).stops&&(l.stops=l.stops.map(function(tt){return[tt[0],Dt.parse(tt[1])]})),l.default=Dt.parse(l.default?l.default:p.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!ul[l.colorSpace])throw new Error("Unknown color space: "+l.colorSpace);if(R==="exponential")d=Zs;else if(R==="interval")d=nu;else if(R==="categorical"){d=go,_=Object.create(null);for(var U=0,Z=l.stops;U<Z.length;U+=1){var Y=Z[U];_[Y[0]]=Y[1]}k=typeof l.stops[0][0]}else{if(R!=="identity")throw new Error('Unknown function type "'+R+'"');d=Rn}if(z){for(var $={},le=[],ne=0;ne<l.stops.length;ne++){var fe=l.stops[ne],_e=fe[0].zoom;$[_e]===void 0&&($[_e]={zoom:_e,type:l.type,property:l.property,default:l.default,stops:[]},le.push(_e)),$[_e].stops.push([fe[0].value,fe[1]])}for(var xe=[],ke=0,Re=le;ke<Re.length;ke+=1){var qe=Re[ke];xe.push([$[qe].zoom,i($[qe],p)])}var Je={name:"linear"};return{kind:"composite",interpolationType:Je,interpolationFactor:Ii.interpolationFactor.bind(void 0,Je),zoomStops:xe.map(function(tt){return tt[0]}),evaluate:function(tt,St){var it=tt.zoom;return Zs({stops:xe,base:l.base},p,it).evaluate(it,St)}}}if(D){var _t=R==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:_t,interpolationFactor:Ii.interpolationFactor.bind(void 0,_t),zoomStops:l.stops.map(function(tt){return tt[0]}),evaluate:function(tt){return d(l,p,tt.zoom,_,k)}}}return{kind:"source",evaluate:function(tt,St){var it=St&&St.properties?St.properties[l.property]:void 0;return it===void 0?fa(l.default,p.default):d(l,p,it,_,k)}}}(this._parameters,this._specification))};function ye(e){var t=e.key,i=e.value,l=e.valueSpec||{},p=e.objectElementValidators||{},d=e.style,_=e.styleSpec,k=[],I=Ur(i);if(I!=="object")return[new Q(t,i,"object expected, "+I+" found")];for(var z in i){var D=z.split(".")[0],R=l[D]||l["*"],U=void 0;if(p[D])U=p[D];else if(l[D])U=$t;else if(p["*"])U=p["*"];else{if(!l["*"]){k.push(new Q(t,i[z],'unknown property "'+z+'"'));continue}U=$t}k=k.concat(U({key:(t&&t+".")+z,value:i[z],valueSpec:R,style:d,styleSpec:_,object:i,objectKey:z},i))}for(var Z in l)p[Z]||l[Z].required&&l[Z].default===void 0&&i[Z]===void 0&&k.push(new Q(t,i,'missing required property "'+Z+'"'));return k}function ct(e){var t=e.value,i=e.valueSpec,l=e.style,p=e.styleSpec,d=e.key,_=e.arrayElementValidator||$t;if(Ur(t)!=="array")return[new Q(d,t,"array expected, "+Ur(t)+" found")];if(i.length&&t.length!==i.length)return[new Q(d,t,"array length "+i.length+" expected, length "+t.length+" found")];if(i["min-length"]&&t.length<i["min-length"])return[new Q(d,t,"array length at least "+i["min-length"]+" expected, length "+t.length+" found")];var k={type:i.value,values:i.values};p.$version<7&&(k.function=i.function),Ur(i.value)==="object"&&(k=i.value);for(var I=[],z=0;z<t.length;z++)I=I.concat(_({array:t,arrayIndex:z,value:t[z],valueSpec:k,style:l,styleSpec:p,key:d+"["+z+"]"}));return I}function Oa(e){var t=e.key,i=e.value,l=e.valueSpec,p=Ur(i);return p==="number"&&i!=i&&(p="NaN"),p!=="number"?[new Q(t,i,"number expected, "+p+" found")]:"minimum"in l&&i<l.minimum?[new Q(t,i,i+" is less than the minimum value "+l.minimum)]:"maximum"in l&&i>l.maximum?[new Q(t,i,i+" is greater than the maximum value "+l.maximum)]:[]}function rs(e){var t,i,l,p=e.valueSpec,d=Ne(e.value.type),_={},k=d!=="categorical"&&e.value.property===void 0,I=!k,z=Ur(e.value.stops)==="array"&&Ur(e.value.stops[0])==="array"&&Ur(e.value.stops[0][0])==="object",D=ye({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Z){if(d==="identity")return[new Q(Z.key,Z.value,'identity function may not have a "stops" property')];var Y=[],$=Z.value;return Y=Y.concat(ct({key:Z.key,value:$,valueSpec:Z.valueSpec,style:Z.style,styleSpec:Z.styleSpec,arrayElementValidator:R})),Ur($)==="array"&&$.length===0&&Y.push(new Q(Z.key,$,"array must have at least one stop")),Y},default:function(Z){return $t({key:Z.key,value:Z.value,valueSpec:p,style:Z.style,styleSpec:Z.styleSpec})}}});return d==="identity"&&k&&D.push(new Q(e.key,e.value,'missing required property "property"')),d==="identity"||e.value.stops||D.push(new Q(e.key,e.value,'missing required property "stops"')),d==="exponential"&&e.valueSpec.expression&&!gs(e.valueSpec)&&D.push(new Q(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(I&&!Ba(e.valueSpec)?D.push(new Q(e.key,e.value,"property functions not supported")):k&&!pa(e.valueSpec)&&D.push(new Q(e.key,e.value,"zoom functions not supported"))),d!=="categorical"&&!z||e.value.property!==void 0||D.push(new Q(e.key,e.value,'"property" property is required')),D;function R(Z){var Y=[],$=Z.value,le=Z.key;if(Ur($)!=="array")return[new Q(le,$,"array expected, "+Ur($)+" found")];if($.length!==2)return[new Q(le,$,"array length 2 expected, length "+$.length+" found")];if(z){if(Ur($[0])!=="object")return[new Q(le,$,"object expected, "+Ur($[0])+" found")];if($[0].zoom===void 0)return[new Q(le,$,"object stop key must have zoom")];if($[0].value===void 0)return[new Q(le,$,"object stop key must have value")];if(l&&l>Ne($[0].zoom))return[new Q(le,$[0].zoom,"stop zoom values must appear in ascending order")];Ne($[0].zoom)!==l&&(l=Ne($[0].zoom),i=void 0,_={}),Y=Y.concat(ye({key:le+"[0]",value:$[0],valueSpec:{zoom:{}},style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{zoom:Oa,value:U}}))}else Y=Y.concat(U({key:le+"[0]",value:$[0],valueSpec:{},style:Z.style,styleSpec:Z.styleSpec},$));return Fa(Se($[1]))?Y.concat([new Q(le+"[1]",$[1],"expressions are not allowed in function stops.")]):Y.concat($t({key:le+"[1]",value:$[1],valueSpec:p,style:Z.style,styleSpec:Z.styleSpec}))}function U(Z,Y){var $=Ur(Z.value),le=Ne(Z.value),ne=Z.value!==null?Z.value:Y;if(t){if($!==t)return[new Q(Z.key,ne,$+" stop domain type must match previous stop domain type "+t)]}else t=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new Q(Z.key,ne,"stop domain value must be a number, string, or boolean")];if($!=="number"&&d!=="categorical"){var fe="number expected, "+$+" found";return Ba(p)&&d===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Q(Z.key,ne,fe)]}return d!=="categorical"||$!=="number"||isFinite(le)&&Math.floor(le)===le?d!=="categorical"&&$==="number"&&i!==void 0&&le<i?[new Q(Z.key,ne,"stop domain values must appear in ascending order")]:(i=le,d==="categorical"&&le in _?[new Q(Z.key,ne,"stop domain values must be unique")]:(_[le]=!0,[])):[new Q(Z.key,ne,"integer expected, found "+le)]}}function _o(e){var t=(e.expressionContext==="property"?Ml:Bn)(Se(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(l){return new Q(""+e.key+l.key,e.value,l.message)});var i=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!i.outputDefined())return[new Q(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!de(i))return[new Q(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!de(i))return[new Q(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!ri(i,["zoom","feature-state"]))return[new Q(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!fo(i))return[new Q(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Io(e){var t=e.key,i=e.value,l=e.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(Ne(i))===-1&&p.push(new Q(t,i,"expected one of ["+l.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(l.values).indexOf(Ne(i))===-1&&p.push(new Q(t,i,"expected one of ["+Object.keys(l.values).join(", ")+"], "+JSON.stringify(i)+" found")),p}function da(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,i=e.slice(1);t<i.length;t+=1){var l=i[t];if(!da(l)&&typeof l!="boolean")return!1}return!0;default:return!0}}bi.deserialize=function(e){return new bi(e._parameters,e._specification)},bi.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Ao={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function jo(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};da(e)||(e=Jt(e));var t=Bn(e,Ao);if(t.result==="error")throw new Error(t.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,l,p){return t.value.evaluate(i,l,{},p)},needGeometry:function i(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(var p=1;p<l.length;p++)if(i(l[p]))return!0;return!1}(e)}}function is(e,t){return e<t?-1:e>t?1:0}function Jt(e){if(!e)return!0;var t,i=e[0];return e.length<=1?i!=="any":i==="=="?ma(e[1],e[2],"=="):i==="!="?vo(ma(e[1],e[2],"==")):i==="<"||i===">"||i==="<="||i===">="?ma(e[1],e[2],i):i==="any"?(t=e.slice(1),["any"].concat(t.map(Jt))):i==="all"?["all"].concat(e.slice(1).map(Jt)):i==="none"?["all"].concat(e.slice(1).map(Jt).map(vo)):i==="in"?ya(e[1],e.slice(2)):i==="!in"?vo(ya(e[1],e.slice(2))):i==="has"?Na(e[1]):i==="!has"?vo(Na(e[1])):i!=="within"||e}function ma(e,t,i){switch(e){case"$type":return["filter-type-"+i,t];case"$id":return["filter-id-"+i,t];default:return["filter-"+i,e,t]}}function ya(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(i){return typeof i!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(is)]]:["filter-in-small",e,["literal",t]]}}function Na(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function vo(e){return["!",e]}function zo(e){return da(Se(e.value))?_o(Be({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(i){var l=i.value,p=i.key;if(Ur(l)!=="array")return[new Q(p,l,"array expected, "+Ur(l)+" found")];var d,_=i.styleSpec,k=[];if(l.length<1)return[new Q(p,l,"filter array must have at least 1 element")];switch(k=k.concat(Io({key:p+"[0]",value:l[0],valueSpec:_.filter_operator,style:i.style,styleSpec:i.styleSpec})),Ne(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Ne(l[1])==="$type"&&k.push(new Q(p,l,'"$type" cannot be use with operator "'+l[0]+'"'));case"==":case"!=":l.length!==3&&k.push(new Q(p,l,'filter array for operator "'+l[0]+'" must have 3 elements'));case"in":case"!in":l.length>=2&&(d=Ur(l[1]))!=="string"&&k.push(new Q(p+"[1]",l[1],"string expected, "+d+" found"));for(var I=2;I<l.length;I++)d=Ur(l[I]),Ne(l[1])==="$type"?k=k.concat(Io({key:p+"["+I+"]",value:l[I],valueSpec:_.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&k.push(new Q(p+"["+I+"]",l[I],"string, number, or boolean expected, "+d+" found"));break;case"any":case"all":case"none":for(var z=1;z<l.length;z++)k=k.concat(t({key:p+"["+z+"]",value:l[z],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=Ur(l[1]),l.length!==2?k.push(new Q(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):d!=="string"&&k.push(new Q(p+"[1]",l[1],"string expected, "+d+" found"));break;case"within":d=Ur(l[1]),l.length!==2?k.push(new Q(p,l,'filter array for "'+l[0]+'" operator must have 2 elements')):d!=="object"&&k.push(new Q(p+"[1]",l[1],"object expected, "+d+" found"))}return k}(e)}function hl(e,t){var i=e.key,l=e.style,p=e.styleSpec,d=e.value,_=e.objectKey,k=p[t+"_"+e.layerType];if(!k)return[];var I=_.match(/^(.*)-transition$/);if(t==="paint"&&I&&k[I[1]]&&k[I[1]].transition)return $t({key:i,value:d,valueSpec:p.transition,style:l,styleSpec:p});var z,D=e.valueSpec||k[_];if(!D)return[new Q(i,d,'unknown property "'+_+'"')];if(Ur(d)==="string"&&Ba(D)&&!D.tokens&&(z=/^{([^}]+)}$/.exec(d)))return[new Q(i,d,'"'+_+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(z[1])+" }`.")];var R=[];return e.layerType==="symbol"&&(_==="text-field"&&l&&!l.glyphs&&R.push(new Q(i,d,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&qs(Se(d))&&Ne(d.type)==="identity"&&R.push(new Q(i,d,'"text-font" does not support identity functions'))),R.concat($t({key:e.key,value:d,valueSpec:D,style:l,styleSpec:p,expressionContext:"property",propertyType:t,propertyKey:_}))}function pl(e){return hl(e,"paint")}function Sn(e){return hl(e,"layout")}function Dl(e){var t=[],i=e.value,l=e.key,p=e.style,d=e.styleSpec;i.type||i.ref||t.push(new Q(l,i,'either "type" or "ref" is required'));var _,k=Ne(i.type),I=Ne(i.ref);if(i.id)for(var z=Ne(i.id),D=0;D<e.arrayIndex;D++){var R=p.layers[D];Ne(R.id)===z&&t.push(new Q(l,i.id,'duplicate layer id "'+i.id+'", previously used at line '+R.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(Y){Y in i&&t.push(new Q(l,i[Y],'"'+Y+'" is prohibited for ref layers'))}),p.layers.forEach(function(Y){Ne(Y.id)===I&&(_=Y)}),_?_.ref?t.push(new Q(l,i.ref,"ref cannot reference another ref layer")):k=Ne(_.type):t.push(new Q(l,i.ref,'ref layer "'+I+'" not found'));else if(k!=="background")if(i.source){var U=p.sources&&p.sources[i.source],Z=U&&Ne(U.type);U?Z==="vector"&&k==="raster"?t.push(new Q(l,i.source,'layer "'+i.id+'" requires a raster source')):Z==="raster"&&k!=="raster"?t.push(new Q(l,i.source,'layer "'+i.id+'" requires a vector source')):Z!=="vector"||i["source-layer"]?Z==="raster-dem"&&k!=="hillshade"?t.push(new Q(l,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!i.paint||!i.paint["line-gradient"]||Z==="geojson"&&U.lineMetrics||t.push(new Q(l,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Q(l,i,'layer "'+i.id+'" must specify a "source-layer"')):t.push(new Q(l,i.source,'source "'+i.source+'" not found'))}else t.push(new Q(l,i,'missing required property "source"'));return t=t.concat(ye({key:l,value:i,valueSpec:d.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return $t({key:l+".type",value:i.type,valueSpec:d.layer.type,style:e.style,styleSpec:e.styleSpec,object:i,objectKey:"type"})},filter:zo,layout:function(Y){return ye({layer:i,key:Y.key,value:Y.value,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{"*":function($){return Sn(Be({layerType:k},$))}}})},paint:function(Y){return ye({layer:i,key:Y.key,value:Y.value,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{"*":function($){return pl(Be({layerType:k},$))}}})}}}))}function Ua(e){var t=e.value,i=e.key,l=Ur(t);return l!=="string"?[new Q(i,t,"string expected, "+l+" found")]:[]}var Lr={promoteId:function(e){var t=e.key,i=e.value;if(Ur(i)==="string")return Ua({key:t,value:i});var l=[];for(var p in i)l.push.apply(l,Ua({key:t+"."+p,value:i[p]}));return l}};function Gs(e){var t=e.value,i=e.key,l=e.styleSpec,p=e.style;if(!t.type)return[new Q(i,t,'"type" is required')];var d,_=Ne(t.type);switch(_){case"vector":case"raster":case"raster-dem":return ye({key:i,value:t,valueSpec:l["source_"+_.replace("-","_")],style:e.style,styleSpec:l,objectElementValidators:Lr});case"geojson":if(d=ye({key:i,value:t,valueSpec:l.source_geojson,style:p,styleSpec:l,objectElementValidators:Lr}),t.cluster)for(var k in t.clusterProperties){var I=t.clusterProperties[k],z=I[0],D=typeof z=="string"?[z,["accumulated"],["get",k]]:z;d.push.apply(d,_o({key:i+"."+k+".map",value:I[1],expressionContext:"cluster-map"})),d.push.apply(d,_o({key:i+"."+k+".reduce",value:D,expressionContext:"cluster-reduce"}))}return d;case"video":return ye({key:i,value:t,valueSpec:l.source_video,style:p,styleSpec:l});case"image":return ye({key:i,value:t,valueSpec:l.source_image,style:p,styleSpec:l});case"canvas":return[new Q(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Io({key:i+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:l})}}function Va(e){var t=e.value,i=e.styleSpec,l=i.light,p=e.style,d=[],_=Ur(t);if(t===void 0)return d;if(_!=="object")return d.concat([new Q("light",t,"object expected, "+_+" found")]);for(var k in t){var I=k.match(/^(.*)-transition$/);d=d.concat(I&&l[I[1]]&&l[I[1]].transition?$t({key:k,value:t[k],valueSpec:i.transition,style:p,styleSpec:i}):l[k]?$t({key:k,value:t[k],valueSpec:l[k],style:p,styleSpec:i}):[new Q(k,t[k],'unknown property "'+k+'"')])}return d}var ga={"*":function(){return[]},array:ct,boolean:function(e){var t=e.value,i=e.key,l=Ur(t);return l!=="boolean"?[new Q(i,t,"boolean expected, "+l+" found")]:[]},number:Oa,color:function(e){var t=e.key,i=e.value,l=Ur(i);return l!=="string"?[new Q(t,i,"color expected, "+l+" found")]:Ut(i)===null?[new Q(t,i,'color expected, "'+i+'" found')]:[]},constants:me,enum:Io,filter:zo,function:rs,layer:Dl,object:ye,source:Gs,light:Va,string:Ua,formatted:function(e){return Ua(e).length===0?[]:_o(e)},resolvedImage:function(e){return Ua(e).length===0?[]:_o(e)}};function $t(e){var t=e.value,i=e.valueSpec,l=e.styleSpec;return i.expression&&qs(Ne(t))?rs(e):i.expression&&Fa(Se(t))?_o(e):i.type&&ga[i.type]?ga[i.type](e):ye(Be({},e,{valueSpec:i.type?l[i.type]:i}))}function Mr(e){var t=e.value,i=e.key,l=Ua(e);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Q(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Q(i,t,'"glyphs" url must include a "{range}" token'))),l}function Fn(e,t){t===void 0&&(t=j);var i=[];return i=i.concat($t({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Mr,"*":function(){return[]}}})),e.constants&&(i=i.concat(me({key:"constants",value:e.constants,style:e,styleSpec:t}))),_a(i)}function _a(e){return[].concat(e).sort(function(t,i){return t.line-i.line})}function va(e){return function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return _a(e.apply(this,t))}}Fn.source=va(Gs),Fn.light=va(Va),Fn.layer=va(Dl),Fn.filter=va(zo),Fn.paintProperty=va(pl),Fn.layoutProperty=va(Sn);var vs=Fn,ou=vs.light,Ks=vs.paintProperty,xs=vs.layoutProperty;function Po(e,t){var i=!1;if(t&&t.length)for(var l=0,p=t;l<p.length;l+=1)e.fire(new se(new Error(p[l].message))),i=!0;return i}var qo=ni;function ni(e,t,i){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var p=new Int32Array(this.arrayBuffer);e=p[0],this.d=(t=p[1])+2*(i=p[2]);for(var d=0;d<this.d*this.d;d++){var _=p[3+d],k=p[3+d+1];l.push(_===k?null:p.subarray(_,k))}var I=p[3+l.length+1];this.keys=p.subarray(p[3+l.length],I),this.bboxes=p.subarray(I),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var z=0;z<this.d*this.d;z++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=i,this.scale=t/e,this.uid=0;var D=i/t*e;this.min=-D,this.max=e+D}ni.prototype.insert=function(e,t,i,l,p){this._forEachCell(t,i,l,p,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(l),this.bboxes.push(p)},ni.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ni.prototype._insertCell=function(e,t,i,l,p,d){this.cells[p].push(d)},ni.prototype.query=function(e,t,i,l,p){var d=this.min,_=this.max;if(e<=d&&t<=d&&_<=i&&_<=l&&!p)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(e,t,i,l,this._queryCell,k,{},p),k},ni.prototype._queryCell=function(e,t,i,l,p,d,_,k){var I=this.cells[p];if(I!==null)for(var z=this.keys,D=this.bboxes,R=0;R<I.length;R++){var U=I[R];if(_[U]===void 0){var Z=4*U;(k?k(D[Z+0],D[Z+1],D[Z+2],D[Z+3]):e<=D[Z+2]&&t<=D[Z+3]&&i>=D[Z+0]&&l>=D[Z+1])?(_[U]=!0,d.push(z[U])):_[U]=!1}}},ni.prototype._forEachCell=function(e,t,i,l,p,d,_,k){for(var I=this._convertToCellCoord(e),z=this._convertToCellCoord(t),D=this._convertToCellCoord(i),R=this._convertToCellCoord(l),U=I;U<=D;U++)for(var Z=z;Z<=R;Z++){var Y=this.d*Z+U;if((!k||k(this._convertFromCellCoord(U),this._convertFromCellCoord(Z),this._convertFromCellCoord(U+1),this._convertFromCellCoord(Z+1)))&&p.call(this,e,t,i,l,Y,d,_,k))return}},ni.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},ni.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},ni.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,i=0,l=0;l<this.cells.length;l++)i+=this.cells[l].length;var p=new Int32Array(t+i+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var d=t,_=0;_<e.length;_++){var k=e[_];p[3+_]=d,p.set(k,d),d+=k.length}return p[3+e.length]=d,p.set(this.keys,d),p[3+e.length+1]=d+=this.keys.length,p.set(this.bboxes,d),d+=this.bboxes.length,p.buffer};var kn=B.ImageData,Ll=B.ImageBitmap,li={};function at(e,t,i){i===void 0&&(i={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),li[e]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}for(var Ai in at("Object",Object),qo.serialize=function(e,t){var i=e.toArrayBuffer();return t&&t.push(i),{buffer:i}},qo.deserialize=function(e){return new qo(e.buffer)},at("Grid",qo),at("Color",Dt),at("Error",Error),at("ResolvedImage",hi),at("StylePropertyFunction",bi),at("StyleExpression",ts,{omit:["_evaluator"]}),at("ZoomDependentExpression",to),at("ZoomConstantExpression",_s),at("CompoundExpression",Jr,{omit:["_evaluate"]}),Da)Da[Ai]._classRegistryKey||at("Expression_"+Ai,Da[Ai]);function Xs(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function ns(e){return Ll&&e instanceof Ll}function En(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Xs(e)||ns(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var i=e;return t&&t.push(i.buffer),i}if(e instanceof kn)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var l=[],p=0,d=e;p<d.length;p+=1)l.push(En(d[p],t));return l}if(typeof e=="object"){var _=e.constructor,k=_._classRegistryKey;if(!k)throw new Error("can't serialize object of unregistered class");var I=_.serialize?_.serialize(e,t):{};if(!_.serialize){for(var z in e)if(e.hasOwnProperty(z)&&!(li[k].omit.indexOf(z)>=0)){var D=e[z];I[z]=li[k].shallow.indexOf(z)>=0?D:En(D,t)}e instanceof Error&&(I.message=e.message)}if(I.$name)throw new Error("$name property is reserved for worker serialization logic.");return k!=="Object"&&(I.$name=k),I}throw new Error("can't serialize object of type "+typeof e)}function Tn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Xs(e)||ns(e)||ArrayBuffer.isView(e)||e instanceof kn)return e;if(Array.isArray(e))return e.map(Tn);if(typeof e=="object"){var t=e.$name||"Object",i=li[t].klass;if(!i)throw new Error("can't deserialize unregistered class "+t);if(i.deserialize)return i.deserialize(e);for(var l=Object.create(i.prototype),p=0,d=Object.keys(e);p<d.length;p+=1){var _=d[p];if(_!=="$name"){var k=e[_];l[_]=li[t].shallow.indexOf(_)>=0?k:Tn(k)}}return l}throw new Error("can't deserialize object of type "+typeof e)}var os=function(){this.first=!0};os.prototype.update=function(e,t){var i=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=i,!0))};var Ye={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function as(e){for(var t=0,i=e;t<i.length;t+=1)if(Ws(i[t].charCodeAt(0)))return!0;return!1}function Ws(e){return!(e!==746&&e!==747&&(e<4352||!(Ye["Bopomofo Extended"](e)||Ye.Bopomofo(e)||Ye["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Ye["CJK Compatibility Ideographs"](e)||Ye["CJK Compatibility"](e)||Ye["CJK Radicals Supplement"](e)||Ye["CJK Strokes"](e)||!(!Ye["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Ye["CJK Unified Ideographs Extension A"](e)||Ye["CJK Unified Ideographs"](e)||Ye["Enclosed CJK Letters and Months"](e)||Ye["Hangul Compatibility Jamo"](e)||Ye["Hangul Jamo Extended-A"](e)||Ye["Hangul Jamo Extended-B"](e)||Ye["Hangul Jamo"](e)||Ye["Hangul Syllables"](e)||Ye.Hiragana(e)||Ye["Ideographic Description Characters"](e)||Ye.Kanbun(e)||Ye["Kangxi Radicals"](e)||Ye["Katakana Phonetic Extensions"](e)||Ye.Katakana(e)&&e!==12540||!(!Ye["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Ye["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Ye["Unified Canadian Aboriginal Syllabics"](e)||Ye["Unified Canadian Aboriginal Syllabics Extended"](e)||Ye["Vertical Forms"](e)||Ye["Yijing Hexagram Symbols"](e)||Ye["Yi Syllables"](e)||Ye["Yi Radicals"](e))))}function ss(e){return!(Ws(e)||function(t){return!!(Ye["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ye["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ye["Letterlike Symbols"](t)||Ye["Number Forms"](t)||Ye["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ye["Control Pictures"](t)&&t!==9251||Ye["Optical Character Recognition"](t)||Ye["Enclosed Alphanumerics"](t)||Ye["Geometric Shapes"](t)||Ye["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ye["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ye["CJK Symbols and Punctuation"](t)||Ye.Katakana(t)||Ye["Private Use Area"](t)||Ye["CJK Compatibility Forms"](t)||Ye["Small Form Variants"](t)||Ye["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function ro(e){return e>=1424&&e<=2303||Ye["Arabic Presentation Forms-A"](e)||Ye["Arabic Presentation Forms-B"](e)}function Zi(e,t){return!(!t&&ro(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Ye.Khmer(e))}function Hs(e){for(var t=0,i=e;t<i.length;t+=1)if(ro(i[t].charCodeAt(0)))return!0;return!1}var ja=null,In="unavailable",io=null,Rl=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(In="error"),ja&&ja(e)};function Bl(){Wu.fire(new J("pluginStateChange",{pluginStatus:In,pluginURL:io}))}var Wu=new he,Hu=function(){return In},xa=function(){if(In!=="deferred"||!io)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");In="loading",Bl(),io&&Dn({url:io},function(e){e?Rl(e):(In="loaded",Bl())})},Co={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return In==="loaded"||Co.applyArabicShaping!=null},isLoading:function(){return In==="loading"},setState:function(e){In=e.pluginStatus,io=e.pluginURL},isParsed:function(){return Co.applyArabicShaping!=null&&Co.processBidirectionalText!=null&&Co.processStyledBidirectionalText!=null},getPluginURL:function(){return io}},ir=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new os,this.transition={})};ir.prototype.isSupportedScript=function(e){return function(t,i){for(var l=0,p=t;l<p.length;l+=1)if(!Zi(p[l].charCodeAt(0),i))return!1;return!0}(e,Co.isLoaded())},ir.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ir.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),i=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*t}};var qa=function(e,t){this.property=e,this.value=t,this.expression=function(i,l){if(qs(i))return new bi(i,l);if(Fa(i)){var p=Ml(i,l);if(p.result==="error")throw new Error(p.value.map(function(_){return _.key+": "+_.message}).join(", "));return p.value}var d=i;return typeof i=="string"&&l.type==="color"&&(d=Dt.parse(i)),{kind:"constant",evaluate:function(){return d}}}(t===void 0?e.specification.default:t,e.specification)};qa.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},qa.prototype.possiblyEvaluate=function(e,t,i){return this.property.possiblyEvaluate(this,e,t,i)};var Zo=function(e){this.property=e,this.value=new qa(e,void 0)};Zo.prototype.transitioned=function(e,t){return new Js(this.property,this.value,t,Me({},e.transition,this.transition),e.now)},Zo.prototype.untransitioned=function(){return new Js(this.property,this.value,null,{},0)};var fn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};fn.prototype.getValue=function(e){return gt(this._values[e].value.value)},fn.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Zo(this._values[e].property)),this._values[e].value=new qa(this._values[e].property,t===null?void 0:gt(t))},fn.prototype.getTransition=function(e){return gt(this._values[e].transition)},fn.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Zo(this._values[e].property)),this._values[e].transition=gt(t)||void 0},fn.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p);var d=this.getTransition(l);d!==void 0&&(e[l+"-transition"]=d)}return e},fn.prototype.transitioned=function(e,t){for(var i=new bs(this._properties),l=0,p=Object.keys(this._values);l<p.length;l+=1){var d=p[l];i._values[d]=this._values[d].transitioned(e,t._values[d])}return i},fn.prototype.untransitioned=function(){for(var e=new bs(this._properties),t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t];e._values[l]=this._values[l].untransitioned()}return e};var Js=function(e,t,i,l,p){this.property=e,this.value=t,this.begin=p+l.delay||0,this.end=this.begin+l.duration||0,e.specification.transition&&(l.delay||l.duration)&&(this.prior=i)};Js.prototype.possiblyEvaluate=function(e,t,i){var l=e.now||0,p=this.value.possiblyEvaluate(e,t,i),d=this.prior;if(d){if(l>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(l<this.begin)return d.possiblyEvaluate(e,t,i);var _=(l-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(e,t,i),p,function(k){if(k<=0)return 0;if(k>=1)return 1;var I=k*k,z=I*k;return 4*(k<.5?z:3*(k-I)+z-.75)}(_))}return p};var bs=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};bs.prototype.possiblyEvaluate=function(e,t,i){for(var l=new Fl(this._properties),p=0,d=Object.keys(this._values);p<d.length;p+=1){var _=d[p];l._values[_]=this._values[_].possiblyEvaluate(e,t,i)}return l},bs.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ba=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ba.prototype.getValue=function(e){return gt(this._values[e].value)},ba.prototype.setValue=function(e,t){this._values[e]=new qa(this._values[e].property,t===null?void 0:gt(t))},ba.prototype.serialize=function(){for(var e={},t=0,i=Object.keys(this._values);t<i.length;t+=1){var l=i[t],p=this.getValue(l);p!==void 0&&(e[l]=p)}return e},ba.prototype.possiblyEvaluate=function(e,t,i){for(var l=new Fl(this._properties),p=0,d=Object.keys(this._values);p<d.length;p+=1){var _=d[p];l._values[_]=this._values[_].possiblyEvaluate(e,t,i)}return l};var On=function(e,t,i){this.property=e,this.value=t,this.parameters=i};On.prototype.isConstant=function(){return this.value.kind==="constant"},On.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},On.prototype.evaluate=function(e,t,i,l){return this.property.evaluate(this.value,this.parameters,e,t,i,l)};var Fl=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Fl.prototype.get=function(e){return this._values[e]};var bt=function(e){this.specification=e};bt.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},bt.prototype.interpolate=function(e,t,i){var l=Aa[this.specification.type];return l?l(e,t,i):e};var dt=function(e,t){this.specification=e,this.overrides=t};dt.prototype.possiblyEvaluate=function(e,t,i,l){return new On(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},i,l)}:e.expression,t)},dt.prototype.interpolate=function(e,t,i){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new On(this,{kind:"constant",value:void 0},e.parameters);var l=Aa[this.specification.type];return l?new On(this,{kind:"constant",value:l(e.value.value,t.value.value,i)},e.parameters):e},dt.prototype.evaluate=function(e,t,i,l,p,d){return e.kind==="constant"?e.value:e.evaluate(t,i,l,p,d)};var au=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l,p,d){if(i.value===void 0)return new On(this,{kind:"constant",value:void 0},l);if(i.expression.kind==="constant"){var _=i.expression.evaluate(l,null,{},p,d),k=i.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,I=this._calculate(k,k,k,l);return new On(this,{kind:"constant",value:I},l)}if(i.expression.kind==="camera"){var z=this._calculate(i.expression.evaluate({zoom:l.zoom-1}),i.expression.evaluate({zoom:l.zoom}),i.expression.evaluate({zoom:l.zoom+1}),l);return new On(this,{kind:"constant",value:z},l)}return new On(this,i.expression,l)},t.prototype.evaluate=function(i,l,p,d,_,k){if(i.kind==="source"){var I=i.evaluate(l,p,d,_,k);return this._calculate(I,I,I,l)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(l.zoom)-1},p,d),i.evaluate({zoom:Math.floor(l.zoom)},p,d),i.evaluate({zoom:Math.floor(l.zoom)+1},p,d),l):i.value},t.prototype._calculate=function(i,l,p,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:i,to:l}:{from:p,to:l}},t.prototype.interpolate=function(i){return i},t}(dt),Nn=function(e){this.specification=e};Nn.prototype.possiblyEvaluate=function(e,t,i,l){if(e.value!==void 0){if(e.expression.kind==="constant"){var p=e.expression.evaluate(t,null,{},i,l);return this._calculate(p,p,p,t)}return this._calculate(e.expression.evaluate(new ir(Math.floor(t.zoom-1),t)),e.expression.evaluate(new ir(Math.floor(t.zoom),t)),e.expression.evaluate(new ir(Math.floor(t.zoom+1),t)),t)}},Nn.prototype._calculate=function(e,t,i,l){return l.zoom>l.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:i,to:t}},Nn.prototype.interpolate=function(e){return e};var wa=function(e){this.specification=e};wa.prototype.possiblyEvaluate=function(e,t,i,l){return!!e.expression.evaluate(t,null,{},i,l)},wa.prototype.interpolate=function(){return!1};var dn=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var i=e[t];i.specification.overridable&&this.overridableProperties.push(t);var l=this.defaultPropertyValues[t]=new qa(i,void 0),p=this.defaultTransitionablePropertyValues[t]=new Zo(i);this.defaultTransitioningPropertyValues[t]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=l.possiblyEvaluate({})}};at("DataDrivenProperty",dt),at("DataConstantProperty",bt),at("CrossFadedDataDrivenProperty",au),at("CrossFadedProperty",Nn),at("ColorRampProperty",wa);var Za=function(e){function t(i,l){if(e.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),l.layout&&(this._unevaluatedLayout=new ba(l.layout)),l.paint)){for(var p in this._transitionablePaint=new fn(l.paint),i.paint)this.setPaintProperty(p,i.paint[p],{validate:!1});for(var d in i.layout)this.setLayoutProperty(d,i.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fl(l.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},t.prototype.setLayoutProperty=function(i,l,p){p===void 0&&(p={}),l!=null&&this._validate(xs,"layers."+this.id+".layout."+i,i,l,p)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,l):this.visibility=l)},t.prototype.getPaintProperty=function(i){return cr(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},t.prototype.setPaintProperty=function(i,l,p){if(p===void 0&&(p={}),l!=null&&this._validate(Ks,"layers."+this.id+".paint."+i,i,l,p))return!1;if(cr(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),l||void 0),!1;var d=this._transitionablePaint._values[i],_=d.property.specification["property-type"]==="cross-faded-data-driven",k=d.value.isDataDriven(),I=d.value;this._transitionablePaint.setValue(i,l),this._handleSpecialPaintPropertyUpdate(i);var z=this._transitionablePaint._values[i].value;return z.isDataDriven()||k||_||this._handleOverridablePaintPropertyUpdate(i,I,z)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!1},t.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(i,l){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)},t.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),hr(i,function(l,p){return!(l===void 0||p==="layout"&&!Object.keys(l).length||p==="paint"&&!Object.keys(l).length)})},t.prototype._validate=function(i,l,p,d,_){return _===void 0&&(_={}),(!_||_.validate!==!1)&&Po(this,i.call(vs,{key:l,layerType:this.type,objectKey:p,value:d,styleSpec:j,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var i in this.paint._values){var l=this.paint.get(i);if(l instanceof On&&Ba(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1},t}(he),Ju={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},su=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Pr=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function $i(e,t){t===void 0&&(t=1);var i=0,l=0;return{members:e.map(function(p){var d=Ju[p.type].BYTES_PER_ELEMENT,_=i=qc(i,Math.max(t,d)),k=p.components||1;return l=Math.max(l,d),i+=d*k,{name:p.name,type:p.type,components:k,offset:_}}),size:qc(i,Math.max(l,t)),alignment:t}}function qc(e,t){return Math.ceil(e/t)*t}Pr.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Pr.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Pr.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Pr.prototype.clear=function(){this.length=0},Pr.prototype.resize=function(e){this.reserve(e),this.length=e},Pr.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Pr.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Ys=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.int16[d+0]=l,this.int16[d+1]=p,i},t}(Pr);Ys.prototype.bytesPerElement=4,at("StructArrayLayout2i4",Ys);var Yu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var k=4*i;return this.int16[k+0]=l,this.int16[k+1]=p,this.int16[k+2]=d,this.int16[k+3]=_,i},t}(Pr);Yu.prototype.bytesPerElement=8,at("StructArrayLayout4i8",Yu);var ls=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,p,d,_,k)},t.prototype.emplace=function(i,l,p,d,_,k,I){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.int16[z+2]=d,this.int16[z+3]=_,this.int16[z+4]=k,this.int16[z+5]=I,i},t}(Pr);ls.prototype.bytesPerElement=12,at("StructArrayLayout2i4i12",ls);var xo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,p,d,_,k)},t.prototype.emplace=function(i,l,p,d,_,k,I){var z=4*i,D=8*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.uint8[D+4]=d,this.uint8[D+5]=_,this.uint8[D+6]=k,this.uint8[D+7]=I,i},t}(Pr);xo.prototype.bytesPerElement=8,at("StructArrayLayout2i4ub8",xo);var fl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.float32[d+0]=l,this.float32[d+1]=p,i},t}(Pr);fl.prototype.bytesPerElement=8,at("StructArrayLayout2f8",fl);var Ga=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,I,z,D,R){var U=this.length;return this.resize(U+1),this.emplace(U,i,l,p,d,_,k,I,z,D,R)},t.prototype.emplace=function(i,l,p,d,_,k,I,z,D,R,U){var Z=10*i;return this.uint16[Z+0]=l,this.uint16[Z+1]=p,this.uint16[Z+2]=d,this.uint16[Z+3]=_,this.uint16[Z+4]=k,this.uint16[Z+5]=I,this.uint16[Z+6]=z,this.uint16[Z+7]=D,this.uint16[Z+8]=R,this.uint16[Z+9]=U,i},t}(Pr);Ga.prototype.bytesPerElement=20,at("StructArrayLayout10ui20",Ga);var lu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,I,z,D,R,U,Z){var Y=this.length;return this.resize(Y+1),this.emplace(Y,i,l,p,d,_,k,I,z,D,R,U,Z)},t.prototype.emplace=function(i,l,p,d,_,k,I,z,D,R,U,Z,Y){var $=12*i;return this.int16[$+0]=l,this.int16[$+1]=p,this.int16[$+2]=d,this.int16[$+3]=_,this.uint16[$+4]=k,this.uint16[$+5]=I,this.uint16[$+6]=z,this.uint16[$+7]=D,this.int16[$+8]=R,this.int16[$+9]=U,this.int16[$+10]=Z,this.int16[$+11]=Y,i},t}(Pr);lu.prototype.bytesPerElement=24,at("StructArrayLayout4i4ui4i24",lu);var dl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.float32[_+0]=l,this.float32[_+1]=p,this.float32[_+2]=d,i},t}(Pr);dl.prototype.bytesPerElement=12,at("StructArrayLayout3f12",dl);var Ol=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint32[1*i+0]=l,i},t}(Pr);Ol.prototype.bytesPerElement=4,at("StructArrayLayout1ul4",Ol);var Qu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,I,z,D){var R=this.length;return this.resize(R+1),this.emplace(R,i,l,p,d,_,k,I,z,D)},t.prototype.emplace=function(i,l,p,d,_,k,I,z,D,R){var U=10*i,Z=5*i;return this.int16[U+0]=l,this.int16[U+1]=p,this.int16[U+2]=d,this.int16[U+3]=_,this.int16[U+4]=k,this.int16[U+5]=I,this.uint32[Z+3]=z,this.uint16[U+8]=D,this.uint16[U+9]=R,i},t}(Pr);Qu.prototype.bytesPerElement=20,at("StructArrayLayout6i1ul2ui20",Qu);var ml=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k){var I=this.length;return this.resize(I+1),this.emplace(I,i,l,p,d,_,k)},t.prototype.emplace=function(i,l,p,d,_,k,I){var z=6*i;return this.int16[z+0]=l,this.int16[z+1]=p,this.int16[z+2]=d,this.int16[z+3]=_,this.int16[z+4]=k,this.int16[z+5]=I,i},t}(Pr);ml.prototype.bytesPerElement=12,at("StructArrayLayout2i2i2i12",ml);var Qs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_){var k=this.length;return this.resize(k+1),this.emplace(k,i,l,p,d,_)},t.prototype.emplace=function(i,l,p,d,_,k){var I=4*i,z=8*i;return this.float32[I+0]=l,this.float32[I+1]=p,this.float32[I+2]=d,this.int16[z+6]=_,this.int16[z+7]=k,i},t}(Pr);Qs.prototype.bytesPerElement=16,at("StructArrayLayout2f1f2i16",Qs);var $u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var k=12*i,I=3*i;return this.uint8[k+0]=l,this.uint8[k+1]=p,this.float32[I+1]=d,this.float32[I+2]=_,i},t}(Pr);$u.prototype.bytesPerElement=12,at("StructArrayLayout2ub2f12",$u);var ws=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.uint16[_+0]=l,this.uint16[_+1]=p,this.uint16[_+2]=d,i},t}(Pr);ws.prototype.bytesPerElement=6,at("StructArrayLayout3ui6",ws);var Ss=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,I,z,D,R,U,Z,Y,$,le,ne,fe){var _e=this.length;return this.resize(_e+1),this.emplace(_e,i,l,p,d,_,k,I,z,D,R,U,Z,Y,$,le,ne,fe)},t.prototype.emplace=function(i,l,p,d,_,k,I,z,D,R,U,Z,Y,$,le,ne,fe,_e){var xe=24*i,ke=12*i,Re=48*i;return this.int16[xe+0]=l,this.int16[xe+1]=p,this.uint16[xe+2]=d,this.uint16[xe+3]=_,this.uint32[ke+2]=k,this.uint32[ke+3]=I,this.uint32[ke+4]=z,this.uint16[xe+10]=D,this.uint16[xe+11]=R,this.uint16[xe+12]=U,this.float32[ke+7]=Z,this.float32[ke+8]=Y,this.uint8[Re+36]=$,this.uint8[Re+37]=le,this.uint8[Re+38]=ne,this.uint32[ke+10]=fe,this.int16[xe+22]=_e,i},t}(Pr);Ss.prototype.bytesPerElement=48,at("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ss);var uu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d,_,k,I,z,D,R,U,Z,Y,$,le,ne,fe,_e,xe,ke,Re,qe,Je,_t,tt,St,it,Yt){var At=this.length;return this.resize(At+1),this.emplace(At,i,l,p,d,_,k,I,z,D,R,U,Z,Y,$,le,ne,fe,_e,xe,ke,Re,qe,Je,_t,tt,St,it,Yt)},t.prototype.emplace=function(i,l,p,d,_,k,I,z,D,R,U,Z,Y,$,le,ne,fe,_e,xe,ke,Re,qe,Je,_t,tt,St,it,Yt,At){var mt=34*i,rr=17*i;return this.int16[mt+0]=l,this.int16[mt+1]=p,this.int16[mt+2]=d,this.int16[mt+3]=_,this.int16[mt+4]=k,this.int16[mt+5]=I,this.int16[mt+6]=z,this.int16[mt+7]=D,this.uint16[mt+8]=R,this.uint16[mt+9]=U,this.uint16[mt+10]=Z,this.uint16[mt+11]=Y,this.uint16[mt+12]=$,this.uint16[mt+13]=le,this.uint16[mt+14]=ne,this.uint16[mt+15]=fe,this.uint16[mt+16]=_e,this.uint16[mt+17]=xe,this.uint16[mt+18]=ke,this.uint16[mt+19]=Re,this.uint16[mt+20]=qe,this.uint16[mt+21]=Je,this.uint16[mt+22]=_t,this.uint32[rr+12]=tt,this.float32[rr+13]=St,this.float32[rr+14]=it,this.float32[rr+15]=Yt,this.float32[rr+16]=At,i},t}(Pr);uu.prototype.bytesPerElement=68,at("StructArrayLayout8i15ui1ul4f68",uu);var ks=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.float32[1*i+0]=l,i},t}(Pr);ks.prototype.bytesPerElement=4,at("StructArrayLayout1f4",ks);var Go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=3*i;return this.int16[_+0]=l,this.int16[_+1]=p,this.int16[_+2]=d,i},t}(Pr);Go.prototype.bytesPerElement=6,at("StructArrayLayout3i6",Go);var ec=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,l,p)},t.prototype.emplace=function(i,l,p,d){var _=4*i;return this.uint32[2*i+0]=l,this.uint16[_+2]=p,this.uint16[_+3]=d,i},t}(Pr);ec.prototype.bytesPerElement=8,at("StructArrayLayout1ul2ui8",ec);var Nl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l){var p=this.length;return this.resize(p+1),this.emplace(p,i,l)},t.prototype.emplace=function(i,l,p){var d=2*i;return this.uint16[d+0]=l,this.uint16[d+1]=p,i},t}(Pr);Nl.prototype.bytesPerElement=4,at("StructArrayLayout2ui4",Nl);var tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i){var l=this.length;return this.resize(l+1),this.emplace(l,i)},t.prototype.emplace=function(i,l){return this.uint16[1*i+0]=l,i},t}(Pr);tc.prototype.bytesPerElement=2,at("StructArrayLayout1ui2",tc);var cu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(i,l,p,d){var _=this.length;return this.resize(_+1),this.emplace(_,i,l,p,d)},t.prototype.emplace=function(i,l,p,d,_){var k=4*i;return this.float32[k+0]=l,this.float32[k+1]=p,this.float32[k+2]=d,this.float32[k+3]=_,i},t}(Pr);cu.prototype.bytesPerElement=16,at("StructArrayLayout4f16",cu);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new M(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,i),t}(su);n.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new n(this,i)},t}(Qu);at("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(l){this._structArray.uint8[this._pos1+37]=l},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(l){this._structArray.uint8[this._pos1+38]=l},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+10]=l},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,i),t}(su);o.prototype.size=48;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new o(this,i)},t}(Ss);at("PlacedSymbolArray",u);var m=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(l){this._structArray.uint32[this._pos4+12]=l},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,i),t}(su);m.prototype.size=68;var x=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new m(this,i)},t}(uu);at("SymbolInstanceArray",x);var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(i){return this.float32[1*i+0]},t}(ks);at("GlyphOffsetArray",S);var T=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(i){return this.int16[3*i+0]},t.prototype.gety=function(i){return this.int16[3*i+1]},t.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},t}(Go);at("SymbolLineVertexArray",T);var C=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,i),t}(su);C.prototype.size=8;var F=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(i){return new C(this,i)},t}(ec);at("FeatureIndexArray",F);var G=$i([{name:"a_pos",components:2,type:"Int16"}],4).members,K=function(e){e===void 0&&(e=[]),this.segments=e};function X(e,t){return 256*(e=Ae(Math.floor(e),0,255))+Ae(Math.floor(t),0,255)}K.prototype.prepareSegment=function(e,t,i,l){var p=this.segments[this.segments.length-1];return e>K.MAX_VERTEX_ARRAY_LENGTH&&xt("Max vertices per segment is "+K.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!p||p.vertexLength+e>K.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==l)&&(p={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},l!==void 0&&(p.sortKey=l),this.segments.push(p)),p},K.prototype.get=function(){return this.segments},K.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var i=t[e];for(var l in i.vaos)i.vaos[l].destroy()}},K.simpleSegment=function(e,t,i,l){return new K([{vertexOffset:e,primitiveOffset:t,vertexLength:i,primitiveLength:l,vaos:{},sortKey:0}])},K.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,at("SegmentVector",K);var te=$i([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ee=A(function(e){e.exports=function(t,i){var l,p,d,_,k,I,z,D;for(p=t.length-(l=3&t.length),d=i,k=3432918353,I=461845907,D=0;D<p;)z=255&t.charCodeAt(D)|(255&t.charCodeAt(++D))<<8|(255&t.charCodeAt(++D))<<16|(255&t.charCodeAt(++D))<<24,++D,d=27492+(65535&(_=5*(65535&(d=(d^=z=(65535&(z=(z=(65535&z)*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*I+(((z>>>16)*I&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(z=0,l){case 3:z^=(255&t.charCodeAt(D+2))<<16;case 2:z^=(255&t.charCodeAt(D+1))<<8;case 1:d^=z=(65535&(z=(z=(65535&(z^=255&t.charCodeAt(D)))*k+(((z>>>16)*k&65535)<<16)&4294967295)<<15|z>>>17))*I+(((z>>>16)*I&65535)<<16)&4294967295}return d^=t.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}}),ae=A(function(e){e.exports=function(t,i){for(var l,p=t.length,d=i^p,_=0;p>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(_)|(255&t.charCodeAt(++_))<<8|(255&t.charCodeAt(++_))<<16|(255&t.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),p-=4,++_;switch(p){case 3:d^=(255&t.charCodeAt(_+2))<<16;case 2:d^=(255&t.charCodeAt(_+1))<<8;case 1:d=1540483477*(65535&(d^=255&t.charCodeAt(_)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0}}),H=ee,oe=ae;H.murmur3=ee,H.murmur2=oe;var pe=function(){this.ids=[],this.positions=[],this.indexed=!1};pe.prototype.add=function(e,t,i,l){this.ids.push(Ee(e)),this.positions.push(t,i,l)},pe.prototype.getPositions=function(e){for(var t=Ee(e),i=0,l=this.ids.length-1;i<l;){var p=i+l>>1;this.ids[p]>=t?l=p:i=p+1}for(var d=[];this.ids[i]===t;)d.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return d},pe.serialize=function(e,t){var i=new Float64Array(e.ids),l=new Uint32Array(e.positions);return function p(d,_,k,I){for(;k<I;){for(var z=d[k+I>>1],D=k-1,R=I+1;;){do D++;while(d[D]<z);do R--;while(d[R]>z);if(D>=R)break;be(d,D,R),be(_,3*D,3*R),be(_,3*D+1,3*R+1),be(_,3*D+2,3*R+2)}R-k<I-R?(p(d,_,k,R),k=R+1):(p(d,_,R+1,I),I=R)}}(i,l,0,i.length-1),t&&t.push(i.buffer,l.buffer),{ids:i,positions:l}},pe.deserialize=function(e){var t=new pe;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ge=Math.pow(2,53)-1;function Ee(e){var t=+e;return!isNaN(t)&&t<=ge?t:H(String(e))}function be(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}at("FeaturePositionMap",pe);var Te=function(e,t){this.gl=e.gl,this.location=t},Ue=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},t}(Te),Xe=function(e){function t(i,l){e.call(this,i,l),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},t}(Te),Ke=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},t}(Te),ot=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},t}(Te),wt=function(e){function t(i,l){e.call(this,i,l),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},t}(Te),Tt=function(e){function t(i,l){e.call(this,i,l),this.current=Dt.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},t}(Te),Et=new Float32Array(16),fr=function(e){function t(i,l){e.call(this,i,l),this.current=Et}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var l=1;l<16;l++)if(i[l]!==this.current[l]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},t}(Te);function ut(e){return[X(255*e.r,255*e.g),X(255*e.b,255*e.a)]}var Bt=function(e,t,i){this.value=e,this.uniformNames=t.map(function(l){return"u_"+l}),this.type=i};Bt.prototype.setUniform=function(e,t,i){e.set(i.constantOr(this.value))},Bt.prototype.getBinding=function(e,t,i){return this.type==="color"?new Tt(e,t):new Xe(e,t)};var Ht=function(e,t){this.uniformNames=t.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ht.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Ht.prototype.setUniform=function(e,t,i,l){var p=l==="u_pattern_to"?this.patternTo:l==="u_pattern_from"?this.patternFrom:l==="u_pixel_ratio_to"?this.pixelRatioTo:l==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&e.set(p)},Ht.prototype.getBinding=function(e,t,i){return i.substr(0,9)==="u_pattern"?new wt(e,t):new Xe(e,t)};var Rt=function(e,t,i,l){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=t.map(function(p){return{name:"a_"+p,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new l};Rt.prototype.populatePaintArray=function(e,t,i,l,p){var d=this.paintVertexArray.length,_=this.expression.evaluate(new ir(0),t,{},l,[],p);this.paintVertexArray.resize(e),this._setPaintValue(d,e,_)},Rt.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:0},i,l);this._setPaintValue(e,t,p)},Rt.prototype._setPaintValue=function(e,t,i){if(this.type==="color")for(var l=ut(i),p=e;p<t;p++)this.paintVertexArray.emplace(p,l[0],l[1]);else{for(var d=e;d<t;d++)this.paintVertexArray.emplace(d,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},Rt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Rt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Lt=function(e,t,i,l,p,d){this.expression=e,this.uniformNames=t.map(function(_){return"u_"+_+"_t"}),this.type=i,this.useIntegerZoom=l,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=t.map(function(_){return{name:"a_"+_,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new d};Lt.prototype.populatePaintArray=function(e,t,i,l,p){var d=this.expression.evaluate(new ir(this.zoom),t,{},l,[],p),_=this.expression.evaluate(new ir(this.zoom+1),t,{},l,[],p),k=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(k,e,d,_)},Lt.prototype.updatePaintArray=function(e,t,i,l){var p=this.expression.evaluate({zoom:this.zoom},i,l),d=this.expression.evaluate({zoom:this.zoom+1},i,l);this._setPaintValue(e,t,p,d)},Lt.prototype._setPaintValue=function(e,t,i,l){if(this.type==="color")for(var p=ut(i),d=ut(l),_=e;_<t;_++)this.paintVertexArray.emplace(_,p[0],p[1],d[0],d[1]);else{for(var k=e;k<t;k++)this.paintVertexArray.emplace(k,i,l);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(l))}},Lt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Lt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Lt.prototype.setUniform=function(e,t){var i=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,l=Ae(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);e.set(l)},Lt.prototype.getBinding=function(e,t,i){return new Xe(e,t)};var Wt=function(e,t,i,l,p,d){this.expression=e,this.type=t,this.useIntegerZoom=i,this.zoom=l,this.layerId=d,this.zoomInPaintVertexArray=new p,this.zoomOutPaintVertexArray=new p};Wt.prototype.populatePaintArray=function(e,t,i){var l=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(l,e,t.patterns&&t.patterns[this.layerId],i)},Wt.prototype.updatePaintArray=function(e,t,i,l,p){this._setPaintValues(e,t,i.patterns&&i.patterns[this.layerId],p)},Wt.prototype._setPaintValues=function(e,t,i,l){if(l&&i){var p=l[i.min],d=l[i.mid],_=l[i.max];if(p&&d&&_)for(var k=e;k<t;k++)this.zoomInPaintVertexArray.emplace(k,d.tl[0],d.tl[1],d.br[0],d.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],d.pixelRatio,p.pixelRatio),this.zoomOutPaintVertexArray.emplace(k,d.tl[0],d.tl[1],d.br[0],d.br[1],_.tl[0],_.tl[1],_.br[0],_.br[1],d.pixelRatio,_.pixelRatio)}},Wt.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,te.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,te.members,this.expression.isStateDependent))},Wt.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Mt=function(e,t,i){this.binders={},this._buffers=[];var l=[];for(var p in e.paint._values)if(i(p)){var d=e.paint.get(p);if(d instanceof On&&Ba(d.property.specification)){var _=Gi(p,e.type),k=d.value,I=d.property.specification.type,z=d.property.useIntegerZoom,D=d.property.specification["property-type"],R=D==="cross-faded"||D==="cross-faded-data-driven";if(k.kind==="constant")this.binders[p]=R?new Ht(k.value,_):new Bt(k.value,_,I),l.push("/u_"+p);else if(k.kind==="source"||R){var U=pi(p,I,"source");this.binders[p]=R?new Wt(k,I,z,t,U,e.id):new Rt(k,_,I,U),l.push("/a_"+p)}else{var Z=pi(p,I,"composite");this.binders[p]=new Lt(k,_,I,z,t,Z),l.push("/z_"+p)}}}this.cacheKey=l.sort().join("")};Mt.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Rt||t instanceof Lt?t.maxValue:0},Mt.prototype.populatePaintArrays=function(e,t,i,l,p){for(var d in this.binders){var _=this.binders[d];(_ instanceof Rt||_ instanceof Lt||_ instanceof Wt)&&_.populatePaintArray(e,t,i,l,p)}},Mt.prototype.setConstantPatternPositions=function(e,t){for(var i in this.binders){var l=this.binders[i];l instanceof Ht&&l.setConstantPatternPositions(e,t)}},Mt.prototype.updatePaintArrays=function(e,t,i,l,p){var d=!1;for(var _ in e)for(var k=0,I=t.getPositions(_);k<I.length;k+=1){var z=I[k],D=i.feature(z.index);for(var R in this.binders){var U=this.binders[R];if((U instanceof Rt||U instanceof Lt||U instanceof Wt)&&U.expression.isStateDependent===!0){var Z=l.paint.get(R);U.expression=Z.value,U.updatePaintArray(z.start,z.end,D,e[_],p),d=!0}}}return d},Mt.prototype.defines=function(){var e=[];for(var t in this.binders){var i=this.binders[t];(i instanceof Bt||i instanceof Ht)&&e.push.apply(e,i.uniformNames.map(function(l){return"#define HAS_UNIFORM_"+l}))}return e},Mt.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Rt||i instanceof Lt)for(var l=0;l<i.paintVertexAttributes.length;l++)e.push(i.paintVertexAttributes[l].name);else if(i instanceof Wt)for(var p=0;p<te.members.length;p++)e.push(te.members[p].name)}return e},Mt.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var i=this.binders[t];if(i instanceof Bt||i instanceof Ht||i instanceof Lt)for(var l=0,p=i.uniformNames;l<p.length;l+=1)e.push(p[l])}return e},Mt.prototype.getPaintVertexBuffers=function(){return this._buffers},Mt.prototype.getUniforms=function(e,t){var i=[];for(var l in this.binders){var p=this.binders[l];if(p instanceof Bt||p instanceof Ht||p instanceof Lt)for(var d=0,_=p.uniformNames;d<_.length;d+=1){var k=_[d];if(t[k]){var I=p.getBinding(e,t[k],k);i.push({name:k,property:l,binding:I})}}}return i},Mt.prototype.setUniforms=function(e,t,i,l){for(var p=0,d=t;p<d.length;p+=1){var _=d[p],k=_.name,I=_.property;this.binders[I].setUniform(_.binding,l,i.get(I),k)}},Mt.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var i=this.binders[t];if(e&&i instanceof Wt){var l=e.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;l&&this._buffers.push(l)}else(i instanceof Rt||i instanceof Lt)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},Mt.prototype.upload=function(e){for(var t in this.binders){var i=this.binders[t];(i instanceof Rt||i instanceof Lt||i instanceof Wt)&&i.upload(e)}this.updatePaintBuffers()},Mt.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Rt||t instanceof Lt||t instanceof Wt)&&t.destroy()}};var It=function(e,t,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var l=0,p=e;l<p.length;l+=1){var d=p[l];this.programConfigurations[d.id]=new Mt(d,t,i)}this.needsUpload=!1,this._featureMap=new pe,this._bufferOffset=0};function Gi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function pi(e,t,i){var l={color:{source:fl,composite:cu},number:{source:ks,composite:fl}},p=function(d){return{"line-pattern":{source:Ga,composite:Ga},"fill-pattern":{source:Ga,composite:Ga},"fill-extrusion-pattern":{source:Ga,composite:Ga}}[d]}(e);return p&&p[i]||l[t][i]}It.prototype.populatePaintArrays=function(e,t,i,l,p,d){for(var _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(e,t,l,p,d);t.id!==void 0&&this._featureMap.add(t.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},It.prototype.updatePaintArrays=function(e,t,i,l){for(var p=0,d=i;p<d.length;p+=1){var _=d[p];this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,t,_,l)||this.needsUpload}},It.prototype.get=function(e){return this.programConfigurations[e]},It.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},It.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},at("ConstantBinder",Bt),at("CrossFadedConstantBinder",Ht),at("SourceExpressionBinder",Rt),at("CrossFadedCompositeBinder",Wt),at("CompositeExpressionBinder",Lt),at("ProgramConfiguration",Mt,{omit:["_buffers"]}),at("ProgramConfigurationSet",It);var An=Math.pow(2,14)-1,en=-An-1;function ui(e){for(var t=8192/e.extent,i=e.loadGeometry(),l=0;l<i.length;l++)for(var p=i[l],d=0;d<p.length;d++){var _=p[d],k=Math.round(_.x*t),I=Math.round(_.y*t);_.x=Ae(k,en,An),_.y=Ae(I,en,An),(k<_.x||k>_.x+1||I<_.y||I>_.y+1)&&xt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function wi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ui(e):[]}}function bo(e,t,i,l,p){e.emplaceBack(2*t+(l+1)/2,2*i+(p+1)/2)}var Un=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ys,this.indexArray=new ws,this.segments=new K,this.programConfigurations=new It(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Es(e,t){for(var i=0;i<e.length;i++)if(Ka(t,e[i]))return!0;for(var l=0;l<t.length;l++)if(Ka(e,t[l]))return!0;return!!Ul(e,t)}function no(e,t,i){return!!Ka(e,t)||!!Ts(t,e,i)}function Sa(e,t){if(e.length===1)return Vl(t,e[0]);for(var i=0;i<t.length;i++)for(var l=t[i],p=0;p<l.length;p++)if(Ka(e,l[p]))return!0;for(var d=0;d<e.length;d++)if(Vl(t,e[d]))return!0;for(var _=0;_<t.length;_++)if(Ul(e,t[_]))return!0;return!1}function Ko(e,t,i){if(e.length>1){if(Ul(e,t))return!0;for(var l=0;l<t.length;l++)if(Ts(t[l],e,i))return!0}for(var p=0;p<e.length;p++)if(Ts(e[p],t,i))return!0;return!1}function Ul(e,t){if(e.length===0||t.length===0)return!1;for(var i=0;i<e.length-1;i++)for(var l=e[i],p=e[i+1],d=0;d<t.length-1;d++)if(yl(l,p,t[d],t[d+1]))return!0;return!1}function yl(e,t,i,l){return er(e,i,l)!==er(t,i,l)&&er(e,t,i)!==er(e,t,l)}function Ts(e,t,i){var l=i*i;if(t.length===1)return e.distSqr(t[0])<l;for(var p=1;p<t.length;p++)if(gl(e,t[p-1],t[p])<l)return!0;return!1}function gl(e,t,i){var l=t.distSqr(i);if(l===0)return e.distSqr(t);var p=((e.x-t.x)*(i.x-t.x)+(e.y-t.y)*(i.y-t.y))/l;return e.distSqr(p<0?t:p>1?i:i.sub(t)._mult(p)._add(t))}function Vl(e,t){for(var i,l,p,d=!1,_=0;_<e.length;_++)for(var k=0,I=(i=e[_]).length-1;k<i.length;I=k++)(l=i[k]).y>t.y!=(p=i[I]).y>t.y&&t.x<(p.x-l.x)*(t.y-l.y)/(p.y-l.y)+l.x&&(d=!d);return d}function Ka(e,t){for(var i=!1,l=0,p=e.length-1;l<e.length;p=l++){var d=e[l],_=e[p];d.y>t.y!=_.y>t.y&&t.x<(_.x-d.x)*(t.y-d.y)/(_.y-d.y)+d.x&&(i=!i)}return i}function jl(e,t,i){var l=i[0],p=i[2];if(e.x<l.x&&t.x<l.x||e.x>p.x&&t.x>p.x||e.y<l.y&&t.y<l.y||e.y>p.y&&t.y>p.y)return!1;var d=er(e,t,i[0]);return d!==er(e,t,i[1])||d!==er(e,t,i[2])||d!==er(e,t,i[3])}function Xa(e,t,i){var l=t.paint.get(e).value;return l.kind==="constant"?l.value:i.programConfigurations.get(t.id).getMaxValue(e)}function Ki(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function us(e,t,i,l,p){if(!t[0]&&!t[1])return e;var d=M.convert(t)._mult(p);i==="viewport"&&d._rotate(-l);for(var _=[],k=0;k<e.length;k++)_.push(e[k].sub(d));return _}Un.prototype.populate=function(e,t,i){var l=this.layers[0],p=[],d=null;l.type==="circle"&&(d=l.layout.get("circle-sort-key"));for(var _=0,k=e;_<k.length;_+=1){var I=k[_],z=I.feature,D=I.id,R=I.index,U=I.sourceLayerIndex,Z=this.layers[0]._featureFilter.needGeometry,Y=wi(z,Z);if(this.layers[0]._featureFilter.filter(new ir(this.zoom),Y,i)){var $=d?d.evaluate(Y,{},i):void 0,le={id:D,properties:z.properties,type:z.type,sourceLayerIndex:U,index:R,geometry:Z?Y.geometry:ui(z),patterns:{},sortKey:$};p.push(le)}}d&&p.sort(function(Je,_t){return Je.sortKey-_t.sortKey});for(var ne=0,fe=p;ne<fe.length;ne+=1){var _e=fe[ne],xe=_e.geometry,ke=_e.index,Re=_e.sourceLayerIndex,qe=e[ke].feature;this.addFeature(_e,xe,ke,i),t.featureIndex.insert(qe,xe,ke,Re,this.index)}},Un.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},Un.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Un.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Un.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,G),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Un.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Un.prototype.addFeature=function(e,t,i,l){for(var p=0,d=t;p<d.length;p+=1)for(var _=0,k=d[p];_<k.length;_+=1){var I=k[_],z=I.x,D=I.y;if(!(z<0||z>=8192||D<0||D>=8192)){var R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),U=R.vertexLength;bo(this.layoutVertexArray,z,D,-1,-1),bo(this.layoutVertexArray,z,D,1,-1),bo(this.layoutVertexArray,z,D,1,1),bo(this.layoutVertexArray,z,D,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+3,U+2),R.vertexLength+=4,R.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},l)},at("CircleBucket",Un,{omit:["layers"]});var Is=new dn({"circle-sort-key":new dt(j.layout_circle["circle-sort-key"])}),$s={paint:new dn({"circle-radius":new dt(j.paint_circle["circle-radius"]),"circle-color":new dt(j.paint_circle["circle-color"]),"circle-blur":new dt(j.paint_circle["circle-blur"]),"circle-opacity":new dt(j.paint_circle["circle-opacity"]),"circle-translate":new bt(j.paint_circle["circle-translate"]),"circle-translate-anchor":new bt(j.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new bt(j.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new bt(j.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new dt(j.paint_circle["circle-stroke-width"]),"circle-stroke-color":new dt(j.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new dt(j.paint_circle["circle-stroke-opacity"])}),layout:Is},br=typeof Float32Array<"u"?Float32Array:Array;function Mo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function oo(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3],k=t[4],I=t[5],z=t[6],D=t[7],R=t[8],U=t[9],Z=t[10],Y=t[11],$=t[12],le=t[13],ne=t[14],fe=t[15],_e=i[0],xe=i[1],ke=i[2],Re=i[3];return e[0]=_e*l+xe*k+ke*R+Re*$,e[1]=_e*p+xe*I+ke*U+Re*le,e[2]=_e*d+xe*z+ke*Z+Re*ne,e[3]=_e*_+xe*D+ke*Y+Re*fe,e[4]=(_e=i[4])*l+(xe=i[5])*k+(ke=i[6])*R+(Re=i[7])*$,e[5]=_e*p+xe*I+ke*U+Re*le,e[6]=_e*d+xe*z+ke*Z+Re*ne,e[7]=_e*_+xe*D+ke*Y+Re*fe,e[8]=(_e=i[8])*l+(xe=i[9])*k+(ke=i[10])*R+(Re=i[11])*$,e[9]=_e*p+xe*I+ke*U+Re*le,e[10]=_e*d+xe*z+ke*Z+Re*ne,e[11]=_e*_+xe*D+ke*Y+Re*fe,e[12]=(_e=i[12])*l+(xe=i[13])*k+(ke=i[14])*R+(Re=i[15])*$,e[13]=_e*p+xe*I+ke*U+Re*le,e[14]=_e*d+xe*z+ke*Z+Re*ne,e[15]=_e*_+xe*D+ke*Y+Re*fe,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,i=arguments.length;i--;)t+=e[i]*e[i];return Math.sqrt(t)});var el,Gh=oo;function hu(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3];return e[0]=i[0]*l+i[4]*p+i[8]*d+i[12]*_,e[1]=i[1]*l+i[5]*p+i[9]*d+i[13]*_,e[2]=i[2]*l+i[6]*p+i[10]*d+i[14]*_,e[3]=i[3]*l+i[7]*p+i[11]*d+i[15]*_,e}el=new br(3),br!=Float32Array&&(el[0]=0,el[1]=0,el[2]=0),function(){var e=new br(4);br!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Kh=(function(){var e=new br(2);br!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(i){e.call(this,i,$s)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Un(i)},t.prototype.queryRadius=function(i){var l=i;return Xa("circle-radius",this,l)+Xa("circle-stroke-width",this,l)+Ki(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,k,I,z){for(var D=us(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,I),R=this.paint.get("circle-radius").evaluate(l,p)+this.paint.get("circle-stroke-width").evaluate(l,p),U=this.paint.get("circle-pitch-alignment")==="map",Z=U?D:function(qe,Je){return qe.map(function(_t){return ql(_t,Je)})}(D,z),Y=U?R*I:R,$=0,le=d;$<le.length;$+=1)for(var ne=0,fe=le[$];ne<fe.length;ne+=1){var _e=fe[ne],xe=U?_e:ql(_e,z),ke=Y,Re=hu([],[_e.x,_e.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ke*=Re[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ke*=k.cameraToCenterDistance/Re[3]),no(Z,xe,ke))return!0}return!1},t}(Za));function ql(e,t){var i=hu([],[e.x,e.y,0,1],t);return new M(i[0]/i[3],i[1]/i[3])}var Zc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Un);function _l(e,t,i,l){var p=t.width,d=t.height;if(l){if(l instanceof Uint8ClampedArray)l=new Uint8Array(l.buffer);else if(l.length!==p*d*i)throw new RangeError("mismatched image size")}else l=new Uint8Array(p*d*i);return e.width=p,e.height=d,e.data=l,e}function pu(e,t,i){var l=t.width,p=t.height;if(l!==e.width||p!==e.height){var d=_l({},{width:l,height:p},i);Xh(e,d,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,l),height:Math.min(e.height,p)},i),e.width=l,e.height=p,e.data=d.data}}function Xh(e,t,i,l,p,d){if(p.width===0||p.height===0)return t;if(p.width>e.width||p.height>e.height||i.x>e.width-p.width||i.y>e.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>t.width||p.height>t.height||l.x>t.width-p.width||l.y>t.height-p.height)throw new RangeError("out of range destination coordinates for image copy");for(var _=e.data,k=t.data,I=0;I<p.height;I++)for(var z=((i.y+I)*e.width+i.x)*d,D=((l.y+I)*t.width+l.x)*d,R=0;R<p.width*d;R++)k[D+R]=_[z+R];return t}at("HeatmapBucket",Zc,{omit:["layers"]});var Zl=function(e,t){_l(this,e,1,t)};Zl.prototype.resize=function(e){pu(this,e,1)},Zl.prototype.clone=function(){return new Zl({width:this.width,height:this.height},new Uint8Array(this.data))},Zl.copy=function(e,t,i,l,p){Xh(e,t,i,l,p,1)};var wo=function(e,t){_l(this,e,4,t)};wo.prototype.resize=function(e){pu(this,e,4)},wo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},wo.prototype.clone=function(){return new wo({width:this.width,height:this.height},new Uint8Array(this.data))},wo.copy=function(e,t,i,l,p){Xh(e,t,i,l,p,4)},at("AlphaImage",Zl),at("RGBAImage",wo);var hy={paint:new dn({"heatmap-radius":new dt(j.paint_heatmap["heatmap-radius"]),"heatmap-weight":new dt(j.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new bt(j.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wa(j.paint_heatmap["heatmap-color"]),"heatmap-opacity":new bt(j.paint_heatmap["heatmap-opacity"])})};function Jp(e){var t={},i=e.resolution||256,l=e.clips?e.clips.length:1,p=e.image||new wo({width:i,height:l}),d=function(Y,$,le){t[e.evaluationKey]=le;var ne=e.expression.evaluate(t);p.data[Y+$+0]=Math.floor(255*ne.r/ne.a),p.data[Y+$+1]=Math.floor(255*ne.g/ne.a),p.data[Y+$+2]=Math.floor(255*ne.b/ne.a),p.data[Y+$+3]=Math.floor(255*ne.a)};if(e.clips)for(var _=0,k=0;_<l;++_,k+=4*i)for(var I=0,z=0;I<i;I++,z+=4){var D=I/(i-1),R=e.clips[_];d(k,z,R.start*(1-D)+R.end*D)}else for(var U=0,Z=0;U<i;U++,Z+=4)d(0,Z,U/(i-1));return p}var py=function(e){function t(i){e.call(this,i,hy),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new Zc(i)},t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Jp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(Za),fy={paint:new dn({"hillshade-illumination-direction":new bt(j.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new bt(j.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new bt(j.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new bt(j.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new bt(j.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new bt(j.paint_hillshade["hillshade-accent-color"])})},dy=function(e){function t(i){e.call(this,i,fy)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(Za),my=$i([{name:"a_pos",components:2,type:"Int16"}],4).members,Wh=Gc,yy=Gc;function Gc(e,t,i){i=i||2;var l,p,d,_,k,I,z,D=t&&t.length,R=D?t[0]*i:e.length,U=Yp(e,0,R,i,!0),Z=[];if(!U||U.next===U.prev)return Z;if(D&&(U=function($,le,ne,fe){var _e,xe,ke,Re=[];for(_e=0,xe=le.length;_e<xe;_e++)(ke=Yp($,le[_e]*fe,_e<xe-1?le[_e+1]*fe:$.length,fe,!1))===ke.next&&(ke.steiner=!0),Re.push(ky(ke));for(Re.sort(by),_e=0;_e<Re.length;_e++)wy(Re[_e],ne),ne=vl(ne,ne.next);return ne}(e,t,U,i)),e.length>80*i){l=d=e[0],p=_=e[1];for(var Y=i;Y<R;Y+=i)(k=e[Y])<l&&(l=k),(I=e[Y+1])<p&&(p=I),k>d&&(d=k),I>_&&(_=I);z=(z=Math.max(d-l,_-p))!==0?1/z:0}return rc(U,Z,i,l,p,z),Z}function Yp(e,t,i,l,p){var d,_;if(p===Yh(e,t,i,l)>0)for(d=t;d<i;d+=l)_=ef(d,e[d],e[d+1],_);else for(d=i-l;d>=t;d-=l)_=ef(d,e[d],e[d+1],_);return _&&Kc(_,_.next)&&(nc(_),_=_.next),_}function vl(e,t){if(!e)return e;t||(t=e);var i,l=e;do if(i=!1,l.steiner||!Kc(l,l.next)&&Bi(l.prev,l,l.next)!==0)l=l.next;else{if(nc(l),(l=t=l.prev)===l.next)break;i=!0}while(i||l!==t);return t}function rc(e,t,i,l,p,d,_){if(e){!_&&d&&function(D,R,U,Z){var Y=D;do Y.z===null&&(Y.z=Hh(Y.x,Y.y,R,U,Z)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==D);Y.prevZ.nextZ=null,Y.prevZ=null,function($){var le,ne,fe,_e,xe,ke,Re,qe,Je=1;do{for(ne=$,$=null,xe=null,ke=0;ne;){for(ke++,fe=ne,Re=0,le=0;le<Je&&(Re++,fe=fe.nextZ);le++);for(qe=Je;Re>0||qe>0&&fe;)Re!==0&&(qe===0||!fe||ne.z<=fe.z)?(_e=ne,ne=ne.nextZ,Re--):(_e=fe,fe=fe.nextZ,qe--),xe?xe.nextZ=_e:$=_e,_e.prevZ=xe,xe=_e;ne=fe}xe.nextZ=null,Je*=2}while(ke>1)}(Y)}(e,l,p,d);for(var k,I,z=e;e.prev!==e.next;)if(k=e.prev,I=e.next,d?_y(e,l,p,d):gy(e))t.push(k.i/i),t.push(e.i/i),t.push(I.i/i),nc(e),e=I.next,z=I.next;else if((e=I)===z){_?_===1?rc(e=vy(vl(e),t,i),t,i,l,p,d,2):_===2&&xy(e,t,i,l,p,d):rc(vl(e),t,i,l,p,d,1);break}}}function gy(e){var t=e.prev,i=e,l=e.next;if(Bi(t,i,l)>=0)return!1;for(var p=e.next.next;p!==e.prev;){if(fu(t.x,t.y,i.x,i.y,l.x,l.y,p.x,p.y)&&Bi(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function _y(e,t,i,l){var p=e.prev,d=e,_=e.next;if(Bi(p,d,_)>=0)return!1;for(var k=p.x>d.x?p.x>_.x?p.x:_.x:d.x>_.x?d.x:_.x,I=p.y>d.y?p.y>_.y?p.y:_.y:d.y>_.y?d.y:_.y,z=Hh(p.x<d.x?p.x<_.x?p.x:_.x:d.x<_.x?d.x:_.x,p.y<d.y?p.y<_.y?p.y:_.y:d.y<_.y?d.y:_.y,t,i,l),D=Hh(k,I,t,i,l),R=e.prevZ,U=e.nextZ;R&&R.z>=z&&U&&U.z<=D;){if(R!==e.prev&&R!==e.next&&fu(p.x,p.y,d.x,d.y,_.x,_.y,R.x,R.y)&&Bi(R.prev,R,R.next)>=0||(R=R.prevZ,U!==e.prev&&U!==e.next&&fu(p.x,p.y,d.x,d.y,_.x,_.y,U.x,U.y)&&Bi(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;R&&R.z>=z;){if(R!==e.prev&&R!==e.next&&fu(p.x,p.y,d.x,d.y,_.x,_.y,R.x,R.y)&&Bi(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;U&&U.z<=D;){if(U!==e.prev&&U!==e.next&&fu(p.x,p.y,d.x,d.y,_.x,_.y,U.x,U.y)&&Bi(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function vy(e,t,i){var l=e;do{var p=l.prev,d=l.next.next;!Kc(p,d)&&Qp(p,l,l.next,d)&&ic(p,d)&&ic(d,p)&&(t.push(p.i/i),t.push(l.i/i),t.push(d.i/i),nc(l),nc(l.next),l=e=d),l=l.next}while(l!==e);return vl(l)}function xy(e,t,i,l,p,d){var _=e;do{for(var k=_.next.next;k!==_.prev;){if(_.i!==k.i&&Ey(_,k)){var I=$p(_,k);return _=vl(_,_.next),I=vl(I,I.next),rc(_,t,i,l,p,d),void rc(I,t,i,l,p,d)}k=k.next}_=_.next}while(_!==e)}function by(e,t){return e.x-t.x}function wy(e,t){if(t=function(l,p){var d,_=p,k=l.x,I=l.y,z=-1/0;do{if(I<=_.y&&I>=_.next.y&&_.next.y!==_.y){var D=_.x+(I-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(D<=k&&D>z){if(z=D,D===k){if(I===_.y)return _;if(I===_.next.y)return _.next}d=_.x<_.next.x?_:_.next}}_=_.next}while(_!==p);if(!d)return null;if(k===z)return d;var R,U=d,Z=d.x,Y=d.y,$=1/0;_=d;do k>=_.x&&_.x>=Z&&k!==_.x&&fu(I<Y?k:z,I,Z,Y,I<Y?z:k,I,_.x,_.y)&&(R=Math.abs(I-_.y)/(k-_.x),ic(_,l)&&(R<$||R===$&&(_.x>d.x||_.x===d.x&&Sy(d,_)))&&(d=_,$=R)),_=_.next;while(_!==U);return d}(e,t)){var i=$p(t,e);vl(t,t.next),vl(i,i.next)}}function Sy(e,t){return Bi(e.prev,e,t.prev)<0&&Bi(t.next,e,e.next)<0}function Hh(e,t,i,l,p){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*p)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-l)*p)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ky(e){var t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function fu(e,t,i,l,p,d,_,k){return(p-_)*(t-k)-(e-_)*(d-k)>=0&&(e-_)*(l-k)-(i-_)*(t-k)>=0&&(i-_)*(d-k)-(p-_)*(l-k)>=0}function Ey(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(i,l){var p=i;do{if(p.i!==i.i&&p.next.i!==i.i&&p.i!==l.i&&p.next.i!==l.i&&Qp(p,p.next,i,l))return!0;p=p.next}while(p!==i);return!1}(e,t)&&(ic(e,t)&&ic(t,e)&&function(i,l){var p=i,d=!1,_=(i.x+l.x)/2,k=(i.y+l.y)/2;do p.y>k!=p.next.y>k&&p.next.y!==p.y&&_<(p.next.x-p.x)*(k-p.y)/(p.next.y-p.y)+p.x&&(d=!d),p=p.next;while(p!==i);return d}(e,t)&&(Bi(e.prev,e,t.prev)||Bi(e,t.prev,t))||Kc(e,t)&&Bi(e.prev,e,e.next)>0&&Bi(t.prev,t,t.next)>0)}function Bi(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Kc(e,t){return e.x===t.x&&e.y===t.y}function Qp(e,t,i,l){var p=Wc(Bi(e,t,i)),d=Wc(Bi(e,t,l)),_=Wc(Bi(i,l,e)),k=Wc(Bi(i,l,t));return p!==d&&_!==k||!(p!==0||!Xc(e,i,t))||!(d!==0||!Xc(e,l,t))||!(_!==0||!Xc(i,e,l))||!(k!==0||!Xc(i,t,l))}function Xc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Wc(e){return e>0?1:e<0?-1:0}function ic(e,t){return Bi(e.prev,e,e.next)<0?Bi(e,t,e.next)>=0&&Bi(e,e.prev,t)>=0:Bi(e,t,e.prev)<0||Bi(e,e.next,t)<0}function $p(e,t){var i=new Jh(e.i,e.x,e.y),l=new Jh(t.i,t.x,t.y),p=e.next,d=t.prev;return e.next=t,t.prev=e,i.next=p,p.prev=i,l.next=i,i.prev=l,d.next=l,l.prev=d,l}function ef(e,t,i,l){var p=new Jh(e,t,i);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function nc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Jh(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yh(e,t,i,l){for(var p=0,d=t,_=i-l;d<i;d+=l)p+=(e[_]-e[d])*(e[d+1]+e[_+1]),_=d;return p}function Ty(e,t,i,l,p){(function d(_,k,I,z,D){for(;z>I;){if(z-I>600){var R=z-I+1,U=k-I+1,Z=Math.log(R),Y=.5*Math.exp(2*Z/3),$=.5*Math.sqrt(Z*Y*(R-Y)/R)*(U-R/2<0?-1:1);d(_,k,Math.max(I,Math.floor(k-U*Y/R+$)),Math.min(z,Math.floor(k+(R-U)*Y/R+$)),D)}var le=_[k],ne=I,fe=z;for(oc(_,I,k),D(_[z],le)>0&&oc(_,I,z);ne<fe;){for(oc(_,ne,fe),ne++,fe--;D(_[ne],le)<0;)ne++;for(;D(_[fe],le)>0;)fe--}D(_[I],le)===0?oc(_,I,fe):oc(_,++fe,z),fe<=k&&(I=fe+1),k<=fe&&(z=fe-1)}})(e,t,i||0,l||e.length-1,p||Iy)}function oc(e,t,i){var l=e[t];e[t]=e[i],e[i]=l}function Iy(e,t){return e<t?-1:e>t?1:0}function Qh(e,t){var i=e.length;if(i<=1)return[e];for(var l,p,d=[],_=0;_<i;_++){var k=We(e[_]);k!==0&&(e[_].area=Math.abs(k),p===void 0&&(p=k<0),p===k<0?(l&&d.push(l),l=[e[_]]):l.push(e[_]))}if(l&&d.push(l),t>1)for(var I=0;I<d.length;I++)d[I].length<=t||(Ty(d[I],t,1,d[I].length-1,Ay),d[I]=d[I].slice(0,t));return d}function Ay(e,t){return t.area-e.area}function $h(e,t,i){for(var l=i.patternDependencies,p=!1,d=0,_=t;d<_.length;d+=1){var k=_[d].paint.get(e+"-pattern");k.isConstant()||(p=!0);var I=k.constantOr(null);I&&(p=!0,l[I.to]=!0,l[I.from]=!0)}return p}function ep(e,t,i,l,p){for(var d=p.patternDependencies,_=0,k=t;_<k.length;_+=1){var I=k[_],z=I.paint.get(e+"-pattern").value;if(z.kind!=="constant"){var D=z.evaluate({zoom:l-1},i,{},p.availableImages),R=z.evaluate({zoom:l},i,{},p.availableImages),U=z.evaluate({zoom:l+1},i,{},p.availableImages);R=R&&R.name?R.name:R,U=U&&U.name?U.name:U,d[D=D&&D.name?D.name:D]=!0,d[R]=!0,d[U]=!0,i.patterns[I.id]={min:D,mid:R,max:U}}}return i}Gc.deviation=function(e,t,i,l){var p=t&&t.length,d=Math.abs(Yh(e,0,p?t[0]*i:e.length,i));if(p)for(var _=0,k=t.length;_<k;_++)d-=Math.abs(Yh(e,t[_]*i,_<k-1?t[_+1]*i:e.length,i));var I=0;for(_=0;_<l.length;_+=3){var z=l[_]*i,D=l[_+1]*i,R=l[_+2]*i;I+=Math.abs((e[z]-e[R])*(e[D+1]-e[z+1])-(e[z]-e[D])*(e[R+1]-e[z+1]))}return d===0&&I===0?0:Math.abs((I-d)/d)},Gc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},l=0,p=0;p<e.length;p++){for(var d=0;d<e[p].length;d++)for(var _=0;_<t;_++)i.vertices.push(e[p][d][_]);p>0&&i.holes.push(l+=e[p-1].length)}return i},Wh.default=yy;var cs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ys,this.indexArray=new ws,this.indexArray2=new Nl,this.programConfigurations=new It(e.layers,e.zoom),this.segments=new K,this.segments2=new K,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};cs.prototype.populate=function(e,t,i){this.hasPattern=$h("fill",this.layers,t);for(var l=this.layers[0].layout.get("fill-sort-key"),p=[],d=0,_=e;d<_.length;d+=1){var k=_[d],I=k.feature,z=k.id,D=k.index,R=k.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,Z=wi(I,U);if(this.layers[0]._featureFilter.filter(new ir(this.zoom),Z,i)){var Y=l?l.evaluate(Z,{},i,t.availableImages):void 0,$={id:z,properties:I.properties,type:I.type,sourceLayerIndex:R,index:D,geometry:U?Z.geometry:ui(I),patterns:{},sortKey:Y};p.push($)}}l&&p.sort(function(qe,Je){return qe.sortKey-Je.sortKey});for(var le=0,ne=p;le<ne.length;le+=1){var fe=ne[le],_e=fe.geometry,xe=fe.index,ke=fe.sourceLayerIndex;if(this.hasPattern){var Re=ep("fill",this.layers,fe,this.zoom,t);this.patternFeatures.push(Re)}else this.addFeature(fe,_e,xe,i,{});t.featureIndex.insert(e[xe].feature,_e,xe,ke,this.index)}},cs.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},cs.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},cs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},cs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},cs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,my),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},cs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},cs.prototype.addFeature=function(e,t,i,l,p){for(var d=0,_=Qh(t,500);d<_.length;d+=1){for(var k=_[d],I=0,z=0,D=k;z<D.length;z+=1)I+=D[z].length;for(var R=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),U=R.vertexLength,Z=[],Y=[],$=0,le=k;$<le.length;$+=1){var ne=le[$];if(ne.length!==0){ne!==k[0]&&Y.push(Z.length/2);var fe=this.segments2.prepareSegment(ne.length,this.layoutVertexArray,this.indexArray2),_e=fe.vertexLength;this.layoutVertexArray.emplaceBack(ne[0].x,ne[0].y),this.indexArray2.emplaceBack(_e+ne.length-1,_e),Z.push(ne[0].x),Z.push(ne[0].y);for(var xe=1;xe<ne.length;xe++)this.layoutVertexArray.emplaceBack(ne[xe].x,ne[xe].y),this.indexArray2.emplaceBack(_e+xe-1,_e+xe),Z.push(ne[xe].x),Z.push(ne[xe].y);fe.vertexLength+=ne.length,fe.primitiveLength+=ne.length}}for(var ke=Wh(Z,Y),Re=0;Re<ke.length;Re+=3)this.indexArray.emplaceBack(U+ke[Re],U+ke[Re+1],U+ke[Re+2]);R.vertexLength+=I,R.primitiveLength+=ke.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},at("FillBucket",cs,{omit:["layers","patternFeatures"]});var zy=new dn({"fill-sort-key":new dt(j.layout_fill["fill-sort-key"])}),Py={paint:new dn({"fill-antialias":new bt(j.paint_fill["fill-antialias"]),"fill-opacity":new dt(j.paint_fill["fill-opacity"]),"fill-color":new dt(j.paint_fill["fill-color"]),"fill-outline-color":new dt(j.paint_fill["fill-outline-color"]),"fill-translate":new bt(j.paint_fill["fill-translate"]),"fill-translate-anchor":new bt(j.paint_fill["fill-translate-anchor"]),"fill-pattern":new au(j.paint_fill["fill-pattern"])}),layout:zy},Cy=function(e){function t(i){e.call(this,i,Py)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l);var p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(i){return new cs(i)},t.prototype.queryRadius=function(){return Ki(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,k,I){return Sa(us(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,I),d)},t.prototype.isTileClipped=function(){return!0},t}(Za),My=$i([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,tf=du;function du(e,t,i,l,p){this.properties={},this.extent=i,this.type=0,this._pbf=e,this._geometry=-1,this._keys=l,this._values=p,e.readFields(Dy,this,t)}function Dy(e,t,i){e==1?t.id=i.readVarint():e==2?function(l,p){for(var d=l.readVarint()+l.pos;l.pos<d;){var _=p._keys[l.readVarint()],k=p._values[l.readVarint()];p.properties[_]=k}}(i,t):e==3?t.type=i.readVarint():e==4&&(t._geometry=i.pos)}function Ly(e){for(var t,i,l=0,p=0,d=e.length,_=d-1;p<d;_=p++)l+=((i=e[_]).x-(t=e[p]).x)*(t.y+i.y);return l}du.types=["Unknown","Point","LineString","Polygon"],du.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,i=e.readVarint()+e.pos,l=1,p=0,d=0,_=0,k=[];e.pos<i;){if(p<=0){var I=e.readVarint();l=7&I,p=I>>3}if(p--,l===1||l===2)d+=e.readSVarint(),_+=e.readSVarint(),l===1&&(t&&k.push(t),t=[]),t.push(new M(d,_));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&k.push(t),k},du.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,i=1,l=0,p=0,d=0,_=1/0,k=-1/0,I=1/0,z=-1/0;e.pos<t;){if(l<=0){var D=e.readVarint();i=7&D,l=D>>3}if(l--,i===1||i===2)(p+=e.readSVarint())<_&&(_=p),p>k&&(k=p),(d+=e.readSVarint())<I&&(I=d),d>z&&(z=d);else if(i!==7)throw new Error("unknown command "+i)}return[_,I,k,z]},du.prototype.toGeoJSON=function(e,t,i){var l,p,d=this.extent*Math.pow(2,i),_=this.extent*e,k=this.extent*t,I=this.loadGeometry(),z=du.types[this.type];function D(Z){for(var Y=0;Y<Z.length;Y++){var $=Z[Y];Z[Y]=[360*($.x+_)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+k)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(l=0;l<I.length;l++)R[l]=I[l][0];D(I=R);break;case 2:for(l=0;l<I.length;l++)D(I[l]);break;case 3:for(I=function(Z){var Y=Z.length;if(Y<=1)return[Z];for(var $,le,ne=[],fe=0;fe<Y;fe++){var _e=Ly(Z[fe]);_e!==0&&(le===void 0&&(le=_e<0),le===_e<0?($&&ne.push($),$=[Z[fe]]):$.push(Z[fe]))}return $&&ne.push($),ne}(I),l=0;l<I.length;l++)for(p=0;p<I[l].length;p++)D(I[l][p])}I.length===1?I=I[0]:z="Multi"+z;var U={type:"Feature",geometry:{type:z,coordinates:I},properties:this.properties};return"id"in this&&(U.id=this.id),U};var rf=nf;function nf(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ry,this,t),this.length=this._features.length}function Ry(e,t,i){e===15?t.version=i.readVarint():e===1?t.name=i.readString():e===5?t.extent=i.readVarint():e===2?t._features.push(i.pos):e===3?t._keys.push(i.readString()):e===4&&t._values.push(function(l){for(var p=null,d=l.readVarint()+l.pos;l.pos<d;){var _=l.readVarint()>>3;p=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return p}(i))}function By(e,t,i){if(e===3){var l=new rf(i,i.readVarint()+i.pos);l.length&&(t[l.name]=l)}}nf.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new tf(this._pbf,t,this.extent,this._keys,this._values)};var mu={VectorTile:function(e,t){this.layers=e.readFields(By,{},t)},VectorTileFeature:tf,VectorTileLayer:rf},Fy=mu.VectorTileFeature.types,tp=Math.pow(2,13);function ac(e,t,i,l,p,d,_,k){e.emplaceBack(t,i,2*Math.floor(l*tp)+_,p*tp*2,d*tp*2,Math.round(k))}var hs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ls,this.indexArray=new ws,this.programConfigurations=new It(e.layers,e.zoom),this.segments=new K,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Oy(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}hs.prototype.populate=function(e,t,i){this.features=[],this.hasPattern=$h("fill-extrusion",this.layers,t);for(var l=0,p=e;l<p.length;l+=1){var d=p[l],_=d.feature,k=d.id,I=d.index,z=d.sourceLayerIndex,D=this.layers[0]._featureFilter.needGeometry,R=wi(_,D);if(this.layers[0]._featureFilter.filter(new ir(this.zoom),R,i)){var U={id:k,sourceLayerIndex:z,index:I,geometry:D?R.geometry:ui(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(ep("fill-extrusion",this.layers,U,this.zoom,t)):this.addFeature(U,U.geometry,I,i,{}),t.featureIndex.insert(_,U.geometry,I,z,this.index,!0)}}},hs.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.features;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},hs.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},hs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},hs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},hs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,My),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},hs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},hs.prototype.addFeature=function(e,t,i,l,p){for(var d=0,_=Qh(t,500);d<_.length;d+=1){for(var k=_[d],I=0,z=0,D=k;z<D.length;z+=1)I+=D[z].length;for(var R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),U=0,Z=k;U<Z.length;U+=1){var Y=Z[U];if(Y.length!==0&&!((rr=Y).every(function(jt){return jt.x<0})||rr.every(function(jt){return jt.x>8192})||rr.every(function(jt){return jt.y<0})||rr.every(function(jt){return jt.y>8192})))for(var $=0,le=0;le<Y.length;le++){var ne=Y[le];if(le>=1){var fe=Y[le-1];if(!Oy(ne,fe)){R.vertexLength+4>K.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _e=ne.sub(fe)._perp()._unit(),xe=fe.dist(ne);$+xe>32768&&($=0),ac(this.layoutVertexArray,ne.x,ne.y,_e.x,_e.y,0,0,$),ac(this.layoutVertexArray,ne.x,ne.y,_e.x,_e.y,0,1,$),ac(this.layoutVertexArray,fe.x,fe.y,_e.x,_e.y,0,0,$+=xe),ac(this.layoutVertexArray,fe.x,fe.y,_e.x,_e.y,0,1,$);var ke=R.vertexLength;this.indexArray.emplaceBack(ke,ke+2,ke+1),this.indexArray.emplaceBack(ke+1,ke+2,ke+3),R.vertexLength+=4,R.primitiveLength+=2}}}}if(R.vertexLength+I>K.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),Fy[e.type]==="Polygon"){for(var Re=[],qe=[],Je=R.vertexLength,_t=0,tt=k;_t<tt.length;_t+=1){var St=tt[_t];if(St.length!==0){St!==k[0]&&qe.push(Re.length/2);for(var it=0;it<St.length;it++){var Yt=St[it];ac(this.layoutVertexArray,Yt.x,Yt.y,0,0,1,1,0),Re.push(Yt.x),Re.push(Yt.y)}}}for(var At=Wh(Re,qe),mt=0;mt<At.length;mt+=3)this.indexArray.emplaceBack(Je+At[mt],Je+At[mt+2],Je+At[mt+1]);R.primitiveLength+=At.length/3,R.vertexLength+=I}}var rr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},at("FillExtrusionBucket",hs,{omit:["layers","features"]});var Ny={paint:new dn({"fill-extrusion-opacity":new bt(j["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new dt(j["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new bt(j["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new bt(j["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new au(j["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new dt(j["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new dt(j["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new bt(j["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Uy=function(e){function t(i){e.call(this,i,Ny)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(i){return new hs(i)},t.prototype.queryRadius=function(){return Ki(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,k,I,z){var D=us(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,I),R=this.paint.get("fill-extrusion-height").evaluate(l,p),U=this.paint.get("fill-extrusion-base").evaluate(l,p),Z=function($,le,ne,fe){for(var _e=[],xe=0,ke=$;xe<ke.length;xe+=1){var Re=ke[xe],qe=[Re.x,Re.y,0,1];hu(qe,qe,le),_e.push(new M(qe[0]/qe[3],qe[1]/qe[3]))}return _e}(D,z),Y=function($,le,ne,fe){for(var _e=[],xe=[],ke=fe[8]*le,Re=fe[9]*le,qe=fe[10]*le,Je=fe[11]*le,_t=fe[8]*ne,tt=fe[9]*ne,St=fe[10]*ne,it=fe[11]*ne,Yt=0,At=$;Yt<At.length;Yt+=1){for(var mt=[],rr=[],jt=0,lr=At[Yt];jt<lr.length;jt+=1){var kt=lr[jt],gr=kt.x,$r=kt.y,fi=fe[0]*gr+fe[4]*$r+fe[12],ci=fe[1]*gr+fe[5]*$r+fe[13],ei=fe[2]*gr+fe[6]*$r+fe[14],di=fe[3]*gr+fe[7]*$r+fe[15],Xi=ei+qe,Wi=di+Je,jn=fi+_t,rn=ci+tt,qn=ei+St,Si=di+it,nn=new M((fi+ke)/Wi,(ci+Re)/Wi);nn.z=Xi/Wi,mt.push(nn);var ar=new M(jn/Si,rn/Si);ar.z=qn/Si,rr.push(ar)}_e.push(mt),xe.push(rr)}return[_e,xe]}(d,U,R,z);return function($,le,ne){var fe=1/0;Sa(ne,le)&&(fe=of(ne,le[0]));for(var _e=0;_e<le.length;_e++)for(var xe=le[_e],ke=$[_e],Re=0;Re<xe.length-1;Re++){var qe=xe[Re],Je=[qe,xe[Re+1],ke[Re+1],ke[Re],qe];Es(ne,Je)&&(fe=Math.min(fe,of(ne,Je)))}return fe!==1/0&&fe}(Y[0],Y[1],Z)},t}(Za);function sc(e,t){return e.x*t.x+e.y*t.y}function of(e,t){if(e.length===1){for(var i,l=0,p=t[l++];!i||p.equals(i);)if(!(i=t[l++]))return 1/0;for(;l<t.length;l++){var d=t[l],_=e[0],k=i.sub(p),I=d.sub(p),z=_.sub(p),D=sc(k,k),R=sc(k,I),U=sc(I,I),Z=sc(z,k),Y=sc(z,I),$=D*U-R*R,le=(U*Z-R*Y)/$,ne=(D*Y-R*Z)/$,fe=p.z*(1-le-ne)+i.z*le+d.z*ne;if(isFinite(fe))return fe}return 1/0}for(var _e=1/0,xe=0,ke=t;xe<ke.length;xe+=1)_e=Math.min(_e,ke[xe].z);return _e}var Vy=$i([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,jy=$i([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,qy=mu.VectorTileFeature.types,Zy=Math.cos(Math.PI/180*37.5),af=Math.pow(2,14)/.5,ao=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){t.gradients[i.id]={}}),this.layoutVertexArray=new xo,this.layoutVertexArray2=new fl,this.indexArray=new ws,this.programConfigurations=new It(e.layers,e.zoom),this.segments=new K,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};ao.prototype.populate=function(e,t,i){this.hasPattern=$h("line",this.layers,t);for(var l=this.layers[0].layout.get("line-sort-key"),p=[],d=0,_=e;d<_.length;d+=1){var k=_[d],I=k.feature,z=k.id,D=k.index,R=k.sourceLayerIndex,U=this.layers[0]._featureFilter.needGeometry,Z=wi(I,U);if(this.layers[0]._featureFilter.filter(new ir(this.zoom),Z,i)){var Y=l?l.evaluate(Z,{},i):void 0,$={id:z,properties:I.properties,type:I.type,sourceLayerIndex:R,index:D,geometry:U?Z.geometry:ui(I),patterns:{},sortKey:Y};p.push($)}}l&&p.sort(function(qe,Je){return qe.sortKey-Je.sortKey});for(var le=0,ne=p;le<ne.length;le+=1){var fe=ne[le],_e=fe.geometry,xe=fe.index,ke=fe.sourceLayerIndex;if(this.hasPattern){var Re=ep("line",this.layers,fe,this.zoom,t);this.patternFeatures.push(Re)}else this.addFeature(fe,_e,xe,i,{});t.featureIndex.insert(e[xe].feature,_e,xe,ke,this.index)}},ao.prototype.update=function(e,t,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,i)},ao.prototype.addFeatures=function(e,t,i){for(var l=0,p=this.patternFeatures;l<p.length;l+=1){var d=p[l];this.addFeature(d,d.geometry,d.index,t,i)}},ao.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ao.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ao.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,jy)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ao.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ao.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},ao.prototype.addFeature=function(e,t,i,l,p){var d=this.layers[0].layout,_=d.get("line-join").evaluate(e,{}),k=d.get("line-cap"),I=d.get("line-miter-limit"),z=d.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var D=0,R=t;D<R.length;D+=1)this.addLine(R[D],e,_,k,I,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,p,l)},ao.prototype.addLine=function(e,t,i,l,p,d){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var _=0;_<e.length-1;_++)this.totalDistance+=e[_].dist(e[_+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var k=qy[t.type]==="Polygon",I=e.length;I>=2&&e[I-1].equals(e[I-2]);)I--;for(var z=0;z<I-1&&e[z].equals(e[z+1]);)z++;if(!(I<(k?3:2))){i==="bevel"&&(p=1.05);var D,R=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),Z=void 0,Y=void 0,$=void 0,le=void 0;this.e1=this.e2=-1,k&&(le=e[z].sub(D=e[I-2])._unit()._perp());for(var ne=z;ne<I;ne++)if(!(Y=ne===I-1?k?e[z+1]:void 0:e[ne+1])||!e[ne].equals(Y)){le&&($=le),D&&(Z=D),D=e[ne],le=Y?Y.sub(D)._unit()._perp():$;var fe=($=$||le).add(le);fe.x===0&&fe.y===0||fe._unit();var _e=$.x*le.x+$.y*le.y,xe=fe.x*le.x+fe.y*le.y,ke=xe!==0?1/xe:1/0,Re=2*Math.sqrt(2-2*xe),qe=xe<Zy&&Z&&Y,Je=$.x*le.y-$.y*le.x>0;if(qe&&ne>z){var _t=D.dist(Z);if(_t>2*R){var tt=D.sub(D.sub(Z)._mult(R/_t)._round());this.updateDistance(Z,tt),this.addCurrentVertex(tt,$,0,0,U),Z=tt}}var St=Z&&Y,it=St?i:k?"butt":l;if(St&&it==="round"&&(ke<d?it="miter":ke<=2&&(it="fakeround")),it==="miter"&&ke>p&&(it="bevel"),it==="bevel"&&(ke>2&&(it="flipbevel"),ke<p&&(it="miter")),Z&&this.updateDistance(Z,D),it==="miter")fe._mult(ke),this.addCurrentVertex(D,fe,0,0,U);else if(it==="flipbevel"){if(ke>100)fe=le.mult(-1);else{var Yt=ke*$.add(le).mag()/$.sub(le).mag();fe._perp()._mult(Yt*(Je?-1:1))}this.addCurrentVertex(D,fe,0,0,U),this.addCurrentVertex(D,fe.mult(-1),0,0,U)}else if(it==="bevel"||it==="fakeround"){var At=-Math.sqrt(ke*ke-1),mt=Je?At:0,rr=Je?0:At;if(Z&&this.addCurrentVertex(D,$,mt,rr,U),it==="fakeround")for(var jt=Math.round(180*Re/Math.PI/20),lr=1;lr<jt;lr++){var kt=lr/jt;if(kt!==.5){var gr=kt-.5;kt+=kt*gr*(kt-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*gr*gr+(.848013+_e*(.215638*_e-1.06021)))}var $r=le.sub($)._mult(kt)._add($)._unit()._mult(Je?-1:1);this.addHalfVertex(D,$r.x,$r.y,!1,Je,0,U)}Y&&this.addCurrentVertex(D,le,-mt,-rr,U)}else if(it==="butt")this.addCurrentVertex(D,fe,0,0,U);else if(it==="square"){var fi=Z?1:-1;this.addCurrentVertex(D,fe,fi,fi,U)}else it==="round"&&(Z&&(this.addCurrentVertex(D,$,0,0,U),this.addCurrentVertex(D,$,1,1,U,!0)),Y&&(this.addCurrentVertex(D,le,-1,-1,U,!0),this.addCurrentVertex(D,le,0,0,U)));if(qe&&ne<I-1){var ci=D.dist(Y);if(ci>2*R){var ei=D.add(Y.sub(D)._mult(R/ci)._round());this.updateDistance(D,ei),this.addCurrentVertex(ei,le,0,0,U),D=ei}}}}},ao.prototype.addCurrentVertex=function(e,t,i,l,p,d){d===void 0&&(d=!1);var _=t.y*l-t.x,k=-t.y-t.x*l;this.addHalfVertex(e,t.x+t.y*i,t.y-t.x*i,d,!1,i,p),this.addHalfVertex(e,_,k,d,!0,-l,p),this.distance>af/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,i,l,p,d))},ao.prototype.addHalfVertex=function(e,t,i,l,p,d,_){var k=.5*(this.lineClips?this.scaledDistance*(af-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(l?1:0),(e.y<<1)+(p?1:0),Math.round(63*t)+128,Math.round(63*i)+128,1+(d===0?0:d<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var I=_.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),_.primitiveLength++),p?this.e2=I:this.e1=I},ao.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ao.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},at("LineBucket",ao,{omit:["layers","patternFeatures"]});var Gy=new dn({"line-cap":new bt(j.layout_line["line-cap"]),"line-join":new dt(j.layout_line["line-join"]),"line-miter-limit":new bt(j.layout_line["line-miter-limit"]),"line-round-limit":new bt(j.layout_line["line-round-limit"]),"line-sort-key":new dt(j.layout_line["line-sort-key"])}),sf={paint:new dn({"line-opacity":new dt(j.paint_line["line-opacity"]),"line-color":new dt(j.paint_line["line-color"]),"line-translate":new bt(j.paint_line["line-translate"]),"line-translate-anchor":new bt(j.paint_line["line-translate-anchor"]),"line-width":new dt(j.paint_line["line-width"]),"line-gap-width":new dt(j.paint_line["line-gap-width"]),"line-offset":new dt(j.paint_line["line-offset"]),"line-blur":new dt(j.paint_line["line-blur"]),"line-dasharray":new Nn(j.paint_line["line-dasharray"]),"line-pattern":new au(j.paint_line["line-pattern"]),"line-gradient":new wa(j.paint_line["line-gradient"])}),layout:Gy},lf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(i,l){return l=new ir(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),e.prototype.possiblyEvaluate.call(this,i,l)},t.prototype.evaluate=function(i,l,p,d){return l=Me({},l,{zoom:Math.floor(l.zoom)}),e.prototype.evaluate.call(this,i,l,p,d)},t}(dt))(sf.paint.properties["line-width"].specification);lf.useIntegerZoom=!0;var Ky=function(e){function t(i){e.call(this,i,sf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof pn,this.gradientVersion=(this.gradientVersion+1)%N)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(i,l){e.prototype.recalculate.call(this,i,l),this.paint._values["line-floorwidth"]=lf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},t.prototype.createBucket=function(i){return new ao(i)},t.prototype.queryRadius=function(i){var l=i,p=uf(Xa("line-width",this,l),Xa("line-gap-width",this,l)),d=Xa("line-offset",this,l);return p/2+Math.abs(d)+Ki(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(i,l,p,d,_,k,I){var z=us(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,I),D=I/2*uf(this.paint.get("line-width").evaluate(l,p),this.paint.get("line-gap-width").evaluate(l,p)),R=this.paint.get("line-offset").evaluate(l,p);return R&&(d=function(U,Z){for(var Y=[],$=new M(0,0),le=0;le<U.length;le++){for(var ne=U[le],fe=[],_e=0;_e<ne.length;_e++){var xe=ne[_e],ke=ne[_e+1],Re=_e===0?$:xe.sub(ne[_e-1])._unit()._perp(),qe=_e===ne.length-1?$:ke.sub(xe)._unit()._perp(),Je=Re._add(qe)._unit();Je._mult(1/(Je.x*qe.x+Je.y*qe.y)),fe.push(Je._mult(Z)._add(xe))}Y.push(fe)}return Y}(d,R*I)),function(U,Z,Y){for(var $=0;$<Z.length;$++){var le=Z[$];if(U.length>=3){for(var ne=0;ne<le.length;ne++)if(Ka(U,le[ne]))return!0}if(Ko(U,le,Y))return!0}return!1}(z,d,D)},t.prototype.isTileClipped=function(){return!0},t}(Za);function uf(e,t){return t>0?t+2*e:e}var Xy=$i([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wy=$i([{name:"a_projected_pos",components:3,type:"Float32"}],4),Hy=($i([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),$i([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),cf=($i([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),$i([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Jy=$i([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Yy(e,t,i){return e.sections.forEach(function(l){l.text=function(p,d,_){var k=d.layout.get("text-transform").evaluate(_,{});return k==="uppercase"?p=p.toLocaleUpperCase():k==="lowercase"&&(p=p.toLocaleLowerCase()),Co.applyArabicShaping&&(p=Co.applyArabicShaping(p)),p}(l.text,t,i)}),e}$i([{name:"triangle",components:3,type:"Uint16"}]),$i([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),$i([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),$i([{type:"Float32",name:"offsetX"}]),$i([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var lc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},hf=function(e,t,i,l,p){var d,_,k=8*p-l-1,I=(1<<k)-1,z=I>>1,D=-7,R=i?p-1:0,U=i?-1:1,Z=e[t+R];for(R+=U,d=Z&(1<<-D)-1,Z>>=-D,D+=k;D>0;d=256*d+e[t+R],R+=U,D-=8);for(_=d&(1<<-D)-1,d>>=-D,D+=l;D>0;_=256*_+e[t+R],R+=U,D-=8);if(d===0)d=1-z;else{if(d===I)return _?NaN:1/0*(Z?-1:1);_+=Math.pow(2,l),d-=z}return(Z?-1:1)*_*Math.pow(2,d-l)},pf=function(e,t,i,l,p,d){var _,k,I,z=8*d-p-1,D=(1<<z)-1,R=D>>1,U=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=l?0:d-1,Y=l?1:-1,$=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(k=isNaN(t)?1:0,_=D):(_=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-_))<1&&(_--,I*=2),(t+=_+R>=1?U/I:U*Math.pow(2,1-R))*I>=2&&(_++,I/=2),_+R>=D?(k=0,_=D):_+R>=1?(k=(t*I-1)*Math.pow(2,p),_+=R):(k=t*Math.pow(2,R-1)*Math.pow(2,p),_=0));p>=8;e[i+Z]=255&k,Z+=Y,k/=256,p-=8);for(_=_<<p|k,z+=p;z>0;e[i+Z]=255&_,Z+=Y,_/=256,z-=8);e[i+Z-Y]|=128*$},Hc=Kr;function Kr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Kr.Varint=0,Kr.Fixed64=1,Kr.Bytes=2,Kr.Fixed32=5;var ff=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function tl(e){return e.type===Kr.Bytes?e.readVarint()+e.pos:e.pos+1}function yu(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function df(e,t,i){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(l);for(var p=i.pos-1;p>=e;p--)i.buf[p+l]=i.buf[p]}function Qy(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function $y(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function eg(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function tg(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function rg(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function ig(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function ng(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function og(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function ag(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function Jc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function gu(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function mf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function sg(e,t,i){e===1&&i.readMessage(lg,t)}function lg(e,t,i){if(e===3){var l=i.readMessage(ug,{}),p=l.width,d=l.height,_=l.left,k=l.top,I=l.advance;t.push({id:l.id,bitmap:new Zl({width:p+6,height:d+6},l.bitmap),metrics:{width:p,height:d,left:_,top:k,advance:I}})}}function ug(e,t,i){e===1?t.id=i.readVarint():e===2?t.bitmap=i.readBytes():e===3?t.width=i.readVarint():e===4?t.height=i.readVarint():e===5?t.left=i.readSVarint():e===6?t.top=i.readSVarint():e===7&&(t.advance=i.readVarint())}function yf(e){for(var t=0,i=0,l=0,p=e;l<p.length;l+=1){var d=p[l];t+=d.w*d.h,i=Math.max(i,d.w)}e.sort(function($,le){return le.h-$.h});for(var _=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}],k=0,I=0,z=0,D=e;z<D.length;z+=1)for(var R=D[z],U=_.length-1;U>=0;U--){var Z=_[U];if(!(R.w>Z.w||R.h>Z.h)){if(R.x=Z.x,R.y=Z.y,I=Math.max(I,R.y+R.h),k=Math.max(k,R.x+R.w),R.w===Z.w&&R.h===Z.h){var Y=_.pop();U<_.length&&(_[U]=Y)}else R.h===Z.h?(Z.x+=R.w,Z.w-=R.w):R.w===Z.w?(Z.y+=R.h,Z.h-=R.h):(_.push({x:Z.x+R.w,y:Z.y,w:Z.w-R.w,h:R.h}),Z.y+=R.h,Z.h-=R.h);break}}return{w:k,h:I,fill:t/(k*I)||0}}Kr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var l=this.readVarint(),p=l>>3,d=this.pos;this.type=7&l,e(p,t,this),this.pos===d&&this.skip(l)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Jc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=mf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Jc(this.buf,this.pos)+4294967296*Jc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Jc(this.buf,this.pos)+4294967296*mf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=hf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=hf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,l=this.buf;return t=127&(i=l[this.pos++]),i<128?t:(t|=(127&(i=l[this.pos++]))<<7,i<128?t:(t|=(127&(i=l[this.pos++]))<<14,i<128?t:(t|=(127&(i=l[this.pos++]))<<21,i<128?t:function(p,d,_){var k,I,z=_.buf;if(k=(112&(I=z[_.pos++]))>>4,I<128||(k|=(127&(I=z[_.pos++]))<<3,I<128)||(k|=(127&(I=z[_.pos++]))<<10,I<128)||(k|=(127&(I=z[_.pos++]))<<17,I<128)||(k|=(127&(I=z[_.pos++]))<<24,I<128)||(k|=(1&(I=z[_.pos++]))<<31,I<128))return yu(p,k,d);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=l[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ff?function(i,l,p){return ff.decode(i.subarray(l,p))}(this.buf,t,e):function(i,l,p){for(var d="",_=l;_<p;){var k,I,z,D=i[_],R=null,U=D>239?4:D>223?3:D>191?2:1;if(_+U>p)break;U===1?D<128&&(R=D):U===2?(192&(k=i[_+1]))==128&&(R=(31&D)<<6|63&k)<=127&&(R=null):U===3?(I=i[_+2],(192&(k=i[_+1]))==128&&(192&I)==128&&((R=(15&D)<<12|(63&k)<<6|63&I)<=2047||R>=55296&&R<=57343)&&(R=null)):U===4&&(I=i[_+2],z=i[_+3],(192&(k=i[_+1]))==128&&(192&I)==128&&(192&z)==128&&((R=(15&D)<<18|(63&k)<<12|(63&I)<<6|63&z)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,U=1):R>65535&&(R-=65536,d+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),d+=String.fromCharCode(R),_+=U}return d}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Kr.Bytes)return e.push(this.readVarint(t));var i=tl(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Kr.Bytes)return e.push(this.readSVarint());var t=tl(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Kr.Bytes)return e.push(this.readBoolean());var t=tl(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Kr.Bytes)return e.push(this.readFloat());var t=tl(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Kr.Bytes)return e.push(this.readDouble());var t=tl(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Kr.Bytes)return e.push(this.readFixed32());var t=tl(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Kr.Bytes)return e.push(this.readSFixed32());var t=tl(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Kr.Bytes)return e.push(this.readFixed64());var t=tl(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Kr.Bytes)return e.push(this.readSFixed64());var t=tl(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Kr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Kr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Kr.Fixed32)this.pos+=4;else{if(t!==Kr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),gu(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),gu(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),gu(this.buf,-1&e,this.pos),gu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),gu(this.buf,-1&e,this.pos),gu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,i){var l,p;if(t>=0?(l=t%4294967296|0,p=t/4294967296|0):(p=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,p=p+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(d,_,k){k.buf[k.pos++]=127&d|128,d>>>=7,k.buf[k.pos++]=127&d|128,d>>>=7,k.buf[k.pos++]=127&d|128,d>>>=7,k.buf[k.pos++]=127&d|128,k.buf[k.pos]=127&(d>>>=7)}(l,0,i),function(d,_){var k=(7&d)<<4;_.buf[_.pos++]|=k|((d>>>=3)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d|((d>>>=7)?128:0),d&&(_.buf[_.pos++]=127&d)))))}(p,i)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(l,p,d){for(var _,k,I=0;I<p.length;I++){if((_=p.charCodeAt(I))>55295&&_<57344){if(!k){_>56319||I+1===p.length?(l[d++]=239,l[d++]=191,l[d++]=189):k=_;continue}if(_<56320){l[d++]=239,l[d++]=191,l[d++]=189,k=_;continue}_=k-55296<<10|_-56320|65536,k=null}else k&&(l[d++]=239,l[d++]=191,l[d++]=189,k=null);_<128?l[d++]=_:(_<2048?l[d++]=_>>6|192:(_<65536?l[d++]=_>>12|224:(l[d++]=_>>18|240,l[d++]=_>>12&63|128),l[d++]=_>>6&63|128),l[d++]=63&_|128)}return d}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&df(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),pf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),pf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var l=this.pos-i;l>=128&&df(i,l,this),this.pos=i-1,this.writeVarint(l),this.pos+=l},writeMessage:function(e,t,i){this.writeTag(e,Kr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Qy,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,$y,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,rg,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,eg,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,tg,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,ig,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,ng,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,og,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,ag,t)},writeBytesField:function(e,t){this.writeTag(e,Kr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Kr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Kr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Kr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Kr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Kr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Kr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Kr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Kr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Kr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Yc=function(e,t){var i=t.pixelRatio,l=t.version,p=t.stretchX,d=t.stretchY,_=t.content;this.paddedRect=e,this.pixelRatio=i,this.stretchX=p,this.stretchY=d,this.content=_,this.version=l},uc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};uc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},uc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},uc.tlbr.get=function(){return this.tl.concat(this.br)},uc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Yc.prototype,uc);var cc=function(e,t){var i={},l={};this.haveRenderCallbacks=[];var p=[];this.addImages(e,i,p),this.addImages(t,l,p);var d=yf(p),_=new wo({width:d.w||1,height:d.h||1});for(var k in e){var I=e[k],z=i[k].paddedRect;wo.copy(I.data,_,{x:0,y:0},{x:z.x+1,y:z.y+1},I.data)}for(var D in t){var R=t[D],U=l[D].paddedRect,Z=U.x+1,Y=U.y+1,$=R.data.width,le=R.data.height;wo.copy(R.data,_,{x:0,y:0},{x:Z,y:Y},R.data),wo.copy(R.data,_,{x:0,y:le-1},{x:Z,y:Y-1},{width:$,height:1}),wo.copy(R.data,_,{x:0,y:0},{x:Z,y:Y+le},{width:$,height:1}),wo.copy(R.data,_,{x:$-1,y:0},{x:Z-1,y:Y},{width:1,height:le}),wo.copy(R.data,_,{x:0,y:0},{x:Z+$,y:Y},{width:1,height:le})}this.image=_,this.iconPositions=i,this.patternPositions=l};cc.prototype.addImages=function(e,t,i){for(var l in e){var p=e[l],d={x:0,y:0,w:p.data.width+2,h:p.data.height+2};i.push(d),t[l]=new Yc(d,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(l)}},cc.prototype.patchUpdatedImages=function(e,t){for(var i in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[i],e.getImage(i),t),this.patchUpdatedImage(this.patternPositions[i],e.getImage(i),t)},cc.prototype.patchUpdatedImage=function(e,t,i){if(e&&t&&e.version!==t.version){e.version=t.version;var l=e.tl;i.update(t.data,void 0,{x:l[0],y:l[1]})}},at("ImagePosition",Yc),at("ImageAtlas",cc);var Xo={horizontal:1,vertical:2,horizontalOnly:3},_u=function(){this.scale=1,this.fontStack="",this.imageName=null};_u.forText=function(e,t){var i=new _u;return i.scale=e||1,i.fontStack=t,i},_u.forImage=function(e){var t=new _u;return t.imageName=e,t};var Vn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Qc(e,t,i,l,p,d,_,k,I,z,D,R,U,Z,Y,$){var le,ne=Vn.fromFeature(e,p);R===Xo.vertical&&ne.verticalizePunctuation();var fe=Co.processBidirectionalText,_e=Co.processStyledBidirectionalText;if(fe&&ne.sections.length===1){le=[];for(var xe=0,ke=fe(ne.toString(),rp(ne,z,d,t,l,Z,Y));xe<ke.length;xe+=1){var Re=ke[xe],qe=new Vn;qe.text=Re,qe.sections=ne.sections;for(var Je=0;Je<Re.length;Je++)qe.sectionIndex.push(0);le.push(qe)}}else if(_e){le=[];for(var _t=0,tt=_e(ne.text,ne.sectionIndex,rp(ne,z,d,t,l,Z,Y));_t<tt.length;_t+=1){var St=tt[_t],it=new Vn;it.text=St[0],it.sectionIndex=St[1],it.sections=ne.sections,le.push(it)}}else le=function(mt,rr){for(var jt=[],lr=mt.text,kt=0,gr=0,$r=rr;gr<$r.length;gr+=1){var fi=$r[gr];jt.push(mt.substring(kt,fi)),kt=fi}return kt<lr.length&&jt.push(mt.substring(kt,lr.length)),jt}(ne,rp(ne,z,d,t,l,Z,Y));var Yt=[],At={positionedLines:Yt,text:ne.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(mt,rr,jt,lr,kt,gr,$r,fi,ci,ei,di,Xi){for(var Wi=0,jn=-17,rn=0,qn=0,Si=fi==="right"?1:fi==="left"?0:.5,nn=0,ar=0,Vr=kt;ar<Vr.length;ar+=1){var Dr=Vr[ar];Dr.trim();var dr=Dr.getMaxScale(),so=24*(dr-1),zn={positionedGlyphs:[],lineOffset:0};mt.positionedLines[nn]=zn;var Yr=zn.positionedGlyphs,zi=0;if(Dr.length()){for(var Pn=0;Pn<Dr.length();Pn++){var _r=Dr.getSection(Pn),As=Dr.getSectionIndex(Pn),Wo=Dr.getCharCode(Pn),zs=0,ki=null,Ps=null,Wa=null,Tu=24,Wl=!(ci===Xo.horizontal||!di&&!Ws(Wo)||di&&($c[Wo]||(ol=Wo,Ye.Arabic(ol)||Ye["Arabic Supplement"](ol)||Ye["Arabic Extended-A"](ol)||Ye["Arabic Presentation Forms-A"](ol)||Ye["Arabic Presentation Forms-B"](ol))));if(_r.imageName){var Iu=lr[_r.imageName];if(!Iu)continue;Wa=_r.imageName,mt.iconsInText=mt.iconsInText||!0,Ps=Iu.paddedRect;var nl=Iu.displaySize;_r.scale=24*_r.scale/Xi,zs=so+(24-nl[1]*_r.scale),Tu=(ki={width:nl[0],height:nl[1],left:1,top:-3,advance:Wl?nl[1]:nl[0]}).advance;var Au=Wl?nl[0]*_r.scale-24*dr:nl[1]*_r.scale-24*dr;Au>0&&Au>zi&&(zi=Au)}else{var lh=jt[_r.fontStack],zu=lh&&lh[Wo];if(zu&&zu.rect)Ps=zu.rect,ki=zu.metrics;else{var fc=rr[_r.fontStack],uh=fc&&fc[Wo];if(!uh)continue;ki=uh.metrics}zs=24*(dr-_r.scale)}Wl?(mt.verticalizable=!0,Yr.push({glyph:Wo,imageName:Wa,x:Wi,y:jn+zs,vertical:Wl,scale:_r.scale,fontStack:_r.fontStack,sectionIndex:As,metrics:ki,rect:Ps}),Wi+=Tu*_r.scale+ei):(Yr.push({glyph:Wo,imageName:Wa,x:Wi,y:jn+zs,vertical:Wl,scale:_r.scale,fontStack:_r.fontStack,sectionIndex:As,metrics:ki,rect:Ps}),Wi+=ki.advance*_r.scale+ei)}Yr.length!==0&&(rn=Math.max(Wi-ei,rn),hg(Yr,0,Yr.length-1,Si,zi)),Wi=0;var ch=gr*dr+zi;zn.lineOffset=Math.max(zi,so),jn+=ch,qn=Math.max(ch,qn),++nn}else jn+=gr,++nn}var ol,dc=jn- -17,Pu=ip($r),bl=Pu.horizontalAlign,Cu=Pu.verticalAlign;(function(hh,ph,mc,yc,fh,gc,_c,vc,dh){var Mu,mh=(ph-mc)*fh;Mu=gc!==_c?-vc*yc- -17:(-yc*dh+.5)*_c;for(var Du=0,xc=hh;Du<xc.length;Du+=1)for(var Hl=0,bc=xc[Du].positionedGlyphs;Hl<bc.length;Hl+=1){var Lu=bc[Hl];Lu.x+=mh,Lu.y+=Mu}})(mt.positionedLines,Si,bl,Cu,rn,qn,gr,dc,kt.length),mt.top+=-Cu*dc,mt.bottom=mt.top+dc,mt.left+=-bl*rn,mt.right=mt.left+rn}(At,t,i,l,le,_,k,I,R,z,U,$),!function(mt){for(var rr=0,jt=mt;rr<jt.length;rr+=1)if(jt[rr].positionedGlyphs.length!==0)return!1;return!0}(Yt)&&At}Vn.fromFeature=function(e,t){for(var i=new Vn,l=0;l<e.sections.length;l++){var p=e.sections[l];p.image?i.addImageSection(p):i.addTextSection(p,t)}return i},Vn.prototype.length=function(){return this.text.length},Vn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Vn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Vn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Vn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",i=0;i<e.length;i++){var l=e.charCodeAt(i+1)||null,p=e.charCodeAt(i-1)||null;t+=l&&ss(l)&&!lc[e[i+1]]||p&&ss(p)&&!lc[e[i-1]]||!lc[e[i]]?e[i]:lc[e[i]]}return t}(this.text)},Vn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&$c[this.text.charCodeAt(t)];t++)e++;for(var i=this.text.length,l=this.text.length-1;l>=0&&l>=e&&$c[this.text.charCodeAt(l)];l--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)},Vn.prototype.substring=function(e,t){var i=new Vn;return i.text=this.text.substring(e,t),i.sectionIndex=this.sectionIndex.slice(e,t),i.sections=this.sections,i},Vn.prototype.toString=function(){return this.text},Vn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,i){return Math.max(t,e.sections[i].scale)},0)},Vn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(_u.forText(e.scale,e.fontStack||t));for(var i=this.sections.length-1,l=0;l<e.text.length;++l)this.sectionIndex.push(i)},Vn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(_u.forImage(t)),this.sectionIndex.push(this.sections.length-1)):xt("Reached maximum number of images 6401")}else xt("Can't add FormattedSection with an empty image.")},Vn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var $c={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Do={};function gf(e,t,i,l,p,d){if(t.imageName){var _=l[t.imageName];return _?_.displaySize[0]*t.scale*24/d+p:0}var k=i[t.fontStack],I=k&&k[e];return I?I.metrics.advance*t.scale+p:0}function _f(e,t,i,l){var p=Math.pow(e-t,2);return l?e<t?p/2:2*p:p+Math.abs(i)*i}function cg(e,t,i){var l=0;return e===10&&(l-=1e4),i&&(l+=150),e!==40&&e!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function vf(e,t,i,l,p,d){for(var _=null,k=_f(t,i,p,d),I=0,z=l;I<z.length;I+=1){var D=z[I],R=_f(t-D.x,i,p,d)+D.badness;R<=k&&(_=D,k=R)}return{index:e,x:t,priorBreak:_,badness:k}}function rp(e,t,i,l,p,d,_){if(d!=="point")return[];if(!e)return[];for(var k,I=[],z=function(le,ne,fe,_e,xe,ke){for(var Re=0,qe=0;qe<le.length();qe++){var Je=le.getSection(qe);Re+=gf(le.getCharCode(qe),Je,_e,xe,ne,ke)}return Re/Math.max(1,Math.ceil(Re/fe))}(e,t,i,l,p,_),D=e.text.indexOf("\u200B")>=0,R=0,U=0;U<e.length();U++){var Z=e.getSection(U),Y=e.getCharCode(U);if($c[Y]||(R+=gf(Y,Z,l,p,t,_)),U<e.length()-1){var $=!((k=Y)<11904||!(Ye["Bopomofo Extended"](k)||Ye.Bopomofo(k)||Ye["CJK Compatibility Forms"](k)||Ye["CJK Compatibility Ideographs"](k)||Ye["CJK Compatibility"](k)||Ye["CJK Radicals Supplement"](k)||Ye["CJK Strokes"](k)||Ye["CJK Symbols and Punctuation"](k)||Ye["CJK Unified Ideographs Extension A"](k)||Ye["CJK Unified Ideographs"](k)||Ye["Enclosed CJK Letters and Months"](k)||Ye["Halfwidth and Fullwidth Forms"](k)||Ye.Hiragana(k)||Ye["Ideographic Description Characters"](k)||Ye["Kangxi Radicals"](k)||Ye["Katakana Phonetic Extensions"](k)||Ye.Katakana(k)||Ye["Vertical Forms"](k)||Ye["Yi Radicals"](k)||Ye["Yi Syllables"](k)));(Do[Y]||$||Z.imageName)&&I.push(vf(U+1,R,z,I,cg(Y,e.getCharCode(U+1),$&&D),!1))}}return function le(ne){return ne?le(ne.priorBreak).concat(ne.index):[]}(vf(e.length(),R,z,I,0,!0))}function ip(e){var t=.5,i=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function hg(e,t,i,l,p){if(l||p)for(var d=e[i],_=(e[i].x+d.metrics.advance*d.scale)*l,k=t;k<=i;k++)e[k].x-=_,e[k].y+=p}function xf(e,t,i,l,p,d){var _,k=e.image;if(k.content){var I=k.content,z=k.pixelRatio||1;_=[I[0]/z,I[1]/z,k.displaySize[0]-I[2]/z,k.displaySize[1]-I[3]/z]}var D,R,U,Z,Y=t.left*d,$=t.right*d;i==="width"||i==="both"?(Z=p[0]+Y-l[3],R=p[0]+$+l[1]):R=(Z=p[0]+(Y+$-k.displaySize[0])/2)+k.displaySize[0];var le=t.top*d,ne=t.bottom*d;return i==="height"||i==="both"?(D=p[1]+le-l[0],U=p[1]+ne+l[2]):U=(D=p[1]+(le+ne-k.displaySize[1])/2)+k.displaySize[1],{image:k,top:D,right:R,bottom:U,left:Z,collisionPadding:_}}Do[10]=!0,Do[32]=!0,Do[38]=!0,Do[40]=!0,Do[41]=!0,Do[43]=!0,Do[45]=!0,Do[47]=!0,Do[173]=!0,Do[183]=!0,Do[8203]=!0,Do[8208]=!0,Do[8211]=!0,Do[8231]=!0;var vu=function(e){function t(i,l,p,d){e.call(this,i,l),this.angle=p,d!==void 0&&(this.segment=d)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(M);function np(e,t){var i=t.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new ir(e+1))};if(i.kind==="source")return{kind:"source"};for(var l=i.zoomStops,p=i.interpolationType,d=0;d<l.length&&l[d]<=e;)d++;for(var _=d=Math.max(0,d-1);_<l.length&&l[_]<e+1;)_++;_=Math.min(l.length-1,_);var k=l[d],I=l[_];return i.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:I,interpolationType:p}:{kind:"camera",minZoom:k,maxZoom:I,minSize:i.evaluate(new ir(k)),maxSize:i.evaluate(new ir(I)),interpolationType:p}}function bf(e,t,i){var l=t.uSize,p=i.lowerSize;return e.kind==="source"?p/128:e.kind==="composite"?ii(p/128,i.upperSize/128,t.uSizeT):l}function wf(e,t){var i=0,l=0;if(e.kind==="constant")l=e.layoutSize;else if(e.kind!=="source"){var p=e.interpolationType,d=p?Ae(Ii.interpolationFactor(p,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?l=ii(e.minSize,e.maxSize,d):i=d}return{uSizeT:i,uSize:l}}at("Anchor",vu);var pg=Object.freeze({__proto__:null,getSizeData:np,evaluateSizeForFeature:bf,evaluateSizeForZoom:wf,SIZE_PACK_FACTOR:128});function Sf(e,t,i,l,p){if(t.segment===void 0)return!0;for(var d=t,_=t.segment+1,k=0;k>-i/2;){if(--_<0)return!1;k-=e[_].dist(d),d=e[_]}k+=e[_].dist(e[_+1]),_++;for(var I=[],z=0;k<i/2;){var D=e[_],R=e[_+1];if(!R)return!1;var U=e[_-1].angleTo(D)-D.angleTo(R);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:k,angleDelta:U}),z+=U;k-I[0].distance>l;)z-=I.shift().angleDelta;if(z>p)return!1;_++,k+=D.dist(R)}return!0}function kf(e){for(var t=0,i=0;i<e.length-1;i++)t+=e[i].dist(e[i+1]);return t}function Ef(e,t,i){return e?.6*t*i:0}function Tf(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function fg(e,t,i,l,p,d){for(var _=Ef(i,p,d),k=Tf(i,l)*d,I=0,z=kf(e)/2,D=0;D<e.length-1;D++){var R=e[D],U=e[D+1],Z=R.dist(U);if(I+Z>z){var Y=(z-I)/Z,$=ii(R.x,U.x,Y),le=ii(R.y,U.y,Y),ne=new vu($,le,U.angleTo(R),D);return ne._round(),!_||Sf(e,ne,k,_,t)?ne:void 0}I+=Z}}function dg(e,t,i,l,p,d,_,k,I){var z=Ef(l,d,_),D=Tf(l,p),R=D*_,U=e[0].x===0||e[0].x===I||e[0].y===0||e[0].y===I;return t-R<t/4&&(t=R+t/4),function Z(Y,$,le,ne,fe,_e,xe,ke,Re){for(var qe=_e/2,Je=kf(Y),_t=0,tt=$-le,St=[],it=0;it<Y.length-1;it++){for(var Yt=Y[it],At=Y[it+1],mt=Yt.dist(At),rr=At.angleTo(Yt);tt+le<_t+mt;){var jt=((tt+=le)-_t)/mt,lr=ii(Yt.x,At.x,jt),kt=ii(Yt.y,At.y,jt);if(lr>=0&&lr<Re&&kt>=0&&kt<Re&&tt-qe>=0&&tt+qe<=Je){var gr=new vu(lr,kt,rr,it);gr._round(),ne&&!Sf(Y,gr,_e,ne,fe)||St.push(gr)}}_t+=mt}return ke||St.length||xe||(St=Z(Y,_t/2,le,ne,fe,_e,xe,!0,Re)),St}(e,U?t/2*k%t:(D/2+2*d)*_*k%t,t,z,i,R,U,!1,I)}function If(e,t,i,l,p){for(var d=[],_=0;_<e.length;_++)for(var k=e[_],I=void 0,z=0;z<k.length-1;z++){var D=k[z],R=k[z+1];D.x<t&&R.x<t||(D.x<t?D=new M(t,D.y+(t-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x<t&&(R=new M(t,D.y+(t-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y<i&&R.y<i||(D.y<i?D=new M(D.x+(i-D.y)/(R.y-D.y)*(R.x-D.x),i)._round():R.y<i&&(R=new M(D.x+(i-D.y)/(R.y-D.y)*(R.x-D.x),i)._round()),D.x>=l&&R.x>=l||(D.x>=l?D=new M(l,D.y+(l-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x>=l&&(R=new M(l,D.y+(l-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y>=p&&R.y>=p||(D.y>=p?D=new M(D.x+(p-D.y)/(R.y-D.y)*(R.x-D.x),p)._round():R.y>=p&&(R=new M(D.x+(p-D.y)/(R.y-D.y)*(R.x-D.x),p)._round()),I&&D.equals(I[I.length-1])||d.push(I=[D]),I.push(R)))))}return d}function Af(e,t,i,l){var p=[],d=e.image,_=d.pixelRatio,k=d.paddedRect.w-2,I=d.paddedRect.h-2,z=e.right-e.left,D=e.bottom-e.top,R=d.stretchX||[[0,k]],U=d.stretchY||[[0,I]],Z=function(lr,kt){return lr+kt[1]-kt[0]},Y=R.reduce(Z,0),$=U.reduce(Z,0),le=k-Y,ne=I-$,fe=0,_e=Y,xe=0,ke=$,Re=0,qe=le,Je=0,_t=ne;if(d.content&&l){var tt=d.content;fe=eh(R,0,tt[0]),xe=eh(U,0,tt[1]),_e=eh(R,tt[0],tt[2]),ke=eh(U,tt[1],tt[3]),Re=tt[0]-fe,Je=tt[1]-xe,qe=tt[2]-tt[0]-_e,_t=tt[3]-tt[1]-ke}var St=function(lr,kt,gr,$r){var fi=th(lr.stretch-fe,_e,z,e.left),ci=rh(lr.fixed-Re,qe,lr.stretch,Y),ei=th(kt.stretch-xe,ke,D,e.top),di=rh(kt.fixed-Je,_t,kt.stretch,$),Xi=th(gr.stretch-fe,_e,z,e.left),Wi=rh(gr.fixed-Re,qe,gr.stretch,Y),jn=th($r.stretch-xe,ke,D,e.top),rn=rh($r.fixed-Je,_t,$r.stretch,$),qn=new M(fi,ei),Si=new M(Xi,ei),nn=new M(Xi,jn),ar=new M(fi,jn),Vr=new M(ci/_,di/_),Dr=new M(Wi/_,rn/_),dr=t*Math.PI/180;if(dr){var so=Math.sin(dr),zn=Math.cos(dr),Yr=[zn,-so,so,zn];qn._matMult(Yr),Si._matMult(Yr),ar._matMult(Yr),nn._matMult(Yr)}var zi=lr.stretch+lr.fixed,Pn=kt.stretch+kt.fixed;return{tl:qn,tr:Si,bl:ar,br:nn,tex:{x:d.paddedRect.x+1+zi,y:d.paddedRect.y+1+Pn,w:gr.stretch+gr.fixed-zi,h:$r.stretch+$r.fixed-Pn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Vr,pixelOffsetBR:Dr,minFontScaleX:qe/_/z,minFontScaleY:_t/_/D,isSDF:i}};if(l&&(d.stretchX||d.stretchY))for(var it=zf(R,le,Y),Yt=zf(U,ne,$),At=0;At<it.length-1;At++)for(var mt=it[At],rr=it[At+1],jt=0;jt<Yt.length-1;jt++)p.push(St(mt,Yt[jt],rr,Yt[jt+1]));else p.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:I+1}));return p}function eh(e,t,i){for(var l=0,p=0,d=e;p<d.length;p+=1){var _=d[p];l+=Math.max(t,Math.min(i,_[1]))-Math.max(t,Math.min(i,_[0]))}return l}function zf(e,t,i){for(var l=[{fixed:-1,stretch:0}],p=0,d=e;p<d.length;p+=1){var _=d[p],k=_[0],I=_[1],z=l[l.length-1];l.push({fixed:k-z.stretch,stretch:z.stretch}),l.push({fixed:k-z.stretch,stretch:z.stretch+(I-k)})}return l.push({fixed:t+1,stretch:i}),l}function th(e,t,i,l){return e/t*i+l}function rh(e,t,i,l){return e-t*i/l}var ih=function(e,t,i,l,p,d,_,k,I,z){if(this.boxStartIndex=e.length,I){var D=d.top,R=d.bottom,U=d.collisionPadding;U&&(D-=U[1],R+=U[3]);var Z=R-D;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{var Y=d.top*_-k,$=d.bottom*_+k,le=d.left*_-k,ne=d.right*_+k,fe=d.collisionPadding;if(fe&&(le-=fe[0]*_,Y-=fe[1]*_,ne+=fe[2]*_,$+=fe[3]*_),z){var _e=new M(le,Y),xe=new M(ne,Y),ke=new M(le,$),Re=new M(ne,$),qe=z*Math.PI/180;_e._rotate(qe),xe._rotate(qe),ke._rotate(qe),Re._rotate(qe),le=Math.min(_e.x,xe.x,ke.x,Re.x),ne=Math.max(_e.x,xe.x,ke.x,Re.x),Y=Math.min(_e.y,xe.y,ke.y,Re.y),$=Math.max(_e.y,xe.y,ke.y,Re.y)}e.emplaceBack(t.x,t.y,le,Y,ne,$,i,l,p)}this.boxEndIndex=e.length},xu=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=mg),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function mg(e,t){return e<t?-1:e>t?1:0}function yg(e,t,i){t===void 0&&(t=1),i===void 0&&(i=!1);for(var l=1/0,p=1/0,d=-1/0,_=-1/0,k=e[0],I=0;I<k.length;I++){var z=k[I];(!I||z.x<l)&&(l=z.x),(!I||z.y<p)&&(p=z.y),(!I||z.x>d)&&(d=z.x),(!I||z.y>_)&&(_=z.y)}var D=Math.min(d-l,_-p),R=D/2,U=new xu([],gg);if(D===0)return new M(l,p);for(var Z=l;Z<d;Z+=D)for(var Y=p;Y<_;Y+=D)U.push(new bu(Z+R,Y+R,R,e));for(var $=function(fe){for(var _e=0,xe=0,ke=0,Re=fe[0],qe=0,Je=Re.length,_t=Je-1;qe<Je;_t=qe++){var tt=Re[qe],St=Re[_t],it=tt.x*St.y-St.x*tt.y;xe+=(tt.x+St.x)*it,ke+=(tt.y+St.y)*it,_e+=3*it}return new bu(xe/_e,ke/_e,0,fe)}(e),le=U.length;U.length;){var ne=U.pop();(ne.d>$.d||!$.d)&&($=ne,i&&console.log("found best %d after %d probes",Math.round(1e4*ne.d)/1e4,le)),ne.max-$.d<=t||(U.push(new bu(ne.p.x-(R=ne.h/2),ne.p.y-R,R,e)),U.push(new bu(ne.p.x+R,ne.p.y-R,R,e)),U.push(new bu(ne.p.x-R,ne.p.y+R,R,e)),U.push(new bu(ne.p.x+R,ne.p.y+R,R,e)),le+=4)}return i&&(console.log("num probes: "+le),console.log("best distance: "+$.d)),$.p}function gg(e,t){return t.max-e.max}function bu(e,t,i,l){this.p=new M(e,t),this.h=i,this.d=function(p,d){for(var _=!1,k=1/0,I=0;I<d.length;I++)for(var z=d[I],D=0,R=z.length,U=R-1;D<R;U=D++){var Z=z[D],Y=z[U];Z.y>p.y!=Y.y>p.y&&p.x<(Y.x-Z.x)*(p.y-Z.y)/(Y.y-Z.y)+Z.x&&(_=!_),k=Math.min(k,gl(p,Z,Y))}return(_?1:-1)*Math.sqrt(k)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}xu.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},xu.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},xu.prototype.peek=function(){return this.data[0]},xu.prototype._up=function(e){for(var t=this.data,i=this.compare,l=t[e];e>0;){var p=e-1>>1,d=t[p];if(i(l,d)>=0)break;t[e]=d,e=p}t[e]=l},xu.prototype._down=function(e){for(var t=this.data,i=this.compare,l=this.length>>1,p=t[e];e<l;){var d=1+(e<<1),_=t[d],k=d+1;if(k<this.length&&i(t[k],_)<0&&(d=k,_=t[k]),i(_,p)>=0)break;t[e]=_,e=d}t[e]=p};var op=Number.POSITIVE_INFINITY;function Pf(e,t){return t[1]!==op?function(i,l,p){var d=0,_=0;switch(l=Math.abs(l),p=Math.abs(p),i){case"top-right":case"top-left":case"top":_=p-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-p}switch(i){case"top-right":case"bottom-right":case"right":d=-l;break;case"top-left":case"bottom-left":case"left":d=l}return[d,_]}(e,t[0],t[1]):function(i,l){var p=0,d=0;l<0&&(l=0);var _=l/Math.sqrt(2);switch(i){case"top-right":case"top-left":d=_-7;break;case"bottom-right":case"bottom-left":d=7-_;break;case"bottom":d=7-l;break;case"top":d=l-7}switch(i){case"top-right":case"bottom-right":p=-_;break;case"top-left":case"bottom-left":p=_;break;case"left":p=l;break;case"right":p=-l}return[p,d]}(e,t[0])}function ap(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Cf(e,t,i,l,p,d,_,k,I,z,D,R,U,Z,Y){var $=function(xe,ke,Re,qe,Je,_t,tt,St){for(var it=qe.layout.get("text-rotate").evaluate(_t,{})*Math.PI/180,Yt=[],At=0,mt=ke.positionedLines;At<mt.length;At+=1)for(var rr=mt[At],jt=0,lr=rr.positionedGlyphs;jt<lr.length;jt+=1){var kt=lr[jt];if(kt.rect){var gr=kt.rect||{},$r=4,fi=!0,ci=1,ei=0,di=(Je||St)&&kt.vertical,Xi=kt.metrics.advance*kt.scale/2;if(St&&ke.verticalizable&&(ei=rr.lineOffset/2-(kt.imageName?-(24-kt.metrics.width*kt.scale)/2:24*(kt.scale-1))),kt.imageName){var Wi=tt[kt.imageName];fi=Wi.sdf,$r=1/(ci=Wi.pixelRatio)}var jn=Je?[kt.x+Xi,kt.y]:[0,0],rn=Je?[0,0]:[kt.x+Xi+Re[0],kt.y+Re[1]-ei],qn=[0,0];di&&(qn=rn,rn=[0,0]);var Si=(kt.metrics.left-$r)*kt.scale-Xi+rn[0],nn=(-kt.metrics.top-$r)*kt.scale+rn[1],ar=Si+gr.w*kt.scale/ci,Vr=nn+gr.h*kt.scale/ci,Dr=new M(Si,nn),dr=new M(ar,nn),so=new M(Si,Vr),zn=new M(ar,Vr);if(di){var Yr=new M(-Xi,Xi- -17),zi=-Math.PI/2,Pn=12-Xi,_r=new M(22-Pn,-(kt.imageName?Pn:0)),As=new(Function.prototype.bind.apply(M,[null].concat(qn)));Dr._rotateAround(zi,Yr)._add(_r)._add(As),dr._rotateAround(zi,Yr)._add(_r)._add(As),so._rotateAround(zi,Yr)._add(_r)._add(As),zn._rotateAround(zi,Yr)._add(_r)._add(As)}if(it){var Wo=Math.sin(it),zs=Math.cos(it),ki=[zs,-Wo,Wo,zs];Dr._matMult(ki),dr._matMult(ki),so._matMult(ki),zn._matMult(ki)}var Ps=new M(0,0),Wa=new M(0,0);Yt.push({tl:Dr,tr:dr,bl:so,br:zn,tex:gr,writingMode:ke.writingMode,glyphOffset:jn,sectionIndex:kt.sectionIndex,isSDF:fi,pixelOffsetTL:Ps,pixelOffsetBR:Wa,minFontScaleX:0,minFontScaleY:0})}}return Yt}(0,i,k,p,d,_,l,e.allowVerticalPlacement),le=e.textSizeData,ne=null;le.kind==="source"?(ne=[128*p.layout.get("text-size").evaluate(_,{})])[0]>32640&&xt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):le.kind==="composite"&&((ne=[128*Z.compositeTextSizes[0].evaluate(_,{},Y),128*Z.compositeTextSizes[1].evaluate(_,{},Y)])[0]>32640||ne[1]>32640)&&xt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,$,ne,k,d,_,z,t,I.lineStartIndex,I.lineLength,U,Y);for(var fe=0,_e=D;fe<_e.length;fe+=1)R[_e[fe]]=e.text.placedSymbolArray.length-1;return 4*$.length}function Mf(e){for(var t in e)return e[t];return null}function _g(e,t,i,l){var p=e.compareText;if(t in p){for(var d=p[t],_=d.length-1;_>=0;_--)if(l.dist(d[_])<i)return!0}else p[t]=[];return p[t].push(l),!1}var vg=mu.VectorTileFeature.types,xg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nh(e,t,i,l,p,d,_,k,I,z,D,R,U){var Z=k?Math.min(32640,Math.round(k[0])):0,Y=k?Math.min(32640,Math.round(k[1])):0;e.emplaceBack(t,i,Math.round(32*l),Math.round(32*p),d,_,(Z<<1)+(I?1:0),Y,16*z,16*D,256*R,256*U)}function sp(e,t,i){e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i),e.emplaceBack(t.x,t.y,i)}function bg(e){for(var t=0,i=e.sections;t<i.length;t+=1)if(Hs(i[t].text))return!0;return!1}var wu=function(e){this.layoutVertexArray=new lu,this.indexArray=new ws,this.programConfigurations=e,this.segments=new K,this.dynamicLayoutVertexArray=new dl,this.opacityVertexArray=new Ol,this.placedSymbolArray=new u};wu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},wu.prototype.upload=function(e,t,i,l){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xy.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Wy.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,xg,!0),this.opacityVertexBuffer.itemSize=1),(i||l)&&this.programConfigurations.upload(e))},wu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},at("SymbolBuffers",wu);var hc=function(e,t,i){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new i,this.segments=new K,this.collisionVertexArray=new $u};hc.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hy.members,!0)},hc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},at("CollisionBuffers",hc);var Rr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Mo([]),this.placementViewportMatrix=Mo([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=np(this.zoom,t["text-size"]),this.iconSizeData=np(this.zoom,t["icon-size"]);var i=this.layers[0].layout,l=i.get("symbol-sort-key"),p=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&l.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(d){return Xo[d]})),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id}),this.sourceID=e.sourceID};Rr.prototype.createArrays=function(){this.text=new wu(new It(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new wu(new It(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new S,this.lineVertexArray=new T,this.symbolInstances=new x},Rr.prototype.calculateGlyphDependencies=function(e,t,i,l,p){for(var d=0;d<e.length;d++)if(t[e.charCodeAt(d)]=!0,(i||l)&&p){var _=lc[e.charAt(d)];_&&(t[_.charCodeAt(0)]=!0)}},Rr.prototype.populate=function(e,t,i){var l=this.layers[0],p=l.layout,d=p.get("text-font"),_=p.get("text-field"),k=p.get("icon-image"),I=(_.value.kind!=="constant"||_.value.value instanceof Hr&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(d.value.kind!=="constant"||d.value.value.length>0),z=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,D=p.get("symbol-sort-key");if(this.features=[],I||z){for(var R=t.iconDependencies,U=t.glyphDependencies,Z=t.availableImages,Y=new ir(this.zoom),$=0,le=e;$<le.length;$+=1){var ne=le[$],fe=ne.feature,_e=ne.id,xe=ne.index,ke=ne.sourceLayerIndex,Re=l._featureFilter.needGeometry,qe=wi(fe,Re);if(l._featureFilter.filter(Y,qe,i)){Re||(qe.geometry=ui(fe));var Je=void 0;if(I){var _t=l.getValueAndResolveTokens("text-field",qe,i,Z),tt=Hr.factory(_t);bg(tt)&&(this.hasRTLText=!0),(!this.hasRTLText||Hu()==="unavailable"||this.hasRTLText&&Co.isParsed())&&(Je=Yy(tt,l,qe))}var St=void 0;if(z){var it=l.getValueAndResolveTokens("icon-image",qe,i,Z);St=it instanceof hi?it:hi.fromString(it)}if(Je||St){var Yt=this.sortFeaturesByKey?D.evaluate(qe,{},i):void 0;if(this.features.push({id:_e,text:Je,icon:St,index:xe,sourceLayerIndex:ke,geometry:qe.geometry,properties:fe.properties,type:vg[fe.type],sortKey:Yt}),St&&(R[St.name]=!0),Je){var At=d.evaluate(qe,{},i).join(","),mt=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Xo.vertical)>=0;for(var rr=0,jt=Je.sections;rr<jt.length;rr+=1){var lr=jt[rr];if(lr.image)R[lr.image.name]=!0;else{var kt=as(Je.toString()),gr=lr.fontStack||At,$r=U[gr]=U[gr]||{};this.calculateGlyphDependencies(lr.text,$r,mt,this.allowVerticalPlacement,kt)}}}}}}p.get("symbol-placement")==="line"&&(this.features=function(fi){var ci={},ei={},di=[],Xi=0;function Wi(Yr){di.push(fi[Yr]),Xi++}function jn(Yr,zi,Pn){var _r=ei[Yr];return delete ei[Yr],ei[zi]=_r,di[_r].geometry[0].pop(),di[_r].geometry[0]=di[_r].geometry[0].concat(Pn[0]),_r}function rn(Yr,zi,Pn){var _r=ci[zi];return delete ci[zi],ci[Yr]=_r,di[_r].geometry[0].shift(),di[_r].geometry[0]=Pn[0].concat(di[_r].geometry[0]),_r}function qn(Yr,zi,Pn){var _r=Pn?zi[0][zi[0].length-1]:zi[0][0];return Yr+":"+_r.x+":"+_r.y}for(var Si=0;Si<fi.length;Si++){var nn=fi[Si],ar=nn.geometry,Vr=nn.text?nn.text.toString():null;if(Vr){var Dr=qn(Vr,ar),dr=qn(Vr,ar,!0);if(Dr in ei&&dr in ci&&ei[Dr]!==ci[dr]){var so=rn(Dr,dr,ar),zn=jn(Dr,dr,di[so].geometry);delete ci[Dr],delete ei[dr],ei[qn(Vr,di[zn].geometry,!0)]=zn,di[so].geometry=null}else Dr in ei?jn(Dr,dr,ar):dr in ci?rn(Dr,dr,ar):(Wi(Si),ci[Dr]=Xi-1,ei[dr]=Xi-1)}else Wi(Si)}return di.filter(function(Yr){return Yr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(fi,ci){return fi.sortKey-ci.sortKey})}},Rr.prototype.update=function(e,t,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,i))},Rr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Rr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Rr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Rr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Rr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Rr.prototype.addToLineVertexArray=function(e,t){var i=this.lineVertexArray.length;if(e.segment!==void 0){for(var l=e.dist(t[e.segment+1]),p=e.dist(t[e.segment]),d={},_=e.segment+1;_<t.length;_++)d[_]={x:t[_].x,y:t[_].y,tileUnitDistanceFromAnchor:l},_<t.length-1&&(l+=t[_+1].dist(t[_]));for(var k=e.segment||0;k>=0;k--)d[k]={x:t[k].x,y:t[k].y,tileUnitDistanceFromAnchor:p},k>0&&(p+=t[k-1].dist(t[k]));for(var I=0;I<t.length;I++){var z=d[I];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},Rr.prototype.addSymbols=function(e,t,i,l,p,d,_,k,I,z,D,R){for(var U=e.indexArray,Z=e.layoutVertexArray,Y=e.segments.prepareSegment(4*t.length,Z,U,this.canOverlap?d.sortKey:void 0),$=this.glyphOffsetArray.length,le=Y.vertexLength,ne=this.allowVerticalPlacement&&_===Xo.vertical?Math.PI/2:0,fe=d.text&&d.text.sections,_e=0;_e<t.length;_e++){var xe=t[_e],ke=xe.tl,Re=xe.tr,qe=xe.bl,Je=xe.br,_t=xe.tex,tt=xe.pixelOffsetTL,St=xe.pixelOffsetBR,it=xe.minFontScaleX,Yt=xe.minFontScaleY,At=xe.glyphOffset,mt=xe.isSDF,rr=xe.sectionIndex,jt=Y.vertexLength,lr=At[1];nh(Z,k.x,k.y,ke.x,lr+ke.y,_t.x,_t.y,i,mt,tt.x,tt.y,it,Yt),nh(Z,k.x,k.y,Re.x,lr+Re.y,_t.x+_t.w,_t.y,i,mt,St.x,tt.y,it,Yt),nh(Z,k.x,k.y,qe.x,lr+qe.y,_t.x,_t.y+_t.h,i,mt,tt.x,St.y,it,Yt),nh(Z,k.x,k.y,Je.x,lr+Je.y,_t.x+_t.w,_t.y+_t.h,i,mt,St.x,St.y,it,Yt),sp(e.dynamicLayoutVertexArray,k,ne),U.emplaceBack(jt,jt+1,jt+2),U.emplaceBack(jt+1,jt+2,jt+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(At[0]),_e!==t.length-1&&rr===t[_e+1].sectionIndex||e.programConfigurations.populatePaintArrays(Z.length,d,d.index,{},R,fe&&fe[rr])}e.placedSymbolArray.emplaceBack(k.x,k.y,$,this.glyphOffsetArray.length-$,le,I,z,k.segment,i?i[0]:0,i?i[1]:0,l[0],l[1],_,0,!1,0,D)},Rr.prototype._addCollisionDebugVertex=function(e,t,i,l,p,d){return t.emplaceBack(0,0),e.emplaceBack(i.x,i.y,l,p,Math.round(d.x),Math.round(d.y))},Rr.prototype.addCollisionDebugVertices=function(e,t,i,l,p,d,_){var k=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),I=k.vertexLength,z=p.layoutVertexArray,D=p.collisionVertexArray,R=_.anchorX,U=_.anchorY;this._addCollisionDebugVertex(z,D,d,R,U,new M(e,t)),this._addCollisionDebugVertex(z,D,d,R,U,new M(i,t)),this._addCollisionDebugVertex(z,D,d,R,U,new M(i,l)),this._addCollisionDebugVertex(z,D,d,R,U,new M(e,l)),k.vertexLength+=4;var Z=p.indexArray;Z.emplaceBack(I,I+1),Z.emplaceBack(I+1,I+2),Z.emplaceBack(I+2,I+3),Z.emplaceBack(I+3,I),k.primitiveLength+=4},Rr.prototype.addDebugCollisionBoxes=function(e,t,i,l){for(var p=e;p<t;p++){var d=this.collisionBoxArray.get(p);this.addCollisionDebugVertices(d.x1,d.y1,d.x2,d.y2,l?this.textCollisionBox:this.iconCollisionBox,d.anchorPoint,i)}},Rr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new hc(ml,cf.members,Nl),this.iconCollisionBox=new hc(ml,cf.members,Nl);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Rr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,i,l,p,d,_,k,I){for(var z={},D=t;D<i;D++){var R=e.get(D);z.textBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},z.textFeatureIndex=R.featureIndex;break}for(var U=l;U<p;U++){var Z=e.get(U);z.verticalTextBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},z.verticalTextFeatureIndex=Z.featureIndex;break}for(var Y=d;Y<_;Y++){var $=e.get(Y);z.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},z.iconFeatureIndex=$.featureIndex;break}for(var le=k;le<I;le++){var ne=e.get(le);z.verticalIconBox={x1:ne.x1,y1:ne.y1,x2:ne.x2,y2:ne.y2,anchorPointX:ne.anchorPointX,anchorPointY:ne.anchorPointY},z.verticalIconFeatureIndex=ne.featureIndex;break}return z},Rr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var i=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},Rr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Rr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Rr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Rr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Rr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Rr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var i=e.placedSymbolArray.get(t),l=i.vertexStartIndex+4*i.numGlyphs,p=i.vertexStartIndex;p<l;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)},Rr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),i=Math.cos(e),l=[],p=[],d=[],_=0;_<this.symbolInstances.length;++_){d.push(_);var k=this.symbolInstances.get(_);l.push(0|Math.round(t*k.anchorX+i*k.anchorY)),p.push(k.featureIndex)}return d.sort(function(I,z){return l[I]-l[z]||p[z]-p[I]}),d},Rr.prototype.addToSortKeyRanges=function(e,t){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===t?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Rr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,l=this.symbolInstanceIndexes;i<l.length;i+=1){var p=this.symbolInstances.get(l[i]);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(function(d,_,k){d>=0&&k.indexOf(d)===_&&t.addIndicesForPlacedSymbol(t.text,d)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},at("SymbolBucket",Rr,{omit:["layers","collisionBoxArray","features","compareText"]}),Rr.MAX_GLYPHS=65535,Rr.addDynamicAttributes=sp;var wg=new dn({"symbol-placement":new bt(j.layout_symbol["symbol-placement"]),"symbol-spacing":new bt(j.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new bt(j.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new dt(j.layout_symbol["symbol-sort-key"]),"symbol-z-order":new bt(j.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new bt(j.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new bt(j.layout_symbol["icon-ignore-placement"]),"icon-optional":new bt(j.layout_symbol["icon-optional"]),"icon-rotation-alignment":new bt(j.layout_symbol["icon-rotation-alignment"]),"icon-size":new dt(j.layout_symbol["icon-size"]),"icon-text-fit":new bt(j.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new bt(j.layout_symbol["icon-text-fit-padding"]),"icon-image":new dt(j.layout_symbol["icon-image"]),"icon-rotate":new dt(j.layout_symbol["icon-rotate"]),"icon-padding":new bt(j.layout_symbol["icon-padding"]),"icon-keep-upright":new bt(j.layout_symbol["icon-keep-upright"]),"icon-offset":new dt(j.layout_symbol["icon-offset"]),"icon-anchor":new dt(j.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new bt(j.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new bt(j.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new bt(j.layout_symbol["text-rotation-alignment"]),"text-field":new dt(j.layout_symbol["text-field"]),"text-font":new dt(j.layout_symbol["text-font"]),"text-size":new dt(j.layout_symbol["text-size"]),"text-max-width":new dt(j.layout_symbol["text-max-width"]),"text-line-height":new bt(j.layout_symbol["text-line-height"]),"text-letter-spacing":new dt(j.layout_symbol["text-letter-spacing"]),"text-justify":new dt(j.layout_symbol["text-justify"]),"text-radial-offset":new dt(j.layout_symbol["text-radial-offset"]),"text-variable-anchor":new bt(j.layout_symbol["text-variable-anchor"]),"text-anchor":new dt(j.layout_symbol["text-anchor"]),"text-max-angle":new bt(j.layout_symbol["text-max-angle"]),"text-writing-mode":new bt(j.layout_symbol["text-writing-mode"]),"text-rotate":new dt(j.layout_symbol["text-rotate"]),"text-padding":new bt(j.layout_symbol["text-padding"]),"text-keep-upright":new bt(j.layout_symbol["text-keep-upright"]),"text-transform":new dt(j.layout_symbol["text-transform"]),"text-offset":new dt(j.layout_symbol["text-offset"]),"text-allow-overlap":new bt(j.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new bt(j.layout_symbol["text-ignore-placement"]),"text-optional":new bt(j.layout_symbol["text-optional"])}),lp={paint:new dn({"icon-opacity":new dt(j.paint_symbol["icon-opacity"]),"icon-color":new dt(j.paint_symbol["icon-color"]),"icon-halo-color":new dt(j.paint_symbol["icon-halo-color"]),"icon-halo-width":new dt(j.paint_symbol["icon-halo-width"]),"icon-halo-blur":new dt(j.paint_symbol["icon-halo-blur"]),"icon-translate":new bt(j.paint_symbol["icon-translate"]),"icon-translate-anchor":new bt(j.paint_symbol["icon-translate-anchor"]),"text-opacity":new dt(j.paint_symbol["text-opacity"]),"text-color":new dt(j.paint_symbol["text-color"],{runtimeType:Ze,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new dt(j.paint_symbol["text-halo-color"]),"text-halo-width":new dt(j.paint_symbol["text-halo-width"]),"text-halo-blur":new dt(j.paint_symbol["text-halo-blur"]),"text-translate":new bt(j.paint_symbol["text-translate"]),"text-translate-anchor":new bt(j.paint_symbol["text-translate-anchor"])}),layout:wg},Su=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:et,this.defaultValue=e};Su.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Su.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Su.prototype.outputDefined=function(){return!1},Su.prototype.serialize=function(){return null},at("FormatSectionOverride",Su,{omit:["defaultValue"]});var Sg=function(e){function t(i){e.call(this,i,lp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(i,l){if(e.prototype.recalculate.call(this,i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var p=this.layout.get("text-writing-mode");if(p){for(var d=[],_=0,k=p;_<k.length;_+=1){var I=k[_];d.indexOf(I)<0&&d.push(I)}this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(i,l,p,d){var _=this.layout.get(i).evaluate(l,{},p,d),k=this._unevaluatedLayout._values[i];return k.isDataDriven()||Fa(k.value)||!_?_:function(I,z){return z.replace(/{([^{}]+)}/g,function(D,R){return R in I?String(I[R]):""})}(l.properties,_)},t.prototype.createBucket=function(i){return new Rr(i)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var i=0,l=lp.paint.overridableProperties;i<l.length;i+=1){var p=l[i];if(t.hasPaintOverride(this.layout,p)){var d,_=this.paint.get(p),k=new Su(_),I=new ts(k,_.property.specification);d=_.value.kind==="constant"||_.value.kind==="source"?new _s("source",I):new to("composite",I,_.value.zoomStops,_.value._interpolationType),this.paint._values[p]=new On(_.property,d,_.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&t.hasPaintOverride(this.layout,i)},t.hasPaintOverride=function(i,l){var p=i.get("text-field"),d=lp.paint.properties[l],_=!1,k=function(D){for(var R=0,U=D;R<U.length;R+=1)if(d.overrides&&d.overrides.hasOverride(U[R]))return void(_=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Hr)k(p.value.value.sections);else if(p.value.kind==="source"){var I=function(D){_||(D instanceof ai&&zr(D.value)===sr?k(D.value.sections):D instanceof cn?k(D.sections):D.eachChild(I))},z=p.value;z._styleExpression&&I(z._styleExpression.expression)}return _},t}(Za),kg={paint:new dn({"background-color":new bt(j.paint_background["background-color"]),"background-pattern":new Nn(j.paint_background["background-pattern"]),"background-opacity":new bt(j.paint_background["background-opacity"])})},Eg=function(e){function t(i){e.call(this,i,kg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Za),Tg={paint:new dn({"raster-opacity":new bt(j.paint_raster["raster-opacity"]),"raster-hue-rotate":new bt(j.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new bt(j.paint_raster["raster-brightness-min"]),"raster-brightness-max":new bt(j.paint_raster["raster-brightness-max"]),"raster-saturation":new bt(j.paint_raster["raster-saturation"]),"raster-contrast":new bt(j.paint_raster["raster-contrast"]),"raster-resampling":new bt(j.paint_raster["raster-resampling"]),"raster-fade-duration":new bt(j.paint_raster["raster-fade-duration"])})},Ig=function(e){function t(i){e.call(this,i,Tg)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Za),Ag=function(e){function t(i){e.call(this,i,{}),this.implementation=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},t.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},t}(Za),zg={circle:Kh,heatmap:py,hillshade:dy,fill:Cy,"fill-extrusion":Uy,line:Ky,symbol:Sg,background:Eg,raster:Ig},Df=B.HTMLImageElement,Lf=B.HTMLCanvasElement,Rf=B.HTMLVideoElement,Bf=B.ImageData,oh=B.ImageBitmap,Gl=function(e,t,i,l){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(t,l)};Gl.prototype.update=function(e,t,i){var l=e.width,p=e.height,d=!(this.size&&this.size[0]===l&&this.size[1]===p||i),_=this.context,k=_.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!t||t.premultiply!==!1)),d)this.size=[l,p],e instanceof Df||e instanceof Lf||e instanceof Rf||e instanceof Bf||oh&&e instanceof oh?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,l,p,0,this.format,k.UNSIGNED_BYTE,e.data);else{var I=i||{x:0,y:0},z=I.x,D=I.y;e instanceof Df||e instanceof Lf||e instanceof Rf||e instanceof Bf||oh&&e instanceof oh?k.texSubImage2D(k.TEXTURE_2D,0,z,D,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,z,D,l,p,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)},Gl.prototype.bind=function(e,t,i){var l=this.context.gl;l.bindTexture(l.TEXTURE_2D,this.texture),i!==l.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=l.LINEAR),e!==this.filter&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,i||e),this.filter=e),t!==this.wrap&&(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,t),this.wrap=t)},Gl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Gl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var up=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};up.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},up.prototype.remove=function(){delete this._channel,this._callback=function(){}};var ku=function(e,t,i){this.target=e,this.parent=t,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ur(["receive","process"],this),this.invoker=new up(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=nr()?e:B};function Ff(e,t,i){var l=2*Math.PI*6378137/256/Math.pow(2,i);return[e*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}ku.prototype.send=function(e,t,i,l,p){var d=this;p===void 0&&(p=!1);var _=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[_]=i);var k=qt(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:e,hasCallback:!!i,targetMapId:l,mustQueue:p,sourceMapId:this.mapId,data:En(t,k)},k),{cancel:function(){i&&delete d.callbacks[_],d.target.postMessage({id:_,type:"<cancel>",targetMapId:l,sourceMapId:d.mapId})}}},ku.prototype.receive=function(e){var t=e.data,i=t.id;if(i&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[i];var l=this.cancelCallbacks[i];delete this.cancelCallbacks[i],l&&l()}else nr()||t.mustQueue?(this.tasks[i]=t,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,t)},ku.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},ku.prototype.processTask=function(e,t){var i=this;if(t.type==="<response>"){var l=this.callbacks[e];delete this.callbacks[e],l&&(t.error?l(Tn(t.error)):l(null,Tn(t.data)))}else{var p=!1,d=qt(this.globalScope)?void 0:[],_=t.hasCallback?function(D,R){p=!0,delete i.cancelCallbacks[e],i.target.postMessage({id:e,type:"<response>",sourceMapId:i.mapId,error:D?En(D):null,data:En(R,d)},d)}:function(D){p=!0},k=null,I=Tn(t.data);if(this.parent[t.type])k=this.parent[t.type](t.sourceMapId,I,_);else if(this.parent.getWorkerSource){var z=t.type.split(".");k=this.parent.getWorkerSource(t.sourceMapId,z[0],I.source)[z[1]](I,_)}else _(new Error("Could not find function "+t.type));!p&&k&&k.cancel&&(this.cancelCallbacks[e]=k.cancel)}},ku.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Fi=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Fi.prototype.setNorthEast=function(e){return this._ne=e instanceof Qr?new Qr(e.lng,e.lat):Qr.convert(e),this},Fi.prototype.setSouthWest=function(e){return this._sw=e instanceof Qr?new Qr(e.lng,e.lat):Qr.convert(e),this},Fi.prototype.extend=function(e){var t,i,l=this._sw,p=this._ne;if(e instanceof Qr)t=e,i=e;else{if(!(e instanceof Fi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Fi.convert(e)):this.extend(Qr.convert(e)):this;if(i=e._ne,!(t=e._sw)||!i)return this}return l||p?(l.lng=Math.min(t.lng,l.lng),l.lat=Math.min(t.lat,l.lat),p.lng=Math.max(i.lng,p.lng),p.lat=Math.max(i.lat,p.lat)):(this._sw=new Qr(t.lng,t.lat),this._ne=new Qr(i.lng,i.lat)),this},Fi.prototype.getCenter=function(){return new Qr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Fi.prototype.getSouthWest=function(){return this._sw},Fi.prototype.getNorthEast=function(){return this._ne},Fi.prototype.getNorthWest=function(){return new Qr(this.getWest(),this.getNorth())},Fi.prototype.getSouthEast=function(){return new Qr(this.getEast(),this.getSouth())},Fi.prototype.getWest=function(){return this._sw.lng},Fi.prototype.getSouth=function(){return this._sw.lat},Fi.prototype.getEast=function(){return this._ne.lng},Fi.prototype.getNorth=function(){return this._ne.lat},Fi.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Fi.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Fi.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Fi.prototype.contains=function(e){var t=Qr.convert(e),i=t.lng,l=t.lat,p=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&p},Fi.convert=function(e){return!e||e instanceof Fi?e:new Fi(e)};var Qr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Qr.prototype.wrap=function(){return new Qr(Ie(this.lng,-180,180),this.lat)},Qr.prototype.toArray=function(){return[this.lng,this.lat]},Qr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Qr.prototype.distanceTo=function(e){var t=Math.PI/180,i=this.lat*t,l=e.lat*t,p=Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(p,1))},Qr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,i=t/Math.cos(Math.PI/180*this.lat);return new Fi(new Qr(this.lng-i,this.lat-t),new Qr(this.lng+i,this.lat+t))},Qr.convert=function(e){if(e instanceof Qr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Qr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Qr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Of=2*Math.PI*63710088e-1;function Nf(e){return Of*Math.cos(e*Math.PI/180)}function Uf(e){return(180+e)/360}function Vf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function jf(e,t){return e/Nf(t)}function cp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Kl=function(e,t,i){i===void 0&&(i=0),this.x=+e,this.y=+t,this.z=+i};Kl.fromLngLat=function(e,t){t===void 0&&(t=0);var i=Qr.convert(e);return new Kl(Uf(i.lng),Vf(i.lat),jf(t,i.lat))},Kl.prototype.toLngLat=function(){return new Qr(360*this.x-180,cp(this.y))},Kl.prototype.toAltitude=function(){return this.z*Nf(cp(this.y))},Kl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Of*(e=cp(this.y),1/Math.cos(e*Math.PI/180));var e};var Xl=function(e,t,i){this.z=e,this.x=t,this.y=i,this.key=pc(0,e,e,t,i)};Xl.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Xl.prototype.url=function(e,t){var i,l,p,d,_,k=(l=this.y,p=this.z,d=Ff(256*(i=this.x),256*(l=Math.pow(2,p)-l-1),p),_=Ff(256*(i+1),256*(l+1),p),d[0]+","+d[1]+","+_[0]+","+_[1]),I=function(z,D,R){for(var U,Z="",Y=z;Y>0;Y--)Z+=(D&(U=1<<Y-1)?1:0)+(R&U?2:0);return Z}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",I).replace("{bbox-epsg-3857}",k)},Xl.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new M(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Xl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qf=function(e,t){this.wrap=e,this.canonical=t,this.key=pc(e,t.z,t.z,t.x,t.y)},Oi=function(e,t,i,l,p){this.overscaledZ=e,this.wrap=t,this.canonical=new Xl(i,+l,+p),this.key=pc(t,e,i,l,p)};function pc(e,t,i,l,p){(e*=2)<0&&(e=-1*e-1);var d=1<<i;return(d*d*e+d*p+l).toString(36)+i.toString(36)+t.toString(36)}Oi.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Oi.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Oi(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Oi(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Oi.prototype.calculateScaledKey=function(e,t){var i=this.canonical.z-e;return e>this.canonical.z?pc(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):pc(this.wrap*+t,e,e,this.canonical.x>>i,this.canonical.y>>i)},Oi.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Oi.prototype.children=function(e){if(this.overscaledZ>=e)return[new Oi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,i=2*this.canonical.x,l=2*this.canonical.y;return[new Oi(t,this.wrap,t,i,l),new Oi(t,this.wrap,t,i+1,l),new Oi(t,this.wrap,t,i,l+1),new Oi(t,this.wrap,t,i+1,l+1)]},Oi.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Oi.prototype.wrapped=function(){return new Oi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Oi.prototype.unwrapTo=function(e){return new Oi(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Oi.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Oi.prototype.toUnwrapped=function(){return new qf(this.wrap,this.canonical)},Oi.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Oi.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Kl(e.x-this.wrap,e.y))},at("CanonicalTileID",Xl),at("OverscaledTileID",Oi,{omit:["posMatrix"]});var rl=function(e,t,i){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return xt('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var l=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=i||"mapbox";for(var p=0;p<l;p++)this.data[this._idx(-1,p)]=this.data[this._idx(0,p)],this.data[this._idx(l,p)]=this.data[this._idx(l-1,p)],this.data[this._idx(p,-1)]=this.data[this._idx(p,0)],this.data[this._idx(p,l)]=this.data[this._idx(p,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)]};rl.prototype.get=function(e,t){var i=new Uint8Array(this.data.buffer),l=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[l],i[l+1],i[l+2])},rl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},rl.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},rl.prototype._unpackMapbox=function(e,t,i){return(256*e*256+256*t+i)/10-1e4},rl.prototype._unpackTerrarium=function(e,t,i){return 256*e+t+i/256-32768},rl.prototype.getPixels=function(){return new wo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},rl.prototype.backfillBorder=function(e,t,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var l=t*this.dim,p=t*this.dim+this.dim,d=i*this.dim,_=i*this.dim+this.dim;switch(t){case-1:l=p-1;break;case 1:p=l+1}switch(i){case-1:d=_-1;break;case 1:_=d+1}for(var k=-t*this.dim,I=-i*this.dim,z=d;z<_;z++)for(var D=l;D<p;D++)this.data[this._idx(D,z)]=e.data[this._idx(D+k,z+I)]},at("DEMData",rl);var ah=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var i=e[t];this._stringToNumber[i]=t,this._numberToString[t]=i}};ah.prototype.encode=function(e){return this._stringToNumber[e]},ah.prototype.decode=function(e){return this._numberToString[e]};var sh=function(e,t,i,l,p){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=i,e._y=l,this.properties=e.properties,this.id=p},hp={geometry:{configurable:!0}};hp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},hp.geometry.set=function(e){this._geometry=e},sh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(sh.prototype,hp);var Eu=function(){this.state={},this.stateChanges={},this.deletedStates={}};Eu.prototype.updateState=function(e,t,i){var l=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][l]=this.stateChanges[e][l]||{},Me(this.stateChanges[e][l],i),this.deletedStates[e]===null)for(var p in this.deletedStates[e]={},this.state[e])p!==l&&(this.deletedStates[e][p]=null);else if(this.deletedStates[e]&&this.deletedStates[e][l]===null)for(var d in this.deletedStates[e][l]={},this.state[e][l])i[d]||(this.deletedStates[e][l][d]=null);else for(var _ in i)this.deletedStates[e]&&this.deletedStates[e][l]&&this.deletedStates[e][l][_]===null&&delete this.deletedStates[e][l][_]},Eu.prototype.removeFeatureState=function(e,t,i){if(this.deletedStates[e]!==null){var l=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&t!==void 0)this.deletedStates[e][l]!==null&&(this.deletedStates[e][l]=this.deletedStates[e][l]||{},this.deletedStates[e][l][i]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][l])for(i in this.deletedStates[e][l]={},this.stateChanges[e][l])this.deletedStates[e][l][i]=null;else this.deletedStates[e][l]=null;else this.deletedStates[e]=null}},Eu.prototype.getState=function(e,t){var i=String(t),l=Me({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var p=this.deletedStates[e][t];if(p===null)return{};for(var d in p)delete l[d]}return l},Eu.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Eu.prototype.coalesceChanges=function(e,t){var i={};for(var l in this.stateChanges){this.state[l]=this.state[l]||{};var p={};for(var d in this.stateChanges[l])this.state[l][d]||(this.state[l][d]={}),Me(this.state[l][d],this.stateChanges[l][d]),p[d]=this.state[l][d];i[l]=p}for(var _ in this.deletedStates){this.state[_]=this.state[_]||{};var k={};if(this.deletedStates[_]===null)for(var I in this.state[_])k[I]={},this.state[_][I]={};else for(var z in this.deletedStates[_]){if(this.deletedStates[_][z]===null)this.state[_][z]={};else for(var D=0,R=Object.keys(this.deletedStates[_][z]);D<R.length;D+=1)delete this.state[_][z][R[D]];k[z]=this.state[_][z]}i[_]=i[_]||{},Me(i[_],k)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var U in e)e[U].setFeatureState(i,t)};var il=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new qo(8192,16,0),this.grid3D=new qo(8192,16,0),this.featureIndexArray=new F,this.promoteId=t};function Zf(e,t,i,l,p){return pt(e,function(d,_){var k=t instanceof Fl?t.get(_):null;return k&&k.evaluate?k.evaluate(i,l,p):k})}function Gf(e){for(var t=1/0,i=1/0,l=-1/0,p=-1/0,d=0,_=e;d<_.length;d+=1){var k=_[d];t=Math.min(t,k.x),i=Math.min(i,k.y),l=Math.max(l,k.x),p=Math.max(p,k.y)}return{minX:t,minY:i,maxX:l,maxY:p}}function Pg(e,t){return t-e}il.prototype.insert=function(e,t,i,l,p,d){var _=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,l,p);for(var k=d?this.grid3D:this.grid,I=0;I<t.length;I++){for(var z=t[I],D=[1/0,1/0,-1/0,-1/0],R=0;R<z.length;R++){var U=z[R];D[0]=Math.min(D[0],U.x),D[1]=Math.min(D[1],U.y),D[2]=Math.max(D[2],U.x),D[3]=Math.max(D[3],U.y)}D[0]<8192&&D[1]<8192&&D[2]>=0&&D[3]>=0&&k.insert(_,D[0],D[1],D[2],D[3])}},il.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new mu.VectorTile(new Hc(this.rawTileData)).layers,this.sourceLayerCoder=new ah(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},il.prototype.query=function(e,t,i,l){var p=this;this.loadVTLayers();for(var d=e.params||{},_=8192/e.tileSize/e.scale,k=jo(d.filter),I=e.queryGeometry,z=e.queryPadding*_,D=Gf(I),R=this.grid.query(D.minX-z,D.minY-z,D.maxX+z,D.maxY+z),U=Gf(e.cameraQueryGeometry),Z=this.grid3D.query(U.minX-z,U.minY-z,U.maxX+z,U.maxY+z,function(xe,ke,Re,qe){return function(Je,_t,tt,St,it){for(var Yt=0,At=Je;Yt<At.length;Yt+=1){var mt=At[Yt];if(_t<=mt.x&&tt<=mt.y&&St>=mt.x&&it>=mt.y)return!0}var rr=[new M(_t,tt),new M(_t,it),new M(St,it),new M(St,tt)];if(Je.length>2){for(var jt=0,lr=rr;jt<lr.length;jt+=1)if(Ka(Je,lr[jt]))return!0}for(var kt=0;kt<Je.length-1;kt++)if(jl(Je[kt],Je[kt+1],rr))return!0;return!1}(e.cameraQueryGeometry,xe-z,ke-z,Re+z,qe+z)}),Y=0,$=Z;Y<$.length;Y+=1)R.push($[Y]);R.sort(Pg);for(var le,ne={},fe=function(xe){var ke=R[xe];if(ke!==le){le=ke;var Re=p.featureIndexArray.get(ke),qe=null;p.loadMatchingFeature(ne,Re.bucketIndex,Re.sourceLayerIndex,Re.featureIndex,k,d.layers,d.availableImages,t,i,l,function(Je,_t,tt){return qe||(qe=ui(Je)),_t.queryIntersectsFeature(I,Je,tt,qe,p.z,e.transform,_,e.pixelPosMatrix)})}},_e=0;_e<R.length;_e++)fe(_e);return ne},il.prototype.loadMatchingFeature=function(e,t,i,l,p,d,_,k,I,z,D){var R=this.bucketLayerIDs[t];if(!d||function(Je,_t){for(var tt=0;tt<Je.length;tt++)if(_t.indexOf(Je[tt])>=0)return!0;return!1}(d,R)){var U=this.sourceLayerCoder.decode(i),Z=this.vtLayers[U].feature(l);if(p.needGeometry){var Y=wi(Z,!0);if(!p.filter(new ir(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!p.filter(new ir(this.tileID.overscaledZ),Z))return;for(var $=this.getId(Z,U),le=0;le<R.length;le++){var ne=R[le];if(!(d&&d.indexOf(ne)<0)){var fe=k[ne];if(fe){var _e={};$!==void 0&&z&&(_e=z.getState(fe.sourceLayer||"_geojsonTileLayer",$));var xe=Me({},I[ne]);xe.paint=Zf(xe.paint,fe.paint,Z,_e,_),xe.layout=Zf(xe.layout,fe.layout,Z,_e,_);var ke=!D||D(Z,fe,_e);if(ke){var Re=new sh(Z,this.z,this.x,this.y,$);Re.layer=xe;var qe=e[ne];qe===void 0&&(qe=e[ne]=[]),qe.push({featureIndex:l,feature:Re,intersectionZ:ke})}}}}}},il.prototype.lookupSymbolFeatures=function(e,t,i,l,p,d,_,k){var I={};this.loadVTLayers();for(var z=jo(p),D=0,R=e;D<R.length;D+=1)this.loadMatchingFeature(I,i,l,R[D],z,d,_,k,t);return I},il.prototype.hasLayer=function(e){for(var t=0,i=this.bucketLayerIDs;t<i.length;t+=1)for(var l=0,p=i[t];l<p.length;l+=1)if(e===p[l])return!0;return!1},il.prototype.getId=function(e,t){var i=e.id;return this.promoteId&&typeof(i=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(i=Number(i)),i},at("FeatureIndex",il,{omit:["rawTileData","sourceLayerCoder"]});var tn=function(e,t){this.tileID=e,this.uid=Pt(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};tn.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Kn.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},tn.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},tn.prototype.loadVectorData=function(e,t,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var l in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(z,D){var R={};if(!D)return R;for(var U=function(){var $=Y[Z],le=$.layerIds.map(function(_e){return D.getLayer(_e)}).filter(Boolean);if(le.length!==0){$.layers=le,$.stateDependentLayerIds&&($.stateDependentLayers=$.stateDependentLayerIds.map(function(_e){return le.filter(function(xe){return xe.id===_e})[0]}));for(var ne=0,fe=le;ne<fe.length;ne+=1)R[fe[ne].id]=$}},Z=0,Y=z;Z<Y.length;Z+=1)U();return R}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var p=this.buckets[l];if(p instanceof Rr){if(this.hasSymbolBuckets=!0,!i)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var d in this.buckets){var _=this.buckets[d];if(_ instanceof Rr&&_.hasRTLText){this.hasRTLText=!0,Co.isLoading()||Co.isLoaded()||Hu()!=="deferred"||xa();break}}for(var k in this.queryPadding=0,this.buckets){var I=this.buckets[k];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(k).queryRadius(I))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},tn.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},tn.prototype.getBucket=function(e){return this.buckets[e.id]},tn.prototype.upload=function(e){for(var t in this.buckets){var i=this.buckets[t];i.uploadPending()&&i.upload(e)}var l=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Gl(e,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Gl(e,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null)},tn.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},tn.prototype.queryRenderedFeatures=function(e,t,i,l,p,d,_,k,I,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:l,cameraQueryGeometry:p,scale:d,tileSize:this.tileSize,pixelPosMatrix:z,transform:k,params:_,queryPadding:this.queryPadding*I},e,t,i):{}},tn.prototype.querySourceFeatures=function(e,t){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var l=i.loadVTLayers(),p=t?t.sourceLayer:"",d=l._geojsonTileLayer||l[p];if(d)for(var _=jo(t&&t.filter),k=this.tileID.canonical,I=k.z,z=k.x,D=k.y,R={z:I,x:z,y:D},U=0;U<d.length;U++){var Z=d.feature(U);if(_.needGeometry){var Y=wi(Z,!0);if(!_.filter(new ir(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!_.filter(new ir(this.tileID.overscaledZ),Z))continue;var $=i.getId(Z,p),le=new sh(Z,I,z,D,$);le.tile=R,e.push(le)}}},tn.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},tn.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},tn.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var i=wr(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var l=Date.now(),p=!1;if(this.expirationTime>l)p=!1;else if(t)if(this.expirationTime<t)p=!0;else{var d=this.expirationTime-t;d?this.expirationTime=l+Math.max(d,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},tn.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},tn.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var l in this.buckets)if(t.style.hasLayer(l)){var p=this.buckets[l],d=p.layers[0].sourceLayer||"_geojsonTileLayer",_=i[d],k=e[d];if(_&&k&&Object.keys(k).length!==0){p.update(k,_,this.imageAtlas&&this.imageAtlas.patternPositions||{});var I=t&&t.style&&t.style.getLayer(l);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(p)))}}}},tn.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},tn.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Kn.now()},tn.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},tn.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Kn.now()+e},tn.prototype.setDependencies=function(e,t){for(var i={},l=0,p=t;l<p.length;l+=1)i[p[l]]=!0;this.dependencies[e]=i},tn.prototype.hasDependency=function(e,t){for(var i=0,l=e;i<l.length;i+=1){var p=this.dependencies[l[i]];if(p){for(var d=0,_=t;d<_.length;d+=1)if(p[_[d]])return!0}}return!1};var xl=B.performance,Kf=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},xl.mark(this._marks.start)};Kf.prototype.finish=function(){xl.mark(this._marks.end);var e=xl.getEntriesByName(this._marks.measure);return e.length===0&&(xl.measure(this._marks.measure,this._marks.start,this._marks.end),e=xl.getEntriesByName(this._marks.measure),xl.clearMarks(this._marks.start),xl.clearMarks(this._marks.end),xl.clearMeasures(this._marks.measure)),e},a.Actor=ku,a.AlphaImage=Zl,a.CanonicalTileID=Xl,a.CollisionBoxArray=s,a.Color=Dt,a.DEMData=rl,a.DataConstantProperty=bt,a.DictionaryCoder=ah,a.EXTENT=8192,a.ErrorEvent=se,a.EvaluationParameters=ir,a.Event=J,a.Evented=he,a.FeatureIndex=il,a.FillBucket=cs,a.FillExtrusionBucket=hs,a.ImageAtlas=cc,a.ImagePosition=Yc,a.LineBucket=ao,a.LngLat=Qr,a.LngLatBounds=Fi,a.MercatorCoordinate=Kl,a.ONE_EM=24,a.OverscaledTileID=Oi,a.Point=M,a.Point$1=M,a.Properties=dn,a.Protobuf=Hc,a.RGBAImage=wo,a.RequestManager=ti,a.RequestPerformance=Kf,a.ResourceType=ko,a.SegmentVector=K,a.SourceFeatureState=Eu,a.StructArrayLayout1ui2=tc,a.StructArrayLayout2f1f2i16=Qs,a.StructArrayLayout2i4=Ys,a.StructArrayLayout3ui6=ws,a.StructArrayLayout4i8=Yu,a.SymbolBucket=Rr,a.Texture=Gl,a.Tile=tn,a.Transitionable=fn,a.Uniform1f=Xe,a.Uniform1i=Ue,a.Uniform2f=Ke,a.Uniform3f=ot,a.Uniform4f=wt,a.UniformColor=Tt,a.UniformMatrix4f=fr,a.UnwrappedTileID=qf,a.ValidationError=Q,a.WritingMode=Xo,a.ZoomHistory=os,a.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},a.addDynamicAttributes=sp,a.asyncAll=function(e,t,i){if(!e.length)return i(null,[]);var l=e.length,p=new Array(e.length),d=null;e.forEach(function(_,k){t(_,function(I,z){I&&(d=I),p[k]=z,--l==0&&i(d,p)})})},a.bezier=ue,a.bindAll=ur,a.browser=Kn,a.cacheEntryPossiblyAdded=function(e){++Yi>Ji&&(e.getActor().send("enforceCacheSizeLimit",Hn),Yi=0)},a.clamp=Ae,a.clearTileCache=function(e){var t=B.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},a.clipLine=If,a.clone=function(e){var t=new br(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},a.clone$1=gt,a.clone$2=function(e){var t=new br(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.collisionCircleLayout=Jy,a.config=Zt,a.create=function(){var e=new br(16);return br!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},a.create$1=function(){var e=new br(9);return br!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},a.create$2=function(){var e=new br(4);return br!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},a.createCommonjsModule=A,a.createExpression=Bn,a.createLayout=$i,a.createStyleLayer=function(e){return e.type==="custom"?new Ag(e):new zg[e.type](e)},a.cross=function(e,t,i){var l=t[0],p=t[1],d=t[2],_=i[0],k=i[1],I=i[2];return e[0]=p*I-d*k,e[1]=d*_-l*I,e[2]=l*k-p*_,e},a.deepEqual=function e(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],i[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(var p in t)if(!e(t[p],i[p]))return!1;return!0}return t===i},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},a.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},a.ease=ze,a.emitValidationErrors=Po,a.endsWith=cr,a.enforceCacheSizeLimit=function(e){Mi(),_i&&_i.then(function(t){t.keys().then(function(i){for(var l=0;l<i.length-e;l++)t.delete(i[l])})})},a.evaluateSizeForFeature=bf,a.evaluateSizeForZoom=wf,a.evaluateVariableOffset=Pf,a.evented=Wu,a.extend=Me,a.featureFilter=jo,a.filterObject=hr,a.fromRotation=function(e,t){var i=Math.sin(t),l=Math.cos(t);return e[0]=l,e[1]=i,e[2]=0,e[3]=-i,e[4]=l,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},a.getAnchorAlignment=ip,a.getAnchorJustification=ap,a.getArrayBuffer=Dn,a.getImage=O,a.getJSON=function(e,t){return Qi(Me(e,{type:"json"}),t)},a.getRTLTextPluginStatus=Hu,a.getReferrer=_n,a.getVideo=function(e,t){var i,l,p=B.document.createElement("video");p.muted=!0,p.onloadstart=function(){t(null,p)};for(var d=0;d<e.length;d++){var _=B.document.createElement("source");i=e[d],l=void 0,(l=B.document.createElement("a")).href=i,(l.protocol!==B.document.location.protocol||l.host!==B.document.location.host)&&(p.crossOrigin="Anonymous"),_.src=e[d],p.appendChild(_)}return{cancel:function(){}}},a.identity=Mo,a.invert=function(e,t){var i=t[0],l=t[1],p=t[2],d=t[3],_=t[4],k=t[5],I=t[6],z=t[7],D=t[8],R=t[9],U=t[10],Z=t[11],Y=t[12],$=t[13],le=t[14],ne=t[15],fe=i*k-l*_,_e=i*I-p*_,xe=i*z-d*_,ke=l*I-p*k,Re=l*z-d*k,qe=p*z-d*I,Je=D*$-R*Y,_t=D*le-U*Y,tt=D*ne-Z*Y,St=R*le-U*$,it=R*ne-Z*$,Yt=U*ne-Z*le,At=fe*Yt-_e*it+xe*St+ke*tt-Re*_t+qe*Je;return At?(e[0]=(k*Yt-I*it+z*St)*(At=1/At),e[1]=(p*it-l*Yt-d*St)*At,e[2]=($*qe-le*Re+ne*ke)*At,e[3]=(U*Re-R*qe-Z*ke)*At,e[4]=(I*tt-_*Yt-z*_t)*At,e[5]=(i*Yt-p*tt+d*_t)*At,e[6]=(le*xe-Y*qe-ne*_e)*At,e[7]=(D*qe-U*xe+Z*_e)*At,e[8]=(_*it-k*tt+z*Je)*At,e[9]=(l*tt-i*it-d*Je)*At,e[10]=(Y*Re-$*xe+ne*fe)*At,e[11]=(R*xe-D*Re-Z*fe)*At,e[12]=(k*_t-_*St-I*Je)*At,e[13]=(i*St-l*_t+p*Je)*At,e[14]=($*_e-Y*ke-le*fe)*At,e[15]=(D*ke-R*_e+U*fe)*At,e):null},a.isChar=Ye,a.isMapboxURL=oi,a.keysDifference=function(e,t){var i=[];for(var l in e)l in t||i.push(l);return i},a.makeRequest=Qi,a.mapObject=pt,a.mercatorXfromLng=Uf,a.mercatorYfromLat=Vf,a.mercatorZfromAltitude=jf,a.mul=Gh,a.multiply=oo,a.mvt=mu,a.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},a.normalize=function(e,t){var i=t[0],l=t[1],p=t[2],d=i*i+l*l+p*p;return d>0&&(d=1/Math.sqrt(d)),e[0]=t[0]*d,e[1]=t[1]*d,e[2]=t[2]*d,e},a.number=ii,a.offscreenCanvasSupported=sn,a.ortho=function(e,t,i,l,p,d,_){var k=1/(t-i),I=1/(l-p),z=1/(d-_);return e[0]=-2*k,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*I,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*z,e[11]=0,e[12]=(t+i)*k,e[13]=(p+l)*I,e[14]=(_+d)*z,e[15]=1,e},a.parseGlyphPBF=function(e){return new Hc(e).readFields(sg,[])},a.pbf=Hc,a.performSymbolLayout=function(e,t,i,l,p,d,_){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var k=e.layers[0].layout,I=e.layers[0]._unevaluatedLayout._values,z={};if(e.textSizeData.kind==="composite"){var D=e.textSizeData,R=D.maxZoom;z.compositeTextSizes=[I["text-size"].possiblyEvaluate(new ir(D.minZoom),_),I["text-size"].possiblyEvaluate(new ir(R),_)]}if(e.iconSizeData.kind==="composite"){var U=e.iconSizeData,Z=U.maxZoom;z.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new ir(U.minZoom),_),I["icon-size"].possiblyEvaluate(new ir(Z),_)]}z.layoutTextSize=I["text-size"].possiblyEvaluate(new ir(e.zoom+1),_),z.layoutIconSize=I["icon-size"].possiblyEvaluate(new ir(e.zoom+1),_),z.textMaxSize=I["text-size"].possiblyEvaluate(new ir(18));for(var Y=24*k.get("text-line-height"),$=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",le=k.get("text-keep-upright"),ne=k.get("text-size"),fe=function(){var ke=xe[_e],Re=k.get("text-font").evaluate(ke,{},_).join(","),qe=ne.evaluate(ke,{},_),Je=z.layoutTextSize.evaluate(ke,{},_),_t=z.layoutIconSize.evaluate(ke,{},_),tt={horizontal:{},vertical:void 0},St=ke.text,it=[0,0];if(St){var Yt=St.toString(),At=24*k.get("text-letter-spacing").evaluate(ke,{},_),mt=function(ar){for(var Vr=0,Dr=ar;Vr<Dr.length;Vr+=1)if(dr=Dr[Vr].charCodeAt(0),Ye.Arabic(dr)||Ye["Arabic Supplement"](dr)||Ye["Arabic Extended-A"](dr)||Ye["Arabic Presentation Forms-A"](dr)||Ye["Arabic Presentation Forms-B"](dr))return!1;var dr;return!0}(Yt)?At:0,rr=k.get("text-anchor").evaluate(ke,{},_),jt=k.get("text-variable-anchor");if(!jt){var lr=k.get("text-radial-offset").evaluate(ke,{},_);it=lr?Pf(rr,[24*lr,op]):k.get("text-offset").evaluate(ke,{},_).map(function(ar){return 24*ar})}var kt=$?"center":k.get("text-justify").evaluate(ke,{},_),gr=k.get("symbol-placement"),$r=gr==="point"?24*k.get("text-max-width").evaluate(ke,{},_):0,fi=function(){e.allowVerticalPlacement&&as(Yt)&&(tt.vertical=Qc(St,t,i,p,Re,$r,Y,rr,"left",mt,it,Xo.vertical,!0,gr,Je,qe))};if(!$&&jt){for(var ci=kt==="auto"?jt.map(function(ar){return ap(ar)}):[kt],ei=!1,di=0;di<ci.length;di++){var Xi=ci[di];if(!tt.horizontal[Xi])if(ei)tt.horizontal[Xi]=tt.horizontal[0];else{var Wi=Qc(St,t,i,p,Re,$r,Y,"center",Xi,mt,it,Xo.horizontal,!1,gr,Je,qe);Wi&&(tt.horizontal[Xi]=Wi,ei=Wi.positionedLines.length===1)}}fi()}else{kt==="auto"&&(kt=ap(rr));var jn=Qc(St,t,i,p,Re,$r,Y,rr,kt,mt,it,Xo.horizontal,!1,gr,Je,qe);jn&&(tt.horizontal[kt]=jn),fi(),as(Yt)&&$&&le&&(tt.vertical=Qc(St,t,i,p,Re,$r,Y,rr,kt,mt,it,Xo.vertical,!1,gr,Je,qe))}}var rn=void 0,qn=!1;if(ke.icon&&ke.icon.name){var Si=l[ke.icon.name];Si&&(rn=function(ar,Vr,Dr){var dr=ip(Dr),so=Vr[0]-ar.displaySize[0]*dr.horizontalAlign,zn=Vr[1]-ar.displaySize[1]*dr.verticalAlign;return{image:ar,top:zn,bottom:zn+ar.displaySize[1],left:so,right:so+ar.displaySize[0]}}(p[ke.icon.name],k.get("icon-offset").evaluate(ke,{},_),k.get("icon-anchor").evaluate(ke,{},_)),qn=Si.sdf,e.sdfIcons===void 0?e.sdfIcons=Si.sdf:e.sdfIcons!==Si.sdf&&xt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Si.pixelRatio!==e.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var nn=Mf(tt.horizontal)||tt.vertical;e.iconsInText=!!nn&&nn.iconsInText,(nn||rn)&&function(ar,Vr,Dr,dr,so,zn,Yr,zi,Pn,_r,As){var Wo=zn.textMaxSize.evaluate(Vr,{});Wo===void 0&&(Wo=Yr);var zs,ki=ar.layers[0].layout,Ps=ki.get("icon-offset").evaluate(Vr,{},As),Wa=Mf(Dr.horizontal),Tu=Yr/24,Wl=ar.tilePixelRatio*Tu,Iu=ar.tilePixelRatio*Wo/24,nl=ar.tilePixelRatio*zi,Au=ar.tilePixelRatio*ki.get("symbol-spacing"),lh=ki.get("text-padding")*ar.tilePixelRatio,zu=ki.get("icon-padding")*ar.tilePixelRatio,fc=ki.get("text-max-angle")/180*Math.PI,uh=ki.get("text-rotation-alignment")==="map"&&ki.get("symbol-placement")!=="point",ch=ki.get("icon-rotation-alignment")==="map"&&ki.get("symbol-placement")!=="point",ol=ki.get("symbol-placement"),dc=Au/2,Pu=ki.get("icon-text-fit");dr&&Pu!=="none"&&(ar.allowVerticalPlacement&&Dr.vertical&&(zs=xf(dr,Dr.vertical,Pu,ki.get("icon-text-fit-padding"),Ps,Tu)),Wa&&(dr=xf(dr,Wa,Pu,ki.get("icon-text-fit-padding"),Ps,Tu)));var bl=function(Cg,wc){wc.x<0||wc.x>=8192||wc.y<0||wc.y>=8192||function(Ei,ps,Mg,wl,mp,Hf,yh,Cs,gh,Sc,_h,vh,yp,Jf,kc,Yf,Qf,$f,ed,td,Ho,xh,rd,Ms,Dg){var id,Jl,Ru,Bu,Fu,Ou=Ei.addToLineVertexArray(ps,Mg),nd=0,od=0,ad=0,sd=0,gp=-1,_p=-1,al={},ld=H(""),vp=0,xp=0;if(Cs._unevaluatedLayout.getValue("text-radial-offset")===void 0?(vp=(id=Cs.layout.get("text-offset").evaluate(Ho,{},Ms).map(function(Tc){return 24*Tc}))[0],xp=id[1]):(vp=24*Cs.layout.get("text-radial-offset").evaluate(Ho,{},Ms),xp=op),Ei.allowVerticalPlacement&&wl.vertical){var ud=Cs.layout.get("text-rotate").evaluate(Ho,{},Ms)+90;Bu=new ih(gh,ps,Sc,_h,vh,wl.vertical,yp,Jf,kc,ud),yh&&(Fu=new ih(gh,ps,Sc,_h,vh,yh,Qf,$f,kc,ud))}if(mp){var bp=Cs.layout.get("icon-rotate").evaluate(Ho,{}),cd=Cs.layout.get("icon-text-fit")!=="none",hd=Af(mp,bp,rd,cd),wp=yh?Af(yh,bp,rd,cd):void 0;Ru=new ih(gh,ps,Sc,_h,vh,mp,Qf,$f,!1,bp),nd=4*hd.length;var pd=Ei.iconSizeData,Ec=null;pd.kind==="source"?(Ec=[128*Cs.layout.get("icon-size").evaluate(Ho,{})])[0]>32640&&xt(Ei.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):pd.kind==="composite"&&((Ec=[128*xh.compositeIconSizes[0].evaluate(Ho,{},Ms),128*xh.compositeIconSizes[1].evaluate(Ho,{},Ms)])[0]>32640||Ec[1]>32640)&&xt(Ei.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ei.addSymbols(Ei.icon,hd,Ec,td,ed,Ho,!1,ps,Ou.lineStartIndex,Ou.lineLength,-1,Ms),gp=Ei.icon.placedSymbolArray.length-1,wp&&(od=4*wp.length,Ei.addSymbols(Ei.icon,wp,Ec,td,ed,Ho,Xo.vertical,ps,Ou.lineStartIndex,Ou.lineLength,-1,Ms),_p=Ei.icon.placedSymbolArray.length-1)}for(var fd in wl.horizontal){var bh=wl.horizontal[fd];if(!Jl){ld=H(bh.text);var Lg=Cs.layout.get("text-rotate").evaluate(Ho,{},Ms);Jl=new ih(gh,ps,Sc,_h,vh,bh,yp,Jf,kc,Lg)}var dd=bh.positionedLines.length===1;if(ad+=Cf(Ei,ps,bh,Hf,Cs,kc,Ho,Yf,Ou,wl.vertical?Xo.horizontal:Xo.horizontalOnly,dd?Object.keys(wl.horizontal):[fd],al,gp,xh,Ms),dd)break}wl.vertical&&(sd+=Cf(Ei,ps,wl.vertical,Hf,Cs,kc,Ho,Yf,Ou,Xo.vertical,["vertical"],al,_p,xh,Ms));var Rg=Jl?Jl.boxStartIndex:Ei.collisionBoxArray.length,Bg=Jl?Jl.boxEndIndex:Ei.collisionBoxArray.length,Fg=Bu?Bu.boxStartIndex:Ei.collisionBoxArray.length,Og=Bu?Bu.boxEndIndex:Ei.collisionBoxArray.length,Ng=Ru?Ru.boxStartIndex:Ei.collisionBoxArray.length,Ug=Ru?Ru.boxEndIndex:Ei.collisionBoxArray.length,Vg=Fu?Fu.boxStartIndex:Ei.collisionBoxArray.length,jg=Fu?Fu.boxEndIndex:Ei.collisionBoxArray.length,Ds=-1,wh=function(Tc,yd){return Tc&&Tc.circleDiameter?Math.max(Tc.circleDiameter,yd):yd};Ds=wh(Jl,Ds),Ds=wh(Bu,Ds),Ds=wh(Ru,Ds);var md=(Ds=wh(Fu,Ds))>-1?1:0;md&&(Ds*=Dg/24),Ei.glyphOffsetArray.length>=Rr.MAX_GLYPHS&&xt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ho.sortKey!==void 0&&Ei.addToSortKeyRanges(Ei.symbolInstances.length,Ho.sortKey),Ei.symbolInstances.emplaceBack(ps.x,ps.y,al.right>=0?al.right:-1,al.center>=0?al.center:-1,al.left>=0?al.left:-1,al.vertical||-1,gp,_p,ld,Rg,Bg,Fg,Og,Ng,Ug,Vg,jg,Sc,ad,sd,nd,od,md,0,yp,vp,xp,Ds)}(ar,wc,Cg,Dr,dr,so,zs,ar.layers[0],ar.collisionBoxArray,Vr.index,Vr.sourceLayerIndex,ar.index,Wl,lh,uh,Pn,nl,zu,ch,Ps,Vr,zn,_r,As,Yr)};if(ol==="line")for(var Cu=0,hh=If(Vr.geometry,0,0,8192,8192);Cu<hh.length;Cu+=1)for(var ph=hh[Cu],mc=0,yc=dg(ph,Au,fc,Dr.vertical||Wa,dr,24,Iu,ar.overscaling,8192);mc<yc.length;mc+=1){var fh=yc[mc];Wa&&_g(ar,Wa.text,dc,fh)||bl(ph,fh)}else if(ol==="line-center")for(var gc=0,_c=Vr.geometry;gc<_c.length;gc+=1){var vc=_c[gc];if(vc.length>1){var dh=fg(vc,fc,Dr.vertical||Wa,dr,24,Iu);dh&&bl(vc,dh)}}else if(Vr.type==="Polygon")for(var Mu=0,mh=Qh(Vr.geometry,0);Mu<mh.length;Mu+=1){var Du=mh[Mu],xc=yg(Du,16);bl(Du[0],new vu(xc.x,xc.y,0))}else if(Vr.type==="LineString")for(var Hl=0,bc=Vr.geometry;Hl<bc.length;Hl+=1){var Lu=bc[Hl];bl(Lu,new vu(Lu[0].x,Lu[0].y,0))}else if(Vr.type==="Point")for(var pp=0,Xf=Vr.geometry;pp<Xf.length;pp+=1)for(var fp=0,Wf=Xf[pp];fp<Wf.length;fp+=1){var dp=Wf[fp];bl([dp],new vu(dp.x,dp.y,0))}}(e,ke,tt,rn,l,z,Je,_t,it,qn,_)},_e=0,xe=e.features;_e<xe.length;_e+=1)fe();d&&e.generateCollisionDebugBuffers()},a.perspective=function(e,t,i,l,p){var d,_=1/Math.tan(t/2);return e[0]=_/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=_,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,p!=null&&p!==1/0?(e[10]=(p+l)*(d=1/(l-p)),e[14]=2*p*l*d):(e[10]=-1,e[14]=-2*l),e},a.pick=function(e,t){for(var i={},l=0;l<t.length;l++){var p=t[l];p in e&&(i[p]=e[p])}return i},a.plugin=Co,a.polygonIntersectsPolygon=Es,a.postMapLoadEvent=lo,a.postTurnstileEvent=yn,a.potpack=yf,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=at,a.registerForPluginStateChange=function(e){return e({pluginStatus:In,pluginURL:io}),Wu.on("pluginStateChange",e),e},a.renderColorRamp=Jp,a.rotate=function(e,t,i){var l=t[0],p=t[1],d=t[2],_=t[3],k=Math.sin(i),I=Math.cos(i);return e[0]=l*I+d*k,e[1]=p*I+_*k,e[2]=l*-k+d*I,e[3]=p*-k+_*I,e},a.rotateX=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),d=t[4],_=t[5],k=t[6],I=t[7],z=t[8],D=t[9],R=t[10],U=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=d*p+z*l,e[5]=_*p+D*l,e[6]=k*p+R*l,e[7]=I*p+U*l,e[8]=z*p-d*l,e[9]=D*p-_*l,e[10]=R*p-k*l,e[11]=U*p-I*l,e},a.rotateZ=function(e,t,i){var l=Math.sin(i),p=Math.cos(i),d=t[0],_=t[1],k=t[2],I=t[3],z=t[4],D=t[5],R=t[6],U=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*p+z*l,e[1]=_*p+D*l,e[2]=k*p+R*l,e[3]=I*p+U*l,e[4]=z*p-d*l,e[5]=D*p-_*l,e[6]=R*p-k*l,e[7]=U*p-I*l,e},a.scale=function(e,t,i){var l=i[0],p=i[1],d=i[2];return e[0]=t[0]*l,e[1]=t[1]*l,e[2]=t[2]*l,e[3]=t[3]*l,e[4]=t[4]*p,e[5]=t[5]*p,e[6]=t[6]*p,e[7]=t[7]*p,e[8]=t[8]*d,e[9]=t[9]*d,e[10]=t[10]*d,e[11]=t[11]*d,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.scale$1=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},a.scale$2=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},a.setCacheLimits=function(e,t){Hn=e,Ji=t},a.setRTLTextPlugin=function(e,t,i){if(i===void 0&&(i=!1),In==="deferred"||In==="loading"||In==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");io=Kn.resolveURL(e),In="deferred",ja=t,Bl(),i||xa()},a.sphericalToCartesian=function(e){var t=e[0],i=e[1],l=e[2];return i+=90,i*=Math.PI/180,l*=Math.PI/180,{x:t*Math.cos(i)*Math.sin(l),y:t*Math.sin(i)*Math.sin(l),z:t*Math.cos(l)}},a.sqrLen=function(e){var t=e[0],i=e[1];return t*t+i*i},a.styleSpec=j,a.sub=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e},a.symbolSize=pg,a.transformMat3=function(e,t,i){var l=t[0],p=t[1],d=t[2];return e[0]=l*i[0]+p*i[3]+d*i[6],e[1]=l*i[1]+p*i[4]+d*i[7],e[2]=l*i[2]+p*i[5]+d*i[8],e},a.transformMat4=hu,a.translate=function(e,t,i){var l,p,d,_,k,I,z,D,R,U,Z,Y,$=i[0],le=i[1],ne=i[2];return t===e?(e[12]=t[0]*$+t[4]*le+t[8]*ne+t[12],e[13]=t[1]*$+t[5]*le+t[9]*ne+t[13],e[14]=t[2]*$+t[6]*le+t[10]*ne+t[14],e[15]=t[3]*$+t[7]*le+t[11]*ne+t[15]):(p=t[1],d=t[2],_=t[3],k=t[4],I=t[5],z=t[6],D=t[7],R=t[8],U=t[9],Z=t[10],Y=t[11],e[0]=l=t[0],e[1]=p,e[2]=d,e[3]=_,e[4]=k,e[5]=I,e[6]=z,e[7]=D,e[8]=R,e[9]=U,e[10]=Z,e[11]=Y,e[12]=l*$+k*le+R*ne+t[12],e[13]=p*$+I*le+U*ne+t[13],e[14]=d*$+z*le+Z*ne+t[14],e[15]=_*$+D*le+Y*ne+t[15]),e},a.triggerPluginCompletionEvent=Rl,a.uniqueId=Pt,a.validateCustomStyleLayer=function(e){var t=[],i=e.id;return i===void 0&&t.push({message:"layers."+i+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+i+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),t},a.validateLight=ou,a.validateStyle=vs,a.values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},a.vectorTile=mu,a.version="1.13.2",a.warnOnce=xt,a.webpSupported=Vi,a.window=B,a.wrap=Ie}),w(["./shared"],function(a){function A(L){var O=typeof L;if(O==="number"||O==="boolean"||O==="string"||L==null)return JSON.stringify(L);if(Array.isArray(L)){for(var q="[",W=0,J=L;W<J.length;W+=1)q+=A(J[W])+",";return q+"]"}for(var se=Object.keys(L).sort(),he="{",j=0;j<se.length;j++)he+=JSON.stringify(se[j])+":"+A(L[se[j]])+",";return he+"}"}function E(L){for(var O="",q=0,W=a.refProperties;q<W.length;q+=1)O+="/"+A(L[W[q]]);return O}var P=function(L){this.keyCache={},L&&this.replace(L)};P.prototype.replace=function(L){this._layerConfigs={},this._layers={},this.update(L,[])},P.prototype.update=function(L,O){for(var q=this,W=0,J=L;W<J.length;W+=1){var se=J[W];this._layerConfigs[se.id]=se;var he=this._layers[se.id]=a.createStyleLayer(se);he._featureFilter=a.featureFilter(he.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(var j=0,Q=O;j<Q.length;j+=1){var me=Q[j];delete this.keyCache[me],delete this._layerConfigs[me],delete this._layers[me]}this.familiesBySource={};for(var Be=0,Ne=function(Ge,Ze){for(var Ct={},$e=0;$e<Ge.length;$e++){var Kt=Ze&&Ze[Ge[$e].id]||E(Ge[$e]);Ze&&(Ze[Ge[$e].id]=Kt);var sr=Ct[Kt];sr||(sr=Ct[Kt]=[]),sr.push(Ge[$e])}var Ft=[];for(var Ot in Ct)Ft.push(Ct[Ot]);return Ft}(a.values(this._layerConfigs),this.keyCache);Be<Ne.length;Be+=1){var Se=Ne[Be].map(function(Ge){return q._layers[Ge.id]}),Oe=Se[0];if(Oe.visibility!=="none"){var rt=Oe.source||"",et=this.familiesBySource[rt];et||(et=this.familiesBySource[rt]={});var we=Oe.sourceLayer||"_geojsonTileLayer",Qe=et[we];Qe||(Qe=et[we]=[]),Qe.push(Se)}}};var M=function(L){var O={},q=[];for(var W in L){var J=L[W],se=O[W]={};for(var he in J){var j=J[+he];if(j&&j.bitmap.width!==0&&j.bitmap.height!==0){var Q={x:0,y:0,w:j.bitmap.width+2,h:j.bitmap.height+2};q.push(Q),se[he]={rect:Q,metrics:j.metrics}}}}var me=a.potpack(q),Be=new a.AlphaImage({width:me.w||1,height:me.h||1});for(var Ne in L){var Se=L[Ne];for(var Oe in Se){var rt=Se[+Oe];if(rt&&rt.bitmap.width!==0&&rt.bitmap.height!==0){var et=O[Ne][Oe].rect;a.AlphaImage.copy(rt.bitmap,Be,{x:0,y:0},{x:et.x+1,y:et.y+1},rt.bitmap)}}}this.image=Be,this.positions=O};a.register("GlyphAtlas",M);var V=function(L){this.tileID=new a.OverscaledTileID(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId};function B(L,O,q){for(var W=new a.EvaluationParameters(O),J=0,se=L;J<se.length;J+=1)se[J].recalculate(W,q)}function N(L,O){var q=a.getArrayBuffer(L.request,function(W,J,se,he){W?O(W):J&&O(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(J)),rawData:J,cacheControl:se,expires:he})});return function(){q.cancel(),O()}}V.prototype.parse=function(L,O,q,W,J){var se=this;this.status="parsing",this.data=L,this.collisionBoxArray=new a.CollisionBoxArray;var he=new a.DictionaryCoder(Object.keys(L.layers).sort()),j=new a.FeatureIndex(this.tileID,this.promoteId);j.bucketLayerIDs=[];var Q,me,Be,Ne,Se={},Oe={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},rt=O.familiesBySource[this.source];for(var et in rt){var we=L.layers[et];if(we){we.version===1&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+et+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Qe=he.encode(et),Ge=[],Ze=0;Ze<we.length;Ze++){var Ct=we.feature(Ze),$e=j.getId(Ct,et);Ge.push({feature:Ct,id:$e,index:Ze,sourceLayerIndex:Qe})}for(var Kt=0,sr=rt[et];Kt<sr.length;Kt+=1){var Ft=sr[Kt],Ot=Ft[0];Ot.minzoom&&this.zoom<Math.floor(Ot.minzoom)||Ot.maxzoom&&this.zoom>=Ot.maxzoom||Ot.visibility!=="none"&&(B(Ft,this.zoom,q),(Se[Ot.id]=Ot.createBucket({index:j.bucketLayerIDs.length,layers:Ft,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qe,sourceID:this.source})).populate(Ge,Oe,this.tileID.canonical),j.bucketLayerIDs.push(Ft.map(function(or){return or.id})))}}}var Xt=a.mapObject(Oe.glyphDependencies,function(or){return Object.keys(or).map(Number)});Object.keys(Xt).length?W.send("getGlyphs",{uid:this.uid,stacks:Xt},function(or,Ut){Q||(Q=or,me=Ut,Cr.call(se))}):me={};var Xr=Object.keys(Oe.iconDependencies);Xr.length?W.send("getImages",{icons:Xr,source:this.source,tileID:this.tileID,type:"icons"},function(or,Ut){Q||(Q=or,Be=Ut,Cr.call(se))}):Be={};var tr=Object.keys(Oe.patternDependencies);function Cr(){if(Q)return J(Q);if(me&&Be&&Ne){var or=new M(me),Ut=new a.ImageAtlas(Be,Ne);for(var Dt in Se){var Wr=Se[Dt];Wr instanceof a.SymbolBucket?(B(Wr.layers,this.zoom,q),a.performSymbolLayout(Wr,me,or.positions,Be,Ut.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Wr.hasPattern&&(Wr instanceof a.LineBucket||Wr instanceof a.FillBucket||Wr instanceof a.FillExtrusionBucket)&&(B(Wr.layers,this.zoom,q),Wr.addFeatures(Oe,this.tileID.canonical,Ut.patternPositions))}this.status="done",J(null,{buckets:a.values(Se).filter(function(Yn){return!Yn.isEmpty()}),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:or.image,imageAtlas:Ut,glyphMap:this.returnDependencies?me:null,iconMap:this.returnDependencies?Be:null,glyphPositions:this.returnDependencies?or.positions:null})}}tr.length?W.send("getImages",{icons:tr,source:this.source,tileID:this.tileID,type:"patterns"},function(or,Ut){Q||(Q=or,Ne=Ut,Cr.call(se))}):Ne={},Cr.call(this)};var ue=function(L,O,q,W){this.actor=L,this.layerIndex=O,this.availableImages=q,this.loadVectorData=W||N,this.loading={},this.loaded={}};ue.prototype.loadTile=function(L,O){var q=this,W=L.uid;this.loading||(this.loading={});var J=!!(L&&L.request&&L.request.collectResourceTiming)&&new a.RequestPerformance(L.request),se=this.loading[W]=new V(L);se.abort=this.loadVectorData(L,function(he,j){if(delete q.loading[W],he||!j)return se.status="done",q.loaded[W]=se,O(he);var Q=j.rawData,me={};j.expires&&(me.expires=j.expires),j.cacheControl&&(me.cacheControl=j.cacheControl);var Be={};if(J){var Ne=J.finish();Ne&&(Be.resourceTiming=JSON.parse(JSON.stringify(Ne)))}se.vectorTile=j.vectorTile,se.parse(j.vectorTile,q.layerIndex,q.availableImages,q.actor,function(Se,Oe){if(Se||!Oe)return O(Se);O(null,a.extend({rawTileData:Q.slice(0)},Oe,me,Be))}),q.loaded=q.loaded||{},q.loaded[W]=se})},ue.prototype.reloadTile=function(L,O){var q=this,W=this.loaded,J=L.uid,se=this;if(W&&W[J]){var he=W[J];he.showCollisionBoxes=L.showCollisionBoxes;var j=function(Q,me){var Be=he.reloadCallback;Be&&(delete he.reloadCallback,he.parse(he.vectorTile,se.layerIndex,q.availableImages,se.actor,Be)),O(Q,me)};he.status==="parsing"?he.reloadCallback=j:he.status==="done"&&(he.vectorTile?he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor,j):j())}},ue.prototype.abortTile=function(L,O){var q=this.loading,W=L.uid;q&&q[W]&&q[W].abort&&(q[W].abort(),delete q[W]),O()},ue.prototype.removeTile=function(L,O){var q=this.loaded,W=L.uid;q&&q[W]&&delete q[W],O()};var ze=a.window.ImageBitmap,Ae=function(){this.loaded={}};function Ie(L,O){if(L.length!==0){Me(L[0],O);for(var q=1;q<L.length;q++)Me(L[q],!O)}}function Me(L,O){for(var q=0,W=0,J=L.length,se=J-1;W<J;se=W++)q+=(L[W][0]-L[se][0])*(L[se][1]+L[W][1]);q>=0!=!!O&&L.reverse()}Ae.prototype.loadTile=function(L,O){var q=L.uid,W=L.encoding,J=L.rawImageData,se=ze&&J instanceof ze?this.getImageData(J):J,he=new a.DEMData(q,se,W);this.loaded=this.loaded||{},this.loaded[q]=he,O(null,he)},Ae.prototype.getImageData=function(L){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(L.width,L.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=L.width,this.offscreenCanvas.height=L.height,this.offscreenCanvasContext.drawImage(L,0,0,L.width,L.height);var O=this.offscreenCanvasContext.getImageData(-1,-1,L.width+2,L.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:O.width,height:O.height},O.data)},Ae.prototype.removeTile=function(L){var O=this.loaded,q=L.uid;O&&O[q]&&delete O[q]};var ft=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,Pt=function(L){this._feature=L,this.extent=a.EXTENT,this.type=L.type,this.properties=L.tags,"id"in L&&!isNaN(L.id)&&(this.id=parseInt(L.id,10))};Pt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var L=[],O=0,q=this._feature.geometry;O<q.length;O+=1){var W=q[O];L.push([new a.Point$1(W[0],W[1])])}return L}for(var J=[],se=0,he=this._feature.geometry;se<he.length;se+=1){for(var j=[],Q=0,me=he[se];Q<me.length;Q+=1){var Be=me[Q];j.push(new a.Point$1(Be[0],Be[1]))}J.push(j)}return J},Pt.prototype.toGeoJSON=function(L,O,q){return ft.call(this,L,O,q)};var ve=function(L){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=L.length,this._features=L};ve.prototype.feature=function(L){return new Pt(this._features[L])};var je=a.vectorTile.VectorTileFeature,ur=cr;function cr(L,O){this.options=O||{},this.features=L,this.length=L.length}function pt(L,O){this.id=typeof L.id=="number"?L.id:void 0,this.type=L.type,this.rawGeometry=L.type===1?[L.geometry]:L.geometry,this.properties=L.tags,this.extent=O||4096}cr.prototype.feature=function(L){return new pt(this.features[L],this.options.extent)},pt.prototype.loadGeometry=function(){var L=this.rawGeometry;this.geometry=[];for(var O=0;O<L.length;O++){for(var q=L[O],W=[],J=0;J<q.length;J++)W.push(new a.Point$1(q[J][0],q[J][1]));this.geometry.push(W)}return this.geometry},pt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var L=this.geometry,O=1/0,q=-1/0,W=1/0,J=-1/0,se=0;se<L.length;se++)for(var he=L[se],j=0;j<he.length;j++){var Q=he[j];O=Math.min(O,Q.x),q=Math.max(q,Q.x),W=Math.min(W,Q.y),J=Math.max(J,Q.y)}return[O,W,q,J]},pt.prototype.toGeoJSON=je.prototype.toGeoJSON;var hr=nt,gt=ur;function nt(L){var O=new a.pbf;return function(q,W){for(var J in q.layers)W.writeMessage(3,xt,q.layers[J])}(L,O),O.finish()}function xt(L,O){var q;O.writeVarintField(15,L.version||1),O.writeStringField(1,L.name||""),O.writeVarintField(5,L.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<L.length;q++)W.feature=L.feature(q),O.writeMessage(2,er,W);var J=W.keys;for(q=0;q<J.length;q++)O.writeStringField(3,J[q]);var se=W.values;for(q=0;q<se.length;q++)O.writeMessage(4,qt,se[q])}function er(L,O){var q=L.feature;q.id!==void 0&&O.writeVarintField(1,q.id),O.writeMessage(2,We,L),O.writeVarintField(3,q.type),O.writeMessage(4,Nt,q)}function We(L,O){var q=L.feature,W=L.keys,J=L.values,se=L.keycache,he=L.valuecache;for(var j in q.properties){var Q=se[j];Q===void 0&&(W.push(j),se[j]=Q=W.length-1),O.writeVarint(Q);var me=q.properties[j],Be=typeof me;Be!=="string"&&Be!=="boolean"&&Be!=="number"&&(me=JSON.stringify(me));var Ne=Be+":"+me,Se=he[Ne];Se===void 0&&(J.push(me),he[Ne]=Se=J.length-1),O.writeVarint(Se)}}function nr(L,O){return(O<<3)+(7&L)}function wr(L){return L<<1^L>>31}function Nt(L,O){for(var q=L.loadGeometry(),W=L.type,J=0,se=0,he=q.length,j=0;j<he;j++){var Q=q[j],me=1;W===1&&(me=Q.length),O.writeVarint(nr(1,me));for(var Be=W===3?Q.length-1:Q.length,Ne=0;Ne<Be;Ne++){Ne===1&&W!==1&&O.writeVarint(nr(2,Be-1));var Se=Q[Ne].x-J,Oe=Q[Ne].y-se;O.writeVarint(wr(Se)),O.writeVarint(wr(Oe)),J+=Se,se+=Oe}W===3&&O.writeVarint(nr(7,1))}}function qt(L,O){var q=typeof L;q==="string"?O.writeStringField(1,L):q==="boolean"?O.writeBooleanField(7,L):q==="number"&&(L%1!=0?O.writeDoubleField(3,L):L<0?O.writeSVarintField(6,L):O.writeVarintField(5,L))}function ht(L,O,q,W){He(L,q,W),He(O,2*q,2*W),He(O,2*q+1,2*W+1)}function He(L,O,q){var W=L[O];L[O]=L[q],L[q]=W}function Sr(L,O,q,W){var J=L-q,se=O-W;return J*J+se*se}hr.fromVectorTileJs=nt,hr.fromGeojsonVt=function(L,O){O=O||{};var q={};for(var W in L)q[W]=new ur(L[W].features,O),q[W].name=W,q[W].version=O.version,q[W].extent=O.extent;return nt({layers:q})},hr.GeoJSONWrapper=gt;var Hi=function(L){return L[0]},Zn=function(L){return L[1]},Gn=function(L,O,q,W,J){O===void 0&&(O=Hi),q===void 0&&(q=Zn),W===void 0&&(W=64),J===void 0&&(J=Float64Array),this.nodeSize=W,this.points=L;for(var se=L.length<65536?Uint16Array:Uint32Array,he=this.ids=new se(L.length),j=this.coords=new J(2*L.length),Q=0;Q<L.length;Q++)he[Q]=Q,j[2*Q]=O(L[Q]),j[2*Q+1]=q(L[Q]);(function me(Be,Ne,Se,Oe,rt,et){if(!(rt-Oe<=Se)){var we=Oe+rt>>1;(function Qe(Ge,Ze,Ct,$e,Kt,sr){for(;Kt>$e;){if(Kt-$e>600){var Ft=Kt-$e+1,Ot=Ct-$e+1,Xt=Math.log(Ft),Xr=.5*Math.exp(2*Xt/3),tr=.5*Math.sqrt(Xt*Xr*(Ft-Xr)/Ft)*(Ot-Ft/2<0?-1:1);Qe(Ge,Ze,Ct,Math.max($e,Math.floor(Ct-Ot*Xr/Ft+tr)),Math.min(Kt,Math.floor(Ct+(Ft-Ot)*Xr/Ft+tr)),sr)}var Cr=Ze[2*Ct+sr],or=$e,Ut=Kt;for(ht(Ge,Ze,$e,Ct),Ze[2*Kt+sr]>Cr&&ht(Ge,Ze,$e,Kt);or<Ut;){for(ht(Ge,Ze,or,Ut),or++,Ut--;Ze[2*or+sr]<Cr;)or++;for(;Ze[2*Ut+sr]>Cr;)Ut--}Ze[2*$e+sr]===Cr?ht(Ge,Ze,$e,Ut):ht(Ge,Ze,++Ut,Kt),Ut<=Ct&&($e=Ut+1),Ct<=Ut&&(Kt=Ut-1)}})(Be,Ne,we,Oe,rt,et%2),me(Be,Ne,Se,Oe,we-1,et+1),me(Be,Ne,Se,we+1,rt,et+1)}})(he,j,W,0,he.length-1,0)};Gn.prototype.range=function(L,O,q,W){return function(J,se,he,j,Q,me,Be){for(var Ne,Se,Oe=[0,J.length-1,0],rt=[];Oe.length;){var et=Oe.pop(),we=Oe.pop(),Qe=Oe.pop();if(we-Qe<=Be)for(var Ge=Qe;Ge<=we;Ge++)Se=se[2*Ge+1],(Ne=se[2*Ge])>=he&&Ne<=Q&&Se>=j&&Se<=me&&rt.push(J[Ge]);else{var Ze=Math.floor((Qe+we)/2);Se=se[2*Ze+1],(Ne=se[2*Ze])>=he&&Ne<=Q&&Se>=j&&Se<=me&&rt.push(J[Ze]);var Ct=(et+1)%2;(et===0?he<=Ne:j<=Se)&&(Oe.push(Qe),Oe.push(Ze-1),Oe.push(Ct)),(et===0?Q>=Ne:me>=Se)&&(Oe.push(Ze+1),Oe.push(we),Oe.push(Ct))}}return rt}(this.ids,this.coords,L,O,q,W,this.nodeSize)},Gn.prototype.within=function(L,O,q){return function(W,J,se,he,j,Q){for(var me=[0,W.length-1,0],Be=[],Ne=j*j;me.length;){var Se=me.pop(),Oe=me.pop(),rt=me.pop();if(Oe-rt<=Q)for(var et=rt;et<=Oe;et++)Sr(J[2*et],J[2*et+1],se,he)<=Ne&&Be.push(W[et]);else{var we=Math.floor((rt+Oe)/2),Qe=J[2*we],Ge=J[2*we+1];Sr(Qe,Ge,se,he)<=Ne&&Be.push(W[we]);var Ze=(Se+1)%2;(Se===0?se-j<=Qe:he-j<=Ge)&&(me.push(rt),me.push(we-1),me.push(Ze)),(Se===0?se+j>=Qe:he+j>=Ge)&&(me.push(we+1),me.push(Oe),me.push(Ze))}}return Be}(this.ids,this.coords,L,O,q,this.nodeSize)};var mi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(L){return L}},vr=function(L){this.options=Cn(Object.create(mi),L),this.trees=new Array(this.options.maxZoom+1)};function Kn(L,O,q,W,J){return{x:L,y:O,zoom:1/0,id:q,parentId:-1,numPoints:W,properties:J}}function Zt(L,O){var q=L.geometry.coordinates,W=q[1];return{x:on(q[0]),y:Gt(W),zoom:1/0,index:O,parentId:-1}}function Vi(L){return{type:"Feature",id:L.id,properties:So(L),geometry:{type:"Point",coordinates:[(W=L.x,360*(W-.5)),(O=L.y,q=(180-360*O)*Math.PI/180,360*Math.atan(Math.exp(q))/Math.PI-90)]}};var O,q,W}function So(L){var O=L.numPoints,q=O>=1e4?Math.round(O/1e3)+"k":O>=1e3?Math.round(O/100)/10+"k":O;return Cn(Cn({},L.properties),{cluster:!0,cluster_id:L.id,point_count:O,point_count_abbreviated:q})}function on(L){return L/360+.5}function Gt(L){var O=Math.sin(L*Math.PI/180),q=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return q<0?0:q>1?1:q}function Cn(L,O){for(var q in O)L[q]=O[q];return L}function ti(L){return L.x}function oi(L){return L.y}function Xn(L,O,q,W,J,se){var he=J-q,j=se-W;if(he!==0||j!==0){var Q=((L-q)*he+(O-W)*j)/(he*he+j*j);Q>1?(q=J,W=se):Q>0&&(q+=he*Q,W+=j*Q)}return(he=L-q)*he+(j=O-W)*j}function ji(L,O,q,W){var J={id:L===void 0?null:L,type:O,geometry:q,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(se){var he=se.geometry,j=se.type;if(j==="Point"||j==="MultiPoint"||j==="LineString")Ci(se,he);else if(j==="Polygon"||j==="MultiLineString")for(var Q=0;Q<he.length;Q++)Ci(se,he[Q]);else if(j==="MultiPolygon")for(Q=0;Q<he.length;Q++)for(var me=0;me<he[Q].length;me++)Ci(se,he[Q][me])}(J),J}function Ci(L,O){for(var q=0;q<O.length;q+=3)L.minX=Math.min(L.minX,O[q]),L.minY=Math.min(L.minY,O[q+1]),L.maxX=Math.max(L.maxX,O[q]),L.maxY=Math.max(L.maxY,O[q+1])}function yi(L,O,q,W){if(O.geometry){var J=O.geometry.coordinates,se=O.geometry.type,he=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),j=[],Q=O.id;if(q.promoteId?Q=O.properties[q.promoteId]:q.generateId&&(Q=W||0),se==="Point")an(J,j);else if(se==="MultiPoint")for(var me=0;me<J.length;me++)an(J[me],j);else if(se==="LineString")mn(J,j,he,!1);else if(se==="MultiLineString"){if(q.lineMetrics){for(me=0;me<J.length;me++)mn(J[me],j=[],he,!1),L.push(ji(Q,"LineString",j,O.properties));return}gi(J,j,he,!1)}else if(se==="Polygon")gi(J,j,he,!0);else{if(se!=="MultiPolygon"){if(se==="GeometryCollection"){for(me=0;me<O.geometry.geometries.length;me++)yi(L,{id:Q,geometry:O.geometry.geometries[me],properties:O.properties},q,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(me=0;me<J.length;me++){var Be=[];gi(J[me],Be,he,!0),j.push(Be)}}L.push(ji(Q,se,j,O.properties))}}function an(L,O){O.push(_i(L[0])),O.push(Fr(L[1])),O.push(0)}function mn(L,O,q,W){for(var J,se,he=0,j=0;j<L.length;j++){var Q=_i(L[j][0]),me=Fr(L[j][1]);O.push(Q),O.push(me),O.push(0),j>0&&(he+=W?(J*me-Q*se)/2:Math.sqrt(Math.pow(Q-J,2)+Math.pow(me-se,2))),J=Q,se=me}var Be=O.length-3;O[2]=1,function Ne(Se,Oe,rt,et){for(var we,Qe=et,Ge=rt-Oe>>1,Ze=rt-Oe,Ct=Se[Oe],$e=Se[Oe+1],Kt=Se[rt],sr=Se[rt+1],Ft=Oe+3;Ft<rt;Ft+=3){var Ot=Xn(Se[Ft],Se[Ft+1],Ct,$e,Kt,sr);if(Ot>Qe)we=Ft,Qe=Ot;else if(Ot===Qe){var Xt=Math.abs(Ft-Ge);Xt<Ze&&(we=Ft,Ze=Xt)}}Qe>et&&(we-Oe>3&&Ne(Se,Oe,we,et),Se[we+2]=Qe,rt-we>3&&Ne(Se,we,rt,et))}(O,0,Be,q),O[Be+2]=1,O.size=Math.abs(he),O.start=0,O.end=O.size}function gi(L,O,q,W){for(var J=0;J<L.length;J++){var se=[];mn(L[J],se,q,W),O.push(se)}}function _i(L){return L/360+.5}function Fr(L){var O=Math.sin(L*Math.PI/180),q=.5-.25*Math.log((1+O)/(1-O))/Math.PI;return q<0?0:q>1?1:q}function kr(L,O,q,W,J,se,he,j){if(W/=O,se>=(q/=O)&&he<W)return L;if(he<q||se>=W)return null;for(var Q=[],me=0;me<L.length;me++){var Be=L[me],Ne=Be.geometry,Se=Be.type,Oe=J===0?Be.minX:Be.minY,rt=J===0?Be.maxX:Be.maxY;if(Oe>=q&&rt<W)Q.push(Be);else if(!(rt<q||Oe>=W)){var et=[];if(Se==="Point"||Se==="MultiPoint")Wn(Ne,et,q,W,J);else if(Se==="LineString")yn(Ne,et,q,W,J,!1,j.lineMetrics);else if(Se==="MultiLineString")lo(Ne,et,q,W,J,!1);else if(Se==="Polygon")lo(Ne,et,q,W,J,!0);else if(Se==="MultiPolygon")for(var we=0;we<Ne.length;we++){var Qe=[];lo(Ne[we],Qe,q,W,J,!0),Qe.length&&et.push(Qe)}if(et.length){if(j.lineMetrics&&Se==="LineString"){for(we=0;we<et.length;we++)Q.push(ji(Be.id,Se,et[we],Be.tags));continue}Se!=="LineString"&&Se!=="MultiLineString"||(et.length===1?(Se="LineString",et=et[0]):Se="MultiLineString"),Se!=="Point"&&Se!=="MultiPoint"||(Se=et.length===3?"Point":"MultiPoint"),Q.push(ji(Be.id,Se,et,Be.tags))}}}return Q.length?Q:null}function Wn(L,O,q,W,J){for(var se=0;se<L.length;se+=3){var he=L[se+J];he>=q&&he<=W&&(O.push(L[se]),O.push(L[se+1]),O.push(L[se+2]))}}function yn(L,O,q,W,J,se,he){for(var j,Q,me=gn(L),Be=J===0?Ji:Mi,Ne=L.start,Se=0;Se<L.length-3;Se+=3){var Oe=L[Se],rt=L[Se+1],et=L[Se+2],we=L[Se+3],Qe=L[Se+4],Ge=J===0?Oe:rt,Ze=J===0?we:Qe,Ct=!1;he&&(j=Math.sqrt(Math.pow(Oe-we,2)+Math.pow(rt-Qe,2))),Ge<q?Ze>q&&(Q=Be(me,Oe,rt,we,Qe,q),he&&(me.start=Ne+j*Q)):Ge>W?Ze<W&&(Q=Be(me,Oe,rt,we,Qe,W),he&&(me.start=Ne+j*Q)):Hn(me,Oe,rt,et),Ze<q&&Ge>=q&&(Q=Be(me,Oe,rt,we,Qe,q),Ct=!0),Ze>W&&Ge<=W&&(Q=Be(me,Oe,rt,we,Qe,W),Ct=!0),!se&&Ct&&(he&&(me.end=Ne+j*Q),O.push(me),me=gn(L)),he&&(Ne+=j)}var $e=L.length-3;Oe=L[$e],rt=L[$e+1],et=L[$e+2],(Ge=J===0?Oe:rt)>=q&&Ge<=W&&Hn(me,Oe,rt,et),$e=me.length-3,se&&$e>=3&&(me[$e]!==me[0]||me[$e+1]!==me[1])&&Hn(me,me[0],me[1],me[2]),me.length&&O.push(me)}function gn(L){var O=[];return O.size=L.size,O.start=L.start,O.end=L.end,O}function lo(L,O,q,W,J,se){for(var he=0;he<L.length;he++)yn(L[he],O,q,W,J,se,!1)}function Hn(L,O,q,W){L.push(O),L.push(q),L.push(W)}function Ji(L,O,q,W,J,se){var he=(se-O)/(W-O);return L.push(se),L.push(q+(J-q)*he),L.push(1),he}function Mi(L,O,q,W,J,se){var he=(se-q)/(J-q);return L.push(O+(W-O)*he),L.push(se),L.push(1),he}function uo(L,O){for(var q=[],W=0;W<L.length;W++){var J,se=L[W],he=se.type;if(he==="Point"||he==="MultiPoint"||he==="LineString")J=Mn(se.geometry,O);else if(he==="MultiLineString"||he==="Polygon"){J=[];for(var j=0;j<se.geometry.length;j++)J.push(Mn(se.geometry[j],O))}else if(he==="MultiPolygon")for(J=[],j=0;j<se.geometry.length;j++){for(var Q=[],me=0;me<se.geometry[j].length;me++)Q.push(Mn(se.geometry[j][me],O));J.push(Q)}q.push(ji(se.id,he,J,se.tags))}return q}function Mn(L,O){var q=[];q.size=L.size,L.start!==void 0&&(q.start=L.start,q.end=L.end);for(var W=0;W<L.length;W+=3)q.push(L[W]+O,L[W+1],L[W+2]);return q}function Yi(L,O){if(L.transformed)return L;var q,W,J,se=1<<L.z,he=L.x,j=L.y;for(q=0;q<L.features.length;q++){var Q=L.features[q],me=Q.geometry,Be=Q.type;if(Q.geometry=[],Be===1)for(W=0;W<me.length;W+=2)Q.geometry.push(sn(me[W],me[W+1],O,se,he,j));else for(W=0;W<me.length;W++){var Ne=[];for(J=0;J<me[W].length;J+=2)Ne.push(sn(me[W][J],me[W][J+1],O,se,he,j));Q.geometry.push(Ne)}}return L.transformed=!0,L}function sn(L,O,q,W,J,se){return[Math.round(q*(L*W-J)),Math.round(q*(O*W-se))]}function ko(L,O,q,W,J){for(var se=O===J.maxZoom?0:J.tolerance/((1<<O)*J.extent),he={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:W,z:O,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},j=0;j<L.length;j++){he.numFeatures++,Jn(he,L[j],se,J);var Q=L[j].minX,me=L[j].minY,Be=L[j].maxX,Ne=L[j].maxY;Q<he.minX&&(he.minX=Q),me<he.minY&&(he.minY=me),Be>he.maxX&&(he.maxX=Be),Ne>he.maxY&&(he.maxY=Ne)}return he}function Jn(L,O,q,W){var J=O.geometry,se=O.type,he=[];if(se==="Point"||se==="MultiPoint")for(var j=0;j<J.length;j+=3)he.push(J[j]),he.push(J[j+1]),L.numPoints++,L.numSimplified++;else if(se==="LineString")_n(he,J,L,q,!1,!1);else if(se==="MultiLineString"||se==="Polygon")for(j=0;j<J.length;j++)_n(he,J[j],L,q,se==="Polygon",j===0);else if(se==="MultiPolygon")for(var Q=0;Q<J.length;Q++){var me=J[Q];for(j=0;j<me.length;j++)_n(he,me[j],L,q,!0,j===0)}if(he.length){var Be=O.tags||null;if(se==="LineString"&&W.lineMetrics){for(var Ne in Be={},O.tags)Be[Ne]=O.tags[Ne];Be.mapbox_clip_start=J.start/J.size,Be.mapbox_clip_end=J.end/J.size}var Se={geometry:he,type:se==="Polygon"||se==="MultiPolygon"?3:se==="LineString"||se==="MultiLineString"?2:1,tags:Be};O.id!==null&&(Se.id=O.id),L.features.push(Se)}}function _n(L,O,q,W,J,se){var he=W*W;if(W>0&&O.size<(J?he:W))q.numPoints+=O.length/3;else{for(var j=[],Q=0;Q<O.length;Q+=3)(W===0||O[Q+2]>he)&&(q.numSimplified++,j.push(O[Q]),j.push(O[Q+1])),q.numPoints++;J&&function(me,Be){for(var Ne=0,Se=0,Oe=me.length,rt=Oe-2;Se<Oe;rt=Se,Se+=2)Ne+=(me[Se]-me[rt])*(me[Se+1]+me[rt+1]);if(Ne>0===Be)for(Se=0,Oe=me.length;Se<Oe/2;Se+=2){var et=me[Se],we=me[Se+1];me[Se]=me[Oe-2-Se],me[Se+1]=me[Oe-1-Se],me[Oe-2-Se]=et,me[Oe-1-Se]=we}}(j,se),L.push(j)}}function ln(L,O){var q=(O=this.options=function(J,se){for(var he in se)J[he]=se[he];return J}(Object.create(this.options),O)).debug;if(q&&console.time("preprocess data"),O.maxZoom<0||O.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(O.promoteId&&O.generateId)throw new Error("promoteId and generateId cannot be used together.");var W=function(J,se){var he=[];if(J.type==="FeatureCollection")for(var j=0;j<J.features.length;j++)yi(he,J.features[j],se,j);else yi(he,J.type==="Feature"?J:{geometry:J},se);return he}(L,O);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",O.indexMaxZoom,O.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(W=function(J,se){var he=se.buffer/se.extent,j=J,Q=kr(J,1,-1-he,he,0,-1,2,se),me=kr(J,1,1-he,2+he,0,-1,2,se);return(Q||me)&&(j=kr(J,1,-he,1+he,0,-1,2,se)||[],Q&&(j=uo(Q,1).concat(j)),me&&(j=j.concat(uo(me,-1)))),j}(W,O)).length&&this.splitTile(W,0,0,0),q&&(W.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function un(L,O,q){return 32*((1<<L)*q+O)+L}function Qi(L,O){var q=L.tileID.canonical;if(!this._geoJSONIndex)return O(null,null);var W=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!W)return O(null,null);var J=new ve(W.features),se=hr(J);se.byteOffset===0&&se.byteLength===se.buffer.byteLength||(se=new Uint8Array(se)),O(null,{vectorTile:J,rawData:se.buffer})}vr.prototype.load=function(L){var O=this.options,q=O.log,W=O.minZoom,J=O.maxZoom,se=O.nodeSize;q&&console.time("total time");var he="prepare "+L.length+" points";q&&console.time(he),this.points=L;for(var j=[],Q=0;Q<L.length;Q++)L[Q].geometry&&j.push(Zt(L[Q],Q));this.trees[J+1]=new Gn(j,ti,oi,se,Float32Array),q&&console.timeEnd(he);for(var me=J;me>=W;me--){var Be=+Date.now();j=this._cluster(j,me),this.trees[me]=new Gn(j,ti,oi,se,Float32Array),q&&console.log("z%d: %d clusters in %dms",me,j.length,+Date.now()-Be)}return q&&console.timeEnd("total time"),this},vr.prototype.getClusters=function(L,O){var q=((L[0]+180)%360+360)%360-180,W=Math.max(-90,Math.min(90,L[1])),J=L[2]===180?180:((L[2]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)q=-180,J=180;else if(q>J){var he=this.getClusters([q,W,180,se],O),j=this.getClusters([-180,W,J,se],O);return he.concat(j)}for(var Q=this.trees[this._limitZoom(O)],me=[],Be=0,Ne=Q.range(on(q),Gt(se),on(J),Gt(W));Be<Ne.length;Be+=1){var Se=Q.points[Ne[Be]];me.push(Se.numPoints?Vi(Se):this.points[Se.index])}return me},vr.prototype.getChildren=function(L){var O=this._getOriginId(L),q=this._getOriginZoom(L),W="No cluster with the specified id.",J=this.trees[q];if(!J)throw new Error(W);var se=J.points[O];if(!se)throw new Error(W);for(var he=this.options.radius/(this.options.extent*Math.pow(2,q-1)),j=[],Q=0,me=J.within(se.x,se.y,he);Q<me.length;Q+=1){var Be=J.points[me[Q]];Be.parentId===L&&j.push(Be.numPoints?Vi(Be):this.points[Be.index])}if(j.length===0)throw new Error(W);return j},vr.prototype.getLeaves=function(L,O,q){var W=[];return this._appendLeaves(W,L,O=O||10,q=q||0,0),W},vr.prototype.getTile=function(L,O,q){var W=this.trees[this._limitZoom(L)],J=Math.pow(2,L),se=this.options,he=se.radius/se.extent,j=(q-he)/J,Q=(q+1+he)/J,me={features:[]};return this._addTileFeatures(W.range((O-he)/J,j,(O+1+he)/J,Q),W.points,O,q,J,me),O===0&&this._addTileFeatures(W.range(1-he/J,j,1,Q),W.points,J,q,J,me),O===J-1&&this._addTileFeatures(W.range(0,j,he/J,Q),W.points,-1,q,J,me),me.features.length?me:null},vr.prototype.getClusterExpansionZoom=function(L){for(var O=this._getOriginZoom(L)-1;O<=this.options.maxZoom;){var q=this.getChildren(L);if(O++,q.length!==1)break;L=q[0].properties.cluster_id}return O},vr.prototype._appendLeaves=function(L,O,q,W,J){for(var se=0,he=this.getChildren(O);se<he.length;se+=1){var j=he[se],Q=j.properties;if(Q&&Q.cluster?J+Q.point_count<=W?J+=Q.point_count:J=this._appendLeaves(L,Q.cluster_id,q,W,J):J<W?J++:L.push(j),L.length===q)break}return J},vr.prototype._addTileFeatures=function(L,O,q,W,J,se){for(var he=0,j=L;he<j.length;he+=1){var Q=O[j[he]],me=Q.numPoints,Be={type:1,geometry:[[Math.round(this.options.extent*(Q.x*J-q)),Math.round(this.options.extent*(Q.y*J-W))]],tags:me?So(Q):this.points[Q.index].properties},Ne=void 0;me?Ne=Q.id:this.options.generateId?Ne=Q.index:this.points[Q.index].id&&(Ne=this.points[Q.index].id),Ne!==void 0&&(Be.id=Ne),se.features.push(Be)}},vr.prototype._limitZoom=function(L){return Math.max(this.options.minZoom,Math.min(+L,this.options.maxZoom+1))},vr.prototype._cluster=function(L,O){for(var q=[],W=this.options,J=W.reduce,se=W.minPoints,he=W.radius/(W.extent*Math.pow(2,O)),j=0;j<L.length;j++){var Q=L[j];if(!(Q.zoom<=O)){Q.zoom=O;for(var me=this.trees[O+1],Be=me.within(Q.x,Q.y,he),Ne=Q.numPoints||1,Se=Ne,Oe=0,rt=Be;Oe<rt.length;Oe+=1){var et=me.points[rt[Oe]];et.zoom>O&&(Se+=et.numPoints||1)}if(Se>=se){for(var we=Q.x*Ne,Qe=Q.y*Ne,Ge=J&&Ne>1?this._map(Q,!0):null,Ze=(j<<5)+(O+1)+this.points.length,Ct=0,$e=Be;Ct<$e.length;Ct+=1){var Kt=me.points[$e[Ct]];if(!(Kt.zoom<=O)){Kt.zoom=O;var sr=Kt.numPoints||1;we+=Kt.x*sr,Qe+=Kt.y*sr,Kt.parentId=Ze,J&&(Ge||(Ge=this._map(Q,!0)),J(Ge,this._map(Kt)))}}Q.parentId=Ze,q.push(Kn(we/Se,Qe/Se,Ze,Se,Ge))}else if(q.push(Q),Se>1)for(var Ft=0,Ot=Be;Ft<Ot.length;Ft+=1){var Xt=me.points[Ot[Ft]];Xt.zoom<=O||(Xt.zoom=O,q.push(Xt))}}}return q},vr.prototype._getOriginId=function(L){return L-this.points.length>>5},vr.prototype._getOriginZoom=function(L){return(L-this.points.length)%32},vr.prototype._map=function(L,O){if(L.numPoints)return O?Cn({},L.properties):L.properties;var q=this.points[L.index].properties,W=this.options.map(q);return O&&W===q?Cn({},W):W},ln.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ln.prototype.splitTile=function(L,O,q,W,J,se,he){for(var j=[L,O,q,W],Q=this.options,me=Q.debug;j.length;){W=j.pop(),q=j.pop(),O=j.pop(),L=j.pop();var Be=1<<O,Ne=un(O,q,W),Se=this.tiles[Ne];if(!Se&&(me>1&&console.time("creation"),Se=this.tiles[Ne]=ko(L,O,q,W,Q),this.tileCoords.push({z:O,x:q,y:W}),me)){me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",O,q,W,Se.numFeatures,Se.numPoints,Se.numSimplified),console.timeEnd("creation"));var Oe="z"+O;this.stats[Oe]=(this.stats[Oe]||0)+1,this.total++}if(Se.source=L,J){if(O===Q.maxZoom||O===J)continue;var rt=1<<J-O;if(q!==Math.floor(se/rt)||W!==Math.floor(he/rt))continue}else if(O===Q.indexMaxZoom||Se.numPoints<=Q.indexMaxPoints)continue;if(Se.source=null,L.length!==0){me>1&&console.time("clipping");var et,we,Qe,Ge,Ze,Ct,$e=.5*Q.buffer/Q.extent,Kt=.5-$e,sr=.5+$e,Ft=1+$e;et=we=Qe=Ge=null,Ze=kr(L,Be,q-$e,q+sr,0,Se.minX,Se.maxX,Q),Ct=kr(L,Be,q+Kt,q+Ft,0,Se.minX,Se.maxX,Q),L=null,Ze&&(et=kr(Ze,Be,W-$e,W+sr,1,Se.minY,Se.maxY,Q),we=kr(Ze,Be,W+Kt,W+Ft,1,Se.minY,Se.maxY,Q),Ze=null),Ct&&(Qe=kr(Ct,Be,W-$e,W+sr,1,Se.minY,Se.maxY,Q),Ge=kr(Ct,Be,W+Kt,W+Ft,1,Se.minY,Se.maxY,Q),Ct=null),me>1&&console.timeEnd("clipping"),j.push(et||[],O+1,2*q,2*W),j.push(we||[],O+1,2*q,2*W+1),j.push(Qe||[],O+1,2*q+1,2*W),j.push(Ge||[],O+1,2*q+1,2*W+1)}}},ln.prototype.getTile=function(L,O,q){var W=this.options,J=W.extent,se=W.debug;if(L<0||L>24)return null;var he=1<<L,j=un(L,O=(O%he+he)%he,q);if(this.tiles[j])return Yi(this.tiles[j],J);se>1&&console.log("drilling down to z%d-%d-%d",L,O,q);for(var Q,me=L,Be=O,Ne=q;!Q&&me>0;)me--,Be=Math.floor(Be/2),Ne=Math.floor(Ne/2),Q=this.tiles[un(me,Be,Ne)];return Q&&Q.source?(se>1&&console.log("found parent tile z%d-%d-%d",me,Be,Ne),se>1&&console.time("drilling down"),this.splitTile(Q.source,me,Be,Ne,L,O,q),se>1&&console.timeEnd("drilling down"),this.tiles[j]?Yi(this.tiles[j],J):null):null};var Dn=function(L){function O(q,W,J,se){L.call(this,q,W,J,Qi),se&&(this.loadGeoJSON=se)}return L&&(O.__proto__=L),(O.prototype=Object.create(L&&L.prototype)).constructor=O,O.prototype.loadData=function(q,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=W,this._pendingLoadDataParams=q,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},O.prototype._loadData=function(){var q=this;if(this._pendingCallback&&this._pendingLoadDataParams){var W=this._pendingCallback,J=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var se=!!(J&&J.request&&J.request.collectResourceTiming)&&new a.RequestPerformance(J.request);this.loadGeoJSON(J,function(he,j){if(he||!j)return W(he);if(typeof j!="object")return W(new Error("Input data given to '"+J.source+"' is not a valid GeoJSON object."));(function Se(Oe,rt){var et,we=Oe&&Oe.type;if(we==="FeatureCollection")for(et=0;et<Oe.features.length;et++)Se(Oe.features[et],rt);else if(we==="GeometryCollection")for(et=0;et<Oe.geometries.length;et++)Se(Oe.geometries[et],rt);else if(we==="Feature")Se(Oe.geometry,rt);else if(we==="Polygon")Ie(Oe.coordinates,rt);else if(we==="MultiPolygon")for(et=0;et<Oe.coordinates.length;et++)Ie(Oe.coordinates[et],rt);return Oe})(j,!0);try{if(J.filter){var Q=a.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Q.result==="error")throw new Error(Q.value.map(function(Se){return Se.key+": "+Se.message}).join(", "));var me=j.features.filter(function(Se){return Q.value.evaluate({zoom:0},Se)});j={type:"FeatureCollection",features:me}}q._geoJSONIndex=J.cluster?new vr(function(Se){var Oe=Se.superclusterOptions,rt=Se.clusterProperties;if(!rt||!Oe)return Oe;for(var et={},we={},Qe={accumulated:null,zoom:0},Ge={properties:null},Ze=Object.keys(rt),Ct=0,$e=Ze;Ct<$e.length;Ct+=1){var Kt=$e[Ct],sr=rt[Kt],Ft=sr[0],Ot=a.createExpression(sr[1]),Xt=a.createExpression(typeof Ft=="string"?[Ft,["accumulated"],["get",Kt]]:Ft);et[Kt]=Ot.value,we[Kt]=Xt.value}return Oe.map=function(Xr){Ge.properties=Xr;for(var tr={},Cr=0,or=Ze;Cr<or.length;Cr+=1){var Ut=or[Cr];tr[Ut]=et[Ut].evaluate(Qe,Ge)}return tr},Oe.reduce=function(Xr,tr){Ge.properties=tr;for(var Cr=0,or=Ze;Cr<or.length;Cr+=1){var Ut=or[Cr];Qe.accumulated=Xr[Ut],Xr[Ut]=we[Ut].evaluate(Qe,Ge)}},Oe}(J)).load(j.features):function(Se,Oe){return new ln(Se,Oe)}(j,J.geojsonVtOptions)}catch(Se){return W(Se)}q.loaded={};var Be={};if(se){var Ne=se.finish();Ne&&(Be.resourceTiming={},Be.resourceTiming[J.source]=JSON.parse(JSON.stringify(Ne)))}W(null,Be)})}},O.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},O.prototype.reloadTile=function(q,W){var J=this.loaded;return J&&J[q.uid]?L.prototype.reloadTile.call(this,q,W):this.loadTile(q,W)},O.prototype.loadGeoJSON=function(q,W){if(q.request)a.getJSON(q.request,W);else{if(typeof q.data!="string")return W(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."));try{return W(null,JSON.parse(q.data))}catch{return W(new Error("Input data given to '"+q.source+"' is not a valid GeoJSON object."))}}},O.prototype.removeSource=function(q,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),W()},O.prototype.getClusterExpansionZoom=function(q,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(J){W(J)}},O.prototype.getClusterChildren=function(q,W){try{W(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(J){W(J)}},O.prototype.getClusterLeaves=function(q,W){try{W(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(J){W(J)}},O}(ue),pr=function(L){var O=this;this.self=L,this.actor=new a.Actor(L,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ue,geojson:Dn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(q,W){if(O.workerSourceTypes[q])throw new Error('Worker source with name "'+q+'" already registered.');O.workerSourceTypes[q]=W},this.self.registerRTLTextPlugin=function(q){if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=q.applyArabicShaping,a.plugin.processBidirectionalText=q.processBidirectionalText,a.plugin.processStyledBidirectionalText=q.processStyledBidirectionalText}};return pr.prototype.setReferrer=function(L,O){this.referrer=O},pr.prototype.setImages=function(L,O,q){for(var W in this.availableImages[L]=O,this.workerSources[L]){var J=this.workerSources[L][W];for(var se in J)J[se].availableImages=O}q()},pr.prototype.setLayers=function(L,O,q){this.getLayerIndex(L).replace(O),q()},pr.prototype.updateLayers=function(L,O,q){this.getLayerIndex(L).update(O.layers,O.removedIds),q()},pr.prototype.loadTile=function(L,O,q){this.getWorkerSource(L,O.type,O.source).loadTile(O,q)},pr.prototype.loadDEMTile=function(L,O,q){this.getDEMWorkerSource(L,O.source).loadTile(O,q)},pr.prototype.reloadTile=function(L,O,q){this.getWorkerSource(L,O.type,O.source).reloadTile(O,q)},pr.prototype.abortTile=function(L,O,q){this.getWorkerSource(L,O.type,O.source).abortTile(O,q)},pr.prototype.removeTile=function(L,O,q){this.getWorkerSource(L,O.type,O.source).removeTile(O,q)},pr.prototype.removeDEMTile=function(L,O){this.getDEMWorkerSource(L,O.source).removeTile(O)},pr.prototype.removeSource=function(L,O,q){if(this.workerSources[L]&&this.workerSources[L][O.type]&&this.workerSources[L][O.type][O.source]){var W=this.workerSources[L][O.type][O.source];delete this.workerSources[L][O.type][O.source],W.removeSource!==void 0?W.removeSource(O,q):q()}},pr.prototype.loadWorkerSource=function(L,O,q){try{this.self.importScripts(O.url),q()}catch(W){q(W.toString())}},pr.prototype.syncRTLPluginState=function(L,O,q){try{a.plugin.setState(O);var W=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&W!=null){this.self.importScripts(W);var J=a.plugin.isParsed();q(J?void 0:new Error("RTL Text Plugin failed to import scripts from "+W),J)}}catch(se){q(se.toString())}},pr.prototype.getAvailableImages=function(L){var O=this.availableImages[L];return O||(O=[]),O},pr.prototype.getLayerIndex=function(L){var O=this.layerIndexes[L];return O||(O=this.layerIndexes[L]=new P),O},pr.prototype.getWorkerSource=function(L,O,q){var W=this;return this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][O]||(this.workerSources[L][O]={}),this.workerSources[L][O][q]||(this.workerSources[L][O][q]=new this.workerSourceTypes[O]({send:function(J,se,he){W.actor.send(J,se,he,L)}},this.getLayerIndex(L),this.getAvailableImages(L))),this.workerSources[L][O][q]},pr.prototype.getDEMWorkerSource=function(L,O){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][O]||(this.demWorkerSources[L][O]=new Ae),this.demWorkerSources[L][O]},pr.prototype.enforceCacheSizeLimit=function(L,O){a.enforceCacheSizeLimit(O)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new pr(self)),pr}),w(["./shared"],function(a){var A=a.createCommonjsModule(function(n){function s(m){return!o(m)}function o(m){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,T,C=new Blob([""],{type:"text/javascript"}),F=URL.createObjectURL(C);try{T=new Worker(F),S=!0}catch{S=!1}return T&&T.terminate(),URL.revokeObjectURL(F),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var T=S.getContext("2d");if(!T)return!1;var C=T.getImageData(0,0,1,1);return C&&C.width===S.width}()?(u[x=m&&m.failIfMajorPerformanceCaveat]===void 0&&(u[x]=function(S){var T=function(F){var G=document.createElement("canvas"),K=Object.create(s.webGLContextAttributes);return K.failIfMajorPerformanceCaveat=F,G.probablySupportsContext?G.probablySupportsContext("webgl",K)||G.probablySupportsContext("experimental-webgl",K):G.supportsContext?G.supportsContext("webgl",K)||G.supportsContext("experimental-webgl",K):G.getContext("webgl",K)||G.getContext("experimental-webgl",K)}(S);if(!T)return!1;var C=T.createShader(T.VERTEX_SHADER);return!(!C||T.isContextLost())&&(T.shaderSource(C,"void main() {}"),T.compileShader(C),T.getShaderParameter(C,T.COMPILE_STATUS)===!0)}(x)),u[x]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var x}n.exports?n.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var u={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),E={create:function(n,s,o){var u=a.window.document.createElement(n);return s!==void 0&&(u.className=s),o&&o.appendChild(u),u},createNS:function(n,s){return a.window.document.createElementNS(n,s)}},P=a.window.document&&a.window.document.documentElement.style;function M(n){if(!P)return n[0];for(var s=0;s<n.length;s++)if(n[s]in P)return n[s];return n[0]}var V,B=M(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);E.disableDrag=function(){P&&B&&(V=P[B],P[B]="none")},E.enableDrag=function(){P&&B&&(P[B]=V)};var N=M(["transform","WebkitTransform"]);E.setTransform=function(n,s){n.style[N]=s};var ue=!1;try{var ze=Object.defineProperty({},"passive",{get:function(){ue=!0}});a.window.addEventListener("test",ze,ze),a.window.removeEventListener("test",ze,ze)}catch{ue=!1}E.addEventListener=function(n,s,o,u){u===void 0&&(u={}),n.addEventListener(s,o,"passive"in u&&ue?u:u.capture)},E.removeEventListener=function(n,s,o,u){u===void 0&&(u={}),n.removeEventListener(s,o,"passive"in u&&ue?u:u.capture)};var Ae=function(n){n.preventDefault(),n.stopPropagation(),a.window.removeEventListener("click",Ae,!0)};function Ie(n){var s=n.userImage;return!!(s&&s.render&&s.render())&&(n.data.replace(new Uint8Array(s.data.buffer)),!0)}E.suppressClick=function(){a.window.addEventListener("click",Ae,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",Ae,!0)},0)},E.mousePos=function(n,s){var o=n.getBoundingClientRect();return new a.Point(s.clientX-o.left-n.clientLeft,s.clientY-o.top-n.clientTop)},E.touchPos=function(n,s){for(var o=n.getBoundingClientRect(),u=[],m=0;m<s.length;m++)u.push(new a.Point(s[m].clientX-o.left-n.clientLeft,s[m].clientY-o.top-n.clientTop));return u},E.mouseButton=function(n){return a.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},E.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var Me=function(n){function s(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var u=0,m=this.requestors;u<m.length;u+=1){var x=m[u];this._notify(x.ids,x.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,u){this._validate(o,u)&&(this.images[o]=u)},s.prototype._validate=function(o,u){var m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),m=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),m=!1),m},s.prototype._validateStretch=function(o,u){if(!o)return!0;for(var m=0,x=0,S=o;x<S.length;x+=1){var T=S[x];if(T[0]<m||T[1]<T[0]||u<T[1])return!1;m=T[1]}return!0},s.prototype._validateContent=function(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,u){var m=!0;if(!this.isLoaded())for(var x=0,S=o;x<S.length;x+=1)this.images[S[x]]||(m=!1);this.isLoaded()||m?this._notify(o,u):this.requestors.push({ids:o,callback:u})},s.prototype._notify=function(o,u){for(var m={},x=0,S=o;x<S.length;x+=1){var T=S[x];this.images[T]||this.fire(new a.Event("styleimagemissing",{id:T}));var C=this.images[T];C?m[T]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:Boolean(C.userImage&&C.userImage.render)}:a.warnOnce('Image "'+T+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}u(null,m)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var u=this.patterns[o],m=this.getImage(o);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{var x={w:m.data.width+2,h:m.data.height+2,x:0,y:0},S=new a.ImagePosition(x,m);this.patterns[o]={bin:x,position:S}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var u in this.patterns)o.push(this.patterns[u].bin);var m=a.potpack(o),x=m.w,S=m.h,T=this.atlasImage;for(var C in T.resize({width:x||1,height:S||1}),this.patterns){var F=this.patterns[C].bin,G=F.x+1,K=F.y+1,X=this.images[C].data,te=X.width,ee=X.height;a.RGBAImage.copy(X,T,{x:0,y:0},{x:G,y:K},{width:te,height:ee}),a.RGBAImage.copy(X,T,{x:0,y:ee-1},{x:G,y:K-1},{width:te,height:1}),a.RGBAImage.copy(X,T,{x:0,y:0},{x:G,y:K+ee},{width:te,height:1}),a.RGBAImage.copy(X,T,{x:te-1,y:0},{x:G-1,y:K},{width:1,height:ee}),a.RGBAImage.copy(X,T,{x:0,y:0},{x:G+te,y:K},{width:1,height:ee})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var u=0,m=o;u<m.length;u+=1){var x=m[u];if(!this.callbackDispatchedThisFrame[x]){this.callbackDispatchedThisFrame[x]=!0;var S=this.images[x];Ie(S)&&this.updateImage(x,S)}}},s}(a.Evented),ft=je,Pt=je,ve=1e20;function je(n,s,o,u,m,x){this.fontSize=n||24,this.buffer=s===void 0?3:s,this.cutoff=u||.25,this.fontFamily=m||"sans-serif",this.fontWeight=x||"normal",this.radius=o||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ur(n,s,o,u,m,x,S){for(var T=0;T<s;T++){for(var C=0;C<o;C++)u[C]=n[C*s+T];for(cr(u,m,x,S,o),C=0;C<o;C++)n[C*s+T]=m[C]}for(C=0;C<o;C++){for(T=0;T<s;T++)u[T]=n[C*s+T];for(cr(u,m,x,S,s),T=0;T<s;T++)n[C*s+T]=Math.sqrt(m[T])}}function cr(n,s,o,u,m){o[0]=0,u[0]=-ve,u[1]=+ve;for(var x=1,S=0;x<m;x++){for(var T=(n[x]+x*x-(n[o[S]]+o[S]*o[S]))/(2*x-2*o[S]);T<=u[S];)S--,T=(n[x]+x*x-(n[o[S]]+o[S]*o[S]))/(2*x-2*o[S]);o[++S]=x,u[S]=T,u[S+1]=+ve}for(x=0,S=0;x<m;x++){for(;u[S+1]<x;)S++;s[x]=(x-o[S])*(x-o[S])+n[o[S]]}}je.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),u=0;u<this.size*this.size;u++){var m=s.data[4*u+3]/255;this.gridOuter[u]=m===1?0:m===0?ve:Math.pow(Math.max(0,.5-m),2),this.gridInner[u]=m===1?ve:m===0?0:Math.pow(Math.max(0,m-.5),2)}for(ur(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),ur(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),u=0;u<this.size*this.size;u++)o[u]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[u]-this.gridInner[u])/this.radius+this.cutoff))));return o},ft.default=Pt;var pt=function(n,s){this.requestManager=n,this.localIdeographFontFamily=s,this.entries={}};pt.prototype.setURL=function(n){this.url=n},pt.prototype.getGlyphs=function(n,s){var o=this,u=[];for(var m in n)for(var x=0,S=n[m];x<S.length;x+=1)u.push({stack:m,id:S[x]});a.asyncAll(u,function(T,C){var F=T.stack,G=T.id,K=o.entries[F];K||(K=o.entries[F]={glyphs:{},requests:{},ranges:{}});var X=K.glyphs[G];if(X===void 0){if(X=o._tinySDF(K,F,G))return K.glyphs[G]=X,void C(null,{stack:F,id:G,glyph:X});var te=Math.floor(G/256);if(256*te>65535)C(new Error("glyphs > 65535 not supported"));else if(K.ranges[te])C(null,{stack:F,id:G,glyph:X});else{var ee=K.requests[te];ee||(ee=K.requests[te]=[],pt.loadGlyphRange(F,te,o.url,o.requestManager,function(ae,H){if(H){for(var oe in H)o._doesCharSupportLocalGlyph(+oe)||(K.glyphs[+oe]=H[+oe]);K.ranges[te]=!0}for(var pe=0,ge=ee;pe<ge.length;pe+=1)(0,ge[pe])(ae,H);delete K.requests[te]})),ee.push(function(ae,H){ae?C(ae):H&&C(null,{stack:F,id:G,glyph:H[G]||null})})}}else C(null,{stack:F,id:G,glyph:X})},function(T,C){if(T)s(T);else if(C){for(var F={},G=0,K=C;G<K.length;G+=1){var X=K[G],te=X.stack,ee=X.id,ae=X.glyph;(F[te]||(F[te]={}))[ee]=ae&&{id:ae.id,bitmap:ae.bitmap.clone(),metrics:ae.metrics}}s(null,F)}})},pt.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](n)||a.isChar["Hangul Syllables"](n)||a.isChar.Hiragana(n)||a.isChar.Katakana(n))},pt.prototype._tinySDF=function(n,s,o){var u=this.localIdeographFontFamily;if(u&&this._doesCharSupportLocalGlyph(o)){var m=n.tinySDF;if(!m){var x="400";/bold/i.test(s)?x="900":/medium/i.test(s)?x="500":/light/i.test(s)&&(x="200"),m=n.tinySDF=new pt.TinySDF(24,3,8,.25,u,x)}return{id:o,bitmap:new a.AlphaImage({width:30,height:30},m.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},pt.loadGlyphRange=function(n,s,o,u,m){var x=256*s,S=x+255,T=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",x+"-"+S),a.ResourceType.Glyphs);a.getArrayBuffer(T,function(C,F){if(C)m(C);else if(F){for(var G={},K=0,X=a.parseGlyphPBF(F);K<X.length;K+=1){var te=X[K];G[te.id]=te}m(null,G)}})},pt.TinySDF=ft;var hr=function(){this.specification=a.styleSpec.light.position};hr.prototype.possiblyEvaluate=function(n,s){return a.sphericalToCartesian(n.expression.evaluate(s))},hr.prototype.interpolate=function(n,s,o){return{x:a.number(n.x,s.x,o),y:a.number(n.y,s.y,o),z:a.number(n.z,s.z,o)}};var gt=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new hr,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),nt=function(n){function s(o){n.call(this),this._transitionable=new a.Transitionable(gt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,u){if(u===void 0&&(u={}),!this._validate(a.validateLight,o,u))for(var m in o){var x=o[m];a.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),x):this._transitionable.setValue(m,x)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,u,m){return(!m||m.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},s}(a.Evented),xt=function(n,s){this.width=n,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};xt.prototype.getDash=function(n,s){var o=n.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,s)),this.dashEntry[o]},xt.prototype.getDashRanges=function(n,s,o){var u=[],m=n.length%2==1?-n[n.length-1]*o:0,x=n[0]*o,S=!0;u.push({left:m,right:x,isDash:S,zeroLength:n[0]===0});for(var T=n[0],C=1;C<n.length;C++){var F=n[C];u.push({left:m=T*o,right:x=(T+=F)*o,isDash:S=!S,zeroLength:F===0})}return u},xt.prototype.addRoundDash=function(n,s,o){for(var u=s/2,m=-o;m<=o;m++)for(var x=this.width*(this.nextRow+o+m),S=0,T=n[S],C=0;C<this.width;C++){C/T.right>1&&(T=n[++S]);var F=Math.abs(C-T.left),G=Math.abs(C-T.right),K=Math.min(F,G),X=void 0,te=m/o*(u+1);if(T.isDash){var ee=u-Math.abs(te);X=Math.sqrt(K*K+ee*ee)}else X=u-Math.sqrt(K*K+te*te);this.data[x+C]=Math.max(0,Math.min(255,X+128))}},xt.prototype.addRegularDash=function(n){for(var s=n.length-1;s>=0;--s){var o=n[s],u=n[s+1];o.zeroLength?n.splice(s,1):u&&u.isDash===o.isDash&&(u.left=o.left,n.splice(s,1))}var m=n[0],x=n[n.length-1];m.isDash===x.isDash&&(m.left=x.left-this.width,x.right=m.right+this.width);for(var S=this.width*this.nextRow,T=0,C=n[T],F=0;F<this.width;F++){F/C.right>1&&(C=n[++T]);var G=Math.abs(F-C.left),K=Math.abs(F-C.right),X=Math.min(G,K);this.data[S+F]=Math.max(0,Math.min(255,(C.isDash?X:-X)+128))}},xt.prototype.addDash=function(n,s){var o=s?7:0,u=2*o+1;if(this.nextRow+u>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var m=0,x=0;x<n.length;x++)m+=n[x];if(m!==0){var S=this.width/m,T=this.getDashRanges(n,this.width,S);s?this.addRoundDash(T,S,o):this.addRegularDash(T)}var C={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:m};return this.nextRow+=u,this.dirty=!0,C},xt.prototype.bind=function(n){var s=n.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var er=function n(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var u=this.workerPool.acquire(this.id),m=0;m<u.length;m++){var x=new n.Actor(u[m],o,this.id);x.name="Worker "+m,this.actors.push(x)}};function We(n,s,o){var u=function(m,x){if(m)return o(m);if(x){var S=a.pick(a.extend(x,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);x.vector_layers&&(S.vectorLayers=x.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(T){return T.id})),S.tiles=s.canonicalizeTileset(S,n.url),o(null,S)}};return n.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(n.url),a.ResourceType.Source),u):a.browser.frame(function(){return u(null,n)})}er.prototype.broadcast=function(n,s,o){a.asyncAll(this.actors,function(u,m){u.send(n,s,m)},o=o||function(){})},er.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},er.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},er.Actor=a.Actor;var nr=function(n,s,o){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=o||24};nr.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},nr.prototype.contains=function(n){var s=Math.pow(2,n.z),o=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*s),u=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*s),m=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*s),x=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*s);return n.x>=o&&n.x<m&&n.y>=u&&n.y<x};var wr=function(n){function s(o,u,m,x){if(n.call(this),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(u,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=We(this._options,this.map._requestManager,function(u,m){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):m&&(a.extend(o,m),m.bounds&&(o.tileBounds=new nr(m.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(m.tiles,o.map._requestManager._customAccessToken),a.postMapLoadEvent(m.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var u=this;return this.setSourceProperty(function(){u._options.tiles=o}),this},s.prototype.setUrl=function(o){var u=this;return this.setSourceProperty(function(){u.url=o,u._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.loadTile=function(o,u){var m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(m,a.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(T,C){return delete o.request,o.aborted?u(null):T&&T.status!==404?u(T):(C&&C.resourceTiming&&(o.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&o.setExpiryData(C),o.loadVectorData(C,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}x.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=u:o.request=o.actor.send("reloadTile",x,S.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",x,S.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Nt=function(n){function s(o,u,m,x){n.call(this),this.id=o,this.dispatcher=m,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=We(this._options,this.map._requestManager,function(u,m){o._tileJSONRequest=null,o._loaded=!0,u?o.fire(new a.ErrorEvent(u)):m&&(a.extend(o,m),m.bounds&&(o.tileBounds=new nr(m.bounds,o.minzoom,o.maxzoom)),a.postTurnstileEvent(m.tiles),a.postMapLoadEvent(m.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return a.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,u){var m=this,x=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(x,a.ResourceType.Tile),function(S,T){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(T){m.map._refreshExpiredTiles&&o.setExpiryData(T),delete T.cacheControl,delete T.expires;var C=m.map.painter.context,F=C.gl;o.texture=m.map.painter.getTileTexture(T.width),o.texture?o.texture.update(T,{useMipmap:!0}):(o.texture=new a.Texture(C,T,F.RGBA,{useMipmap:!0}),o.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&F.texParameterf(F.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(m.dispatcher),u(null)}})},s.prototype.abortTile=function(o,u){o.request&&(o.request.cancel(),delete o.request),u()},s.prototype.unloadTile=function(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()},s.prototype.hasTransition=function(){return!1},s}(a.Evented),qt=function(n){function s(o,u,m,x){n.call(this,o,u,m,x),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,u){var m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function x(S,T){S&&(o.state="errored",u(S)),T&&(o.dem=T,o.needsHillshadePrepare=!0,o.state="loaded",u(null))}o.request=a.getImage(this.map._requestManager.transformRequest(m,a.ResourceType.Tile),function(S,T){if(delete o.request,o.aborted)o.state="unloaded",u(null);else if(S)o.state="errored",u(S);else if(T){this.map._refreshExpiredTiles&&o.setExpiryData(T),delete T.cacheControl,delete T.expires;var C=a.window.ImageBitmap&&T instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?T:a.browser.getImageData(T,1),F={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:C,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",F,x.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var u=o.canonical,m=Math.pow(2,u.z),x=(u.x-1+m)%m,S=u.x===0?o.wrap-1:o.wrap,T=(u.x+1+m)%m,C=u.x+1===m?o.wrap+1:o.wrap,F={};return F[new a.OverscaledTileID(o.overscaledZ,S,u.z,x,u.y).key]={backfilled:!1},F[new a.OverscaledTileID(o.overscaledZ,C,u.z,T,u.y).key]={backfilled:!1},u.y>0&&(F[new a.OverscaledTileID(o.overscaledZ,S,u.z,x,u.y-1).key]={backfilled:!1},F[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},F[new a.OverscaledTileID(o.overscaledZ,C,u.z,T,u.y-1).key]={backfilled:!1}),u.y+1<m&&(F[new a.OverscaledTileID(o.overscaledZ,S,u.z,x,u.y+1).key]={backfilled:!1},F[new a.OverscaledTileID(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},F[new a.OverscaledTileID(o.overscaledZ,C,u.z,T,u.y+1).key]={backfilled:!1}),F},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(Nt),ht=function(n){function s(o,u,m,x){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(x),this._data=u.data,this._options=a.extend({},u),this._collectResourceTiming=u.collectResourceTiming,this._resourceTiming=[],u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;var S=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*S,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*S,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?Math.min(u.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.EXTENT,radius:(u.clusterRadius||50)*S,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(u){if(u)o.fire(new a.ErrorEvent(u));else{var m={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(m.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new a.Event("data",m))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var u=this;return this._data=o,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(m){if(m)u.fire(new a.ErrorEvent(m));else{var x={dataType:"source",sourceDataType:"content"};u._collectResourceTiming&&u._resourceTiming&&u._resourceTiming.length>0&&(x.resourceTiming=u._resourceTiming,u._resourceTiming=[]),u.fire(new a.Event("data",x))}}),this},s.prototype.getClusterExpansionZoom=function(o,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},u),this},s.prototype.getClusterChildren=function(o,u){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},u),this},s.prototype.getClusterLeaves=function(o,u,m,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:u,offset:m},x),this},s.prototype._updateWorkerData=function(o){var u=this;this._loaded=!1;var m=a.extend({},this.workerOptions),x=this._data;typeof x=="string"?(m.request=this.map._requestManager.transformRequest(a.browser.resolveURL(x),a.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(x),this.actor.send(this.type+".loadData",m,function(S,T){u._removed||T&&T.abandoned||(u._loaded=!0,T&&T.resourceTiming&&T.resourceTiming[u.id]&&(u._resourceTiming=T.resourceTiming[u.id].slice(0)),u.actor.send(u.type+".coalesce",{source:m.source},null),o(S))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,u){var m=this,x=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(x,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,T){return delete o.request,o.unloadVectorData(),o.aborted?u(null):S?u(S):(o.loadVectorData(T,m.map.painter,x==="reloadTile"),u(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(a.Evented),He=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Sr=function(n){function s(o,u,m,x){n.call(this),this.id=o,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(o,u){var m=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(x,S){m._loaded=!0,x?m.fire(new a.ErrorEvent(x)):S&&(m.image=S,o&&(m.coordinates=o),u&&u(),m._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var u=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){u.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var u=this;this.coordinates=o;var m=o.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var T=1/0,C=1/0,F=-1/0,G=-1/0,K=0,X=S;K<X.length;K+=1){var te=X[K];T=Math.min(T,te.x),C=Math.min(C,te.y),F=Math.max(F,te.x),G=Math.max(G,te.y)}var ee=Math.max(F-T,G-C),ae=Math.max(0,Math.floor(-Math.log(ee)/Math.LN2)),H=Math.pow(2,ae);return new a.CanonicalTileID(ae,Math.floor((T+F)/2*H),Math.floor((C+G)/2*H))}(m),this.minzoom=this.maxzoom=this.tileID.z;var x=m.map(function(S){return u.tileID.getTilePoint(S)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(x[0].x,x[0].y,0,0),this._boundsArray.emplaceBack(x[1].x,x[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(x[3].x,x[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(x[2].x,x[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,u=o.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,He.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}},s.prototype.loadTile=function(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(a.Evented),Hi=function(n){function s(o,u,m,x){n.call(this,o,u,m,x),this.roundZoom=!0,this.type="video",this.options=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var u=this.options;this.urls=[];for(var m=0,x=u.urls;m<x.length;m+=1)this.urls.push(this.map._requestManager.transformRequest(x[m],a.ResourceType.Source).url);a.getVideo(this.urls,function(S,T){o._loaded=!0,S?o.fire(new a.ErrorEvent(S)):T&&(o.video=T,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+u.start(0)+" and "+u.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,u=o.gl;for(var m in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,He.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this.tiles){var x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(Sr),Zn=function(n){function s(o,u,m,x){n.call(this,o,u,m,x),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(T){return typeof T!="number"})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var u=this.map.painter.context,m=u.gl;for(var x in this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,He.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(u,this.canvas,m.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[x];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,u=[this.canvas.width,this.canvas.height];o<u.length;o+=1){var m=u[o];if(isNaN(m)||m<=0)return!0}return!1},s}(Sr),Gn={vector:wr,raster:Nt,"raster-dem":qt,geojson:ht,video:Hi,image:Sr,canvas:Zn};function mi(n,s){var o=a.identity([]);return a.translate(o,o,[1,1,0]),a.scale(o,o,[.5*n.width,.5*n.height,1]),a.multiply(o,o,n.calculatePosMatrix(s.toUnwrapped()))}function vr(n,s,o,u,m,x){var S=function(ae,H,oe){if(ae)for(var pe=0,ge=ae;pe<ge.length;pe+=1){var Ee=H[ge[pe]];if(Ee&&Ee.source===oe&&Ee.type==="fill-extrusion")return!0}else for(var be in H){var Te=H[be];if(Te.source===oe&&Te.type==="fill-extrusion")return!0}return!1}(m&&m.layers,s,n.id),T=x.maxPitchScaleFactor(),C=n.tilesIn(u,T,S);C.sort(Kn);for(var F=[],G=0,K=C;G<K.length;G+=1){var X=K[G];F.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(s,o,n._state,X.queryGeometry,X.cameraQueryGeometry,X.scale,m,x,T,mi(n.transform,X.tileID))})}var te=function(ae){for(var H={},oe={},pe=0,ge=ae;pe<ge.length;pe+=1){var Ee=ge[pe],be=Ee.queryResults,Te=Ee.wrappedTileID,Ue=oe[Te]=oe[Te]||{};for(var Xe in be)for(var Ke=be[Xe],ot=Ue[Xe]=Ue[Xe]||{},wt=H[Xe]=H[Xe]||[],Tt=0,Et=Ke;Tt<Et.length;Tt+=1){var fr=Et[Tt];ot[fr.featureIndex]||(ot[fr.featureIndex]=!0,wt.push(fr))}}return H}(F);for(var ee in te)te[ee].forEach(function(ae){var H=ae.feature,oe=n.getFeatureState(H.layer["source-layer"],H.id);H.source=H.layer.source,H.layer["source-layer"]&&(H.sourceLayer=H.layer["source-layer"]),H.state=oe});return te}function Kn(n,s){var o=n.tileID,u=s.tileID;return o.overscaledZ-u.overscaledZ||o.canonical.y-u.canonical.y||o.wrap-u.wrap||o.canonical.x-u.canonical.x}var Zt=function(n,s){this.max=n,this.onRemove=s,this.reset()};Zt.prototype.reset=function(){for(var n in this.data)for(var s=0,o=this.data[n];s<o.length;s+=1){var u=o[s];u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value)}return this.data={},this.order=[],this},Zt.prototype.add=function(n,s,o){var u=this,m=n.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);var x={value:s,timeout:void 0};if(o!==void 0&&(x.timeout=setTimeout(function(){u.remove(n,x)},o)),this.data[m].push(x),this.order.push(m),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},Zt.prototype.has=function(n){return n.wrapped().key in this.data},Zt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Zt.prototype._getAndRemoveByKey=function(n){var s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value},Zt.prototype.getByKey=function(n){var s=this.data[n];return s?s[0].value:null},Zt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Zt.prototype.remove=function(n,s){if(!this.has(n))return this;var o=n.wrapped().key,u=s===void 0?0:this.data[o].indexOf(s),m=this.data[o][u];return this.data[o].splice(u,1),m.timeout&&clearTimeout(m.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(m.value),this.order.splice(this.order.indexOf(o),1),this},Zt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Zt.prototype.filter=function(n){var s=[];for(var o in this.data)for(var u=0,m=this.data[o];u<m.length;u+=1){var x=m[u];n(x.value)||s.push(x)}for(var S=0,T=s;S<T.length;S+=1){var C=T[S];this.remove(C.value.tileID,C)}};var Vi=function(n,s,o){this.context=n;var u=n.gl;this.buffer=u.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Vi.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Vi.prototype.updateData=function(n){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},Vi.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var So={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},on=function(n,s,o,u){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=u,this.context=n;var m=n.gl;this.buffer=m.createBuffer(),n.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};on.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},on.prototype.updateData=function(n){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)},on.prototype.enableAttributes=function(n,s){for(var o=0;o<this.attributes.length;o++){var u=s.attributes[this.attributes[o].name];u!==void 0&&n.enableVertexAttribArray(u)}},on.prototype.setVertexAttribPointers=function(n,s,o){for(var u=0;u<this.attributes.length;u++){var m=this.attributes[u],x=s.attributes[m.name];x!==void 0&&n.vertexAttribPointer(x,m.components,n[So[m.type]],!1,this.itemSize,m.offset+this.itemSize*(o||0))}},on.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Gt=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Gt.prototype.get=function(){return this.current},Gt.prototype.set=function(n){},Gt.prototype.getDefault=function(){return this.default},Gt.prototype.setDefault=function(){this.set(this.default)};var Cn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Gt),ti=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Gt),oi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Gt),Xn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Gt),ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Gt),Ci=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Gt),yi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Gt),an=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Gt),mn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Gt),gi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Gt),_i=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Gt),Fr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Gt),kr=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}},s}(Gt),Wn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Gt),yn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return a.Color.transparent},s.prototype.set=function(o){var u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Gt),gn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Gt),lo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}},s}(Gt),Hn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Gt),Ji=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Gt),Mi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Gt),uo=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Gt),Mn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Gt),Yi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),sn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),ko=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Gt),Jn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Gt),_n=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Gt),ln=function(n){function s(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Gt),un=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Gt),Qi=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Gt),Dn=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Gt),pr=function(n){function s(o,u){n.call(this,o),this.context=o,this.parent=u}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Gt),L=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(pr),O=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(pr),q=function(n,s,o,u){this.context=n,this.width=s,this.height=o;var m=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new L(n,m),u&&(this.depthAttachment=new O(n,m))};q.prototype.destroy=function(){var n=this.context.gl,s=this.colorAttachment.get();if(s&&n.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var W=function(n,s,o){this.func=n,this.mask=s,this.range=o};W.ReadOnly=!1,W.ReadWrite=!0,W.disabled=new W(519,W.ReadOnly,[0,1]);var J=function(n,s,o,u,m,x){this.test=n,this.ref=s,this.mask=o,this.fail=u,this.depthFail=m,this.pass=x};J.disabled=new J({func:519,mask:0},0,0,7680,7680,7680);var se=function(n,s,o){this.blendFunction=n,this.blendColor=s,this.mask=o};se.disabled=new se(se.Replace=[1,0],a.Color.transparent,[!1,!1,!1,!1]),se.unblended=new se(se.Replace,a.Color.transparent,[!0,!0,!0,!0]),se.alphaBlended=new se([1,771],a.Color.transparent,[!0,!0,!0,!0]);var he=function(n,s,o){this.enable=n,this.mode=s,this.frontFace=o};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var j=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Cn(this),this.clearDepth=new ti(this),this.clearStencil=new oi(this),this.colorMask=new Xn(this),this.depthMask=new ji(this),this.stencilMask=new Ci(this),this.stencilFunc=new yi(this),this.stencilOp=new an(this),this.stencilTest=new mn(this),this.depthRange=new gi(this),this.depthTest=new _i(this),this.depthFunc=new Fr(this),this.blend=new kr(this),this.blendFunc=new Wn(this),this.blendColor=new yn(this),this.blendEquation=new gn(this),this.cullFace=new lo(this),this.cullFaceSide=new Hn(this),this.frontFace=new Ji(this),this.program=new Mi(this),this.activeTexture=new uo(this),this.viewport=new Mn(this),this.bindFramebuffer=new Yi(this),this.bindRenderbuffer=new sn(this),this.bindTexture=new ko(this),this.bindVertexBuffer=new Jn(this),this.bindElementBuffer=new _n(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ln(this),this.pixelStoreUnpack=new un(this),this.pixelStoreUnpackPremultiplyAlpha=new Qi(this),this.pixelStoreUnpackFlipY=new Dn(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};j.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},j.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},j.prototype.createIndexBuffer=function(n,s){return new Vi(this,n,s)},j.prototype.createVertexBuffer=function(n,s,o){return new on(this,n,s,o)},j.prototype.createRenderbuffer=function(n,s,o){var u=this.gl,m=u.createRenderbuffer();return this.bindRenderbuffer.set(m),u.renderbufferStorage(u.RENDERBUFFER,n,s,o),this.bindRenderbuffer.set(null),m},j.prototype.createFramebuffer=function(n,s,o){return new q(this,n,s,o)},j.prototype.clear=function(n){var s=n.color,o=n.depth,u=this.gl,m=0;s&&(m|=u.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),u.clear(m)},j.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},j.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},j.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},j.prototype.setColorMode=function(n){a.deepEqual(n.blendFunction,se.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},j.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Q=function(n){function s(o,u,m){var x=this;n.call(this),this.id=o,this.dispatcher=m,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(x._sourceLoaded=!0),x._sourceLoaded&&!x._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(x.reload(),x.transform&&x.update(x.transform))}),this.on("error",function(){x._sourceErrored=!0}),this._source=function(S,T,C,F){var G=new Gn[T.type](S,T,C,F);if(G.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+G.id);return a.bindAll(["load","abort","unload","serialize","prepare"],G),G}(o,u,m,this),this._tiles={},this._cache=new Zt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,u){return this._source.loadTile(o,u)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var u in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var m=this._tiles[u];m.upload(o),m.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return a.values(this._tiles).map(function(o){return o.tileID}).sort(me).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var u=this,m=[];for(var x in this._tiles)this._isIdRenderable(x,o)&&m.push(this._tiles[x]);return o?m.sort(function(S,T){var C=S.tileID,F=T.tileID,G=new a.Point(C.canonical.x,C.canonical.y)._rotate(u.transform.angle),K=new a.Point(F.canonical.x,F.canonical.y)._rotate(u.transform.angle);return C.overscaledZ-F.overscaledZ||K.y-G.y||K.x-G.x}).map(function(S){return S.tileID.key}):m.map(function(S){return S.tileID}).sort(me).map(function(S){return S.key})},s.prototype.hasRenderableParent=function(o){var u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)},s.prototype._isIdRenderable=function(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,u){var m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=u),this._loadTile(m,this._tileLoaded.bind(this,m,o,u)))},s.prototype._tileLoaded=function(o,u,m,x){if(x)return o.state="errored",void(x.status!==404?this._source.fire(new a.ErrorEvent(x,{tile:o})):this.update(this.transform));o.timeAdded=a.browser.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var u=this.getRenderableIds(),m=0;m<u.length;m++){var x=u[m];if(o.neighboringTiles&&o.neighboringTiles[x]){var S=this.getTileByID(x);T(o,S),T(S,o)}}function T(C,F){C.needsHillshadePrepare=!0;var G=F.tileID.canonical.x-C.tileID.canonical.x,K=F.tileID.canonical.y-C.tileID.canonical.y,X=Math.pow(2,C.tileID.canonical.z),te=F.tileID.key;G===0&&K===0||Math.abs(K)>1||(Math.abs(G)>1&&(Math.abs(G+X)===1?G+=X:Math.abs(G-X)===1&&(G-=X)),F.dem&&C.dem&&(C.dem.backfillBorder(F.dem,G,K),C.neighboringTiles&&C.neighboringTiles[te]&&(C.neighboringTiles[te].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,u,m,x){for(var S in this._tiles){var T=this._tiles[S];if(!(x[S]||!T.hasData()||T.tileID.overscaledZ<=u||T.tileID.overscaledZ>m)){for(var C=T.tileID;T&&T.tileID.overscaledZ>u+1;){var F=T.tileID.scaledTo(T.tileID.overscaledZ-1);(T=this._tiles[F.key])&&T.hasData()&&(C=F)}for(var G=C;G.overscaledZ>u;)if(o[(G=G.scaledTo(G.overscaledZ-1)).key]){x[C.key]=C;break}}}},s.prototype.findLoadedParent=function(o,u){if(o.key in this._loadedParentTiles){var m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=u?m:null}for(var x=o.overscaledZ-1;x>=u;x--){var S=o.scaledTo(x),T=this._getLoadedTile(S);if(T)return T}},s.prototype._getLoadedTile=function(o){var u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var u=Math.ceil(o.width/this._source.tileSize)+1,m=Math.ceil(o.height/this._source.tileSize)+1,x=Math.floor(u*m*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(S)},s.prototype.handleWrapJump=function(o){var u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){var m={};for(var x in this._tiles){var S=this._tiles[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),m[S.tileID.key]=S}for(var T in this._tiles=m,this._timers)clearTimeout(this._timers[T]),delete this._timers[T];for(var C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}},s.prototype.update=function(o){var u=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var m;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?m=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ue){return new a.OverscaledTileID(Ue.canonical.z,Ue.wrap,Ue.canonical.z,Ue.canonical.x,Ue.canonical.y)}):(m=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(m=m.filter(function(Ue){return u._source.hasTile(Ue)}))):m=[];var x=o.coveringZoomLevel(this._source),S=Math.max(x-s.maxOverzooming,this._source.minzoom),T=Math.max(x+s.maxUnderzooming,this._source.minzoom),C=this._updateRetainedTiles(m,x);if(Be(this._source.type)){for(var F={},G={},K=0,X=Object.keys(C);K<X.length;K+=1){var te=X[K],ee=C[te],ae=this._tiles[te];if(ae&&!(ae.fadeEndTime&&ae.fadeEndTime<=a.browser.now())){var H=this.findLoadedParent(ee,S);H&&(this._addTile(H.tileID),F[H.tileID.key]=H.tileID),G[te]=ee}}for(var oe in this._retainLoadedChildren(G,x,T,C),F)C[oe]||(this._coveredTiles[oe]=!0,C[oe]=F[oe])}for(var pe in C)this._tiles[pe].clearFadeHold();for(var ge=0,Ee=a.keysDifference(this._tiles,C);ge<Ee.length;ge+=1){var be=Ee[ge],Te=this._tiles[be];Te.hasSymbolBuckets&&!Te.holdingForFade()?Te.setHoldDuration(this.map._fadeDuration):Te.hasSymbolBuckets&&!Te.symbolFadeFinished()||this._removeTile(be)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,u){for(var m={},x={},S=Math.max(u-s.maxOverzooming,this._source.minzoom),T=Math.max(u+s.maxUnderzooming,this._source.minzoom),C={},F=0,G=o;F<G.length;F+=1){var K=G[F],X=this._addTile(K);m[K.key]=K,X.hasData()||u<this._source.maxzoom&&(C[K.key]=K)}this._retainLoadedChildren(C,u,T,m);for(var te=0,ee=o;te<ee.length;te+=1){var ae=ee[te],H=this._tiles[ae.key];if(!H.hasData()){if(u+1>this._source.maxzoom){var oe=ae.children(this._source.maxzoom)[0],pe=this.getTile(oe);if(pe&&pe.hasData()){m[oe.key]=oe;continue}}else{var ge=ae.children(this._source.maxzoom);if(m[ge[0].key]&&m[ge[1].key]&&m[ge[2].key]&&m[ge[3].key])continue}for(var Ee=H.wasRequested(),be=ae.overscaledZ-1;be>=S;--be){var Te=ae.scaledTo(be);if(x[Te.key]||(x[Te.key]=!0,!(H=this.getTile(Te))&&Ee&&(H=this._addTile(Te)),H&&(m[Te.key]=Te,Ee=H.wasRequested(),H.hasData())))break}}}return m},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var u=[],m=void 0,x=this._tiles[o].tileID;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){m=this._loadedParentTiles[x.key];break}u.push(x.key);var S=x.scaledTo(x.overscaledZ-1);if(m=this._getLoadedTile(S))break;x=S}for(var T=0,C=u;T<C.length;T+=1)this._loadedParentTiles[C[T]]=m}},s.prototype._addTile=function(o){var u=this._tiles[o.key];if(u)return u;(u=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));var m=Boolean(u);return m||(u=new a.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))),u?(u.uses++,this._tiles[o.key]=u,m||this._source.fire(new a.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null},s.prototype._setTileReloadTimer=function(o,u){var m=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var x=u.getExpiryTimeout();x&&(this._timers[o]=setTimeout(function(){m._reloadTile(o,"expired"),delete m._timers[o]},x))},s.prototype._removeTile=function(o){var u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,u,m){var x=this,S=[],T=this.transform;if(!T)return S;for(var C=m?T.getCameraQueryGeometry(o):o,F=o.map(function(be){return T.pointCoordinate(be)}),G=C.map(function(be){return T.pointCoordinate(be)}),K=this.getIds(),X=1/0,te=1/0,ee=-1/0,ae=-1/0,H=0,oe=G;H<oe.length;H+=1){var pe=oe[H];X=Math.min(X,pe.x),te=Math.min(te,pe.y),ee=Math.max(ee,pe.x),ae=Math.max(ae,pe.y)}for(var ge=function(be){var Te=x._tiles[K[be]];if(!Te.holdingForFade()){var Ue=Te.tileID,Xe=Math.pow(2,T.zoom-Te.tileID.overscaledZ),Ke=u*Te.queryPadding*a.EXTENT/Te.tileSize/Xe,ot=[Ue.getTilePoint(new a.MercatorCoordinate(X,te)),Ue.getTilePoint(new a.MercatorCoordinate(ee,ae))];if(ot[0].x-Ke<a.EXTENT&&ot[0].y-Ke<a.EXTENT&&ot[1].x+Ke>=0&&ot[1].y+Ke>=0){var wt=F.map(function(Et){return Ue.getTilePoint(Et)}),Tt=G.map(function(Et){return Ue.getTilePoint(Et)});S.push({tile:Te,tileID:Ue,queryGeometry:wt,cameraQueryGeometry:Tt,scale:Xe})}}},Ee=0;Ee<K.length;Ee++)ge(Ee);return S},s.prototype.getVisibleCoordinates=function(o){for(var u=this,m=this.getRenderableIds(o).map(function(C){return u._tiles[C].tileID}),x=0,S=m;x<S.length;x+=1){var T=S[x];T.posMatrix=this.transform.calculatePosMatrix(T.toUnwrapped())}return m},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Be(this._source.type))for(var o in this._tiles){var u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=a.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,u,m){this._state.updateState(o=o||"_geojsonTileLayer",u,m)},s.prototype.removeFeatureState=function(o,u,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,m)},s.prototype.getFeatureState=function(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)},s.prototype.setDependencies=function(o,u,m){var x=this._tiles[o];x&&x.setDependencies(u,m)},s.prototype.reloadTilesForDependencies=function(o,u){for(var m in this._tiles)this._tiles[m].hasDependency(o,u)&&this._reloadTile(m,"reloading");this._cache.filter(function(x){return!x.hasDependency(o,u)})},s}(a.Evented);function me(n,s){var o=Math.abs(2*n.wrap)-+(n.wrap<0),u=Math.abs(2*s.wrap)-+(s.wrap<0);return n.overscaledZ-s.overscaledZ||u-o||s.canonical.y-n.canonical.y||s.canonical.x-n.canonical.x}function Be(n){return n==="raster"||n==="image"||n==="video"}function Ne(){return new a.window.Worker(cu.workerUrl)}Q.maxOverzooming=10,Q.maxUnderzooming=3;var Se="mapboxgl_preloaded_worker_pool",Oe=function(){this.active={}};Oe.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<Oe.workerCount;)this.workers.push(new Ne);return this.active[n]=!0,this.workers.slice()},Oe.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},Oe.prototype.isPreloaded=function(){return!!this.active[Se]},Oe.prototype.numActive=function(){return Object.keys(this.active).length};var rt,et=Math.floor(a.browser.hardwareConcurrency/2);function we(){return rt||(rt=new Oe),rt}function Qe(n,s){var o={};for(var u in n)u!=="ref"&&(o[u]=n[u]);return a.refProperties.forEach(function(m){m in s&&(o[m]=s[m])}),o}function Ge(n){n=n.slice();for(var s=Object.create(null),o=0;o<n.length;o++)s[n[o].id]=n[o];for(var u=0;u<n.length;u++)"ref"in n[u]&&(n[u]=Qe(n[u],s[n[u].ref]));return n}Oe.workerCount=Math.max(Math.min(et,6),1);var Ze={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ct(n,s,o){o.push({command:Ze.addSource,args:[n,s[n]]})}function $e(n,s,o){s.push({command:Ze.removeSource,args:[n]}),o[n]=!0}function Kt(n,s,o,u){$e(n,o,u),Ct(n,s,o)}function sr(n,s,o){var u;for(u in n[o])if(n[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;for(u in s[o])if(s[o].hasOwnProperty(u)&&u!=="data"&&!a.deepEqual(n[o][u],s[o][u]))return!1;return!0}function Ft(n,s,o,u,m,x){var S;for(S in s=s||{},n=n||{})n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:x,args:[u,S,s[S],m]}));for(S in s)s.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(a.deepEqual(n[S],s[S])||o.push({command:x,args:[u,S,s[S],m]}))}function Ot(n){return n.id}function Xt(n,s){return n[s.id]=s,n}var Xr=function(n,s){this.reset(n,s)};Xr.prototype.reset=function(n,s){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Xr.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=a.clamp(n,0,1);for(var s=1,o=this._distances[s],u=n*this.paddedLength+this.padding;o<u&&s<this._distances.length;)o=this._distances[++s];var m=s-1,x=this._distances[m],S=o-x,T=S>0?(u-x)/S:0;return this.points[m].mult(1-T).add(this.points[s].mult(T))};var tr=function(n,s,o){var u=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(s/o);for(var x=0;x<this.xCellCount*this.yCellCount;x++)u.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Cr(n,s,o,u,m){var x=a.create();return s?(a.scale(x,x,[1/m,1/m,1]),o||a.rotateZ(x,x,u.angle)):a.multiply(x,u.labelPlaneMatrix,n),x}function or(n,s,o,u,m){if(s){var x=a.clone(n);return a.scale(x,x,[m,m,1]),o||a.rotateZ(x,x,-u.angle),x}return u.glCoordMatrix}function Ut(n,s){var o=[n.x,n.y,0,1];Or(o,o,s);var u=o[3];return{point:new a.Point(o[0]/u,o[1]/u),signedDistanceFromCamera:u}}function Dt(n,s){return .5+n/s*.5}function Wr(n,s){var o=n[0]/n[3],u=n[1]/n[3];return o>=-s[0]&&o<=s[0]&&u>=-s[1]&&u<=s[1]}function Yn(n,s,o,u,m,x,S,T){var C=u?n.textSizeData:n.iconSizeData,F=a.evaluateSizeForZoom(C,o.transform.zoom),G=[256/o.width*2+1,256/o.height*2+1],K=u?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;K.clear();for(var X=n.lineVertexArray,te=u?n.text.placedSymbolArray:n.icon.placedSymbolArray,ee=o.transform.width/o.transform.height,ae=!1,H=0;H<te.length;H++){var oe=te.get(H);if(oe.hidden||oe.writingMode===a.WritingMode.vertical&&!ae)ai(oe.numGlyphs,K);else{ae=!1;var pe=[oe.anchorX,oe.anchorY,0,1];if(a.transformMat4(pe,pe,s),Wr(pe,G)){var ge=Dt(o.transform.cameraToCenterDistance,pe[3]),Ee=a.evaluateSizeForFeature(C,F,oe),be=S?Ee/ge:Ee*ge,Te=new a.Point(oe.anchorX,oe.anchorY),Ue=Ut(Te,m).point,Xe={},Ke=Lo(oe,be,!1,T,s,m,x,n.glyphOffsetArray,X,K,Ue,Te,Xe,ee);ae=Ke.useVertical,(Ke.notEnoughRoom||ae||Ke.needsFlipping&&Lo(oe,be,!0,T,s,m,x,n.glyphOffsetArray,X,K,Ue,Te,Xe,ee).notEnoughRoom)&&ai(oe.numGlyphs,K)}else ai(oe.numGlyphs,K)}}u?n.text.dynamicLayoutVertexBuffer.updateData(K):n.icon.dynamicLayoutVertexBuffer.updateData(K)}function Hr(n,s,o,u,m,x,S,T,C,F,G){var K=T.glyphStartIndex+T.numGlyphs,X=T.lineStartIndex,te=T.lineStartIndex+T.lineLength,ee=s.getoffsetX(T.glyphStartIndex),ae=s.getoffsetX(K-1),H=zr(n*ee,o,u,m,x,S,T.segment,X,te,C,F,G);if(!H)return null;var oe=zr(n*ae,o,u,m,x,S,T.segment,X,te,C,F,G);return oe?{first:H,last:oe}:null}function hi(n,s,o,u){return n===a.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*u?{useVertical:!0}:(n===a.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function Lo(n,s,o,u,m,x,S,T,C,F,G,K,X,te){var ee,ae=s/24,H=n.lineOffsetX*ae,oe=n.lineOffsetY*ae;if(n.numGlyphs>1){var pe=n.glyphStartIndex+n.numGlyphs,ge=n.lineStartIndex,Ee=n.lineStartIndex+n.lineLength,be=Hr(ae,T,H,oe,o,G,K,n,C,x,X);if(!be)return{notEnoughRoom:!0};var Te=Ut(be.first.point,S).point,Ue=Ut(be.last.point,S).point;if(u&&!o){var Xe=hi(n.writingMode,Te,Ue,te);if(Xe)return Xe}ee=[be.first];for(var Ke=n.glyphStartIndex+1;Ke<pe-1;Ke++)ee.push(zr(ae*T.getoffsetX(Ke),H,oe,o,G,K,n.segment,ge,Ee,C,x,X));ee.push(be.last)}else{if(u&&!o){var ot=Ut(K,m).point,wt=n.lineStartIndex+n.segment+1,Tt=new a.Point(C.getx(wt),C.gety(wt)),Et=Ut(Tt,m),fr=Et.signedDistanceFromCamera>0?Et.point:vn(K,Tt,ot,1,m),ut=hi(n.writingMode,ot,fr,te);if(ut)return ut}var Bt=zr(ae*T.getoffsetX(n.glyphStartIndex),H,oe,o,G,K,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,C,x,X);if(!Bt)return{notEnoughRoom:!0};ee=[Bt]}for(var Ht=0,Rt=ee;Ht<Rt.length;Ht+=1){var Lt=Rt[Ht];a.addDynamicAttributes(F,Lt.point,Lt.angle)}return{}}function vn(n,s,o,u,m){var x=Ut(n.add(n.sub(s)._unit()),m).point,S=o.sub(x);return o.add(S._mult(u/S.mag()))}function zr(n,s,o,u,m,x,S,T,C,F,G,K){var X=u?n-s:n+s,te=X>0?1:-1,ee=0;u&&(te*=-1,ee=Math.PI),te<0&&(ee+=Math.PI);for(var ae=te>0?T+S:T+S+1,H=m,oe=m,pe=0,ge=0,Ee=Math.abs(X),be=[];pe+ge<=Ee;){if((ae+=te)<T||ae>=C)return null;if(oe=H,be.push(H),(H=K[ae])===void 0){var Te=new a.Point(F.getx(ae),F.gety(ae)),Ue=Ut(Te,G);if(Ue.signedDistanceFromCamera>0)H=K[ae]=Ue.point;else{var Xe=ae-te;H=vn(pe===0?x:new a.Point(F.getx(Xe),F.gety(Xe)),Te,oe,Ee-pe+1,G)}}pe+=ge,ge=oe.dist(H)}var Ke=(Ee-pe)/ge,ot=H.sub(oe),wt=ot.mult(Ke)._add(oe);wt._add(ot._unit()._perp()._mult(o*te));var Tt=ee+Math.atan2(H.y-oe.y,H.x-oe.x);return be.push(wt),{point:wt,angle:Tt,path:be}}tr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},tr.prototype.insert=function(n,s,o,u,m){this._forEachCell(s,o,u,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(m)},tr.prototype.insertCircle=function(n,s,o,u){this._forEachCell(s-u,o-u,s+u,o+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(o),this.circles.push(u)},tr.prototype._insertBoxCell=function(n,s,o,u,m,x){this.boxCells[m].push(x)},tr.prototype._insertCircleCell=function(n,s,o,u,m,x){this.circleCells[m].push(x)},tr.prototype._query=function(n,s,o,u,m,x){if(o<0||n>this.width||u<0||s>this.height)return!m&&[];var S=[];if(n<=0&&s<=0&&this.width<=o&&this.height<=u){if(m)return!0;for(var T=0;T<this.boxKeys.length;T++)S.push({key:this.boxKeys[T],x1:this.bboxes[4*T],y1:this.bboxes[4*T+1],x2:this.bboxes[4*T+2],y2:this.bboxes[4*T+3]});for(var C=0;C<this.circleKeys.length;C++){var F=this.circles[3*C],G=this.circles[3*C+1],K=this.circles[3*C+2];S.push({key:this.circleKeys[C],x1:F-K,y1:G-K,x2:F+K,y2:G+K})}return x?S.filter(x):S}return this._forEachCell(n,s,o,u,this._queryCell,S,{hitTest:m,seenUids:{box:{},circle:{}}},x),m?S.length>0:S},tr.prototype._queryCircle=function(n,s,o,u,m){var x=n-o,S=n+o,T=s-o,C=s+o;if(S<0||x>this.width||C<0||T>this.height)return!u&&[];var F=[];return this._forEachCell(x,T,S,C,this._queryCellCircle,F,{hitTest:u,circle:{x:n,y:s,radius:o},seenUids:{box:{},circle:{}}},m),u?F.length>0:F},tr.prototype.query=function(n,s,o,u,m){return this._query(n,s,o,u,!1,m)},tr.prototype.hitTest=function(n,s,o,u,m){return this._query(n,s,o,u,!0,m)},tr.prototype.hitTestCircle=function(n,s,o,u){return this._queryCircle(n,s,o,!0,u)},tr.prototype._queryCell=function(n,s,o,u,m,x,S,T){var C=S.seenUids,F=this.boxCells[m];if(F!==null)for(var G=this.bboxes,K=0,X=F;K<X.length;K+=1){var te=X[K];if(!C.box[te]){C.box[te]=!0;var ee=4*te;if(n<=G[ee+2]&&s<=G[ee+3]&&o>=G[ee+0]&&u>=G[ee+1]&&(!T||T(this.boxKeys[te]))){if(S.hitTest)return x.push(!0),!0;x.push({key:this.boxKeys[te],x1:G[ee],y1:G[ee+1],x2:G[ee+2],y2:G[ee+3]})}}}var ae=this.circleCells[m];if(ae!==null)for(var H=this.circles,oe=0,pe=ae;oe<pe.length;oe+=1){var ge=pe[oe];if(!C.circle[ge]){C.circle[ge]=!0;var Ee=3*ge;if(this._circleAndRectCollide(H[Ee],H[Ee+1],H[Ee+2],n,s,o,u)&&(!T||T(this.circleKeys[ge]))){if(S.hitTest)return x.push(!0),!0;var be=H[Ee],Te=H[Ee+1],Ue=H[Ee+2];x.push({key:this.circleKeys[ge],x1:be-Ue,y1:Te-Ue,x2:be+Ue,y2:Te+Ue})}}}},tr.prototype._queryCellCircle=function(n,s,o,u,m,x,S,T){var C=S.circle,F=S.seenUids,G=this.boxCells[m];if(G!==null)for(var K=this.bboxes,X=0,te=G;X<te.length;X+=1){var ee=te[X];if(!F.box[ee]){F.box[ee]=!0;var ae=4*ee;if(this._circleAndRectCollide(C.x,C.y,C.radius,K[ae+0],K[ae+1],K[ae+2],K[ae+3])&&(!T||T(this.boxKeys[ee])))return x.push(!0),!0}}var H=this.circleCells[m];if(H!==null)for(var oe=this.circles,pe=0,ge=H;pe<ge.length;pe+=1){var Ee=ge[pe];if(!F.circle[Ee]){F.circle[Ee]=!0;var be=3*Ee;if(this._circlesCollide(oe[be],oe[be+1],oe[be+2],C.x,C.y,C.radius)&&(!T||T(this.circleKeys[Ee])))return x.push(!0),!0}}},tr.prototype._forEachCell=function(n,s,o,u,m,x,S,T){for(var C=this._convertToXCellCoord(n),F=this._convertToYCellCoord(s),G=this._convertToXCellCoord(o),K=this._convertToYCellCoord(u),X=C;X<=G;X++)for(var te=F;te<=K;te++)if(m.call(this,n,s,o,u,this.xCellCount*te+X,x,S,T))return},tr.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},tr.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},tr.prototype._circlesCollide=function(n,s,o,u,m,x){var S=u-n,T=m-s,C=o+x;return C*C>S*S+T*T},tr.prototype._circleAndRectCollide=function(n,s,o,u,m,x,S){var T=(x-u)/2,C=Math.abs(n-(u+T));if(C>T+o)return!1;var F=(S-m)/2,G=Math.abs(s-(m+F));if(G>F+o)return!1;if(C<=T||G<=F)return!0;var K=C-T,X=G-F;return K*K+X*X<=o*o};var Qn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ai(n,s){for(var o=0;o<n;o++){var u=s.length;s.resize(u+4),s.float32.set(Qn,3*u)}}function Or(n,s,o){var u=s[0],m=s[1];return n[0]=o[0]*u+o[4]*m+o[12],n[1]=o[1]*u+o[5]*m+o[13],n[3]=o[3]*u+o[7]*m+o[15],n}var Di=function(n,s,o){s===void 0&&(s=new tr(n.width+200,n.height+200,25)),o===void 0&&(o=new tr(n.width+200,n.height+200,25)),this.transform=n,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function xr(n,s,o){return s*(a.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}Di.prototype.placeCollisionBox=function(n,s,o,u,m){var x=this.projectAndGetPerspectiveRatio(u,n.anchorPointX,n.anchorPointY),S=o*x.perspectiveRatio,T=n.x1*S+x.point.x,C=n.y1*S+x.point.y,F=n.x2*S+x.point.x,G=n.y2*S+x.point.y;return!this.isInsideGrid(T,C,F,G)||!s&&this.grid.hitTest(T,C,F,G,m)?{box:[],offscreen:!1}:{box:[T,C,F,G],offscreen:this.isOffscreen(T,C,F,G)}},Di.prototype.placeCollisionCircles=function(n,s,o,u,m,x,S,T,C,F,G,K,X){var te=[],ee=new a.Point(s.anchorX,s.anchorY),ae=Ut(ee,x),H=Dt(this.transform.cameraToCenterDistance,ae.signedDistanceFromCamera),oe=(F?m/H:m*H)/a.ONE_EM,pe=Ut(ee,S).point,ge=Hr(oe,u,s.lineOffsetX*oe,s.lineOffsetY*oe,!1,pe,ee,s,o,S,{}),Ee=!1,be=!1,Te=!0;if(ge){for(var Ue=.5*K*H+X,Xe=new a.Point(-100,-100),Ke=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),ot=new Xr,wt=ge.first,Tt=ge.last,Et=[],fr=wt.path.length-1;fr>=1;fr--)Et.push(wt.path[fr]);for(var ut=1;ut<Tt.path.length;ut++)Et.push(Tt.path[ut]);var Bt=2.5*Ue;if(T){var Ht=Et.map(function(Ko){return Ut(Ko,T)});Et=Ht.some(function(Ko){return Ko.signedDistanceFromCamera<=0})?[]:Ht.map(function(Ko){return Ko.point})}var Rt=[];if(Et.length>0){for(var Lt=Et[0].clone(),Wt=Et[0].clone(),Mt=1;Mt<Et.length;Mt++)Lt.x=Math.min(Lt.x,Et[Mt].x),Lt.y=Math.min(Lt.y,Et[Mt].y),Wt.x=Math.max(Wt.x,Et[Mt].x),Wt.y=Math.max(Wt.y,Et[Mt].y);Rt=Lt.x>=Xe.x&&Wt.x<=Ke.x&&Lt.y>=Xe.y&&Wt.y<=Ke.y?[Et]:Wt.x<Xe.x||Lt.x>Ke.x||Wt.y<Xe.y||Lt.y>Ke.y?[]:a.clipLine([Et],Xe.x,Xe.y,Ke.x,Ke.y)}for(var It=0,Gi=Rt;It<Gi.length;It+=1){var pi;ot.reset(Gi[It],.25*Ue),pi=ot.length<=.5*Ue?1:Math.ceil(ot.paddedLength/Bt)+1;for(var An=0;An<pi;An++){var en=An/Math.max(pi-1,1),ui=ot.lerp(en),wi=ui.x+100,bo=ui.y+100;te.push(wi,bo,Ue,0);var Un=wi-Ue,Es=bo-Ue,no=wi+Ue,Sa=bo+Ue;if(Te=Te&&this.isOffscreen(Un,Es,no,Sa),be=be||this.isInsideGrid(Un,Es,no,Sa),!n&&this.grid.hitTestCircle(wi,bo,Ue,G)&&(Ee=!0,!C))return{circles:[],offscreen:!1,collisionDetected:Ee}}}}return{circles:!C&&Ee||!be?[]:te,offscreen:Te,collisionDetected:Ee}},Di.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var s=[],o=1/0,u=1/0,m=-1/0,x=-1/0,S=0,T=n;S<T.length;S+=1){var C=T[S],F=new a.Point(C.x+100,C.y+100);o=Math.min(o,F.x),u=Math.min(u,F.y),m=Math.max(m,F.x),x=Math.max(x,F.y),s.push(F)}for(var G={},K={},X=0,te=this.grid.query(o,u,m,x).concat(this.ignoredGrid.query(o,u,m,x));X<te.length;X+=1){var ee=te[X],ae=ee.key;if(G[ae.bucketInstanceId]===void 0&&(G[ae.bucketInstanceId]={}),!G[ae.bucketInstanceId][ae.featureIndex]){var H=[new a.Point(ee.x1,ee.y1),new a.Point(ee.x2,ee.y1),new a.Point(ee.x2,ee.y2),new a.Point(ee.x1,ee.y2)];a.polygonIntersectsPolygon(s,H)&&(G[ae.bucketInstanceId][ae.featureIndex]=!0,K[ae.bucketInstanceId]===void 0&&(K[ae.bucketInstanceId]=[]),K[ae.bucketInstanceId].push(ae.featureIndex))}}return K},Di.prototype.insertCollisionBox=function(n,s,o,u,m){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:u,collisionGroupID:m},n[0],n[1],n[2],n[3])},Di.prototype.insertCollisionCircles=function(n,s,o,u,m){for(var x=s?this.ignoredGrid:this.grid,S={bucketInstanceId:o,featureIndex:u,collisionGroupID:m},T=0;T<n.length;T+=4)x.insertCircle(S,n[T],n[T+1],n[T+2])},Di.prototype.projectAndGetPerspectiveRatio=function(n,s,o){var u=[s,o,0,1];return Or(u,u,n),{point:new a.Point((u[0]/u[3]+1)/2*this.transform.width+100,(-u[1]/u[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u[3]*.5}},Di.prototype.isOffscreen=function(n,s,o,u){return o<100||n>=this.screenRightBoundary||u<100||s>this.screenBottomBoundary},Di.prototype.isInsideGrid=function(n,s,o,u){return o>=0&&n<this.gridRightBoundary&&u>=0&&s<this.gridBottomBoundary},Di.prototype.getViewportMatrix=function(){var n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n};var cn=function(n,s,o,u){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):u&&o?1:0,this.placed=o};cn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Li=function(n,s,o,u,m){this.text=new cn(n?n.text:null,s,o,m),this.icon=new cn(n?n.icon:null,s,u,m)};Li.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ti=function(n,s,o){this.text=n,this.icon=s,this.skipFade=o},mr=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},co=function(n,s,o,u,m){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=u,this.tileID=m},Nr=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Jr(n,s,o,u,m){var x=a.getAnchorAlignment(n),S=-(x.horizontalAlign-.5)*s,T=-(x.verticalAlign-.5)*o,C=a.evaluateVariableOffset(n,u);return new a.Point(S+C[0]*m,T+C[1]*m)}function xn(n,s,o,u,m,x){var S=n.x1,T=n.x2,C=n.y1,F=n.y2,G=n.anchorPointX,K=n.anchorPointY,X=new a.Point(s,o);return u&&X._rotate(m?x:-x),{x1:S+X.x,y1:C+X.y,x2:T+X.x,y2:F+X.y,anchorPointX:G,anchorPointY:K}}Nr.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[n]};var vi=function(n,s,o,u){this.transform=n.clone(),this.collisionIndex=new Di(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Nr(o),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}};function ho(n,s,o,u,m){n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0),n.emplaceBack(s?1:0,o?1:0,u||0,m||0)}vi.prototype.getBucketParts=function(n,s,o,u){var m=o.getBucket(s),x=o.latestFeatureIndex;if(m&&x&&s.id===m.layerIds[0]){var S=o.collisionBoxArray,T=m.layers[0].layout,C=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),F=o.tileSize/a.EXTENT,G=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),K=T.get("text-pitch-alignment")==="map",X=T.get("text-rotation-alignment")==="map",te=xr(o,1,this.transform.zoom),ee=Cr(G,K,X,this.transform,te),ae=null;if(K){var H=or(G,K,X,this.transform,te);ae=a.multiply([],this.transform.labelPlaneMatrix,H)}this.retainedQueryData[m.bucketInstanceId]=new co(m.bucketInstanceId,x,m.sourceLayerIndex,m.index,o.tileID);var oe={bucket:m,layout:T,posMatrix:G,textLabelPlaneMatrix:ee,labelToScreenMatrix:ae,scale:C,textPixelRatio:F,holdingForFade:o.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(u)for(var pe=0,ge=m.sortKeyRanges;pe<ge.length;pe+=1){var Ee=ge[pe];n.push({sortKey:Ee.sortKey,symbolInstanceStart:Ee.symbolInstanceStart,symbolInstanceEnd:Ee.symbolInstanceEnd,parameters:oe})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:oe})}},vi.prototype.attemptAnchorPlacement=function(n,s,o,u,m,x,S,T,C,F,G,K,X,te,ee){var ae,H=[K.textOffset0,K.textOffset1],oe=Jr(n,o,u,H,m),pe=this.collisionIndex.placeCollisionBox(xn(s,oe.x,oe.y,x,S,this.transform.angle),G,T,C,F.predicate);if(!ee||this.collisionIndex.placeCollisionBox(xn(ee,oe.x,oe.y,x,S,this.transform.angle),G,T,C,F.predicate).box.length!==0)return pe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID]&&this.prevPlacement.placements[K.crossTileID].text&&(ae=this.prevPlacement.variableOffsets[K.crossTileID].anchor),this.variableOffsets[K.crossTileID]={textOffset:H,width:o,height:u,anchor:n,textBoxScale:m,prevAnchor:ae},this.markUsedJustification(X,n,K,te),X.allowVerticalPlacement&&(this.markUsedOrientation(X,te,K),this.placedOrientations[K.crossTileID]=te),{shift:oe,placedGlyphBoxes:pe}):void 0},vi.prototype.placeLayerBucketPart=function(n,s,o){var u=this,m=n.parameters,x=m.bucket,S=m.layout,T=m.posMatrix,C=m.textLabelPlaneMatrix,F=m.labelToScreenMatrix,G=m.textPixelRatio,K=m.holdingForFade,X=m.collisionBoxArray,te=m.partiallyEvaluatedTextSize,ee=m.collisionGroup,ae=S.get("text-optional"),H=S.get("icon-optional"),oe=S.get("text-allow-overlap"),pe=S.get("icon-allow-overlap"),ge=S.get("text-rotation-alignment")==="map",Ee=S.get("text-pitch-alignment")==="map",be=S.get("icon-text-fit")!=="none",Te=S.get("symbol-z-order")==="viewport-y",Ue=oe&&(pe||!x.hasIconData()||H),Xe=pe&&(oe||!x.hasTextData()||ae);!x.collisionArrays&&X&&x.deserializeCollisionBoxes(X);var Ke=function(ut,Bt){if(!s[ut.crossTileID])if(K)u.placements[ut.crossTileID]=new Ti(!1,!1,!1);else{var Ht,Rt=!1,Lt=!1,Wt=!0,Mt=null,It={box:null,offscreen:null},Gi={box:null,offscreen:null},pi=null,An=null,en=0,ui=0,wi=0;Bt.textFeatureIndex?en=Bt.textFeatureIndex:ut.useRuntimeCollisionCircles&&(en=ut.featureIndex),Bt.verticalTextFeatureIndex&&(ui=Bt.verticalTextFeatureIndex);var bo=Bt.textBox;if(bo){var Un=function(br){var Mo=a.WritingMode.horizontal;if(x.allowVerticalPlacement&&!br&&u.prevPlacement){var oo=u.prevPlacement.placedOrientations[ut.crossTileID];oo&&(u.placedOrientations[ut.crossTileID]=oo,u.markUsedOrientation(x,Mo=oo,ut))}return Mo},Es=function(br,Mo){if(x.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&Bt.verticalTextBox)for(var oo=0,el=x.writingModes;oo<el.length&&(el[oo]===a.WritingMode.vertical?(It=Mo(),Gi=It):It=br(),!(It&&It.box&&It.box.length));oo+=1);else It=br()};if(S.get("text-variable-anchor")){var no=S.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[ut.crossTileID]){var Sa=u.prevPlacement.variableOffsets[ut.crossTileID];no.indexOf(Sa.anchor)>0&&(no=no.filter(function(br){return br!==Sa.anchor})).unshift(Sa.anchor)}var Ko=function(br,Mo,oo){for(var el=br.x2-br.x1,Gh=br.y2-br.y1,hu=ut.textBoxScale,Kh=be&&!pe?Mo:null,ql={box:[],offscreen:!1},Zc=oe?2*no.length:no.length,_l=0;_l<Zc;++_l){var pu=u.attemptAnchorPlacement(no[_l%no.length],br,el,Gh,hu,ge,Ee,G,T,ee,_l>=no.length,ut,x,oo,Kh);if(pu&&(ql=pu.placedGlyphBoxes)&&ql.box&&ql.box.length){Rt=!0,Mt=pu.shift;break}}return ql};Es(function(){return Ko(bo,Bt.iconBox,a.WritingMode.horizontal)},function(){var br=Bt.verticalTextBox;return x.allowVerticalPlacement&&!(It&&It.box&&It.box.length)&&ut.numVerticalGlyphVertices>0&&br?Ko(br,Bt.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),It&&(Rt=It.box,Wt=It.offscreen);var Ul=Un(It&&It.box);if(!Rt&&u.prevPlacement){var yl=u.prevPlacement.variableOffsets[ut.crossTileID];yl&&(u.variableOffsets[ut.crossTileID]=yl,u.markUsedJustification(x,yl.anchor,ut,Ul))}}else{var Ts=function(br,Mo){var oo=u.collisionIndex.placeCollisionBox(br,oe,G,T,ee.predicate);return oo&&oo.box&&oo.box.length&&(u.markUsedOrientation(x,Mo,ut),u.placedOrientations[ut.crossTileID]=Mo),oo};Es(function(){return Ts(bo,a.WritingMode.horizontal)},function(){var br=Bt.verticalTextBox;return x.allowVerticalPlacement&&ut.numVerticalGlyphVertices>0&&br?Ts(br,a.WritingMode.vertical):{box:null,offscreen:null}}),Un(It&&It.box&&It.box.length)}}if(Rt=(Ht=It)&&Ht.box&&Ht.box.length>0,Wt=Ht&&Ht.offscreen,ut.useRuntimeCollisionCircles){var gl=x.text.placedSymbolArray.get(ut.centerJustifiedTextSymbolIndex),Vl=a.evaluateSizeForFeature(x.textSizeData,te,gl),Ka=S.get("text-padding");pi=u.collisionIndex.placeCollisionCircles(oe,gl,x.lineVertexArray,x.glyphOffsetArray,Vl,T,C,F,o,Ee,ee.predicate,ut.collisionCircleDiameter,Ka),Rt=oe||pi.circles.length>0&&!pi.collisionDetected,Wt=Wt&&pi.offscreen}if(Bt.iconFeatureIndex&&(wi=Bt.iconFeatureIndex),Bt.iconBox){var jl=function(br){var Mo=be&&Mt?xn(br,Mt.x,Mt.y,ge,Ee,u.transform.angle):br;return u.collisionIndex.placeCollisionBox(Mo,pe,G,T,ee.predicate)};Lt=Gi&&Gi.box&&Gi.box.length&&Bt.verticalIconBox?(An=jl(Bt.verticalIconBox)).box.length>0:(An=jl(Bt.iconBox)).box.length>0,Wt=Wt&&An.offscreen}var Xa=ae||ut.numHorizontalGlyphVertices===0&&ut.numVerticalGlyphVertices===0,Ki=H||ut.numIconVertices===0;if(Xa||Ki?Ki?Xa||(Lt=Lt&&Rt):Rt=Lt&&Rt:Lt=Rt=Lt&&Rt,Rt&&Ht&&Ht.box&&u.collisionIndex.insertCollisionBox(Ht.box,S.get("text-ignore-placement"),x.bucketInstanceId,Gi&&Gi.box&&ui?ui:en,ee.ID),Lt&&An&&u.collisionIndex.insertCollisionBox(An.box,S.get("icon-ignore-placement"),x.bucketInstanceId,wi,ee.ID),pi&&(Rt&&u.collisionIndex.insertCollisionCircles(pi.circles,S.get("text-ignore-placement"),x.bucketInstanceId,en,ee.ID),o)){var us=x.bucketInstanceId,Is=u.collisionCircleArrays[us];Is===void 0&&(Is=u.collisionCircleArrays[us]=new mr);for(var $s=0;$s<pi.circles.length;$s+=4)Is.circles.push(pi.circles[$s+0]),Is.circles.push(pi.circles[$s+1]),Is.circles.push(pi.circles[$s+2]),Is.circles.push(pi.collisionDetected?1:0)}u.placements[ut.crossTileID]=new Ti(Rt||Ue,Lt||Xe,Wt||x.justReloaded),s[ut.crossTileID]=!0}};if(Te)for(var ot=x.getSortedSymbolIndexes(this.transform.angle),wt=ot.length-1;wt>=0;--wt){var Tt=ot[wt];Ke(x.symbolInstances.get(Tt),x.collisionArrays[Tt])}else for(var Et=n.symbolInstanceStart;Et<n.symbolInstanceEnd;Et++)Ke(x.symbolInstances.get(Et),x.collisionArrays[Et]);if(o&&x.bucketInstanceId in this.collisionCircleArrays){var fr=this.collisionCircleArrays[x.bucketInstanceId];a.invert(fr.invProjMatrix,T),fr.viewportMatrix=this.collisionIndex.getViewportMatrix()}x.justReloaded=!1},vi.prototype.markUsedJustification=function(n,s,o,u){var m;m=u===a.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(s)];for(var x=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];x<S.length;x+=1){var T=S[x];T>=0&&(n.text.placedSymbolArray.get(T).crossTileID=m>=0&&T!==m?0:o.crossTileID)}},vi.prototype.markUsedOrientation=function(n,s,o){for(var u=s===a.WritingMode.horizontal||s===a.WritingMode.horizontalOnly?s:0,m=s===a.WritingMode.vertical?s:0,x=0,S=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];x<S.length;x+=1)n.text.placedSymbolArray.get(S[x]).placedOrientation=u;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=m)},vi.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var u=s?s.symbolFadeChange(n):1,m=s?s.opacities:{},x=s?s.variableOffsets:{},S=s?s.placedOrientations:{};for(var T in this.placements){var C=this.placements[T],F=m[T];F?(this.opacities[T]=new Li(F,u,C.text,C.icon),o=o||C.text!==F.text.placed||C.icon!==F.icon.placed):(this.opacities[T]=new Li(null,u,C.text,C.icon,C.skipFade),o=o||C.text||C.icon)}for(var G in m){var K=m[G];if(!this.opacities[G]){var X=new Li(K,u,!1,!1);X.isHidden()||(this.opacities[G]=X,o=o||K.text.placed||K.icon.placed)}}for(var te in x)this.variableOffsets[te]||!this.opacities[te]||this.opacities[te].isHidden()||(this.variableOffsets[te]=x[te]);for(var ee in S)this.placedOrientations[ee]||!this.opacities[ee]||this.opacities[ee].isHidden()||(this.placedOrientations[ee]=S[ee]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)},vi.prototype.updateLayerOpacities=function(n,s){for(var o={},u=0,m=s;u<m.length;u+=1){var x=m[u],S=x.getBucket(n);S&&x.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,o,x.collisionBoxArray)}},vi.prototype.updateBucketOpacities=function(n,s,o){var u=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var m=n.layers[0].layout,x=new Li(null,0,!1,!1,!0),S=m.get("text-allow-overlap"),T=m.get("icon-allow-overlap"),C=m.get("text-variable-anchor"),F=m.get("text-rotation-alignment")==="map",G=m.get("text-pitch-alignment")==="map",K=m.get("icon-text-fit")!=="none",X=new Li(null,0,S&&(T||!n.hasIconData()||m.get("icon-optional")),T&&(S||!n.hasTextData()||m.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var te=function(oe,pe,ge){for(var Ee=0;Ee<pe/4;Ee++)oe.opacityVertexArray.emplaceBack(ge)},ee=function(oe){var pe=n.symbolInstances.get(oe),ge=pe.numHorizontalGlyphVertices,Ee=pe.numVerticalGlyphVertices,be=pe.crossTileID,Te=u.opacities[be];s[be]?Te=x:Te||(u.opacities[be]=Te=X),s[be]=!0;var Ue=pe.numIconVertices>0,Xe=u.placedOrientations[pe.crossTileID],Ke=Xe===a.WritingMode.vertical,ot=Xe===a.WritingMode.horizontal||Xe===a.WritingMode.horizontalOnly;if(ge>0||Ee>0){var wt=ms(Te.text);te(n.text,ge,Ke?Bo:wt),te(n.text,Ee,ot?Bo:wt);var Tt=Te.text.isHidden();[pe.rightJustifiedTextSymbolIndex,pe.centerJustifiedTextSymbolIndex,pe.leftJustifiedTextSymbolIndex].forEach(function(It){It>=0&&(n.text.placedSymbolArray.get(It).hidden=Tt||Ke?1:0)}),pe.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(pe.verticalPlacedTextSymbolIndex).hidden=Tt||ot?1:0);var Et=u.variableOffsets[pe.crossTileID];Et&&u.markUsedJustification(n,Et.anchor,pe,Xe);var fr=u.placedOrientations[pe.crossTileID];fr&&(u.markUsedJustification(n,"left",pe,fr),u.markUsedOrientation(n,fr,pe))}if(Ue){var ut=ms(Te.icon),Bt=!(K&&pe.verticalPlacedIconSymbolIndex&&Ke);pe.placedIconSymbolIndex>=0&&(te(n.icon,pe.numIconVertices,Bt?ut:Bo),n.icon.placedSymbolArray.get(pe.placedIconSymbolIndex).hidden=Te.icon.isHidden()),pe.verticalPlacedIconSymbolIndex>=0&&(te(n.icon,pe.numVerticalIconVertices,Bt?Bo:ut),n.icon.placedSymbolArray.get(pe.verticalPlacedIconSymbolIndex).hidden=Te.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var Ht=n.collisionArrays[oe];if(Ht){var Rt=new a.Point(0,0);if(Ht.textBox||Ht.verticalTextBox){var Lt=!0;if(C){var Wt=u.variableOffsets[be];Wt?(Rt=Jr(Wt.anchor,Wt.width,Wt.height,Wt.textOffset,Wt.textBoxScale),F&&Rt._rotate(G?u.transform.angle:-u.transform.angle)):Lt=!1}Ht.textBox&&ho(n.textCollisionBox.collisionVertexArray,Te.text.placed,!Lt||Ke,Rt.x,Rt.y),Ht.verticalTextBox&&ho(n.textCollisionBox.collisionVertexArray,Te.text.placed,!Lt||ot,Rt.x,Rt.y)}var Mt=Boolean(!ot&&Ht.verticalIconBox);Ht.iconBox&&ho(n.iconCollisionBox.collisionVertexArray,Te.icon.placed,Mt,K?Rt.x:0,K?Rt.y:0),Ht.verticalIconBox&&ho(n.iconCollisionBox.collisionVertexArray,Te.icon.placed,!Mt,K?Rt.x:0,K?Rt.y:0)}}},ae=0;ae<n.symbolInstances.length;ae++)ee(ae);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var H=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=H.invProjMatrix,n.placementViewportMatrix=H.viewportMatrix,n.collisionCircleArray=H.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},vi.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},vi.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},vi.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},vi.prototype.stillRecent=function(n,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>n},vi.prototype.setStale=function(){this.stale=!0};var Eo=Math.pow(2,25),Ro=Math.pow(2,24),ia=Math.pow(2,17),Os=Math.pow(2,16),$n=Math.pow(2,9),Ta=Math.pow(2,8),Ia=Math.pow(2,1);function ms(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var s=n.placed?1:0,o=Math.floor(127*n.opacity);return o*Eo+s*Ro+o*ia+s*Os+o*$n+s*Ta+o*Ia+s}var Bo=0,po=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};po.prototype.continuePlacement=function(n,s,o,u,m){for(var x=this._bucketParts;this._currentTileIndex<n.length;)if(s.getBucketParts(x,u,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort(function(S,T){return S.sortKey-T.sortKey}));this._currentPartIndex<x.length;)if(s.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,m())return!0;return!1};var na=function(n,s,o,u,m,x,S){this.placement=new vi(n,m,x,S),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=u,this._done=!1};na.prototype.isDone=function(){return this._done},na.prototype.continuePlacement=function(n,s,o){for(var u=this,m=a.browser.now(),x=function(){var C=a.browser.now()-m;return!u._forceFullPlacement&&C>2};this._currentPlacementIndex>=0;){var S=s[n[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=T)&&(!S.maxzoom||S.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new po(S)),this._inProgressLayer.continuePlacement(o[S.source],this.placement,this._showCollisionBoxes,S,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},na.prototype.commit=function(n){return this.placement.commit(n),this.placement};var To=512/a.EXTENT/2,eo=function(n,s,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var u=0;u<s.length;u++){var m=s.get(u),x=m.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:m.crossTileID,coord:this.getScaledCoordinates(m,n)})}};eo.prototype.getScaledCoordinates=function(n,s){var o=To/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*a.EXTENT+n.anchorX)*o),y:Math.floor((s.canonical.y*a.EXTENT+n.anchorY)*o)}},eo.prototype.findMatches=function(n,s,o){for(var u=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),m=0;m<n.length;m++){var x=n.get(m);if(!x.crossTileID){var S=this.indexedSymbolInstances[x.key];if(S)for(var T=this.getScaledCoordinates(x,s),C=0,F=S;C<F.length;C+=1){var G=F[C];if(Math.abs(G.coord.x-T.x)<=u&&Math.abs(G.coord.y-T.y)<=u&&!o[G.crossTileID]){o[G.crossTileID]=!0,x.crossTileID=G.crossTileID;break}}}}};var hn=function(){this.maxCrossTileID=0};hn.prototype.generate=function(){return++this.maxCrossTileID};var fo=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};fo.prototype.handleWrapJump=function(n){var s=Math.round((n-this.lng)/360);if(s!==0)for(var o in this.indexes){var u=this.indexes[o],m={};for(var x in u){var S=u[x];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+s),m[S.tileID.key]=S}this.indexes[o]=m}this.lng=n},fo.prototype.addBucket=function(n,s,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var u=0;u<s.symbolInstances.length;u++)s.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var m=this.usedCrossTileIDs[n.overscaledZ];for(var x in this.indexes){var S=this.indexes[x];if(Number(x)>n.overscaledZ)for(var T in S){var C=S[T];C.tileID.isChildOf(n)&&C.findMatches(s.symbolInstances,n,m)}else{var F=S[n.scaledTo(Number(x)).key];F&&F.findMatches(s.symbolInstances,n,m)}}for(var G=0;G<s.symbolInstances.length;G++){var K=s.symbolInstances.get(G);K.crossTileID||(K.crossTileID=o.generate(),m[K.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new eo(n,s.symbolInstances,s.bucketInstanceId),!0},fo.prototype.removeBucketCrossTileIDs=function(n,s){for(var o in s.indexedSymbolInstances)for(var u=0,m=s.indexedSymbolInstances[o];u<m.length;u+=1)delete this.usedCrossTileIDs[n][m[u].crossTileID]},fo.prototype.removeStaleBuckets=function(n){var s=!1;for(var o in this.indexes){var u=this.indexes[o];for(var m in u)n[u[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,u[m]),delete u[m],s=!0)}return s};var de=function(){this.layerIndexes={},this.crossTileIDs=new hn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};de.prototype.addLayer=function(n,s,o){var u=this.layerIndexes[n.id];u===void 0&&(u=this.layerIndexes[n.id]=new fo);var m=!1,x={};u.handleWrapJump(o);for(var S=0,T=s;S<T.length;S+=1){var C=T[S],F=C.getBucket(n);F&&n.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(C.tileID,F,this.crossTileIDs)&&(m=!0),x[F.bucketInstanceId]=!0)}return u.removeStaleBuckets(x)&&(m=!0),m},de.prototype.pruneUnusedLayers=function(n){var s={};for(var o in n.forEach(function(u){s[u]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var ri=function(n,s){return a.emitValidationErrors(n,s&&s.filter(function(o){return o.identifier!=="source.canvas"}))},xi=a.pick(Ze,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),yr=a.pick(Ze,["setCenter","setZoom","setBearing","setPitch"]),bn=function(){var n={},s=a.styleSpec.$version;for(var o in a.styleSpec.$root){var u,m=a.styleSpec.$root[o];m.required&&(u=o==="version"?s:m.type==="array"?[]:{})!=null&&(n[o]=u)}return n}(),pn=function(n){function s(o,u){var m=this;u===void 0&&(u={}),n.call(this),this.map=o,this.dispatcher=new er(we(),this),this.imageManager=new Me,this.imageManager.setEventedParent(this),this.glyphManager=new pt(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new xt(256,512),this.crossTileSymbolIndex=new de,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var x=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(S){x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(T,C){if(a.triggerPluginCompletionEvent(T),C&&C.every(function(G){return G}))for(var F in x.sourceCaches)x.sourceCaches[F].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var T=m.sourceCaches[S.sourceId];if(T){var C=T.getSource();if(C&&C.vectorLayerIds)for(var F in m._layers){var G=m._layers[F];G.source===C.id&&m._validateLayer(G)}}}})}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.loadURL=function(o,u){var m=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var x=typeof u.validate=="boolean"?u.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);var S=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(S,function(T,C){m._request=null,T?m.fire(new a.ErrorEvent(T)):C&&m._load(C,x)})},s.prototype.loadJSON=function(o,u){var m=this;u===void 0&&(u={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){m._request=null,m._load(o,u.validate!==!1)})},s.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(bn,!1)},s.prototype._load=function(o,u){if(!u||!ri(this,a.validateStyle(o))){for(var m in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(m,o.sources[m],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var x=Ge(this.stylesheet.layers);this._order=x.map(function(F){return F.id}),this._layers={},this._serializedLayers={};for(var S=0,T=x;S<T.length;S+=1){var C=T[S];(C=a.createStyleLayer(C)).setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new nt(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},s.prototype._loadSprite=function(o){var u=this;this._spriteRequest=function(m,x,S){var T,C,F,G=a.browser.devicePixelRatio>1?"@2x":"",K=a.getJSON(x.transformRequest(x.normalizeSpriteURL(m,G,".json"),a.ResourceType.SpriteJSON),function(ee,ae){K=null,F||(F=ee,T=ae,te())}),X=a.getImage(x.transformRequest(x.normalizeSpriteURL(m,G,".png"),a.ResourceType.SpriteImage),function(ee,ae){X=null,F||(F=ee,C=ae,te())});function te(){if(F)S(F);else if(T&&C){var ee=a.browser.getImageData(C),ae={};for(var H in T){var oe=T[H],pe=oe.width,ge=oe.height,Ee=oe.x,be=oe.y,Te=oe.sdf,Ue=oe.pixelRatio,Xe=oe.stretchX,Ke=oe.stretchY,ot=oe.content,wt=new a.RGBAImage({width:pe,height:ge});a.RGBAImage.copy(ee,wt,{x:Ee,y:be},{x:0,y:0},{width:pe,height:ge}),ae[H]={data:wt,pixelRatio:Ue,sdf:Te,stretchX:Xe,stretchY:Ke,content:ot}}S(null,ae)}}return{cancel:function(){K&&(K.cancel(),K=null),X&&(X.cancel(),X=null)}}}(o,this.map._requestManager,function(m,x){if(u._spriteRequest=null,m)u.fire(new a.ErrorEvent(m));else if(x)for(var S in x)u.imageManager.addImage(S,x[S]);u.imageManager.setLoaded(!0),u._availableImages=u.imageManager.listImages(),u.dispatcher.broadcast("setImages",u._availableImages),u.fire(new a.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var u=this.sourceCaches[o.source];if(u){var m=o.sourceLayer;if(m){var x=u.getSource();(x.type==="geojson"||x.vectorLayerIds&&x.vectorLayerIds.indexOf(m)===-1)&&this.fire(new a.ErrorEvent(new Error('Source layer "'+m+'" does not exist on source "'+x.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var u=[],m=0,x=o;m<x.length;m+=1){var S=this._layers[x[m]];S.type!=="custom"&&u.push(S.serialize())}return u},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var u in this._layers)if(this._layers[u].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var u=this._changed;if(this._changed){var m=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);for(var S in(m.length||x.length)&&this._updateWorkerLayers(m,x),this._updatedSources){var T=this._updatedSources[S];T==="reload"?this._reloadSource(S):T==="clear"&&this._clearSource(S)}for(var C in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[C].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var F={};for(var G in this.sourceCaches){var K=this.sourceCaches[G];F[G]=K.used,K.used=!1}for(var X=0,te=this._order;X<te.length;X+=1){var ee=this._layers[te[X]];ee.recalculate(o,this._availableImages),!ee.isHidden(o.zoom)&&ee.source&&(this.sourceCaches[ee.source].used=!0)}for(var ae in F){var H=this.sourceCaches[ae];F[ae]!==H.used&&H.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ae}))}this.light.recalculate(o),this.z=o.zoom,u&&this.fire(new a.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var u=this;if(this._checkLoaded(),ri(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Ge(o.layers);var m=function(S,T){if(!S)return[{command:Ze.setStyle,args:[T]}];var C=[];try{if(!a.deepEqual(S.version,T.version))return[{command:Ze.setStyle,args:[T]}];a.deepEqual(S.center,T.center)||C.push({command:Ze.setCenter,args:[T.center]}),a.deepEqual(S.zoom,T.zoom)||C.push({command:Ze.setZoom,args:[T.zoom]}),a.deepEqual(S.bearing,T.bearing)||C.push({command:Ze.setBearing,args:[T.bearing]}),a.deepEqual(S.pitch,T.pitch)||C.push({command:Ze.setPitch,args:[T.pitch]}),a.deepEqual(S.sprite,T.sprite)||C.push({command:Ze.setSprite,args:[T.sprite]}),a.deepEqual(S.glyphs,T.glyphs)||C.push({command:Ze.setGlyphs,args:[T.glyphs]}),a.deepEqual(S.transition,T.transition)||C.push({command:Ze.setTransition,args:[T.transition]}),a.deepEqual(S.light,T.light)||C.push({command:Ze.setLight,args:[T.light]});var F={},G=[];(function(X,te,ee,ae){var H;for(H in te=te||{},X=X||{})X.hasOwnProperty(H)&&(te.hasOwnProperty(H)||$e(H,ee,ae));for(H in te)te.hasOwnProperty(H)&&(X.hasOwnProperty(H)?a.deepEqual(X[H],te[H])||(X[H].type==="geojson"&&te[H].type==="geojson"&&sr(X,te,H)?ee.push({command:Ze.setGeoJSONSourceData,args:[H,te[H].data]}):Kt(H,te,ee,ae)):Ct(H,te,ee))})(S.sources,T.sources,G,F);var K=[];S.layers&&S.layers.forEach(function(X){F[X.source]?C.push({command:Ze.removeLayer,args:[X.id]}):K.push(X)}),C=C.concat(G),function(X,te,ee){te=te||[];var ae,H,oe,pe,ge,Ee,be,Te=(X=X||[]).map(Ot),Ue=te.map(Ot),Xe=X.reduce(Xt,{}),Ke=te.reduce(Xt,{}),ot=Te.slice(),wt=Object.create(null);for(ae=0,H=0;ae<Te.length;ae++)Ke.hasOwnProperty(oe=Te[ae])?H++:(ee.push({command:Ze.removeLayer,args:[oe]}),ot.splice(ot.indexOf(oe,H),1));for(ae=0,H=0;ae<Ue.length;ae++)ot[ot.length-1-ae]!==(oe=Ue[Ue.length-1-ae])&&(Xe.hasOwnProperty(oe)?(ee.push({command:Ze.removeLayer,args:[oe]}),ot.splice(ot.lastIndexOf(oe,ot.length-H),1)):H++,ee.push({command:Ze.addLayer,args:[Ke[oe],Ee=ot[ot.length-ae]]}),ot.splice(ot.length-ae,0,oe),wt[oe]=!0);for(ae=0;ae<Ue.length;ae++)if(pe=Xe[oe=Ue[ae]],ge=Ke[oe],!wt[oe]&&!a.deepEqual(pe,ge))if(a.deepEqual(pe.source,ge.source)&&a.deepEqual(pe["source-layer"],ge["source-layer"])&&a.deepEqual(pe.type,ge.type)){for(be in Ft(pe.layout,ge.layout,ee,oe,null,Ze.setLayoutProperty),Ft(pe.paint,ge.paint,ee,oe,null,Ze.setPaintProperty),a.deepEqual(pe.filter,ge.filter)||ee.push({command:Ze.setFilter,args:[oe,ge.filter]}),a.deepEqual(pe.minzoom,ge.minzoom)&&a.deepEqual(pe.maxzoom,ge.maxzoom)||ee.push({command:Ze.setLayerZoomRange,args:[oe,ge.minzoom,ge.maxzoom]}),pe)pe.hasOwnProperty(be)&&be!=="layout"&&be!=="paint"&&be!=="filter"&&be!=="metadata"&&be!=="minzoom"&&be!=="maxzoom"&&(be.indexOf("paint.")===0?Ft(pe[be],ge[be],ee,oe,be.slice(6),Ze.setPaintProperty):a.deepEqual(pe[be],ge[be])||ee.push({command:Ze.setLayerProperty,args:[oe,be,ge[be]]}));for(be in ge)ge.hasOwnProperty(be)&&!pe.hasOwnProperty(be)&&be!=="layout"&&be!=="paint"&&be!=="filter"&&be!=="metadata"&&be!=="minzoom"&&be!=="maxzoom"&&(be.indexOf("paint.")===0?Ft(pe[be],ge[be],ee,oe,be.slice(6),Ze.setPaintProperty):a.deepEqual(pe[be],ge[be])||ee.push({command:Ze.setLayerProperty,args:[oe,be,ge[be]]}))}else ee.push({command:Ze.removeLayer,args:[oe]}),Ee=ot[ot.lastIndexOf(oe)+1],ee.push({command:Ze.addLayer,args:[ge,Ee]})}(K,T.layers,C)}catch(X){console.warn("Unable to compute style diff:",X),C=[{command:Ze.setStyle,args:[T]}]}return C}(this.serialize(),o).filter(function(S){return!(S.command in yr)});if(m.length===0)return!1;var x=m.filter(function(S){return!(S.command in xi)});if(x.length>0)throw new Error("Unimplemented: "+x.map(function(S){return S.command}).join(", ")+".");return m.forEach(function(S){S.command!=="setTransition"&&u[S.command].apply(u,S.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,u){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,u),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,u){this.imageManager.updateImage(o,u)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,u,m){var x=this;if(m===void 0&&(m={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(u).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateStyle.source,"sources."+o,u,null,m))){this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);var S=this.sourceCaches[o]=new Q(o,u,this.dispatcher);S.style=this,S.setEventedParent(this,function(){return{isSourceLoaded:x.loaded(),source:S.serialize(),sourceId:o}}),S.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var u in this._layers)if(this._layers[u].source===o)return this.fire(new a.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+u+'" is using it.')));var m=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],m.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),m.setEventedParent(null),m.clearTiles(),m.onRemove&&m.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,u){this._checkLoaded(),this.sourceCaches[o].getSource().setData(u),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,u,m){m===void 0&&(m={}),this._checkLoaded();var x=o.id;if(this.getLayer(x))this.fire(new a.ErrorEvent(new Error('Layer with id "'+x+'" already exists on this map')));else{var S;if(o.type==="custom"){if(ri(this,a.validateCustomStyleLayer(o)))return;S=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(x,o.source),o=a.clone$1(o),o=a.extend(o,{source:x})),this._validate(a.validateStyle.layer,"layers."+x,o,{arrayIndex:-1},m))return;S=a.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[S.id]=S.serialize()}var T=u?this._order.indexOf(u):this._order.length;if(u&&T===-1)this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.')));else{if(this._order.splice(T,0,x),this._layerOrderChanged=!0,this._layers[x]=S,this._removedLayers[x]&&S.source&&S.type!=="custom"){var C=this._removedLayers[x];delete this._removedLayers[x],C.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},s.prototype.moveLayer=function(o,u){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==u){var m=this._order.indexOf(o);this._order.splice(m,1);var x=u?this._order.indexOf(u):this._order.length;u&&x===-1?this.fire(new a.ErrorEvent(new Error('Layer with id "'+u+'" does not exist on this map.'))):(this._order.splice(x,0,o),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var u=this._layers[o];if(u){u.setEventedParent(null);var m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,u,m){this._checkLoaded();var x=this.getLayer(o);x?x.minzoom===u&&x.maxzoom===m||(u!=null&&(x.minzoom=u),m!=null&&(x.maxzoom=m),this._updateLayer(x)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,u,m){m===void 0&&(m={}),this._checkLoaded();var x=this.getLayer(o);if(x){if(!a.deepEqual(x.filter,u))return u==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(a.validateStyle.filter,"layers."+x.id+".filter",u,null,m)||(x.filter=a.clone$1(u),this._updateLayer(x)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return a.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,u,m,x){x===void 0&&(x={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getLayoutProperty(u),m)||(S.setLayoutProperty(u,m,x),this._updateLayer(S)):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,u){var m=this.getLayer(o);if(m)return m.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,u,m,x){x===void 0&&(x={}),this._checkLoaded();var S=this.getLayer(o);S?a.deepEqual(S.getPaintProperty(u),m)||(S.setPaintProperty(u,m,x)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,u){return this.getLayer(o).getPaintProperty(u)},s.prototype.setFeatureState=function(o,u){this._checkLoaded();var m=o.source,x=o.sourceLayer,S=this.sourceCaches[m];if(S!==void 0){var T=S.getSource().type;T==="geojson"&&x?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||x?(o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(x,o.id,u)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,u){this._checkLoaded();var m=o.source,x=this.sourceCaches[m];if(x!==void 0){var S=x.getSource().type,T=S==="vector"?o.sourceLayer:void 0;S!=="vector"||T?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):x.removeFeatureState(T,o.id,u):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+m+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var u=o.source,m=o.sourceLayer,x=this.sourceCaches[u];if(x!==void 0){if(x.getSource().type!=="vector"||m)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),x.getFeatureState(m,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+u+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var u=this,m=function(Xe){return u._layers[Xe].type==="fill-extrusion"},x={},S=[],T=this._order.length-1;T>=0;T--){var C=this._order[T];if(m(C)){x[C]=T;for(var F=0,G=o;F<G.length;F+=1){var K=G[F][C];if(K)for(var X=0,te=K;X<te.length;X+=1)S.push(te[X])}}}S.sort(function(Xe,Ke){return Ke.intersectionZ-Xe.intersectionZ});for(var ee=[],ae=this._order.length-1;ae>=0;ae--){var H=this._order[ae];if(m(H))for(var oe=S.length-1;oe>=0;oe--){var pe=S[oe].feature;if(x[pe.layer.id]<ae)break;ee.push(pe),S.pop()}else for(var ge=0,Ee=o;ge<Ee.length;ge+=1){var be=Ee[ge][H];if(be)for(var Te=0,Ue=be;Te<Ue.length;Te+=1)ee.push(Ue[Te].feature)}}return ee},s.prototype.queryRenderedFeatures=function(o,u,m){u&&u.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);var x={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,T=u.layers;S<T.length;S+=1){var C=T[S],F=this._layers[C];if(!F)return this.fire(new a.ErrorEvent(new Error("The layer '"+C+"' does not exist in the map's style and cannot be queried for features."))),[];x[F.source]=!0}}var G=[];for(var K in u.availableImages=this._availableImages,this.sourceCaches)u.layers&&!x[K]||G.push(vr(this.sourceCaches[K],this._layers,this._serializedLayers,o,u,m));return this.placement&&G.push(function(X,te,ee,ae,H,oe,pe){for(var ge={},Ee=oe.queryRenderedSymbols(ae),be=[],Te=0,Ue=Object.keys(Ee).map(Number);Te<Ue.length;Te+=1)be.push(pe[Ue[Te]]);be.sort(Kn);for(var Xe=function(){var Et=ot[Ke],fr=Et.featureIndex.lookupSymbolFeatures(Ee[Et.bucketInstanceId],te,Et.bucketIndex,Et.sourceLayerIndex,H.filter,H.layers,H.availableImages,X);for(var ut in fr){var Bt=ge[ut]=ge[ut]||[],Ht=fr[ut];Ht.sort(function(Wt,Mt){var It=Et.featureSortOrder;if(It){var Gi=It.indexOf(Wt.featureIndex);return It.indexOf(Mt.featureIndex)-Gi}return Mt.featureIndex-Wt.featureIndex});for(var Rt=0,Lt=Ht;Rt<Lt.length;Rt+=1)Bt.push(Lt[Rt])}},Ke=0,ot=be;Ke<ot.length;Ke+=1)Xe();var wt=function(Et){ge[Et].forEach(function(fr){var ut=fr.feature,Bt=ee[X[Et].source].getFeatureState(ut.layer["source-layer"],ut.id);ut.source=ut.layer.source,ut.layer["source-layer"]&&(ut.sourceLayer=ut.layer["source-layer"]),ut.state=Bt})};for(var Tt in ge)wt(Tt);return ge}(this._layers,this._serializedLayers,this.sourceCaches,o,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(G)},s.prototype.querySourceFeatures=function(o,u){u&&u.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);var m=this.sourceCaches[o];return m?function(x,S){for(var T=x.getRenderableIds().map(function(te){return x.getTileByID(te)}),C=[],F={},G=0;G<T.length;G++){var K=T[G],X=K.tileID.canonical.key;F[X]||(F[X]=!0,K.querySourceFeatures(C,S))}return C}(m,u):[]},s.prototype.addSourceType=function(o,u,m){return s.getSourceType(o)?m(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},m):m(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,u){u===void 0&&(u={}),this._checkLoaded();var m=this.light.getLight(),x=!1;for(var S in o)if(!a.deepEqual(o[S],m[S])){x=!0;break}if(x){var T={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(T)}},s.prototype._validate=function(o,u,m,x,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&ri(this,o.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:m,styleSpec:a.styleSpec},x)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var u in this.sourceCaches)this.sourceCaches[u].clearTiles(),this.sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var u in this.sourceCaches)this.sourceCaches[u].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,u,m,x,S){S===void 0&&(S=!1);for(var T=!1,C=!1,F={},G=0,K=this._order;G<K.length;G+=1){var X=this._layers[K[G]];if(X.type==="symbol"){if(!F[X.source]){var te=this.sourceCaches[X.source];F[X.source]=te.getRenderableIds(!0).map(function(pe){return te.getTileByID(pe)}).sort(function(pe,ge){return ge.tileID.overscaledZ-pe.tileID.overscaledZ||(pe.tileID.isLessThan(ge.tileID)?-1:1)})}var ee=this.crossTileSymbolIndex.addLayer(X,F[X.source],o.center.lng);T=T||ee}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),o.zoom))&&(this.pauseablePlacement=new na(o,this._order,S,u,m,x,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),C=!0),T&&this.pauseablePlacement.placement.setStale()),C||T)for(var ae=0,H=this._order;ae<H.length;ae+=1){var oe=this._layers[H[ae]];oe.type==="symbol"&&this.placement.updateLayerOpacities(oe,F[oe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();var x=this.sourceCaches[u.source];x&&x.setDependencies(u.tileID.key,u.type,u.icons)},s.prototype.getGlyphs=function(o,u,m){this.glyphManager.getGlyphs(u.stacks,m)},s.prototype.getResource=function(o,u,m){return a.makeRequest(u,m)},s}(a.Evented);pn.getSourceType=function(n){return Gn[n]},pn.setSourceType=function(n,s){Gn[n]=s},pn.registerForPluginStateChange=a.registerForPluginStateChange;var ii=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Aa=Er(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),oa=Er(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),zl=Er(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),za=Er(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Pa=Er("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ns=Er(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Us=Er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Vs=Er("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),aa=Er("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ll=Er("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ca=Er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Fo=Er(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),$a=Er(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ul=Er(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ii=Er(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Oo=Er(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),No=Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),wn=Er(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),mo=Er(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),sa=Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Uo=Er(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),la=Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Ln=Er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Vo=Er(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),ua=Er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),es=Er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Er(n,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=s.match(/attribute ([\w]+) ([\w]+)/g),m=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=x?x.concat(m):m,T={};return{fragmentSource:n=n.replace(o,function(C,F,G,K,X){return T[X]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
varying `+G+" "+K+" "+X+`;
#else
uniform `+G+" "+K+" u_"+X+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+X+`
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`}),vertexSource:s=s.replace(o,function(C,F,G,K,X){var te=K==="float"?"vec2":"vec4",ee=X.match(/color/)?"color":te;return T[X]?F==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
uniform lowp float u_`+X+`_t;
attribute `+G+" "+te+" a_"+X+`;
varying `+G+" "+K+" "+X+`;
#else
uniform `+G+" "+K+" u_"+X+`;
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+X+`
    `+X+" = a_"+X+`;
#else
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+X+`
    `+X+" = unpack_mix_"+ee+"(a_"+X+", u_"+X+`_t);
#else
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`:F==="define"?`
#ifndef HAS_UNIFORM_u_`+X+`
uniform lowp float u_`+X+`_t;
attribute `+G+" "+te+" a_"+X+`;
#else
uniform `+G+" "+K+" u_"+X+`;
#endif
`:ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+X+`
    `+G+" "+K+" "+X+" = a_"+X+`;
#else
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+X+`
    `+G+" "+K+" "+X+" = unpack_mix_"+ee+"(a_"+X+", u_"+X+`_t);
#else
    `+G+" "+K+" "+X+" = u_"+X+`;
#endif
`}),staticAttributes:u,staticUniforms:S}}var Pl=Object.freeze({__proto__:null,prelude:Aa,background:oa,backgroundPattern:zl,circle:za,clippingMask:Pa,heatmap:Ns,heatmapTexture:Us,collisionBox:Vs,collisionCircle:aa,debug:ll,fill:Ca,fillOutline:Fo,fillOutlinePattern:$a,fillPattern:ul,fillExtrusion:Ii,fillExtrusionPattern:Oo,hillshadePrepare:No,hillshade:wn,line:mo,lineGradient:sa,linePattern:Uo,lineSDF:la,raster:Ln,symbolIcon:Vo,symbolSDF:ua,symbolTextAndIcon:es}),ys=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function ca(n){for(var s=[],o=0;o<n.length;o++)if(n[o]!==null){var u=n[o].split(" ");s.push(u.pop())}return s}ys.prototype.bind=function(n,s,o,u,m,x,S,T){this.context=n;for(var C=this.boundPaintVertexBuffers.length!==u.length,F=0;!C&&F<u.length;F++)this.boundPaintVertexBuffers[F]!==u[F]&&(C=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!C&&this.boundIndexBuffer===m&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===T?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),m&&m.dynamicDraw&&m.bind(),T&&T.bind()):this.freshBind(s,o,u,m,x,S,T)},ys.prototype.freshBind=function(n,s,o,u,m,x,S){var T,C=n.numAttributes,F=this.context,G=F.gl;if(F.extVertexArrayObject)this.vao&&this.destroy(),this.vao=F.extVertexArrayObject.createVertexArrayOES(),F.bindVertexArrayOES.set(this.vao),T=0,this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=u,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=S;else{T=F.currentNumAttributes||0;for(var K=C;K<T;K++)G.disableVertexAttribArray(K)}s.enableAttributes(G,n);for(var X=0,te=o;X<te.length;X+=1)te[X].enableAttributes(G,n);x&&x.enableAttributes(G,n),S&&S.enableAttributes(G,n),s.bind(),s.setVertexAttribPointers(G,n,m);for(var ee=0,ae=o;ee<ae.length;ee+=1){var H=ae[ee];H.bind(),H.setVertexAttribPointers(G,n,m)}x&&(x.bind(),x.setVertexAttribPointers(G,n,m)),u&&u.bind(),S&&(S.bind(),S.setVertexAttribPointers(G,n,m)),F.currentNumAttributes=C},ys.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Cl=function(n,s,o,u,m,x){var S=n.gl;this.program=S.createProgram();for(var T=ca(o.staticAttributes),C=u?u.getBinderAttributes():[],F=T.concat(C),G=o.staticUniforms?ca(o.staticUniforms):[],K=u?u.getBinderUniforms():[],X=[],te=0,ee=G.concat(K);te<ee.length;te+=1){var ae=ee[te];X.indexOf(ae)<0&&X.push(ae)}var H=u?u.defines():[];x&&H.push("#define OVERDRAW_INSPECTOR;");var oe=H.concat(Aa.fragmentSource,o.fragmentSource).join(`
`),pe=H.concat(Aa.vertexSource,o.vertexSource).join(`
`),ge=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(ge,oe),S.compileShader(ge),S.attachShader(this.program,ge);var Ee=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(Ee,pe),S.compileShader(Ee),S.attachShader(this.program,Ee),this.attributes={};var be={};this.numAttributes=F.length;for(var Te=0;Te<this.numAttributes;Te++)F[Te]&&(S.bindAttribLocation(this.program,Te,F[Te]),this.attributes[F[Te]]=Te);S.linkProgram(this.program),S.deleteShader(Ee),S.deleteShader(ge);for(var Ue=0;Ue<X.length;Ue++){var Xe=X[Ue];if(Xe&&!be[Xe]){var Ke=S.getUniformLocation(this.program,Xe);Ke&&(be[Xe]=Ke)}}this.fixedUniforms=m(n,be),this.binderUniforms=u?u.getUniforms(n,be):[]}}};function Ri(n,s,o){var u=1/xr(o,1,s.transform.tileZoom),m=Math.pow(2,o.tileID.overscaledZ),x=o.tileSize*Math.pow(2,s.transform.tileZoom)/m,S=x*(o.tileID.canonical.x+o.tileID.wrap*m),T=x*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[u,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,T>>16],u_pixel_coord_lower:[65535&S,65535&T]}}Cl.prototype.draw=function(n,s,o,u,m,x,S,T,C,F,G,K,X,te,ee,ae){var H,oe=n.gl;if(!this.failedToCreate){for(var pe in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(u),n.setColorMode(m),n.setCullFace(x),this.fixedUniforms)this.fixedUniforms[pe].set(S[pe]);te&&te.setUniforms(n,this.binderUniforms,K,{zoom:X});for(var ge=(H={},H[oe.LINES]=2,H[oe.TRIANGLES]=3,H[oe.LINE_STRIP]=1,H)[s],Ee=0,be=G.get();Ee<be.length;Ee+=1){var Te=be[Ee],Ue=Te.vaos||(Te.vaos={});(Ue[T]||(Ue[T]=new ys)).bind(n,this,C,te?te.getPaintVertexBuffers():[],F,Te.vertexOffset,ee,ae),oe.drawElements(s,Te.primitiveLength*ge,oe.UNSIGNED_SHORT,Te.primitiveOffset*ge*2)}}};var cl=function(n,s,o,u){var m=s.style.light,x=m.properties.get("position"),S=[x.x,x.y,x.z],T=a.create$1();m.properties.get("anchor")==="viewport"&&a.fromRotation(T,-s.transform.angle),a.transformMat3(S,S,T);var C=m.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+o,u_opacity:u}},Ma=function(n,s,o,u,m,x,S){return a.extend(cl(n,s,o,u),Ri(x,s,S),{u_height_factor:-Math.pow(2,m.overscaledZ)/S.tileSize/8})},si=function(n){return{u_matrix:n}},Da=function(n,s,o,u){return a.extend(si(n),Ri(o,s,u))},js=function(n,s){return{u_matrix:n,u_world:s}},yo=function(n,s,o,u,m){return a.extend(Da(n,s,o,u),{u_world:m})},qi=function(n,s,o,u){var m,x,S=n.transform;if(u.paint.get("circle-pitch-alignment")==="map"){var T=xr(o,1,S.zoom);m=!0,x=[T,T]}else m=!1,x=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(s.posMatrix,o,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:x}},La=function(n,s,o){var u=xr(o,1,s.zoom),m=Math.pow(2,s.zoom-o.tileID.overscaledZ),x=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:u,u_extrude_scale:[s.pixelsToGLUnits[0]/(u*m),s.pixelsToGLUnits[1]/(u*m)],u_overscale_factor:x}},ha=function(n,s,o){return{u_matrix:n,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},Ra=function(n,s,o){return o===void 0&&(o=1),{u_matrix:n,u_color:s,u_overlay:0,u_overlay_scale:o}},Ba=function(n){return{u_matrix:n}},pa=function(n,s,o,u){return{u_matrix:n,u_extrude_scale:xr(s,1,o),u_intensity:u}},gs=function(n,s,o){var u=n.transform;return{u_matrix:go(n,s,o),u_ratio:1/xr(s,1,u.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Ur=function(n,s,o,u){return a.extend(gs(n,s,o),{u_image:0,u_image_height:u})},qs=function(n,s,o,u){var m=n.transform,x=fa(s,m);return{u_matrix:go(n,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/xr(s,1,m.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[x,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},iu=function(n,s,o,u,m){var x=n.lineAtlas,S=fa(s,n.transform),T=o.layout.get("line-cap")==="round",C=x.getDash(u.from,T),F=x.getDash(u.to,T),G=C.width*m.fromScale,K=F.width*m.toScale;return a.extend(gs(n,s,o),{u_patternscale_a:[S/G,-C.height/2],u_patternscale_b:[S/K,-F.height/2],u_sdfgamma:x.width/(256*Math.min(G,K)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:F.y,u_mix:m.t})};function fa(n,s){return 1/xr(n,1,s.tileZoom)}function go(n,s,o){return n.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var nu=function(n,s,o,u,m){return{u_matrix:n,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(S=m.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(x=m.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:Zs(m.paint.get("raster-hue-rotate"))};var x,S};function Zs(n){n*=Math.PI/180;var s=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var Rn,ts=function(n,s,o,u,m,x,S,T,C,F){var G=m.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:G.width/G.height,u_fade_change:m.options.fadeDuration?m.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:S,u_coord_matrix:T,u_is_text:+C,u_pitch_with_map:+u,u_texsize:F,u_texture:0}},Fa=function(n,s,o,u,m,x,S,T,C,F,G){var K=m.transform;return a.extend(ts(n,s,o,u,m,x,S,T,C,F),{u_gamma_scale:u?Math.cos(K._pitch)*K.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+G})},Bn=function(n,s,o,u,m,x,S,T,C,F){return a.extend(Fa(n,s,o,u,m,x,S,T,!0,C,!0),{u_texsize_icon:F,u_texture_icon:1})},_s=function(n,s,o){return{u_matrix:n,u_opacity:s,u_color:o}},to=function(n,s,o,u,m,x){return a.extend(function(S,T,C,F){var G=C.imageManager.getPattern(S.from.toString()),K=C.imageManager.getPattern(S.to.toString()),X=C.imageManager.getPixelSize(),te=X.width,ee=X.height,ae=Math.pow(2,F.tileID.overscaledZ),H=F.tileSize*Math.pow(2,C.transform.tileZoom)/ae,oe=H*(F.tileID.canonical.x+F.tileID.wrap*ae),pe=H*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:G.tl,u_pattern_br_a:G.br,u_pattern_tl_b:K.tl,u_pattern_br_b:K.br,u_texsize:[te,ee],u_mix:T.t,u_pattern_size_a:G.displaySize,u_pattern_size_b:K.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/xr(F,1,C.transform.tileZoom),u_pixel_coord_upper:[oe>>16,pe>>16],u_pixel_coord_lower:[65535&oe,65535&pe]}}(u,x,o,m),{u_matrix:n,u_opacity:s})},Ml={fillExtrusion:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fillExtrusionPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_lightpos:new a.Uniform3f(n,s.u_lightpos),u_lightintensity:new a.Uniform1f(n,s.u_lightintensity),u_lightcolor:new a.Uniform3f(n,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(n,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(n,s.u_height_factor),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade),u_opacity:new a.Uniform1f(n,s.u_opacity)}},fill:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},fillPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},fillOutline:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world)}},fillOutlinePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_texsize:new a.Uniform2f(n,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},circle:function(n,s){return{u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(n,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},collisionBox:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(n,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(n,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(n,s.u_overscale_factor)}},collisionCircle:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(n,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(n,s.u_viewport_size)}},debug:function(n,s){return{u_color:new a.UniformColor(n,s.u_color),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_overlay:new a.Uniform1i(n,s.u_overlay),u_overlay_scale:new a.Uniform1f(n,s.u_overlay_scale)}},clippingMask:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmap:function(n,s){return{u_extrude_scale:new a.Uniform1f(n,s.u_extrude_scale),u_intensity:new a.Uniform1f(n,s.u_intensity),u_matrix:new a.UniformMatrix4f(n,s.u_matrix)}},heatmapTexture:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_world:new a.Uniform2f(n,s.u_world),u_image:new a.Uniform1i(n,s.u_image),u_color_ramp:new a.Uniform1i(n,s.u_color_ramp),u_opacity:new a.Uniform1f(n,s.u_opacity)}},hillshade:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_latrange:new a.Uniform2f(n,s.u_latrange),u_light:new a.Uniform2f(n,s.u_light),u_shadow:new a.UniformColor(n,s.u_shadow),u_highlight:new a.UniformColor(n,s.u_highlight),u_accent:new a.UniformColor(n,s.u_accent)}},hillshadePrepare:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_image:new a.Uniform1i(n,s.u_image),u_dimension:new a.Uniform2f(n,s.u_dimension),u_zoom:new a.Uniform1f(n,s.u_zoom),u_unpack:new a.Uniform4f(n,s.u_unpack)}},line:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels)}},lineGradient:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_image:new a.Uniform1i(n,s.u_image),u_image_height:new a.Uniform1f(n,s.u_image_height)}},linePattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_texsize:new a.Uniform2f(n,s.u_texsize),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_image:new a.Uniform1i(n,s.u_image),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_scale:new a.Uniform3f(n,s.u_scale),u_fade:new a.Uniform1f(n,s.u_fade)}},lineSDF:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_ratio:new a.Uniform1f(n,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(n,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(n,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(n,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(n,s.u_sdfgamma),u_image:new a.Uniform1i(n,s.u_image),u_tex_y_a:new a.Uniform1f(n,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(n,s.u_tex_y_b),u_mix:new a.Uniform1f(n,s.u_mix)}},raster:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_tl_parent:new a.Uniform2f(n,s.u_tl_parent),u_scale_parent:new a.Uniform1f(n,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(n,s.u_buffer_scale),u_fade_t:new a.Uniform1f(n,s.u_fade_t),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image0:new a.Uniform1i(n,s.u_image0),u_image1:new a.Uniform1i(n,s.u_image1),u_brightness_low:new a.Uniform1f(n,s.u_brightness_low),u_brightness_high:new a.Uniform1f(n,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(n,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(n,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(n,s.u_spin_weights)}},symbolIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture)}},symbolSDF:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texture:new a.Uniform1i(n,s.u_texture),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},symbolTextAndIcon:function(n,s){return{u_is_size_zoom_constant:new a.Uniform1i(n,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(n,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(n,s.u_size_t),u_size:new a.Uniform1f(n,s.u_size),u_camera_to_center_distance:new a.Uniform1f(n,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(n,s.u_pitch),u_rotate_symbol:new a.Uniform1i(n,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(n,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(n,s.u_fade_change),u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(n,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(n,s.u_coord_matrix),u_is_text:new a.Uniform1i(n,s.u_is_text),u_pitch_with_map:new a.Uniform1i(n,s.u_pitch_with_map),u_texsize:new a.Uniform2f(n,s.u_texsize),u_texsize_icon:new a.Uniform2f(n,s.u_texsize_icon),u_texture:new a.Uniform1i(n,s.u_texture),u_texture_icon:new a.Uniform1i(n,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(n,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(n,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(n,s.u_is_halo)}},background:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_color:new a.UniformColor(n,s.u_color)}},backgroundPattern:function(n,s){return{u_matrix:new a.UniformMatrix4f(n,s.u_matrix),u_opacity:new a.Uniform1f(n,s.u_opacity),u_image:new a.Uniform1i(n,s.u_image),u_pattern_tl_a:new a.Uniform2f(n,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(n,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(n,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(n,s.u_pattern_br_b),u_texsize:new a.Uniform2f(n,s.u_texsize),u_mix:new a.Uniform1f(n,s.u_mix),u_pattern_size_a:new a.Uniform2f(n,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(n,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(n,s.u_scale_a),u_scale_b:new a.Uniform1f(n,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(n,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(n,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(n,s.u_tile_units_to_pixels)}}};function bi(n,s,o,u,m,x,S){for(var T=n.context,C=T.gl,F=n.useProgram("collisionBox"),G=[],K=0,X=0,te=0;te<u.length;te++){var ee=u[te],ae=s.getTile(ee),H=ae.getBucket(o);if(H){var oe=ee.posMatrix;m[0]===0&&m[1]===0||(oe=n.translatePosMatrix(ee.posMatrix,ae,m,x));var pe=S?H.textCollisionBox:H.iconCollisionBox,ge=H.collisionCircleArray;if(ge.length>0){var Ee=a.create(),be=oe;a.mul(Ee,H.placementInvProjMatrix,n.transform.glCoordMatrix),a.mul(Ee,Ee,H.placementViewportMatrix),G.push({circleArray:ge,circleOffset:X,transform:be,invTransform:Ee}),X=K+=ge.length/4}pe&&F.draw(T,C.LINES,W.disabled,J.disabled,n.colorModeForRenderPass(),he.disabled,La(oe,n.transform,ae),o.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,null,n.transform.zoom,null,null,pe.collisionVertexBuffer)}}if(S&&G.length){var Te=n.useProgram("collisionCircle"),Ue=new a.StructArrayLayout2f1f2i16;Ue.resize(4*K),Ue._trim();for(var Xe=0,Ke=0,ot=G;Ke<ot.length;Ke+=1)for(var wt=ot[Ke],Tt=0;Tt<wt.circleArray.length/4;Tt++){var Et=4*Tt,fr=wt.circleArray[Et+0],ut=wt.circleArray[Et+1],Bt=wt.circleArray[Et+2],Ht=wt.circleArray[Et+3];Ue.emplace(Xe++,fr,ut,Bt,Ht,0),Ue.emplace(Xe++,fr,ut,Bt,Ht,1),Ue.emplace(Xe++,fr,ut,Bt,Ht,2),Ue.emplace(Xe++,fr,ut,Bt,Ht,3)}(!Rn||Rn.length<2*K)&&(Rn=function(pi){var An=2*pi,en=new a.StructArrayLayout3ui6;en.resize(An),en._trim();for(var ui=0;ui<An;ui++){var wi=6*ui;en.uint16[wi+0]=4*ui+0,en.uint16[wi+1]=4*ui+1,en.uint16[wi+2]=4*ui+2,en.uint16[wi+3]=4*ui+2,en.uint16[wi+4]=4*ui+3,en.uint16[wi+5]=4*ui+0}return en}(K));for(var Rt=T.createIndexBuffer(Rn,!0),Lt=T.createVertexBuffer(Ue,a.collisionCircleLayout.members,!0),Wt=0,Mt=G;Wt<Mt.length;Wt+=1){var It=Mt[Wt],Gi=ha(It.transform,It.invTransform,n.transform);Te.draw(T,C.TRIANGLES,W.disabled,J.disabled,n.colorModeForRenderPass(),he.disabled,Gi,o.id,Lt,Rt,a.SegmentVector.simpleSegment(0,2*It.circleOffset,It.circleArray.length,It.circleArray.length/2),null,n.transform.zoom,null,null,null)}Lt.destroy(),Rt.destroy()}}var ye=a.identity(new Float32Array(16));function ct(n,s,o,u,m,x){var S=a.getAnchorAlignment(n),T=-(S.horizontalAlign-.5)*s,C=-(S.verticalAlign-.5)*o,F=a.evaluateVariableOffset(n,u);return new a.Point((T/m+F[0])*x,(C/m+F[1])*x)}function Oa(n,s,o,u,m,x,S,T,C,F,G){var K=n.text.placedSymbolArray,X=n.text.dynamicLayoutVertexArray,te=n.icon.dynamicLayoutVertexArray,ee={};X.clear();for(var ae=0;ae<K.length;ae++){var H=K.get(ae),oe=H.hidden||!H.crossTileID||n.allowVerticalPlacement&&!H.placedOrientation?null:u[H.crossTileID];if(oe){var pe=new a.Point(H.anchorX,H.anchorY),ge=Ut(pe,o?T:S),Ee=Dt(x.cameraToCenterDistance,ge.signedDistanceFromCamera),be=m.evaluateSizeForFeature(n.textSizeData,F,H)*Ee/a.ONE_EM;o&&(be*=n.tilePixelRatio/C);for(var Te=ct(oe.anchor,oe.width,oe.height,oe.textOffset,oe.textBoxScale,be),Ue=o?Ut(pe.add(Te),S).point:ge.point.add(s?Te.rotate(-x.angle):Te),Xe=n.allowVerticalPlacement&&H.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,Ke=0;Ke<H.numGlyphs;Ke++)a.addDynamicAttributes(X,Ue,Xe);G&&H.associatedIconIndex>=0&&(ee[H.associatedIconIndex]={shiftedAnchor:Ue,angle:Xe})}else ai(H.numGlyphs,X)}if(G){te.clear();for(var ot=n.icon.placedSymbolArray,wt=0;wt<ot.length;wt++){var Tt=ot.get(wt);if(Tt.hidden)ai(Tt.numGlyphs,te);else{var Et=ee[wt];if(Et)for(var fr=0;fr<Tt.numGlyphs;fr++)a.addDynamicAttributes(te,Et.shiftedAnchor,Et.angle);else ai(Tt.numGlyphs,te)}}n.icon.dynamicLayoutVertexBuffer.updateData(te)}n.text.dynamicLayoutVertexBuffer.updateData(X)}function rs(n,s,o){return o.iconsInText&&s?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function _o(n,s,o,u,m,x,S,T,C,F,G,K){for(var X=n.context,te=X.gl,ee=n.transform,ae=T==="map",H=C==="map",oe=ae&&o.layout.get("symbol-placement")!=="point",pe=ae&&!H&&!oe,ge=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ee=!1,be=n.depthModeForSublayer(0,W.ReadOnly),Te=o.layout.get("text-variable-anchor"),Ue=[],Xe=0,Ke=u;Xe<Ke.length;Xe+=1){var ot=Ke[Xe],wt=s.getTile(ot),Tt=wt.getBucket(o);if(Tt){var Et=m?Tt.text:Tt.icon;if(Et&&Et.segments.get().length){var fr=Et.programConfigurations.get(o.id),ut=m||Tt.sdfIcons,Bt=m?Tt.textSizeData:Tt.iconSizeData,Ht=H||ee.pitch!==0,Rt=n.useProgram(rs(ut,m,Tt),fr),Lt=a.evaluateSizeForZoom(Bt,ee.zoom),Wt=void 0,Mt=[0,0],It=void 0,Gi=void 0,pi=null,An=void 0;if(m)It=wt.glyphAtlasTexture,Gi=te.LINEAR,Wt=wt.glyphAtlasTexture.size,Tt.iconsInText&&(Mt=wt.imageAtlasTexture.size,pi=wt.imageAtlasTexture,An=Ht||n.options.rotating||n.options.zooming||Bt.kind==="composite"||Bt.kind==="camera"?te.LINEAR:te.NEAREST);else{var en=o.layout.get("icon-size").constantOr(0)!==1||Tt.iconsNeedLinear;It=wt.imageAtlasTexture,Gi=ut||n.options.rotating||n.options.zooming||en||Ht?te.LINEAR:te.NEAREST,Wt=wt.imageAtlasTexture.size}var ui=xr(wt,1,n.transform.zoom),wi=Cr(ot.posMatrix,H,ae,n.transform,ui),bo=or(ot.posMatrix,H,ae,n.transform,ui),Un=Te&&Tt.hasTextData(),Es=o.layout.get("icon-text-fit")!=="none"&&Un&&Tt.hasIconData();oe&&Yn(Tt,ot.posMatrix,n,m,wi,bo,H,F);var no=n.translatePosMatrix(ot.posMatrix,wt,x,S),Sa=oe||m&&Te||Es?ye:wi,Ko=n.translatePosMatrix(bo,wt,x,S,!0),Ul=ut&&o.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0,yl={program:Rt,buffers:Et,uniformValues:ut?Tt.iconsInText?Bn(Bt.kind,Lt,pe,H,n,no,Sa,Ko,Wt,Mt):Fa(Bt.kind,Lt,pe,H,n,no,Sa,Ko,m,Wt,!0):ts(Bt.kind,Lt,pe,H,n,no,Sa,Ko,m,Wt),atlasTexture:It,atlasTextureIcon:pi,atlasInterpolation:Gi,atlasInterpolationIcon:An,isSDF:ut,hasHalo:Ul};if(ge&&Tt.canOverlap){Ee=!0;for(var Ts=0,gl=Et.segments.get();Ts<gl.length;Ts+=1){var Vl=gl[Ts];Ue.push({segments:new a.SegmentVector([Vl]),sortKey:Vl.sortKey,state:yl})}}else Ue.push({segments:Et.segments,sortKey:0,state:yl})}}}Ee&&Ue.sort(function(Is,$s){return Is.sortKey-$s.sortKey});for(var Ka=0,jl=Ue;Ka<jl.length;Ka+=1){var Xa=jl[Ka],Ki=Xa.state;if(X.activeTexture.set(te.TEXTURE0),Ki.atlasTexture.bind(Ki.atlasInterpolation,te.CLAMP_TO_EDGE),Ki.atlasTextureIcon&&(X.activeTexture.set(te.TEXTURE1),Ki.atlasTextureIcon&&Ki.atlasTextureIcon.bind(Ki.atlasInterpolationIcon,te.CLAMP_TO_EDGE)),Ki.isSDF){var us=Ki.uniformValues;Ki.hasHalo&&(us.u_is_halo=1,Io(Ki.buffers,Xa.segments,o,n,Ki.program,be,G,K,us)),us.u_is_halo=0}Io(Ki.buffers,Xa.segments,o,n,Ki.program,be,G,K,Ki.uniformValues)}}function Io(n,s,o,u,m,x,S,T,C){var F=u.context;m.draw(F,F.gl.TRIANGLES,x,S,T,he.disabled,C,o.id,n.layoutVertexBuffer,n.indexBuffer,s,o.paint,u.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function da(n,s,o,u,m,x,S){var T,C,F,G,K,X=n.context.gl,te=o.paint.get("fill-pattern"),ee=te&&te.constantOr(1),ae=o.getCrossfadeParameters();S?(C=ee&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",T=X.LINES):(C=ee?"fillPattern":"fill",T=X.TRIANGLES);for(var H=0,oe=u;H<oe.length;H+=1){var pe=oe[H],ge=s.getTile(pe);if(!ee||ge.patternsLoaded()){var Ee=ge.getBucket(o);if(Ee){var be=Ee.programConfigurations.get(o.id),Te=n.useProgram(C,be);ee&&(n.context.activeTexture.set(X.TEXTURE0),ge.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),be.updatePaintBuffers(ae));var Ue=te.constantOr(null);if(Ue&&ge.imageAtlas){var Xe=ge.imageAtlas,Ke=Xe.patternPositions[Ue.to.toString()],ot=Xe.patternPositions[Ue.from.toString()];Ke&&ot&&be.setConstantPatternPositions(Ke,ot)}var wt=n.translatePosMatrix(pe.posMatrix,ge,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(S){G=Ee.indexBuffer2,K=Ee.segments2;var Tt=[X.drawingBufferWidth,X.drawingBufferHeight];F=C==="fillOutlinePattern"&&ee?yo(wt,n,ae,ge,Tt):js(wt,Tt)}else G=Ee.indexBuffer,K=Ee.segments,F=ee?Da(wt,n,ae,ge):si(wt);Te.draw(n.context,T,m,n.stencilModeForClipping(pe),x,he.disabled,F,o.id,Ee.layoutVertexBuffer,G,K,o.paint,n.transform.zoom,be)}}}}function Ao(n,s,o,u,m,x,S){for(var T=n.context,C=T.gl,F=o.paint.get("fill-extrusion-pattern"),G=F.constantOr(1),K=o.getCrossfadeParameters(),X=o.paint.get("fill-extrusion-opacity"),te=0,ee=u;te<ee.length;te+=1){var ae=ee[te],H=s.getTile(ae),oe=H.getBucket(o);if(oe){var pe=oe.programConfigurations.get(o.id),ge=n.useProgram(G?"fillExtrusionPattern":"fillExtrusion",pe);G&&(n.context.activeTexture.set(C.TEXTURE0),H.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),pe.updatePaintBuffers(K));var Ee=F.constantOr(null);if(Ee&&H.imageAtlas){var be=H.imageAtlas,Te=be.patternPositions[Ee.to.toString()],Ue=be.patternPositions[Ee.from.toString()];Te&&Ue&&pe.setConstantPatternPositions(Te,Ue)}var Xe=n.translatePosMatrix(ae.posMatrix,H,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ke=o.paint.get("fill-extrusion-vertical-gradient"),ot=G?Ma(Xe,n,Ke,X,ae,K,H):cl(Xe,n,Ke,X);ge.draw(T,T.gl.TRIANGLES,m,x,S,he.backCCW,ot,o.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,o.paint,n.transform.zoom,pe)}}}function jo(n,s,o,u,m,x){var S=n.context,T=S.gl,C=s.fbo;if(C){var F=n.useProgram("hillshade");S.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,C.colorAttachment.get());var G=function(K,X,te){var ee=te.paint.get("hillshade-shadow-color"),ae=te.paint.get("hillshade-highlight-color"),H=te.paint.get("hillshade-accent-color"),oe=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(oe-=K.transform.angle);var pe,ge,Ee,be=!K.options.moving;return{u_matrix:K.transform.calculatePosMatrix(X.tileID.toUnwrapped(),be),u_image:0,u_latrange:(pe=X.tileID,ge=Math.pow(2,pe.canonical.z),Ee=pe.canonical.y,[new a.MercatorCoordinate(0,Ee/ge).toLngLat().lat,new a.MercatorCoordinate(0,(Ee+1)/ge).toLngLat().lat]),u_light:[te.paint.get("hillshade-exaggeration"),oe],u_shadow:ee,u_highlight:ae,u_accent:H}}(n,s,o);F.draw(S,T.TRIANGLES,u,m,x,he.disabled,G,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function is(n,s,o,u,m,x){var S=n.context,T=S.gl,C=s.dem;if(C&&C.data){var F=C.dim,G=C.stride,K=C.getPixels();if(S.activeTexture.set(T.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||n.getTileTexture(G),s.demTexture){var X=s.demTexture;X.update(K,{premultiply:!1}),X.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else s.demTexture=new a.Texture(S,K,T.RGBA,{premultiply:!1}),s.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);S.activeTexture.set(T.TEXTURE0);var te=s.fbo;if(!te){var ee=new a.Texture(S,{width:F,height:F,data:null},T.RGBA);ee.bind(T.LINEAR,T.CLAMP_TO_EDGE),(te=s.fbo=S.createFramebuffer(F,F,!0)).colorAttachment.set(ee.texture)}S.bindFramebuffer.set(te.framebuffer),S.viewport.set([0,0,F,F]),n.useProgram("hillshadePrepare").draw(S,T.TRIANGLES,u,m,x,he.disabled,function(ae,H){var oe=H.stride,pe=a.create();return a.ortho(pe,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(pe,pe,[0,-a.EXTENT,0]),{u_matrix:pe,u_image:1,u_dimension:[oe,oe],u_zoom:ae.overscaledZ,u_unpack:H.getUnpackVector()}}(s.tileID,C),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Jt(n,s,o,u,m){var x=u.paint.get("raster-fade-duration");if(x>0){var S=a.browser.now(),T=(S-n.timeAdded)/x,C=s?(S-s.timeAdded)/x:-1,F=o.getSource(),G=m.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),K=!s||Math.abs(s.tileID.overscaledZ-G)>Math.abs(n.tileID.overscaledZ-G),X=K&&n.refreshedUponExpiration?1:a.clamp(K?T:1-C,0,1);return n.refreshedUponExpiration&&T>=1&&(n.refreshedUponExpiration=!1),s?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}var ma=new a.Color(1,0,0,1),ya=new a.Color(0,1,0,1),Na=new a.Color(0,0,1,1),vo=new a.Color(1,0,1,1),zo=new a.Color(0,1,1,1);function hl(n,s,o,u){Sn(n,0,s+o/2,n.transform.width,o,u)}function pl(n,s,o,u){Sn(n,s-o/2,0,o,n.transform.height,u)}function Sn(n,s,o,u,m,x){var S=n.context,T=S.gl;T.enable(T.SCISSOR_TEST),T.scissor(s*a.browser.devicePixelRatio,o*a.browser.devicePixelRatio,u*a.browser.devicePixelRatio,m*a.browser.devicePixelRatio),S.clear({color:x}),T.disable(T.SCISSOR_TEST)}function Dl(n,s,o){var u=n.context,m=u.gl,x=o.posMatrix,S=n.useProgram("debug"),T=W.disabled,C=J.disabled,F=n.colorModeForRenderPass();u.activeTexture.set(m.TEXTURE0),n.emptyTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),S.draw(u,m.LINE_STRIP,T,C,F,he.disabled,Ra(x,a.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var G=s.getTileByID(o.key).latestRawTileData,K=Math.floor((G&&G.byteLength||0)/1024),X=s.getTile(o).tileSize,te=512/Math.min(X,512)*(o.overscaledZ/n.transform.zoom)*.5,ee=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ee+=" => "+o.overscaledZ),function(ae,H){ae.initDebugOverlayCanvas();var oe=ae.debugOverlayCanvas,pe=ae.context.gl,ge=ae.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,oe.width,oe.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(H,5,5),ge.strokeText(H,5,5),ae.debugOverlayTexture.update(oe),ae.debugOverlayTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE)}(n,ee+" "+K+"kb"),S.draw(u,m.TRIANGLES,T,C,se.alphaBlended,he.disabled,Ra(x,a.Color.transparent,te),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var Ua={symbol:function(n,s,o,u,m){if(n.renderPass==="translucent"){var x=J.disabled,S=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(T,C,F,G,K,X,te){for(var ee=C.transform,ae=K==="map",H=X==="map",oe=0,pe=T;oe<pe.length;oe+=1){var ge=pe[oe],Ee=G.getTile(ge),be=Ee.getBucket(F);if(be&&be.text&&be.text.segments.get().length){var Te=a.evaluateSizeForZoom(be.textSizeData,ee.zoom),Ue=xr(Ee,1,C.transform.zoom),Xe=Cr(ge.posMatrix,H,ae,C.transform,Ue),Ke=F.layout.get("icon-text-fit")!=="none"&&be.hasIconData();if(Te){var ot=Math.pow(2,ee.zoom-Ee.tileID.overscaledZ);Oa(be,ae,H,te,a.symbolSize,ee,Xe,ge.posMatrix,ot,Te,Ke)}}}}(u,n,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),m),o.paint.get("icon-opacity").constantOr(1)!==0&&_o(n,s,o,u,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),x,S),o.paint.get("text-opacity").constantOr(1)!==0&&_o(n,s,o,u,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),x,S),s.map.showCollisionBoxes&&(bi(n,s,o,u,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),bi(n,s,o,u,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,s,o,u){if(n.renderPass==="translucent"){var m=o.paint.get("circle-opacity"),x=o.paint.get("circle-stroke-width"),S=o.paint.get("circle-stroke-opacity"),T=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(m.constantOr(1)!==0||x.constantOr(1)!==0&&S.constantOr(1)!==0){for(var C=n.context,F=C.gl,G=n.depthModeForSublayer(0,W.ReadOnly),K=J.disabled,X=n.colorModeForRenderPass(),te=[],ee=0;ee<u.length;ee++){var ae=u[ee],H=s.getTile(ae),oe=H.getBucket(o);if(oe){var pe=oe.programConfigurations.get(o.id),ge={programConfiguration:pe,program:n.useProgram("circle",pe),layoutVertexBuffer:oe.layoutVertexBuffer,indexBuffer:oe.indexBuffer,uniformValues:qi(n,ae,H,o)};if(T)for(var Ee=0,be=oe.segments.get();Ee<be.length;Ee+=1){var Te=be[Ee];te.push({segments:new a.SegmentVector([Te]),sortKey:Te.sortKey,state:ge})}else te.push({segments:oe.segments,sortKey:0,state:ge})}}T&&te.sort(function(wt,Tt){return wt.sortKey-Tt.sortKey});for(var Ue=0,Xe=te;Ue<Xe.length;Ue+=1){var Ke=Xe[Ue],ot=Ke.state;ot.program.draw(C,F.TRIANGLES,G,K,X,he.disabled,ot.uniformValues,o.id,ot.layoutVertexBuffer,ot.indexBuffer,Ke.segments,o.paint,n.transform.zoom,ot.programConfiguration)}}}},heatmap:function(n,s,o,u){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var m=n.context,x=m.gl,S=J.disabled,T=new se([x.ONE,x.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(te,ee,ae){var H=te.gl;te.activeTexture.set(H.TEXTURE1),te.viewport.set([0,0,ee.width/4,ee.height/4]);var oe=ae.heatmapFbo;if(oe)H.bindTexture(H.TEXTURE_2D,oe.colorAttachment.get()),te.bindFramebuffer.set(oe.framebuffer);else{var pe=H.createTexture();H.bindTexture(H.TEXTURE_2D,pe),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),oe=ae.heatmapFbo=te.createFramebuffer(ee.width/4,ee.height/4,!1),function(ge,Ee,be,Te){var Ue=ge.gl;Ue.texImage2D(Ue.TEXTURE_2D,0,Ue.RGBA,Ee.width/4,Ee.height/4,0,Ue.RGBA,ge.extRenderToTextureHalfFloat?ge.extTextureHalfFloat.HALF_FLOAT_OES:Ue.UNSIGNED_BYTE,null),Te.colorAttachment.set(be)}(te,ee,pe,oe)}})(m,n,o),m.clear({color:a.Color.transparent});for(var C=0;C<u.length;C++){var F=u[C];if(!s.hasRenderableParent(F)){var G=s.getTile(F),K=G.getBucket(o);if(K){var X=K.programConfigurations.get(o.id);n.useProgram("heatmap",X).draw(m,x.TRIANGLES,W.disabled,S,T,he.disabled,pa(F.posMatrix,G,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,K.layoutVertexBuffer,K.indexBuffer,K.segments,o.paint,n.transform.zoom,X)}}}m.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(te,ee){var ae=te.context,H=ae.gl,oe=ee.heatmapFbo;if(oe){ae.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,oe.colorAttachment.get()),ae.activeTexture.set(H.TEXTURE1);var pe=ee.colorRampTexture;pe||(pe=ee.colorRampTexture=new a.Texture(ae,ee.colorRamp,H.RGBA)),pe.bind(H.LINEAR,H.CLAMP_TO_EDGE),te.useProgram("heatmapTexture").draw(ae,H.TRIANGLES,W.disabled,J.disabled,te.colorModeForRenderPass(),he.disabled,function(ge,Ee,be,Te){var Ue=a.create();a.ortho(Ue,0,ge.width,ge.height,0,0,1);var Xe=ge.context.gl;return{u_matrix:Ue,u_world:[Xe.drawingBufferWidth,Xe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ee.paint.get("heatmap-opacity")}}(te,ee),ee.id,te.viewportBuffer,te.quadTriangleIndexBuffer,te.viewportSegments,ee.paint,te.transform.zoom)}}(n,o))},line:function(n,s,o,u){if(n.renderPass==="translucent"){var m=o.paint.get("line-opacity"),x=o.paint.get("line-width");if(m.constantOr(1)!==0&&x.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,W.ReadOnly),T=n.colorModeForRenderPass(),C=o.paint.get("line-dasharray"),F=o.paint.get("line-pattern"),G=F.constantOr(1),K=o.paint.get("line-gradient"),X=o.getCrossfadeParameters(),te=G?"linePattern":C?"lineSDF":K?"lineGradient":"line",ee=n.context,ae=ee.gl,H=!0,oe=0,pe=u;oe<pe.length;oe+=1){var ge=pe[oe],Ee=s.getTile(ge);if(!G||Ee.patternsLoaded()){var be=Ee.getBucket(o);if(be){var Te=be.programConfigurations.get(o.id),Ue=n.context.program.get(),Xe=n.useProgram(te,Te),Ke=H||Xe.program!==Ue,ot=F.constantOr(null);if(ot&&Ee.imageAtlas){var wt=Ee.imageAtlas,Tt=wt.patternPositions[ot.to.toString()],Et=wt.patternPositions[ot.from.toString()];Tt&&Et&&Te.setConstantPatternPositions(Tt,Et)}var fr=G?qs(n,Ee,o,X):C?iu(n,Ee,o,C,X):K?Ur(n,Ee,o,be.lineClipsArray.length):gs(n,Ee,o);if(G)ee.activeTexture.set(ae.TEXTURE0),Ee.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),Te.updatePaintBuffers(X);else if(C&&(Ke||n.lineAtlas.dirty))ee.activeTexture.set(ae.TEXTURE0),n.lineAtlas.bind(ee);else if(K){var ut=be.gradients[o.id],Bt=ut.texture;if(o.gradientVersion!==ut.version){var Ht=256;if(o.stepInterpolant){var Rt=s.getSource().maxzoom,Lt=ge.canonical.z===Rt?Math.ceil(1<<n.transform.maxZoom-ge.canonical.z):1;Ht=a.clamp(a.nextPowerOfTwo(be.maxLineLength/a.EXTENT*1024*Lt),256,ee.maxTextureSize)}ut.gradient=a.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Ht,image:ut.gradient||void 0,clips:be.lineClipsArray}),ut.texture?ut.texture.update(ut.gradient):ut.texture=new a.Texture(ee,ut.gradient,ae.RGBA),ut.version=o.gradientVersion,Bt=ut.texture}ee.activeTexture.set(ae.TEXTURE0),Bt.bind(o.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}Xe.draw(ee,ae.TRIANGLES,S,n.stencilModeForClipping(ge),T,he.disabled,fr,o.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,o.paint,n.transform.zoom,Te,be.layoutVertexBuffer2),H=!1}}}}},fill:function(n,s,o,u){var m=o.paint.get("fill-color"),x=o.paint.get("fill-opacity");if(x.constantOr(1)!==0){var S=n.colorModeForRenderPass(),T=o.paint.get("fill-pattern"),C=n.opaquePassEnabledForLayer()&&!T.constantOr(1)&&m.constantOr(a.Color.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===C){var F=n.depthModeForSublayer(1,n.renderPass==="opaque"?W.ReadWrite:W.ReadOnly);da(n,s,o,u,F,S,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var G=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,W.ReadOnly);da(n,s,o,u,G,S,!0)}}},"fill-extrusion":function(n,s,o,u){var m=o.paint.get("fill-extrusion-opacity");if(m!==0&&n.renderPass==="translucent"){var x=new W(n.context.gl.LEQUAL,W.ReadWrite,n.depthRangeFor3D);if(m!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))Ao(n,s,o,u,x,J.disabled,se.disabled),Ao(n,s,o,u,x,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Ao(n,s,o,u,x,J.disabled,S)}}},hillshade:function(n,s,o,u){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var m=n.context,x=n.depthModeForSublayer(0,W.ReadOnly),S=n.colorModeForRenderPass(),T=n.renderPass==="translucent"?n.stencilConfigForOverlap(u):[{},u],C=T[0],F=0,G=T[1];F<G.length;F+=1){var K=G[F],X=s.getTile(K);X.needsHillshadePrepare&&n.renderPass==="offscreen"?is(n,X,o,x,J.disabled,S):n.renderPass==="translucent"&&jo(n,X,o,x,C[K.overscaledZ],S)}m.viewport.set([0,0,n.width,n.height])}},raster:function(n,s,o,u){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&u.length)for(var m=n.context,x=m.gl,S=s.getSource(),T=n.useProgram("raster"),C=n.colorModeForRenderPass(),F=S instanceof Sr?[{},u]:n.stencilConfigForOverlap(u),G=F[0],K=F[1],X=K[K.length-1].overscaledZ,te=!n.options.moving,ee=0,ae=K;ee<ae.length;ee+=1){var H=ae[ee],oe=n.depthModeForSublayer(H.overscaledZ-X,o.paint.get("raster-opacity")===1?W.ReadWrite:W.ReadOnly,x.LESS),pe=s.getTile(H),ge=n.transform.calculatePosMatrix(H.toUnwrapped(),te);pe.registerFadeDuration(o.paint.get("raster-fade-duration"));var Ee=s.findLoadedParent(H,0),be=Jt(pe,Ee,s,o,n.transform),Te=void 0,Ue=void 0,Xe=o.paint.get("raster-resampling")==="nearest"?x.NEAREST:x.LINEAR;m.activeTexture.set(x.TEXTURE0),pe.texture.bind(Xe,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),m.activeTexture.set(x.TEXTURE1),Ee?(Ee.texture.bind(Xe,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST),Te=Math.pow(2,Ee.tileID.overscaledZ-pe.tileID.overscaledZ),Ue=[pe.tileID.canonical.x*Te%1,pe.tileID.canonical.y*Te%1]):pe.texture.bind(Xe,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST);var Ke=nu(ge,Ue||[0,0],Te||1,be,o);S instanceof Sr?T.draw(m,x.TRIANGLES,oe,J.disabled,C,he.disabled,Ke,o.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):T.draw(m,x.TRIANGLES,oe,G[H.overscaledZ],C,he.disabled,Ke,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,s,o){var u=o.paint.get("background-color"),m=o.paint.get("background-opacity");if(m!==0){var x=n.context,S=x.gl,T=n.transform,C=T.tileSize,F=o.paint.get("background-pattern");if(!n.isPatternMissing(F)){var G=!F&&u.a===1&&m===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===G){var K=J.disabled,X=n.depthModeForSublayer(0,G==="opaque"?W.ReadWrite:W.ReadOnly),te=n.colorModeForRenderPass(),ee=n.useProgram(F?"backgroundPattern":"background"),ae=T.coveringTiles({tileSize:C});F&&(x.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var H=o.getCrossfadeParameters(),oe=0,pe=ae;oe<pe.length;oe+=1){var ge=pe[oe],Ee=n.transform.calculatePosMatrix(ge.toUnwrapped()),be=F?to(Ee,m,n,F,{tileID:ge,tileSize:C},H):_s(Ee,m,u);ee.draw(x,S.TRIANGLES,X,K,te,he.disabled,be,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,s,o){for(var u=0;u<o.length;u++)Dl(n,s,o[u])},custom:function(n,s,o){var u=n.context,m=o.implementation;if(n.renderPass==="offscreen"){var x=m.prerender;x&&(n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),x.call(m,u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),u.setColorMode(n.colorModeForRenderPass()),u.setStencilMode(J.disabled);var S=m.renderingMode==="3d"?new W(n.context.gl.LEQUAL,W.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,W.ReadOnly);u.setDepthMode(S),m.render(u.gl,n.transform.customLayerMatrix()),u.setDirty(),n.setBaseState(),u.bindFramebuffer.set(null)}}},Lr=function(n,s){this.context=new j(n),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=Q.maxUnderzooming+Q.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new de,this.gpuTimers={}};Lr.prototype.resize=function(n,s){if(this.width=n*a.browser.devicePixelRatio,this.height=s*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,u=this.style._order;o<u.length;o+=1)this.style._layers[u[o]].resize()},Lr.prototype.setup=function(){var n=this.context,s=new a.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(a.EXTENT,0),s.emplaceBack(0,a.EXTENT),s.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(s,ii.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var o=new a.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(a.EXTENT,0),o.emplaceBack(0,a.EXTENT),o.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(o,ii.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var u=new a.StructArrayLayout4i8;u.emplaceBack(0,0,0,0),u.emplaceBack(a.EXTENT,0,a.EXTENT,0),u.emplaceBack(0,a.EXTENT,0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(u,He.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var m=new a.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(m,ii.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var x=new a.StructArrayLayout1ui2;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(x);var S=new a.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var T=this.context.gl;this.stencilClearMode=new J({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)},Lr.prototype.clearStencil=function(){var n=this.context,s=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=a.create();a.ortho(o,0,this.width,this.height,0,0,1),a.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,s.TRIANGLES,W.disabled,this.stencilClearMode,se.disabled,he.disabled,Ba(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Lr.prototype._renderTileClippingMasks=function(n,s){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&s&&s.length){this.currentStencilSource=n.source;var o=this.context,u=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(se.disabled),o.setDepthMode(W.disabled);var m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var x=0,S=s;x<S.length;x+=1){var T=S[x],C=this._tileClippingMaskIDs[T.key]=this.nextStencilID++;m.draw(o,u.TRIANGLES,W.disabled,new J({func:u.ALWAYS,mask:0},C,255,u.KEEP,u.KEEP,u.REPLACE),se.disabled,he.disabled,Ba(T.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Lr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,s=this.context.gl;return new J({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)},Lr.prototype.stencilModeForClipping=function(n){var s=this.context.gl;return new J({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)},Lr.prototype.stencilConfigForOverlap=function(n){var s,o=this.context.gl,u=n.sort(function(C,F){return F.overscaledZ-C.overscaledZ}),m=u[u.length-1].overscaledZ,x=u[0].overscaledZ-m+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();for(var S={},T=0;T<x;T++)S[T+m]=new J({func:o.GEQUAL,mask:255},T+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=x,[S,u]}return[(s={},s[m]=J.disabled,s),u]},Lr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new se([n.CONSTANT_COLOR,n.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?se.unblended:se.alphaBlended},Lr.prototype.depthModeForSublayer=function(n,s,o){if(!this.opaquePassEnabledForLayer())return W.disabled;var u=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new W(o||this.context.gl.LEQUAL,s,[u,u])},Lr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Lr.prototype.render=function(n,s){var o=this;this.style=n,this.options=s,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var u=this.style._order,m=this.style.sourceCaches;for(var x in m){var S=m[x];S.used&&S.prepare(this.context)}var T,C,F={},G={},K={};for(var X in m){var te=m[X];F[X]=te.getVisibleCoordinates(),G[X]=F[X].slice().reverse(),K[X]=te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ee=0;ee<u.length;ee++)if(this.style._layers[u[ee]].is3D()){this.opaquePassCutoff=ee;break}this.renderPass="offscreen";for(var ae=0,H=u;ae<H.length;ae+=1){var oe=this.style._layers[H[ae]];if(oe.hasOffscreenPass()&&!oe.isHidden(this.transform.zoom)){var pe=G[oe.source];(oe.type==="custom"||pe.length)&&this.renderLayer(this,m[oe.source],oe,pe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var ge=this.style._layers[u[this.currentLayer]],Ee=m[ge.source],be=F[ge.source];this._renderTileClippingMasks(ge,be),this.renderLayer(this,Ee,ge,be)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var Te=this.style._layers[u[this.currentLayer]],Ue=m[Te.source],Xe=(Te.type==="symbol"?K:G)[Te.source];this._renderTileClippingMasks(Te,F[Te.source]),this.renderLayer(this,Ue,Te,Xe)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(Ke){Ke.source&&!Ke.isHidden(o.transform.zoom)&&(Ke.source!==(C&&C.id)&&(C=o.style.sourceCaches[Ke.source]),(!T||T.getSource().maxzoom<C.getSource().maxzoom)&&(T=C))}),T&&Ua.debug(this,T,T.getVisibleCoordinates())),this.options.showPadding&&function(Ke){var ot=Ke.transform.padding;hl(Ke,Ke.transform.height-(ot.top||0),3,ma),hl(Ke,ot.bottom||0,3,ya),pl(Ke,ot.left||0,3,Na),pl(Ke,Ke.transform.width-(ot.right||0),3,vo);var wt=Ke.transform.centerPoint;(function(Tt,Et,fr,ut){Sn(Tt,Et-1,fr-10,2,20,ut),Sn(Tt,Et-10,fr-1,20,2,ut)})(Ke,wt.x,Ke.transform.height-wt.y,zo)}(this),this.context.setDefault()},Lr.prototype.renderLayer=function(n,s,o,u){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||u.length)&&(this.id=o.id,this.gpuTimingStart(o),Ua[o.type](n,s,o,u,this.style.placement.variableOffsets),this.gpuTimingEnd())},Lr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},Lr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},Lr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},Lr.prototype.queryGpuTimers=function(n){var s={};for(var o in n){var u=n[o],m=this.context.extTimerQuery,x=m.getQueryObjectEXT(u.query,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(u.query),s[o]=x}return s},Lr.prototype.translatePosMatrix=function(n,s,o,u,m){if(!o[0]&&!o[1])return n;var x=m?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(x){var S=Math.sin(x),T=Math.cos(x);o=[o[0]*T-o[1]*S,o[0]*S+o[1]*T]}var C=[m?o[0]:xr(s,o[0],this.transform.zoom),m?o[1]:xr(s,o[1],this.transform.zoom),0],F=new Float32Array(16);return a.translate(F,n,C),F},Lr.prototype.saveTileTexture=function(n){var s=this._tileTextures[n.size[0]];s?s.push(n):this._tileTextures[n.size[0]]=[n]},Lr.prototype.getTileTexture=function(n){var s=this._tileTextures[n];return s&&s.length>0?s.pop():null},Lr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var s=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!s||!o},Lr.prototype.useProgram=function(n,s){this.cache=this.cache||{};var o=""+n+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new Cl(this.context,n,Pl[n],s,Ml[n],this._showOverdrawInspector)),this.cache[o]},Lr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Lr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},Lr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Lr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Gs=function(n,s){this.points=n,this.planes=s};Gs.fromInvProjectionMatrix=function(n,s,o){var u=Math.pow(2,o),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return a.transformMat4([],S,n)}).map(function(S){return a.scale$1([],S,1/S[3]/s*u)}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var T=a.sub([],m[S[0]],m[S[1]]),C=a.sub([],m[S[2]],m[S[1]]),F=a.normalize([],a.cross([],T,C)),G=-a.dot(F,m[S[1]]);return F.concat(G)});return new Gs(m,x)};var Va=function(n,s){this.min=n,this.max=s,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};Va.prototype.quadrant=function(n){for(var s=[n%2==0,n<2],o=a.clone$2(this.min),u=a.clone$2(this.max),m=0;m<s.length;m++)o[m]=s[m]?this.min[m]:this.center[m],u[m]=s[m]?this.center[m]:this.max[m];return u[2]=this.max[2],new Va(o,u)},Va.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},Va.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},Va.prototype.intersects=function(n){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,u=0;u<n.planes.length;u++){for(var m=n.planes[u],x=0,S=0;S<s.length;S++)x+=a.dot$1(m,s[S])>=0;if(x===0)return 0;x!==s.length&&(o=!1)}if(o)return 2;for(var T=0;T<3;T++){for(var C=Number.MAX_VALUE,F=-Number.MAX_VALUE,G=0;G<n.points.length;G++){var K=n.points[G][T]-this.min[T];C=Math.min(C,K),F=Math.max(F,K)}if(F<0||C>this.max[T]-this.min[T])return 0}return 1};var ga=function(n,s,o,u){if(n===void 0&&(n=0),s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),isNaN(n)||n<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=o,this.right=u};ga.prototype.interpolate=function(n,s,o){return s.top!=null&&n.top!=null&&(this.top=a.number(n.top,s.top,o)),s.bottom!=null&&n.bottom!=null&&(this.bottom=a.number(n.bottom,s.bottom,o)),s.left!=null&&n.left!=null&&(this.left=a.number(n.left,s.left,o)),s.right!=null&&n.right!=null&&(this.right=a.number(n.right,s.right,o)),this},ga.prototype.getCenter=function(n,s){var o=a.clamp((this.left+n-this.right)/2,0,n),u=a.clamp((this.top+s-this.bottom)/2,0,s);return new a.Point(o,u)},ga.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},ga.prototype.clone=function(){return new ga(this.top,this.bottom,this.left,this.right)},ga.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var $t=function(n,s,o,u,m){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=m===void 0||m,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=o==null?0:o,this._maxPitch=u==null?60:u,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ga,this._posMatrixCache={},this._alignedPosMatrixCache={}},Mr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};$t.prototype.clone=function(){var n=new $t(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Mr.minZoom.get=function(){return this._minZoom},Mr.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Mr.maxZoom.get=function(){return this._maxZoom},Mr.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Mr.minPitch.get=function(){return this._minPitch},Mr.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Mr.maxPitch.get=function(){return this._maxPitch},Mr.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Mr.renderWorldCopies.get=function(){return this._renderWorldCopies},Mr.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Mr.worldSize.get=function(){return this.tileSize*this.scale},Mr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Mr.size.get=function(){return new a.Point(this.width,this.height)},Mr.bearing.get=function(){return-this.angle/Math.PI*180},Mr.bearing.set=function(n){var s=-a.wrap(n,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Mr.pitch.get=function(){return this._pitch/Math.PI*180},Mr.pitch.set=function(n){var s=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Mr.fov.get=function(){return this._fov/Math.PI*180},Mr.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Mr.zoom.get=function(){return this._zoom},Mr.zoom.set=function(n){var s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Mr.center.get=function(){return this._center},Mr.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Mr.padding.get=function(){return this._edgeInsets.toJSON()},Mr.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Mr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},$t.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},$t.prototype.interpolatePadding=function(n,s,o){this._unmodified=!1,this._edgeInsets.interpolate(n,s,o),this._constrain(),this._calcMatrices()},$t.prototype.coveringZoomLevel=function(n){var s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)},$t.prototype.getVisibleUnwrappedCoordinates=function(n){var s=[new a.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new a.Point(0,0)),u=this.pointCoordinate(new a.Point(this.width,0)),m=this.pointCoordinate(new a.Point(this.width,this.height)),x=this.pointCoordinate(new a.Point(0,this.height)),S=Math.floor(Math.min(o.x,u.x,m.x,x.x)),T=Math.floor(Math.max(o.x,u.x,m.x,x.x)),C=S-1;C<=T+1;C++)C!==0&&s.push(new a.UnwrappedTileID(C,n));return s},$t.prototype.coveringTiles=function(n){var s=this.coveringZoomLevel(n),o=s;if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);var u=a.MercatorCoordinate.fromLngLat(this.center),m=Math.pow(2,s),x=[m*u.x,m*u.y,0],S=Gs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),T=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(T=s);var C=function(Ke){return{aabb:new Va([Ke*m,0,0],[(Ke+1)*m,m,0]),zoom:0,x:0,y:0,wrap:Ke,fullyVisible:!1}},F=[],G=[],K=s,X=n.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var te=1;te<=3;te++)F.push(C(-te)),F.push(C(te));for(F.push(C(0));F.length>0;){var ee=F.pop(),ae=ee.x,H=ee.y,oe=ee.fullyVisible;if(!oe){var pe=ee.aabb.intersects(S);if(pe===0)continue;oe=pe===2}var ge=ee.aabb.distanceX(x),Ee=ee.aabb.distanceY(x),be=Math.max(Math.abs(ge),Math.abs(Ee));if(ee.zoom===K||be>3+(1<<K-ee.zoom)-2&&ee.zoom>=T)G.push({tileID:new a.OverscaledTileID(ee.zoom===K?X:ee.zoom,ee.wrap,ee.zoom,ae,H),distanceSq:a.sqrLen([x[0]-.5-ae,x[1]-.5-H])});else for(var Te=0;Te<4;Te++){var Ue=(ae<<1)+Te%2,Xe=(H<<1)+(Te>>1);F.push({aabb:ee.aabb.quadrant(Te),zoom:ee.zoom+1,x:Ue,y:Xe,wrap:ee.wrap,fullyVisible:oe})}}return G.sort(function(Ke,ot){return Ke.distanceSq-ot.distanceSq}).map(function(Ke){return Ke.tileID})},$t.prototype.resize=function(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()},Mr.unmodified.get=function(){return this._unmodified},$t.prototype.zoomScale=function(n){return Math.pow(2,n)},$t.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},$t.prototype.project=function(n){var s=a.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(n.lng)*this.worldSize,a.mercatorYfromLat(s)*this.worldSize)},$t.prototype.unproject=function(n){return new a.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Mr.point.get=function(){return this.project(this.center)},$t.prototype.setLocationAtPoint=function(n,s){var o=this.pointCoordinate(s),u=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(n),x=new a.MercatorCoordinate(m.x-(o.x-u.x),m.y-(o.y-u.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())},$t.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},$t.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},$t.prototype.locationCoordinate=function(n){return a.MercatorCoordinate.fromLngLat(n)},$t.prototype.coordinateLocation=function(n){return n.toLngLat()},$t.prototype.pointCoordinate=function(n){var s=[n.x,n.y,0,1],o=[n.x,n.y,1,1];a.transformMat4(s,s,this.pixelMatrixInverse),a.transformMat4(o,o,this.pixelMatrixInverse);var u=s[3],m=o[3],x=s[1]/u,S=o[1]/m,T=s[2]/u,C=o[2]/m,F=T===C?0:(0-T)/(C-T);return new a.MercatorCoordinate(a.number(s[0]/u,o[0]/m,F)/this.worldSize,a.number(x,S,F)/this.worldSize)},$t.prototype.coordinatePoint=function(n){var s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix),new a.Point(s[0]/s[3],s[1]/s[3])},$t.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},$t.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},$t.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},$t.prototype.calculatePosMatrix=function(n,s){s===void 0&&(s=!1);var o=n.key,u=s?this._alignedPosMatrixCache:this._posMatrixCache;if(u[o])return u[o];var m=n.canonical,x=this.worldSize/this.zoomScale(m.z),S=m.x+Math.pow(2,m.z)*n.wrap,T=a.identity(new Float64Array(16));return a.translate(T,T,[S*x,m.y*x,0]),a.scale(T,T,[x/a.EXTENT,x/a.EXTENT,1]),a.multiply(T,s?this.alignedProjMatrix:this.projMatrix,T),u[o]=new Float32Array(T),u[o]},$t.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},$t.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,s,o,u,m=-90,x=90,S=-180,T=180,C=this.size,F=this._unmodified;if(this.latRange){var G=this.latRange;m=a.mercatorYfromLat(G[1])*this.worldSize,n=(x=a.mercatorYfromLat(G[0])*this.worldSize)-m<C.y?C.y/(x-m):0}if(this.lngRange){var K=this.lngRange;S=a.mercatorXfromLng(K[0])*this.worldSize,s=(T=a.mercatorXfromLng(K[1])*this.worldSize)-S<C.x?C.x/(T-S):0}var X=this.point,te=Math.max(s||0,n||0);if(te)return this.center=this.unproject(new a.Point(s?(T+S)/2:X.x,n?(x+m)/2:X.y)),this.zoom+=this.scaleZoom(te),this._unmodified=F,void(this._constraining=!1);if(this.latRange){var ee=X.y,ae=C.y/2;ee-ae<m&&(u=m+ae),ee+ae>x&&(u=x-ae)}if(this.lngRange){var H=X.x,oe=C.x/2;H-oe<S&&(o=S+oe),H+oe>T&&(o=T-oe)}o===void 0&&u===void 0||(this.center=this.unproject(new a.Point(o!==void 0?o:X.x,u!==void 0?u:X.y))),this._unmodified=F,this._constraining=!1}},$t.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),u=Math.sin(o)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-s-o,.01,Math.PI-.01)),m=this.point,x=m.x,S=m.y,T=1.01*(Math.cos(Math.PI/2-this._pitch)*u+this.cameraToCenterDistance),C=this.height/50,F=new Float64Array(16);a.perspective(F,this._fov,this.width/this.height,C,T),F[8]=2*-n.x/this.width,F[9]=2*n.y/this.height,a.scale(F,F,[1,-1,1]),a.translate(F,F,[0,0,-this.cameraToCenterDistance]),a.rotateX(F,F,this._pitch),a.rotateZ(F,F,this.angle),a.translate(F,F,[-x,-S,0]),this.mercatorMatrix=a.scale([],F,[this.worldSize,this.worldSize,this.worldSize]),a.scale(F,F,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=F,this.invProjMatrix=a.invert([],this.projMatrix);var G=this.width%2/2,K=this.height%2/2,X=Math.cos(this.angle),te=Math.sin(this.angle),ee=x-Math.round(x)+X*G+te*K,ae=S-Math.round(S)+X*K+te*G,H=new Float64Array(F);if(a.translate(H,H,[ee>.5?ee-1:ee,ae>.5?ae-1:ae,0]),this.alignedProjMatrix=H,F=a.create(),a.scale(F,F,[this.width/2,-this.height/2,1]),a.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=a.create(),a.scale(F,F,[1,-1,1]),a.translate(F,F,[-1,-1,0]),a.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(F=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=F,this._posMatrixCache={},this._alignedPosMatrixCache={}}},$t.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new a.Point(0,0)),s=[n.x*this.worldSize,n.y*this.worldSize,0,1];return a.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},$t.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,n))},$t.prototype.getCameraQueryGeometry=function(n){var s=this.getCameraPoint();if(n.length===1)return[n[0],s];for(var o=s.x,u=s.y,m=s.x,x=s.y,S=0,T=n;S<T.length;S+=1){var C=T[S];o=Math.min(o,C.x),u=Math.min(u,C.y),m=Math.max(m,C.x),x=Math.max(x,C.y)}return[new a.Point(o,u),new a.Point(m,u),new a.Point(m,x),new a.Point(o,x),new a.Point(o,u)]},Object.defineProperties($t.prototype,Mr);var Fn=function(n){var s,o,u,m;this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,u=null,m=function(){u=null,o&&(s(),u=setTimeout(m,300),o=!1)},function(){return o=!0,u||m(),u})};Fn.prototype.addTo=function(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Fn.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Fn.prototype.getHashString=function(n){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,u=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,u),x=Math.round(s.lng*m)/m,S=Math.round(s.lat*m)/m,T=this._map.getBearing(),C=this._map.getPitch(),F="";if(F+=n?"/"+x+"/"+S+"/"+o:o+"/"+S+"/"+x,(T||C)&&(F+="/"+Math.round(10*T)/10),C&&(F+="/"+Math.round(C)),this._hashName){var G=this._hashName,K=!1,X=a.window.location.hash.slice(1).split("&").map(function(te){var ee=te.split("=")[0];return ee===G?(K=!0,ee+"="+F):te}).filter(function(te){return te});return K||X.push(G+"="+F),"#"+X.join("&")}return"#"+F},Fn.prototype._getCurrentHash=function(){var n,s=this,o=a.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(u){return u.split("=")}).forEach(function(u){u[0]===s._hashName&&(n=u)}),(n&&n[1]||"").split("/")):o.split("/")},Fn.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:s,pitch:+(n[4]||0)}),!0}return!1},Fn.prototype._updateHashUnthrottled=function(){var n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());try{a.window.history.replaceState(a.window.history.state,null,n)}catch{}};var _a={linearity:.3,easing:a.bezier(0,0,.3,1)},va=a.extend({deceleration:2500,maxSpeed:1400},_a),vs=a.extend({deceleration:20,maxSpeed:1400},_a),ou=a.extend({deceleration:1e3,maxSpeed:360},_a),Ks=a.extend({deceleration:1e3,maxSpeed:90},_a),xs=function(n){this._map=n,this.clear()};function Po(n,s){(!n.duration||n.duration<s.duration)&&(n.duration=s.duration,n.easing=s.easing)}function qo(n,s,o){var u=o.maxSpeed,m=o.linearity,x=o.deceleration,S=a.clamp(n*m/(s/1e3),-u,u),T=Math.abs(S)/(x*m);return{easing:o.easing,duration:1e3*T,amount:S*(T/2)}}xs.prototype.clear=function(){this._inertiaBuffer=[]},xs.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:n})},xs.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,s=a.browser.now();n.length>0&&s-n[0].time>160;)n.shift()},xs.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},o=0,u=this._inertiaBuffer;o<u.length;o+=1){var m=u[o].settings;s.zoom+=m.zoomDelta||0,s.bearing+=m.bearingDelta||0,s.pitch+=m.pitchDelta||0,m.panDelta&&s.pan._add(m.panDelta),m.around&&(s.around=m.around),m.pinchAround&&(s.pinchAround=m.pinchAround)}var x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(s.pan.mag()){var T=qo(s.pan.mag(),x,a.extend({},va,n||{}));S.offset=s.pan.mult(T.amount/s.pan.mag()),S.center=this._map.transform.center,Po(S,T)}if(s.zoom){var C=qo(s.zoom,x,vs);S.zoom=this._map.transform.zoom+C.amount,Po(S,C)}if(s.bearing){var F=qo(s.bearing,x,ou);S.bearing=this._map.transform.bearing+a.clamp(F.amount,-179,179),Po(S,F)}if(s.pitch){var G=qo(s.pitch,x,Ks);S.pitch=this._map.transform.pitch+G.amount,Po(S,G)}if(S.zoom||S.bearing){var K=s.pinchAround===void 0?s.around:s.pinchAround;S.around=K?this._map.unproject(K):this._map.getCenter()}return this.clear(),a.extend(S,{noMoveStart:!0})}};var ni=function(n){function s(u,m,x,S){S===void 0&&(S={});var T=E.mousePos(m.getCanvasContainer(),x),C=m.unproject(T);n.call(this,u,a.extend({point:T,lngLat:C,originalEvent:x},S)),this._defaultPrevented=!1,this.target=m}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),kn=function(n){function s(u,m,x){var S=u==="touchend"?x.changedTouches:x.touches,T=E.touchPos(m.getCanvasContainer(),S),C=T.map(function(K){return m.unproject(K)}),F=T.reduce(function(K,X,te,ee){return K.add(X.div(ee.length))},new a.Point(0,0)),G=m.unproject(F);n.call(this,u,{points:T,point:F,lngLats:C,lngLat:G,originalEvent:x}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),Ll=function(n){function s(u,m,x){n.call(this,u,{originalEvent:x}),this._defaultPrevented=!1}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(a.Event),li=function(n,s){this._map=n,this._clickTolerance=s.clickTolerance};li.prototype.reset=function(){delete this._mousedownPos},li.prototype.wheel=function(n){return this._firePreventable(new Ll(n.type,this._map,n))},li.prototype.mousedown=function(n,s){return this._mousedownPos=s,this._firePreventable(new ni(n.type,this._map,n))},li.prototype.mouseup=function(n){this._map.fire(new ni(n.type,this._map,n))},li.prototype.click=function(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new ni(n.type,this._map,n))},li.prototype.dblclick=function(n){return this._firePreventable(new ni(n.type,this._map,n))},li.prototype.mouseover=function(n){this._map.fire(new ni(n.type,this._map,n))},li.prototype.mouseout=function(n){this._map.fire(new ni(n.type,this._map,n))},li.prototype.touchstart=function(n){return this._firePreventable(new kn(n.type,this._map,n))},li.prototype.touchmove=function(n){this._map.fire(new kn(n.type,this._map,n))},li.prototype.touchend=function(n){this._map.fire(new kn(n.type,this._map,n))},li.prototype.touchcancel=function(n){this._map.fire(new kn(n.type,this._map,n))},li.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},li.prototype.isEnabled=function(){return!0},li.prototype.isActive=function(){return!1},li.prototype.enable=function(){},li.prototype.disable=function(){};var at=function(n){this._map=n};at.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},at.prototype.mousemove=function(n){this._map.fire(new ni(n.type,this._map,n))},at.prototype.mousedown=function(){this._delayContextMenu=!0},at.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ni("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},at.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new ni(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},at.prototype.isEnabled=function(){return!0},at.prototype.isActive=function(){return!1},at.prototype.enable=function(){},at.prototype.disable=function(){};var Ai=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1};function Xs(n,s){for(var o={},u=0;u<n.length;u++)o[n[u].identifier]=s[u];return o}Ai.prototype.isEnabled=function(){return!!this._enabled},Ai.prototype.isActive=function(){return!!this._active},Ai.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Ai.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ai.prototype.mousedown=function(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(E.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},Ai.prototype.mousemoveWindow=function(n,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var u=this._startPos;this._lastPos=o,this._box||(this._box=E.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var m=Math.min(u.x,o.x),x=Math.max(u.x,o.x),S=Math.min(u.y,o.y),T=Math.max(u.y,o.y);E.setTransform(this._box,"translate("+m+"px,"+S+"px)"),this._box.style.width=x-m+"px",this._box.style.height=T-S+"px"}}},Ai.prototype.mouseupWindow=function(n,s){var o=this;if(this._active&&n.button===0){var u=this._startPos,m=s;if(this.reset(),E.suppressClick(),u.x!==m.x||u.y!==m.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(x){return x.fitScreenCoordinates(u,m,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Ai.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Ai.prototype.blur=function(){this.reset()},Ai.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(E.remove(this._box),this._box=null),E.enableDrag(),delete this._startPos,delete this._lastPos},Ai.prototype._fireEvent=function(n,s){return this._map.fire(new a.Event(n,{originalEvent:s}))};var ns=function(n){this.reset(),this.numTouches=n.numTouches};ns.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},ns.prototype.touchstart=function(n,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(u){for(var m=new a.Point(0,0),x=0,S=u;x<S.length;x+=1)m._add(S[x]);return m.div(u.length)}(s),this.touches=Xs(o,s)))},ns.prototype.touchmove=function(n,s,o){if(!this.aborted&&this.centroid){var u=Xs(o,s);for(var m in this.touches){var x=u[m];(!x||x.dist(this.touches[m])>30)&&(this.aborted=!0)}}},ns.prototype.touchend=function(n,s,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var u=!this.aborted&&this.centroid;if(this.reset(),u)return u}};var En=function(n){this.singleTap=new ns(n),this.numTaps=n.numTaps,this.reset()};En.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},En.prototype.touchstart=function(n,s,o){this.singleTap.touchstart(n,s,o)},En.prototype.touchmove=function(n,s,o){this.singleTap.touchmove(n,s,o)},En.prototype.touchend=function(n,s,o){var u=this.singleTap.touchend(n,s,o);if(u){var m=n.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(u)<30;if(m&&x||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}};var Tn=function(){this._zoomIn=new En({numTouches:1,numTaps:2}),this._zoomOut=new En({numTouches:2,numTaps:1}),this.reset()};Tn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Tn.prototype.touchstart=function(n,s,o){this._zoomIn.touchstart(n,s,o),this._zoomOut.touchstart(n,s,o)},Tn.prototype.touchmove=function(n,s,o){this._zoomIn.touchmove(n,s,o),this._zoomOut.touchmove(n,s,o)},Tn.prototype.touchend=function(n,s,o){var u=this,m=this._zoomIn.touchend(n,s,o),x=this._zoomOut.touchend(n,s,o);return m?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(m)},{originalEvent:n})}}):x?(this._active=!0,n.preventDefault(),setTimeout(function(){return u.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(x)},{originalEvent:n})}}):void 0},Tn.prototype.touchcancel=function(){this.reset()},Tn.prototype.enable=function(){this._enabled=!0},Tn.prototype.disable=function(){this._enabled=!1,this.reset()},Tn.prototype.isEnabled=function(){return this._enabled},Tn.prototype.isActive=function(){return this._active};var os={0:1,2:2},Ye=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};Ye.prototype.blur=function(){this.reset()},Ye.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ye.prototype._correctButton=function(n,s){return!1},Ye.prototype._move=function(n,s){return{}},Ye.prototype.mousedown=function(n,s){if(!this._lastPoint){var o=E.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=s,this._eventButton=o)}},Ye.prototype.mousemoveWindow=function(n,s){var o=this._lastPoint;if(o){if(n.preventDefault(),function(u,m){var x=os[m];return u.buttons===void 0||(u.buttons&x)!==x}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)}},Ye.prototype.mouseupWindow=function(n){this._lastPoint&&E.mouseButton(n)===this._eventButton&&(this._moved&&E.suppressClick(),this.reset())},Ye.prototype.enable=function(){this._enabled=!0},Ye.prototype.disable=function(){this._enabled=!1,this.reset()},Ye.prototype.isEnabled=function(){return this._enabled},Ye.prototype.isActive=function(){return this._active};var as=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.mousedown=function(o,u){n.prototype.mousedown.call(this,o,u),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,u){return u===0&&!o.ctrlKey},s.prototype._move=function(o,u){return{around:u,panDelta:u.sub(o)}},s}(Ye),Ws=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var m=.8*(u.x-o.x);if(m)return this._active=!0,{bearingDelta:m}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(Ye),ss=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype._correctButton=function(o,u){return u===0&&o.ctrlKey||u===2},s.prototype._move=function(o,u){var m=-.5*(u.y-o.y);if(m)return this._active=!0,{pitchDelta:m}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(Ye),ro=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};ro.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},ro.prototype.touchstart=function(n,s,o){return this._calculateTransform(n,s,o)},ro.prototype.touchmove=function(n,s,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,s,o)},ro.prototype.touchend=function(n,s,o){this._calculateTransform(n,s,o),this._active&&o.length<this._minTouches&&this.reset()},ro.prototype.touchcancel=function(){this.reset()},ro.prototype._calculateTransform=function(n,s,o){o.length>0&&(this._active=!0);var u=Xs(o,s),m=new a.Point(0,0),x=new a.Point(0,0),S=0;for(var T in u){var C=u[T],F=this._touches[T];F&&(m._add(C),x._add(C.sub(F)),S++,u[T]=C)}if(this._touches=u,!(S<this._minTouches)&&x.mag()){var G=x.div(S);if(this._sum._add(G),!(this._sum.mag()<this._clickTolerance))return{around:m.div(S),panDelta:G}}},ro.prototype.enable=function(){this._enabled=!0},ro.prototype.disable=function(){this._enabled=!1,this.reset()},ro.prototype.isEnabled=function(){return this._enabled},ro.prototype.isActive=function(){return this._active};var Zi=function(){this.reset()};function Hs(n,s,o){for(var u=0;u<n.length;u++)if(n[u].identifier===o)return s[u]}function ja(n,s){return Math.log(n/s)/Math.LN2}Zi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Zi.prototype._start=function(n){},Zi.prototype._move=function(n,s,o){return{}},Zi.prototype.touchstart=function(n,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Zi.prototype.touchmove=function(n,s,o){if(this._firstTwoTouches){n.preventDefault();var u=this._firstTwoTouches,m=u[1],x=Hs(o,s,u[0]),S=Hs(o,s,m);if(x&&S){var T=this._aroundCenter?null:x.add(S).div(2);return this._move([x,S],T,n)}}},Zi.prototype.touchend=function(n,s,o){if(this._firstTwoTouches){var u=this._firstTwoTouches,m=u[1],x=Hs(o,s,u[0]),S=Hs(o,s,m);x&&S||(this._active&&E.suppressClick(),this.reset())}},Zi.prototype.touchcancel=function(){this.reset()},Zi.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Zi.prototype.disable=function(){this._enabled=!1,this.reset()},Zi.prototype.isEnabled=function(){return this._enabled},Zi.prototype.isActive=function(){return this._active};var In=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,u){var m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(ja(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ja(this._distance,m),pinchAround:u}},s}(Zi);function io(n,s){return 180*n.angleWith(s)/Math.PI}var Rl=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,u){var m=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:io(this._vector,m),pinchAround:u}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var u=25/(Math.PI*this._minDiameter)*360,m=io(o,this._startVector);return Math.abs(m)<u},s}(Zi);function Bl(n){return Math.abs(n.y)>Math.abs(n.x)}var Wu=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,Bl(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,u,m){var x=o[0].sub(this._lastPoints[0]),S=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(x,S,m.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(x.y+S.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,u,m){if(this._valid!==void 0)return this._valid;var x=o.mag()>=2,S=u.mag()>=2;if(x||S){if(!x||!S)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;var T=o.y>0==u.y>0;return Bl(o)&&Bl(u)&&T}},s}(Zi),Hu={panStep:100,bearingStep:15,pitchStep:10},xa=function(){var n=Hu;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function Co(n){return n*(2-n)}xa.prototype.blur=function(){this.reset()},xa.prototype.reset=function(){this._active=!1},xa.prototype.keydown=function(n){var s=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,u=0,m=0,x=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?u=-1:(n.preventDefault(),x=-1);break;case 39:n.shiftKey?u=1:(n.preventDefault(),x=1);break;case 38:n.shiftKey?m=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?m=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(u=0,m=0),{cameraAnimation:function(T){var C=T.getZoom();T.easeTo({duration:300,easeId:"keyboardHandler",easing:Co,zoom:o?Math.round(C)+o*(n.shiftKey?2:1):C,bearing:T.getBearing()+u*s._bearingStep,pitch:T.getPitch()+m*s._pitchStep,offset:[-x*s._panStep,-S*s._panStep],center:T.getCenter()},{originalEvent:n})}}}},xa.prototype.enable=function(){this._enabled=!0},xa.prototype.disable=function(){this._enabled=!1,this.reset()},xa.prototype.isEnabled=function(){return this._enabled},xa.prototype.isActive=function(){return this._active},xa.prototype.disableRotation=function(){this._rotationDisabled=!0},xa.prototype.enableRotation=function(){this._rotationDisabled=!1};var ir=function(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onTimeout"],this)};ir.prototype.setZoomRate=function(n){this._defaultZoomRate=n},ir.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},ir.prototype.isEnabled=function(){return!!this._enabled},ir.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},ir.prototype.isZooming=function(){return!!this._zooming},ir.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},ir.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ir.prototype.wheel=function(n){if(this.isEnabled()){var s=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=a.browser.now(),u=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,s!==0&&s%4.000244140625==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(u*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}},ir.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},ir.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=E.mousePos(this._el,n);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ir.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,u=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&u!==0&&(u=1/u);var m=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(m*u))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var x,S=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,T=this._startZoom,C=this._easing,F=!1;if(this._type==="wheel"&&T&&C){var G=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),K=C(G);x=a.number(T,S,K),G<1?this._frameId||(this._frameId=!0):F=!0}else x=S,F=!0;return this._active=!0,F&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!F,zoomDelta:x-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ir.prototype._smoothOutEasing=function(n){var s=a.ease;if(this._prevEase){var o=this._prevEase,u=(a.browser.now()-o.start)/o.duration,m=o.easing(u+.01)-o.easing(u),x=.27/Math.sqrt(m*m+1e-4)*.01,S=Math.sqrt(.0729-x*x);s=a.bezier(x,S,.25,1)}return this._prevEase={start:a.browser.now(),duration:n,easing:s},s},ir.prototype.blur=function(){this.reset()},ir.prototype.reset=function(){this._active=!1};var qa=function(n,s){this._clickZoom=n,this._tapZoom=s};qa.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},qa.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},qa.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},qa.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Zo=function(){this.reset()};Zo.prototype.reset=function(){this._active=!1},Zo.prototype.blur=function(){this.reset()},Zo.prototype.dblclick=function(n,s){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:n})}}},Zo.prototype.enable=function(){this._enabled=!0},Zo.prototype.disable=function(){this._enabled=!1,this.reset()},Zo.prototype.isEnabled=function(){return this._enabled},Zo.prototype.isActive=function(){return this._active};var fn=function(){this._tap=new En({numTouches:1,numTaps:1}),this.reset()};fn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},fn.prototype.touchstart=function(n,s,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,s,o))},fn.prototype.touchmove=function(n,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var u=s[0],m=u.y-this._swipePoint.y;return this._swipePoint=u,n.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(n,s,o)},fn.prototype.touchend=function(n,s,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,s,o)&&(this._tapTime=n.timeStamp)},fn.prototype.touchcancel=function(){this.reset()},fn.prototype.enable=function(){this._enabled=!0},fn.prototype.disable=function(){this._enabled=!1,this.reset()},fn.prototype.isEnabled=function(){return this._enabled},fn.prototype.isActive=function(){return this._active};var Js=function(n,s,o){this._el=n,this._mousePan=s,this._touchPan=o};Js.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Js.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Js.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Js.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var bs=function(n,s,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};bs.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},bs.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},bs.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},bs.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ba=function(n,s,o,u){this._el=n,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0};ba.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ba.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ba.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ba.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ba.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ba.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var On=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Fl=function(n){function s(){n.apply(this,arguments)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s}(a.Event);function bt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var dt=function(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xs(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),a.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[a.window,"blur",void 0]];for(var u=0,m=this._listeners;u<m.length;u+=1){var x=m[u],S=x[0];E.addEventListener(S,x[1],S===a.window.document?this.handleWindowEvent:this.handleEvent,x[2])}};dt.prototype.destroy=function(){for(var n=0,s=this._listeners;n<s.length;n+=1){var o=s[n],u=o[0];E.removeEventListener(u,o[1],u===a.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},dt.prototype._addDefaultHandlers=function(n){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new li(s,n));var u=s.boxZoom=new Ai(s,n);this._add("boxZoom",u);var m=new Tn,x=new Zo;s.doubleClickZoom=new qa(x,m),this._add("tapZoom",m),this._add("clickZoom",x);var S=new fn;this._add("tapDragZoom",S);var T=s.touchPitch=new Wu;this._add("touchPitch",T);var C=new Ws(n),F=new ss(n);s.dragRotate=new bs(n,C,F),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);var G=new as(n),K=new ro(n);s.dragPan=new Js(o,G,K),this._add("mousePan",G),this._add("touchPan",K,["touchZoom","touchRotate"]);var X=new Rl,te=new In;s.touchZoomRotate=new ba(o,te,X,S),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]);var ee=s.scrollZoom=new ir(s,this);this._add("scrollZoom",ee,["mousePan"]);var ae=s.keyboard=new xa;this._add("keyboard",ae),this._add("blockableMapEvent",new at(s));for(var H=0,oe=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];H<oe.length;H+=1){var pe=oe[H];n.interactive&&n[pe]&&s[pe].enable(n[pe])}},dt.prototype._add=function(n,s,o){this._handlers.push({handlerName:n,handler:s,allowed:o}),this._handlersById[n]=s},dt.prototype.stop=function(n){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},dt.prototype.isActive=function(){for(var n=0,s=this._handlers;n<s.length;n+=1)if(s[n].handler.isActive())return!0;return!1},dt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},dt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},dt.prototype.isMoving=function(){return Boolean(On(this._eventsInProgress))||this.isZooming()},dt.prototype._blockedByActive=function(n,s,o){for(var u in n)if(u!==o&&(!s||s.indexOf(u)<0))return!0;return!1},dt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},dt.prototype._getMapTouches=function(n){for(var s=[],o=0,u=n;o<u.length;o+=1){var m=u[o];this._el.contains(m.target)&&s.push(m)}return s},dt.prototype.handleEvent=function(n,s){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,u={needsRenderFrame:!1},m={},x={},S=n.touches?this._getMapTouches(n.touches):void 0,T=S?E.touchPos(this._el,S):E.mousePos(this._el,n),C=0,F=this._handlers;C<F.length;C+=1){var G=F[C],K=G.handlerName,X=G.handler,te=G.allowed;if(X.isEnabled()){var ee=void 0;this._blockedByActive(x,te,K)?X.reset():X[s||n.type]&&(ee=X[s||n.type](n,T,S),this.mergeHandlerResult(u,m,ee,K,o),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||X.isActive())&&(x[K]=X)}}var ae={};for(var H in this._previousActiveHandlers)x[H]||(ae[H]=o);this._previousActiveHandlers=x,(Object.keys(ae).length||bt(u))&&(this._changes.push([u,m,ae]),this._triggerRenderFrame()),(Object.keys(x).length||bt(u))&&this._map._stop(!0),this._updatingCamera=!1;var oe=u.cameraAnimation;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))},dt.prototype.mergeHandlerResult=function(n,s,o,u,m){if(o){a.extend(n,o);var x={handlerName:u,originalEvent:o.originalEvent||m};o.zoomDelta!==void 0&&(s.zoom=x),o.panDelta!==void 0&&(s.drag=x),o.pitchDelta!==void 0&&(s.pitch=x),o.bearingDelta!==void 0&&(s.rotate=x)}},dt.prototype._applyChanges=function(){for(var n={},s={},o={},u=0,m=this._changes;u<m.length;u+=1){var x=m[u],S=x[0],T=x[1],C=x[2];S.panDelta&&(n.panDelta=(n.panDelta||new a.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),a.extend(s,T),a.extend(o,C)}this._updateMapTransform(n,s,o),this._changes=[]},dt.prototype._updateMapTransform=function(n,s,o){var u=this._map,m=u.transform;if(!bt(n))return this._fireEvents(s,o,!0);var x=n.panDelta,S=n.zoomDelta,T=n.bearingDelta,C=n.pitchDelta,F=n.around,G=n.pinchAround;G!==void 0&&(F=G),u._stop(!0),F=F||u.transform.centerPoint;var K=m.pointLocation(x?F.sub(x):F);T&&(m.bearing+=T),C&&(m.pitch+=C),S&&(m.zoom+=S),m.setLocationAtPoint(K,F),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,o,!0)},dt.prototype._fireEvents=function(n,s,o){var u=this,m=On(this._eventsInProgress),x=On(n),S={};for(var T in n)this._eventsInProgress[T]||(S[T+"start"]=n[T].originalEvent),this._eventsInProgress[T]=n[T];for(var C in!m&&x&&this._fireEvent("movestart",x.originalEvent),S)this._fireEvent(C,S[C]);for(var F in x&&this._fireEvent("move",x.originalEvent),n)this._fireEvent(F,n[F].originalEvent);var G,K={};for(var X in this._eventsInProgress){var te=this._eventsInProgress[X],ee=te.handlerName,ae=te.originalEvent;this._handlersById[ee].isActive()||(delete this._eventsInProgress[X],K[X+"end"]=G=s[ee]||ae)}for(var H in K)this._fireEvent(H,K[H]);var oe=On(this._eventsInProgress);if(o&&(m||x)&&!oe){this._updatingCamera=!0;var pe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ge=function(Ee){return Ee!==0&&-u._bearingSnap<Ee&&Ee<u._bearingSnap};pe?(ge(pe.bearing||this._map.getBearing())&&(pe.bearing=0),this._map.easeTo(pe,{originalEvent:G})):(this._map.fire(new a.Event("moveend",{originalEvent:G})),ge(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},dt.prototype._fireEvent=function(n,s){this._map.fire(new a.Event(n,s?{originalEvent:s}:{}))},dt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete n._frameId,n.handleEvent(new Fl("renderFrame",{timeStamp:s})),n._applyChanges()})},dt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var au=function(n){function s(o,u){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,u){return this.jumpTo({center:o},u)},s.prototype.panBy=function(o,u,m){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},u),m)},s.prototype.panTo=function(o,u,m){return this.easeTo(a.extend({center:o},u),m)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,u){return this.jumpTo({zoom:o},u),this},s.prototype.zoomTo=function(o,u,m){return this.easeTo(a.extend({zoom:o},u),m)},s.prototype.zoomIn=function(o,u){return this.zoomTo(this.getZoom()+1,o,u),this},s.prototype.zoomOut=function(o,u){return this.zoomTo(this.getZoom()-1,o,u),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,u){return this.jumpTo({bearing:o},u),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,u){return this.jumpTo({padding:o},u),this},s.prototype.rotateTo=function(o,u,m){return this.easeTo(a.extend({bearing:o},u),m)},s.prototype.resetNorth=function(o,u){return this.rotateTo(0,a.extend({duration:1e3},o),u),this},s.prototype.resetNorthPitch=function(o,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),u),this},s.prototype.snapToNorth=function(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,u){return this.jumpTo({pitch:o},u),this},s.prototype.cameraForBounds=function(o,u){o=a.LngLatBounds.convert(o);var m=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),m,u)},s.prototype._cameraForBoxAndBearing=function(o,u,m,x){var S={top:0,bottom:0,right:0,left:0};if(typeof(x=a.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},x)).padding=="number"){var T=x.padding;x.padding={top:T,bottom:T,right:T,left:T}}x.padding=a.extend(S,x.padding);var C=this.transform,F=C.padding,G=C.project(a.LngLat.convert(o)),K=C.project(a.LngLat.convert(u)),X=G.rotate(-m*Math.PI/180),te=K.rotate(-m*Math.PI/180),ee=new a.Point(Math.max(X.x,te.x),Math.max(X.y,te.y)),ae=new a.Point(Math.min(X.x,te.x),Math.min(X.y,te.y)),H=ee.sub(ae),oe=(C.width-(F.left+F.right+x.padding.left+x.padding.right))/H.x,pe=(C.height-(F.top+F.bottom+x.padding.top+x.padding.bottom))/H.y;if(!(pe<0||oe<0)){var ge=Math.min(C.scaleZoom(C.scale*Math.min(oe,pe)),x.maxZoom),Ee=typeof x.offset.x=="number"?new a.Point(x.offset.x,x.offset.y):a.Point.convert(x.offset),be=new a.Point((x.padding.left-x.padding.right)/2,(x.padding.top-x.padding.bottom)/2).rotate(m*Math.PI/180),Te=Ee.add(be).mult(C.scale/C.zoomScale(ge));return{center:C.unproject(G.add(K).div(2).sub(Te)),zoom:ge,bearing:m}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,u,m){return this._fitInternal(this.cameraForBounds(o,u),u,m)},s.prototype.fitScreenCoordinates=function(o,u,m,x,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(o)),this.transform.pointLocation(a.Point.convert(u)),m,x),x,S)},s.prototype._fitInternal=function(o,u,m){return o?(delete(u=a.extend(o,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this},s.prototype.jumpTo=function(o,u){this.stop();var m=this.transform,x=!1,S=!1,T=!1;return"zoom"in o&&m.zoom!==+o.zoom&&(x=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=a.LngLat.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(S=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(T=!0,m.pitch=+o.pitch),o.padding==null||m.isPaddingEqual(o.padding)||(m.padding=o.padding),this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),x&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),S&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),T&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u))},s.prototype.easeTo=function(o,u){var m=this;this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.browser.prefersReducedMotion)&&(o.duration=0);var x=this.transform,S=this.getZoom(),T=this.getBearing(),C=this.getPitch(),F=this.getPadding(),G="zoom"in o?+o.zoom:S,K="bearing"in o?this._normalizeBearing(o.bearing,T):T,X="pitch"in o?+o.pitch:C,te="padding"in o?o.padding:x.padding,ee=a.Point.convert(o.offset),ae=x.centerPoint.add(ee),H=x.pointLocation(ae),oe=a.LngLat.convert(o.center||H);this._normalizeCenter(oe);var pe,ge,Ee=x.project(H),be=x.project(oe).sub(Ee),Te=x.zoomScale(G-S);o.around&&(pe=a.LngLat.convert(o.around),ge=x.locationPoint(pe));var Ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||G!==S,this._rotating=this._rotating||T!==K,this._pitching=this._pitching||X!==C,this._padding=!x.isPaddingEqual(te),this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Ue),this._ease(function(Xe){if(m._zooming&&(x.zoom=a.number(S,G,Xe)),m._rotating&&(x.bearing=a.number(T,K,Xe)),m._pitching&&(x.pitch=a.number(C,X,Xe)),m._padding&&(x.interpolatePadding(F,te,Xe),ae=x.centerPoint.add(ee)),pe)x.setLocationAtPoint(pe,ge);else{var Ke=x.zoomScale(x.zoom-S),ot=G>S?Math.min(2,Te):Math.max(.5,Te),wt=Math.pow(ot,1-Xe),Tt=x.unproject(Ee.add(be.mult(Xe*wt)).mult(Ke));x.setLocationAtPoint(x.renderWorldCopies?Tt.wrap():Tt,ae)}m._fireMoveEvents(u)},function(Xe){m._afterEase(u,Xe)},o),this},s.prototype._prepareEase=function(o,u,m){m===void 0&&(m={}),this._moving=!0,u||m.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!m.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new a.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))},s.prototype._afterEase=function(o,u){if(!this._easeId||!u||this._easeId!==u){delete this._easeId;var m=this._zooming,x=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new a.Event("zoomend",o)),x&&this.fire(new a.Event("rotateend",o)),S&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}},s.prototype.flyTo=function(o,u){var m=this;if(!o.essential&&a.browser.prefersReducedMotion){var x=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(x,u)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);var S=this.transform,T=this.getZoom(),C=this.getBearing(),F=this.getPitch(),G=this.getPadding(),K="zoom"in o?a.clamp(+o.zoom,S.minZoom,S.maxZoom):T,X="bearing"in o?this._normalizeBearing(o.bearing,C):C,te="pitch"in o?+o.pitch:F,ee="padding"in o?o.padding:S.padding,ae=S.zoomScale(K-T),H=a.Point.convert(o.offset),oe=S.centerPoint.add(H),pe=S.pointLocation(oe),ge=a.LngLat.convert(o.center||pe);this._normalizeCenter(ge);var Ee=S.project(pe),be=S.project(ge).sub(Ee),Te=o.curve,Ue=Math.max(S.width,S.height),Xe=Ue/ae,Ke=be.mag();if("minZoom"in o){var ot=a.clamp(Math.min(o.minZoom,T,K),S.minZoom,S.maxZoom),wt=Ue/S.zoomScale(ot-T);Te=Math.sqrt(wt/Ke*2)}var Tt=Te*Te;function Et(Mt){var It=(Xe*Xe-Ue*Ue+(Mt?-1:1)*Tt*Tt*Ke*Ke)/(2*(Mt?Xe:Ue)*Tt*Ke);return Math.log(Math.sqrt(It*It+1)-It)}function fr(Mt){return(Math.exp(Mt)-Math.exp(-Mt))/2}function ut(Mt){return(Math.exp(Mt)+Math.exp(-Mt))/2}var Bt=Et(0),Ht=function(Mt){return ut(Bt)/ut(Bt+Te*Mt)},Rt=function(Mt){return Ue*((ut(Bt)*(fr(It=Bt+Te*Mt)/ut(It))-fr(Bt))/Tt)/Ke;var It},Lt=(Et(1)-Bt)/Te;if(Math.abs(Ke)<1e-6||!isFinite(Lt)){if(Math.abs(Ue-Xe)<1e-6)return this.easeTo(o,u);var Wt=Xe<Ue?-1:1;Lt=Math.abs(Math.log(Xe/Ue))/Te,Rt=function(){return 0},Ht=function(Mt){return Math.exp(Wt*Te*Mt)}}return o.duration="duration"in o?+o.duration:1e3*Lt/("screenSpeed"in o?+o.screenSpeed/Te:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=C!==X,this._pitching=te!==F,this._padding=!S.isPaddingEqual(ee),this._prepareEase(u,!1),this._ease(function(Mt){var It=Mt*Lt,Gi=1/Ht(It);S.zoom=Mt===1?K:T+S.scaleZoom(Gi),m._rotating&&(S.bearing=a.number(C,X,Mt)),m._pitching&&(S.pitch=a.number(F,te,Mt)),m._padding&&(S.interpolatePadding(G,ee,Mt),oe=S.centerPoint.add(H));var pi=Mt===1?ge:S.unproject(Ee.add(be.mult(Rt(It))).mult(Gi));S.setLocationAtPoint(S.renderWorldCopies?pi.wrap():pi,oe),m._fireMoveEvents(u)},function(){return m._afterEase(u)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,u)}if(!o){var x=this.handlers;x&&x.stop(!1)}return this},s.prototype._ease=function(o,u,m){m.animate===!1||m.duration===0?(o(1),u()):(this._easeStart=a.browser.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,u){o=a.wrap(o,-180,180);var m=Math.abs(o-u);return Math.abs(o-360-u)<m&&(o-=360),Math.abs(o+360-u)<m&&(o+=360),o},s.prototype._normalizeCenter=function(o){var u=this.transform;if(u.renderWorldCopies&&!u.lngRange){var m=o.lng-u.center.lng;o.lng+=m>180?-360:m<-180?360:0}},s}(a.Evented),Nn=function(n){n===void 0&&(n={}),this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Nn.prototype.getDefaultPosition=function(){return"bottom-right"},Nn.prototype.onAdd=function(n){var s=this.options&&this.options.compact;return this._map=n,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Nn.prototype.onRemove=function(){E.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Nn.prototype._setElementTitle=function(n,s){var o=this._map._getUIString("AttributionControl."+s);n.title=o,n.setAttribute("aria-label",o)},Nn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Nn.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){var o=s.reduce(function(u,m,x){return m.value&&(u+=m.key+"="+m.value+(x<s.length-1?"&":"")),u},"?");n.href=a.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},Nn.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Nn.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(T){return typeof T!="string"?"":T})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var u in o){var m=o[u];if(m.used){var x=m.getSource();x.attribution&&n.indexOf(x.attribution)<0&&n.push(x.attribution)}}n.sort(function(T,C){return T.length-C.length});var S=(n=n.filter(function(T,C){for(var F=C+1;F<n.length;F++)if(n[F].indexOf(T)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Nn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var wa=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};wa.prototype.onAdd=function(n){this._map=n,this._container=E.create("div","mapboxgl-ctrl");var s=E.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},wa.prototype.onRemove=function(){E.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},wa.prototype.getDefaultPosition=function(){return"bottom-left"},wa.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},wa.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var s in n)if(n[s].getSource().mapbox_logo)return!0;return!1}},wa.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var dn=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};dn.prototype.add=function(n){var s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s},dn.prototype.remove=function(n){for(var s=this._currentlyRunning,o=0,u=s?this._queue.concat(s):this._queue;o<u.length;o+=1){var m=u[o];if(m.id===n)return void(m.cancelled=!0)}},dn.prototype.run=function(n){n===void 0&&(n=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,u=s;o<u.length;o+=1){var m=u[o];if(!m.cancelled&&(m.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},dn.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Za={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ju=a.window.HTMLImageElement,su=a.window.HTMLElement,Pr=a.window.ImageBitmap,$i={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},qc=function(n){function s(u){var m=this;if((u=a.extend({},$i,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var x=new $t(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies);if(n.call(this,x,u),this._interactive=u.interactive,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._crossSourceCollisions=u.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=u.collectResourceTiming,this._renderTaskQueue=new dn,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Za,u.locale),this._clickTolerance=u.clickTolerance,this._requestManager=new a.RequestManager(u.transformRequest,u.accessToken),typeof u.container=="string"){if(this._container=a.window.document.getElementById(u.container),!this._container)throw new Error("Container '"+u.container+"' not found.")}else{if(!(u.container instanceof su))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(u.maxBounds&&this.setMaxBounds(u.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return m._update(!1)}),this.on("moveend",function(){return m._update(!1)}),this.on("zoom",function(){return m._update(!0)}),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new dt(this,u),this._hash=u.hash&&new Fn(typeof u.hash=="string"&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,a.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localIdeographFontFamily:u.localIdeographFontFamily}),u.attributionControl&&this.addControl(new Nn({customAttribution:u.customAttribution})),this.addControl(new wa,u.logoPosition),this.on("style.load",function(){m.transform.unmodified&&m.jumpTo(m.style.stylesheet)}),this.on("data",function(S){m._update(S.dataType==="style"),m.fire(new a.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){m.fire(new a.Event(S.dataType+"dataloading",S))})}n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(u,m){if(m===void 0&&(m=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var x=u.onAdd(this);this._controls.push(u);var S=this._controlPositions[m];return m.indexOf("bottom")!==-1?S.insertBefore(x,S.firstChild):S.appendChild(x),this},s.prototype.removeControl=function(u){if(!u||!u.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var m=this._controls.indexOf(u);return m>-1&&this._controls.splice(m,1),u.onRemove(this),this},s.prototype.hasControl=function(u){return this._controls.indexOf(u)>-1},s.prototype.resize=function(u){var m=this._containerDimensions(),x=m[0],S=m[1];if(x===this.transform.width&&S===this.transform.height)return this;this._resizeCanvas(x,S),this.transform.resize(x,S),this.painter.resize(x,S);var T=!this._moving;return T&&this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),this.fire(new a.Event("resize",u)),T&&this.fire(new a.Event("moveend",u)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(u){return this.transform.setMaxBounds(a.LngLatBounds.convert(u)),this._update()},s.prototype.setMinZoom=function(u){if((u=u==null?-2:u)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u&&this.setZoom(u),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(u){if((u=u==null?22:u)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u&&this.setZoom(u),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(u){if((u=u==null?0:u)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u&&this.setPitch(u),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(u){if((u=u==null?60:u)>60)throw new Error("maxPitch must be less than or equal to 60");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u&&this.setPitch(u),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(u){return this.transform.renderWorldCopies=u,this._update()},s.prototype.project=function(u){return this.transform.locationPoint(a.LngLat.convert(u))},s.prototype.unproject=function(u){return this.transform.pointLocation(a.Point.convert(u))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(u,m,x){var S,T=this;if(u==="mouseenter"||u==="mouseover"){var C=!1;return{layer:m,listener:x,delegates:{mousemove:function(G){var K=T.getLayer(m)?T.queryRenderedFeatures(G.point,{layers:[m]}):[];K.length?C||(C=!0,x.call(T,new ni(u,T,G.originalEvent,{features:K}))):C=!1},mouseout:function(){C=!1}}}}if(u==="mouseleave"||u==="mouseout"){var F=!1;return{layer:m,listener:x,delegates:{mousemove:function(G){(T.getLayer(m)?T.queryRenderedFeatures(G.point,{layers:[m]}):[]).length?F=!0:F&&(F=!1,x.call(T,new ni(u,T,G.originalEvent)))},mouseout:function(G){F&&(F=!1,x.call(T,new ni(u,T,G.originalEvent)))}}}}return{layer:m,listener:x,delegates:(S={},S[u]=function(G){var K=T.getLayer(m)?T.queryRenderedFeatures(G.point,{layers:[m]}):[];K.length&&(G.features=K,x.call(T,G),delete G.features)},S)}},s.prototype.on=function(u,m,x){if(x===void 0)return n.prototype.on.call(this,u,m);var S=this._createDelegatedListener(u,m,x);for(var T in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(S),S.delegates)this.on(T,S.delegates[T]);return this},s.prototype.once=function(u,m,x){if(x===void 0)return n.prototype.once.call(this,u,m);var S=this._createDelegatedListener(u,m,x);for(var T in S.delegates)this.once(T,S.delegates[T]);return this},s.prototype.off=function(u,m,x){var S=this;return x===void 0?n.prototype.off.call(this,u,m):(this._delegatedListeners&&this._delegatedListeners[u]&&function(T){for(var C=T[u],F=0;F<C.length;F++){var G=C[F];if(G.layer===m&&G.listener===x){for(var K in G.delegates)S.off(K,G.delegates[K]);return C.splice(F,1),S}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(u,m){if(!this.style)return[];var x;if(m!==void 0||u===void 0||u instanceof a.Point||Array.isArray(u)||(m=u,u=void 0),m=m||{},(u=u||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||typeof u[0]=="number")x=[a.Point.convert(u)];else{var S=a.Point.convert(u[0]),T=a.Point.convert(u[1]);x=[S,new a.Point(T.x,S.y),T,new a.Point(S.x,T.y),S]}return this.style.queryRenderedFeatures(x,m,this.transform)},s.prototype.querySourceFeatures=function(u,m){return this.style.querySourceFeatures(u,m)},s.prototype.setStyle=function(u,m){return(m=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},m)).diff!==!1&&m.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&u?(this._diffStyle(u,m),this):(this._localIdeographFontFamily=m.localIdeographFontFamily,this._updateStyle(u,m))},s.prototype._getUIString=function(u){var m=this._locale[u];if(m==null)throw new Error("Missing UI string '"+u+"'");return m},s.prototype._updateStyle=function(u,m){return this.style&&(this.style.setEventedParent(null),this.style._remove()),u?(this.style=new pn(this,m||{}),this.style.setEventedParent(this,{style:this.style}),typeof u=="string"?this.style.loadURL(u):this.style.loadJSON(u),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new pn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(u,m){var x=this;if(typeof u=="string"){var S=this._requestManager.normalizeStyleURL(u),T=this._requestManager.transformRequest(S,a.ResourceType.Style);a.getJSON(T,function(C,F){C?x.fire(new a.ErrorEvent(C)):F&&x._updateDiff(F,m)})}else typeof u=="object"&&this._updateDiff(u,m)},s.prototype._updateDiff=function(u,m){try{this.style.setState(u)&&this._update(!0)}catch(x){a.warnOnce("Unable to perform style diff: "+(x.message||x.error||x)+".  Rebuilding the style from scratch."),this._updateStyle(u,m)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(u,m){return this._lazyInitEmptyStyle(),this.style.addSource(u,m),this._update(!0)},s.prototype.isSourceLoaded=function(u){var m=this.style&&this.style.sourceCaches[u];if(m!==void 0)return m.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+u+"'")))},s.prototype.areTilesLoaded=function(){var u=this.style&&this.style.sourceCaches;for(var m in u){var x=u[m]._tiles;for(var S in x){var T=x[S];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0},s.prototype.addSourceType=function(u,m,x){return this._lazyInitEmptyStyle(),this.style.addSourceType(u,m,x)},s.prototype.removeSource=function(u){return this.style.removeSource(u),this._update(!0)},s.prototype.getSource=function(u){return this.style.getSource(u)},s.prototype.addImage=function(u,m,x){x===void 0&&(x={});var S=x.pixelRatio;S===void 0&&(S=1);var T=x.sdf;T===void 0&&(T=!1);var C=x.stretchX,F=x.stretchY,G=x.content;if(this._lazyInitEmptyStyle(),m instanceof Ju||Pr&&m instanceof Pr){var K=a.browser.getImageData(m);this.style.addImage(u,{data:new a.RGBAImage({width:K.width,height:K.height},K.data),pixelRatio:S,stretchX:C,stretchY:F,content:G,sdf:T,version:0})}else{if(m.width===void 0||m.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var X=m;this.style.addImage(u,{data:new a.RGBAImage({width:m.width,height:m.height},new Uint8Array(m.data)),pixelRatio:S,stretchX:C,stretchY:F,content:G,sdf:T,version:0,userImage:X}),X.onAdd&&X.onAdd(this,u)}},s.prototype.updateImage=function(u,m){var x=this.style.getImage(u);if(!x)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=m instanceof Ju||Pr&&m instanceof Pr?a.browser.getImageData(m):m,T=S.width,C=S.height,F=S.data;return T===void 0||C===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):T!==x.data.width||C!==x.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(x.data.replace(F,!(m instanceof Ju||Pr&&m instanceof Pr)),void this.style.updateImage(u,x))},s.prototype.hasImage=function(u){return u?!!this.style.getImage(u):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(u){this.style.removeImage(u)},s.prototype.loadImage=function(u,m){a.getImage(this._requestManager.transformRequest(u,a.ResourceType.Image),m)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(u,m){return this._lazyInitEmptyStyle(),this.style.addLayer(u,m),this._update(!0)},s.prototype.moveLayer=function(u,m){return this.style.moveLayer(u,m),this._update(!0)},s.prototype.removeLayer=function(u){return this.style.removeLayer(u),this._update(!0)},s.prototype.getLayer=function(u){return this.style.getLayer(u)},s.prototype.setLayerZoomRange=function(u,m,x){return this.style.setLayerZoomRange(u,m,x),this._update(!0)},s.prototype.setFilter=function(u,m,x){return x===void 0&&(x={}),this.style.setFilter(u,m,x),this._update(!0)},s.prototype.getFilter=function(u){return this.style.getFilter(u)},s.prototype.setPaintProperty=function(u,m,x,S){return S===void 0&&(S={}),this.style.setPaintProperty(u,m,x,S),this._update(!0)},s.prototype.getPaintProperty=function(u,m){return this.style.getPaintProperty(u,m)},s.prototype.setLayoutProperty=function(u,m,x,S){return S===void 0&&(S={}),this.style.setLayoutProperty(u,m,x,S),this._update(!0)},s.prototype.getLayoutProperty=function(u,m){return this.style.getLayoutProperty(u,m)},s.prototype.setLight=function(u,m){return m===void 0&&(m={}),this._lazyInitEmptyStyle(),this.style.setLight(u,m),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(u,m){return this.style.setFeatureState(u,m),this._update()},s.prototype.removeFeatureState=function(u,m){return this.style.removeFeatureState(u,m),this._update()},s.prototype.getFeatureState=function(u){return this.style.getFeatureState(u)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var u=0,m=0;return this._container&&(u=this._container.clientWidth||400,m=this._container.clientHeight||300),[u,m]},s.prototype._detectMissingCSS=function(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=E.create("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();var m=this._canvasContainer=E.create("div","mapboxgl-canvas-container",u);this._interactive&&m.classList.add("mapboxgl-interactive"),this._canvas=E.create("canvas","mapboxgl-canvas",m),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var x=this._containerDimensions();this._resizeCanvas(x[0],x[1]);var S=this._controlContainer=E.create("div","mapboxgl-control-container",u),T=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(C){T[C]=E.create("div","mapboxgl-ctrl-"+C,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(u,m){var x=a.browser.devicePixelRatio||1;this._canvas.width=x*u,this._canvas.height=x*m,this._canvas.style.width=u+"px",this._canvas.style.height=m+"px"},s.prototype._setupPainter=function(){var u=a.extend({},A.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),m=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);m?(this.painter=new Lr(m,this.transform),a.webpSupported.testSupport(m)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:u}))},s.prototype._contextRestored=function(u){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:u}))},s.prototype._onMapScroll=function(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(u){return this._update(),this._renderTaskQueue.add(u)},s.prototype._cancelRenderFrame=function(u){this._renderTaskQueue.remove(u)},s.prototype._render=function(u){var m,x=this,S=0,T=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(m=T.createQueryEXT(),T.beginQueryEXT(T.TIME_ELAPSED_EXT,m),S=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(u),!this._removed){var C=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var F=this.transform.zoom,G=a.browser.now();this.style.zoomHistory.update(F,G);var K=new a.EvaluationParameters(F,{now:G,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),X=K.crossFadingFactor();X===1&&X===this._crossFadingFactor||(C=!0,this._crossFadingFactor=X),this.style.update(K)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||C)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var te=a.browser.now()-S;T.endQueryEXT(T.TIME_ELAPSED_EXT,m),setTimeout(function(){var H=T.getQueryObjectEXT(m,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(m),x.fire(new a.Event("gpu-timing-frame",{cpuTime:te,gpuTime:H}))},50)}if(this.listens("gpu-timing-layer")){var ee=this.painter.collectGpuTimers();setTimeout(function(){var H=x.painter.queryGpuTimers(ee);x.fire(new a.Event("gpu-timing-layer",{layerTimes:H}))},50)}var ae=this._sourcesDirty||this._styleDirty||this._placementDirty;return ae||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||ae||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var u=0,m=this._controls;u<m.length;u+=1)m[u].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var x=this.painter.context.gl.getExtension("WEBGL_lose_context");x&&x.loseContext(),Ys(this._canvasContainer),Ys(this._controlContainer),Ys(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},s.prototype.triggerRepaint=function(){var u=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(m){u._frame=null,u._render(m)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(u){this._trackResize&&this.resize({originalEvent:u})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(u){this._showPadding!==u&&(this._showPadding=u,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(u){this._vertices=u,this._update()},s.prototype._setCacheLimits=function(u,m){a.setCacheLimits(u,m)},o.version.get=function(){return a.version},Object.defineProperties(s.prototype,o),s}(au);function Ys(n){n.parentNode&&n.parentNode.removeChild(n)}var Yu={showCompass:!0,showZoom:!0,visualizePitch:!1},ls=function(n){var s=this;this.options=a.extend({},Yu,n),this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),E.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),E.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=E.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ls.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),s=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},ls.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},ls.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xo(this._map,this._compass,this.options.visualizePitch)),this._container},ls.prototype.onRemove=function(){E.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ls.prototype._createButton=function(n,s){var o=E.create("button",n,this._container);return o.type="button",o.addEventListener("click",s),o},ls.prototype._setButtonTitle=function(n,s){var o=this._map._getUIString("NavigationControl."+s);n.title=o,n.setAttribute("aria-label",o)};var xo=function(n,s,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Ws({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new ss({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),E.addEventListener(s,"mousedown",this.mousedown),E.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),E.addEventListener(s,"touchmove",this.touchmove),E.addEventListener(s,"touchend",this.touchend),E.addEventListener(s,"touchcancel",this.reset)};function fl(n,s,o){if(n=new a.LngLat(n.lng,n.lat),s){var u=new a.LngLat(n.lng-360,n.lat),m=new a.LngLat(n.lng+360,n.lat),x=o.locationPoint(n).distSqr(s);o.locationPoint(u).distSqr(s)<x?n=u:o.locationPoint(m).distSqr(s)<x&&(n=m)}for(;Math.abs(n.lng-o.center.lng)>180;){var S=o.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=o.width&&S.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}xo.prototype.down=function(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),E.disableDrag()},xo.prototype.move=function(n,s){var o=this.map,u=this.mouseRotate.mousemoveWindow(n,s);if(u&&u.bearingDelta&&o.setBearing(o.getBearing()+u.bearingDelta),this.mousePitch){var m=this.mousePitch.mousemoveWindow(n,s);m&&m.pitchDelta&&o.setPitch(o.getPitch()+m.pitchDelta)}},xo.prototype.off=function(){var n=this.element;E.removeEventListener(n,"mousedown",this.mousedown),E.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),E.removeEventListener(n,"touchmove",this.touchmove),E.removeEventListener(n,"touchend",this.touchend),E.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},xo.prototype.offTemp=function(){E.enableDrag(),E.removeEventListener(a.window,"mousemove",this.mousemove),E.removeEventListener(a.window,"mouseup",this.mouseup)},xo.prototype.mousedown=function(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),E.mousePos(this.element,n)),E.addEventListener(a.window,"mousemove",this.mousemove),E.addEventListener(a.window,"mouseup",this.mouseup)},xo.prototype.mousemove=function(n){this.move(n,E.mousePos(this.element,n))},xo.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},xo.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=E.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},xo.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=E.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},xo.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},xo.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Ga={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function lu(n,s,o){var u=n.classList;for(var m in Ga)u.remove("mapboxgl-"+o+"-anchor-"+m);u.add("mapboxgl-"+o+"-anchor-"+s)}var dl,Ol=function(n){function s(o,u){if(n.call(this),(o instanceof a.window.HTMLElement||u)&&(o=a.extend({element:o},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=E.create("div"),this._element.setAttribute("aria-label","Map marker");var m=E.createNS("http://www.w3.org/2000/svg","svg");m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height","41px"),m.setAttributeNS(null,"width","27px"),m.setAttributeNS(null,"viewBox","0 0 27 41");var x=E.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");var S=E.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");var T=E.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");for(var C=0,F=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];C<F.length;C+=1){var G=F[C],K=E.createNS("http://www.w3.org/2000/svg","ellipse");K.setAttributeNS(null,"opacity","0.04"),K.setAttributeNS(null,"cx","10.5"),K.setAttributeNS(null,"cy","5.80029008"),K.setAttributeNS(null,"rx",G.rx),K.setAttributeNS(null,"ry",G.ry),T.appendChild(K)}var X=E.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"fill",this._color);var te=E.createNS("http://www.w3.org/2000/svg","path");te.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),X.appendChild(te);var ee=E.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"fill","#000000");var ae=E.createNS("http://www.w3.org/2000/svg","path");ae.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ee.appendChild(ae);var H=E.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");var oe=E.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(8.0, 8.0)");var pe=E.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#000000"),pe.setAttributeNS(null,"opacity","0.25"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962");var ge=E.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#FFFFFF"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962"),oe.appendChild(pe),oe.appendChild(ge),S.appendChild(T),S.appendChild(X),S.appendChild(ee),S.appendChild(H),S.appendChild(oe),m.appendChild(S),m.setAttributeNS(null,"height",41*this._scale+"px"),m.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(m),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Ee){Ee.preventDefault()}),this._element.addEventListener("mousedown",function(Ee){Ee.preventDefault()}),lu(this._element,this._anchor,"marker"),this._popup=null}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),E.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var u=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var u=o.code,m=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&m!==32&&m!==13||this.togglePopup()},s.prototype._onMapClick=function(o){var u=o.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=fl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(u="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),E.setTransform(this._element,Ga[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+m+" "+u)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=a.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var u=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(a.Evented),Qu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ml=0,Qs=!1,$u=function(n){function s(o){n.call(this),this.options=a.extend({},Qu,o),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.onAdd=function(o){var u;return this._map=o,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),u=this._setupUI,dl!==void 0?u(dl):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(function(m){u(dl=m.state!=="denied")}):u(dl=!!a.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),E.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ml=0,Qs=!1},s.prototype._isOutOfMapMaxBounds=function(o){var u=this._map.getMaxBounds(),m=o.coords;return u&&(m.longitude<u.getWest()||m.longitude>u.getEast()||m.latitude<u.getSouth()||m.latitude>u.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude),m=o.coords.accuracy,x=this._map.getBearing(),S=a.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(m),S,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var u=new a.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,u=this._map.unproject([0,o]),m=this._map.unproject([1,o]),x=u.distanceTo(m),S=Math.ceil(2*this._accuracy/x);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Qs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var u=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=E.create("button","mapboxgl-ctrl-geolocate",this._container),E.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{var x=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=x,this._geolocateButton.setAttribute("aria-label",x)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ol(this._dotElement),this._circleElement=E.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ol({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||u._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(u._watchState="BACKGROUND",u._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),u._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),u.fire(new a.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ml--,Qs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ml>1?(o={maximumAge:6e5,timeout:0},Qs=!0):(o=this.options.positionOptions,Qs=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(a.Evented),ws={maxWidth:100,unit:"metric"},Ss=function(n){this.options=a.extend({},ws,n),a.bindAll(["_onMove","setUnit"],this)};function uu(n,s,o){var u=o&&o.maxWidth||100,m=n._container.clientHeight/2,x=n.unproject([0,m]),S=n.unproject([u,m]),T=x.distanceTo(S);if(o&&o.unit==="imperial"){var C=3.2808*T;C>5280?ks(s,u,C/5280,n._getUIString("ScaleControl.Miles")):ks(s,u,C,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?ks(s,u,T/1852,n._getUIString("ScaleControl.NauticalMiles")):T>=1e3?ks(s,u,T/1e3,n._getUIString("ScaleControl.Kilometers")):ks(s,u,T,n._getUIString("ScaleControl.Meters"))}function ks(n,s,o,u){var m,x,S,T=(m=o,(x=Math.pow(10,(""+Math.floor(m)).length-1))*(S=(S=m/x)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(C){var F=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*F)/F}(S)));n.style.width=s*(T/o)+"px",n.innerHTML=T+"&nbsp;"+u}Ss.prototype.getDefaultPosition=function(){return"bottom-left"},Ss.prototype._onMove=function(){uu(this._map,this._container,this.options)},Ss.prototype.onAdd=function(n){return this._map=n,this._container=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ss.prototype.onRemove=function(){E.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ss.prototype.setUnit=function(n){this.options.unit=n,uu(this._map,this._container,this.options)};var Go=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof a.window.HTMLElement?this._container=n.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};Go.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=E.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Go.prototype.onRemove=function(){E.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Go.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},Go.prototype._setupUI=function(){var n=this._fullscreenButton=E.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Go.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},Go.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Go.prototype._isFullscreen=function(){return this._fullscreen},Go.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Go.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ec={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Nl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),tc=function(n){function s(o){n.call(this),this.options=a.extend(Object.create(ec),o),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(s.__proto__=n),(s.prototype=Object.create(n&&n.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&E.remove(this._content),this._container&&(E.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(a.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var u,m=a.window.document.createDocumentFragment(),x=a.window.document.createElement("body");for(x.innerHTML=o;u=x.firstChild;)m.appendChild(u);return this.setDOMContent(m)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=E.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=E.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var u=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=E.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=E.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(K){return u._container.classList.add(K)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=fl(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var m=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),x=this.options.anchor,S=function K(X){if(X){if(typeof X=="number"){var te=Math.round(Math.sqrt(.5*Math.pow(X,2)));return{center:new a.Point(0,0),top:new a.Point(0,X),"top-left":new a.Point(te,te),"top-right":new a.Point(-te,te),bottom:new a.Point(0,-X),"bottom-left":new a.Point(te,-te),"bottom-right":new a.Point(-te,-te),left:new a.Point(X,0),right:new a.Point(-X,0)}}if(X instanceof a.Point||Array.isArray(X)){var ee=a.Point.convert(X);return{center:ee,top:ee,"top-left":ee,"top-right":ee,bottom:ee,"bottom-left":ee,"bottom-right":ee,left:ee,right:ee}}return{center:a.Point.convert(X.center||[0,0]),top:a.Point.convert(X.top||[0,0]),"top-left":a.Point.convert(X["top-left"]||[0,0]),"top-right":a.Point.convert(X["top-right"]||[0,0]),bottom:a.Point.convert(X.bottom||[0,0]),"bottom-left":a.Point.convert(X["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(X["bottom-right"]||[0,0]),left:a.Point.convert(X.left||[0,0]),right:a.Point.convert(X.right||[0,0])}}return K(new a.Point(0,0))}(this.options.offset);if(!x){var T,C=this._container.offsetWidth,F=this._container.offsetHeight;T=m.y+S.bottom.y<F?["top"]:m.y>this._map.transform.height-F?["bottom"]:[],m.x<C/2?T.push("left"):m.x>this._map.transform.width-C/2&&T.push("right"),x=T.length===0?"bottom":T.join("-")}var G=m.add(S[x]).round();E.setTransform(this._container,Ga[x]+" translate("+G.x+"px,"+G.y+"px)"),lu(this._container,x,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(Nl);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(a.Evented),cu={version:a.version,supported:A,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:qc,NavigationControl:ls,GeolocateControl:$u,AttributionControl:Nn,ScaleControl:Ss,FullscreenControl:Go,Popup:tc,Marker:Ol,Style:pn,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){we().acquire(Se)},clearPrewarmedResources:function(){var n=rt;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(Se),rt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(n){a.config.ACCESS_TOKEN=n},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(n){a.config.API_URL=n},get workerCount(){return Oe.workerCount},set workerCount(n){Oe.workerCount=n},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){a.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){a.clearTileCache(n)},workerUrl:""};return cu}),v})})(Pc);const N0=Pc.exports;function dm(c){let h;const f=c[15].default,y=Vu(f,c,c[14],null);return{c(){y&&y.c()},l(v){y&&y.l(v)},m(v,w){y&&y.m(v,w),h=!0},p(v,w){y&&y.p&&(!h||w&16384)&&ju(y,f,v,v[14],h?Zu(f,v[14],w,null):qu(v[14]),null)},i(v){h||(vt(y,v),h=!0)},o(v){zt(y,v),h=!1},d(v){y&&y.d(v)}}}function U0(c){let h,f,y,v=c[0]&&dm(c);return{c(){h=De("div"),v&&v.c(),this.h()},l(w){h=Le(w,"DIV",{class:!0,id:!0});var a=Ve(h);v&&v.l(a),a.forEach(ie),this.h()},h(){ce(h,"class","absolute top-0 bg-grey4 w-full h-full svelte-a65d1y"),ce(h,"id",c[1]),Np(()=>c[16].call(h))},m(w,a){Fe(w,h,a),v&&v.m(h,null),f=Up(h,c[16].bind(h)),c[17](h),y=!0},p(w,[a]){w[0]?v?(v.p(w,a),a&1&&vt(v,1)):(v=dm(w),v.c(),vt(v,1),v.m(h,null)):v&&(Ha(),zt(v,1,1,()=>{v=null}),Ja()),(!y||a&2)&&ce(h,"id",w[1])},i(w){y||(vt(v),y=!0)},o(w){zt(v),y=!1},d(w){w&&ie(h),v&&v.d(),f(),c[17](null)}}}function V0(c,h,f){let{$$slots:y={},$$scope:v}=h,{map:w}=h,{id:a="map"}=h,{location:A={bounds:[[-8.1775,54.02275],[-5.43279,55.31298]]}}=h,{style:E="https://raw.githubusercontent.com/kham1508/map_tiles/main/basemap_styles/style-omt.json"}=h,{interactive:P=!0}=h,{minzoom:M=0}=h,{maxzoom:V=14}=h,{zoom:B=null}=h,{scrollzoom:N=!0}=h,{geolocate:ue=!0}=h,{zoomcontrol:ze=!0}=h,{options:Ae={}}=h,Ie,Me;Om("map",{getMap:()=>w}),A.bounds?Ae={...Ae,bounds:A.bounds}:A.lon&&A.lat&&(Ae={...Ae,center:[A.lon,A.lat]},A.zoom&&(Ae.zoom=A.zoom)),Fm(()=>{const je=document.createElement("link");return je.rel="stylesheet",je.href="https://unpkg.com/mapbox-gl@1.13.0/dist/mapbox-gl.css",je.onload=()=>{f(0,w=new Pc.exports.Map({container:Ie,style:E,minZoom:M,maxZoom:V,interactive:P,...Ae})),ze&&w.addControl(new Pc.exports.NavigationControl({showCompass:!1})),N||w.scrollZoom.disable(),ue&&w.addControl(new Pc.exports.GeolocateControl),w.on("load",()=>{f(4,B=w.getZoom())}),w.on("zoom",()=>{f(4,B=w.getZoom())})},document.head.appendChild(je),()=>{w.remove(),je.parentNode.removeChild(je)}});function ft(){let je=document.getElementsByClassName("mapboxgl-canvas");je[0]&&(je[0].style.width="100%",w.resize())}function Pt(){Me=this.clientWidth,f(2,Me)}function ve(je){sl[je?"unshift":"push"](()=>{Ie=je,f(3,Ie)})}return c.$$set=je=>{"map"in je&&f(0,w=je.map),"id"in je&&f(1,a=je.id),"location"in je&&f(6,A=je.location),"style"in je&&f(7,E=je.style),"interactive"in je&&f(8,P=je.interactive),"minzoom"in je&&f(9,M=je.minzoom),"maxzoom"in je&&f(10,V=je.maxzoom),"zoom"in je&&f(4,B=je.zoom),"scrollzoom"in je&&f(11,N=je.scrollzoom),"geolocate"in je&&f(12,ue=je.geolocate),"zoomcontrol"in je&&f(13,ze=je.zoomcontrol),"options"in je&&f(5,Ae=je.options),"$$scope"in je&&f(14,v=je.$$scope)},c.$$.update=()=>{c.$$.dirty&4&&Me&&ft()},[w,a,Me,Ie,B,Ae,A,E,P,M,V,N,ue,ze,v,y,Pt,ve]}class j0 extends ea{constructor(h){super(),ta(this,h,V0,U0,ra,{map:0,id:1,location:6,style:7,interactive:8,minzoom:9,maxzoom:10,zoom:4,scrollzoom:11,geolocate:12,zoomcontrol:13,options:5})}}function mm(c){let h;const f=c[11].default,y=Vu(f,c,c[10],null);return{c(){y&&y.c()},l(v){y&&y.l(v)},m(v,w){y&&y.m(v,w),h=!0},p(v,w){y&&y.p&&(!h||w&1024)&&ju(y,f,v,v[10],h?Zu(f,v[10],w,null):qu(v[10]),null)},i(v){h||(vt(y,v),h=!0)},o(v){zt(y,v),h=!1},d(v){y&&y.d(v)}}}function q0(c){let h,f,y=c[0]&&mm(c);return{c(){y&&y.c(),h=Br()},l(v){y&&y.l(v),h=Br()},m(v,w){y&&y.m(v,w),Fe(v,h,w),f=!0},p(v,[w]){v[0]?y?(y.p(v,w),w&1&&vt(y,1)):(y=mm(v),y.c(),vt(y,1),y.m(h.parentNode,h)):y&&(Ha(),zt(y,1,1,()=>{y=null}),Ja())},i(v){f||(vt(y),f=!0)},o(v){zt(y),f=!1},d(v){y&&y.d(v),v&&ie(h)}}}function Z0(c,h,f){let{$$slots:y={},$$scope:v}=h,{id:w}=h,{type:a}=h,{url:A=null}=h,{props:E={}}=h,{data:P=null}=h,{layer:M=null}=h,{promoteId:V=null}=h,{minzoom:B=null}=h,{maxzoom:N=null}=h,ue=!1;const{getMap:ze}=Lc("map"),Ae=ze();Ae.getSource(w)&&Ae.removeSource(w);function Ie(){Ae.isSourceLoaded(w)?(f(0,ue=!0),console.log(w+" loaded!")):setTimeout(()=>{console.log("..."),Ie()},500)}function Me(){Ae.isStyleLoaded(w)?(ft(),document.querySelector("#map canvas")&&document.querySelector("#map canvas").tabIndex=="0"&&(document.querySelector("#map canvas").tabIndex="-1")):setTimeout(()=>{console.log("..."),Me()},500)}B&&(E.minzoom=B),N&&(E.maxzoom=N),M&&V?(E.promoteId={},E.promoteId[M]=V):V&&(E.promoteId=V);function ft(){console.log(w+" map source loading..."),a=="geojson"?P?(Ae.addSource(w,{type:a,data:P,...E}),Ie()):A&&(Ae.addSource(w,{type:a,data:A,...E}),Ie()):a=="vector"&&(Ae.addSource(w,{type:a,tiles:[A],...E}),Ie())}Me();function Pt(){Ae.getSource(w).setData(P)}return c.$$set=ve=>{"id"in ve&&f(2,w=ve.id),"type"in ve&&f(3,a=ve.type),"url"in ve&&f(4,A=ve.url),"props"in ve&&f(1,E=ve.props),"data"in ve&&f(5,P=ve.data),"layer"in ve&&f(6,M=ve.layer),"promoteId"in ve&&f(7,V=ve.promoteId),"minzoom"in ve&&f(8,B=ve.minzoom),"maxzoom"in ve&&f(9,N=ve.maxzoom),"$$scope"in ve&&f(10,v=ve.$$scope)},c.$$.update=()=>{c.$$.dirty&33&&ue&&P&&Pt()},[ue,E,w,a,A,P,M,V,B,N,v,y]}class cy extends ea{constructor(h){super(),ta(this,h,Z0,q0,ra,{id:2,type:3,url:4,props:1,data:5,layer:6,promoteId:7,minzoom:8,maxzoom:9})}}function G0(c,h,f){const{Popup:y}=N0,v=Nm(),w=new y({closeButton:!1,closeOnClick:!1});let{id:a}=h,{source:A}=h,{sourceLayer:E=null}=h,{type:P}=h,{filter:M=null}=h,{layout:V={}}=h,{paint:B={}}=h,{data:N=null}=h,{code:ue=null}=h,{name:ze="name"}=h,{colorCode:Ae=null}=h,{click:Ie=!1}=h,{ignoreClick:Me=!1}=h,{clickCenter:ft=!1}=h,{selected:Pt=null}=h,{hover:ve=!1}=h,{hovered:je=null}=h,{highlight:ur=!1}=h,{highlightKey:cr="highlighted"}=h,{highlighted:pt=[]}=h,{order:hr=null}=h,{maxzoom:gt=null}=h,{minzoom:nt=null}=h,{isChild:xt=!1}=h;const{getMap:er}=Lc("map"),We=er();let nr=null,wr=null,Nt=[];We.getLayer(a)&&We.removeLayer(a);let qt={id:a,type:P,source:A,paint:B,layout:V};M&&(qt.filter=M),E&&(qt["source-layer"]=E),gt&&(qt.maxzoom=gt),nt&&(qt.minzoom=nt),We.addLayer(qt,hr);function ht(){console.log("updating colors..."),N.forEach(He=>{We.setFeatureState({source:A,sourceLayer:E,id:He[ue]},{color:He[Ae]})})}return Ie&&We.on("click",a,He=>{if(He.features.length>0&&!Me){let Sr=He.features[0].id;if(xt&&pt.includes(Sr)||!xt&&Pt!=Sr){if(f(0,Pt=Sr),v("select",{code:Pt}),nr&&We.setFeatureState({source:A,sourceLayer:E,id:nr},{selected:!1}),We.setFeatureState({source:A,sourceLayer:E,id:Pt},{selected:!0}),ft){let Hi=centroid(He.features[0].toJSON().geometry);We.flyTo({center:Hi.geometry.coordinates})}f(24,nr=Pt)}}}),ve&&(We.on("mousemove",a,He=>{if(He.features.length>0){let Sr=He.features[0].id;je&&We.setFeatureState({source:A,sourceLayer:E,id:je},{hovered:!1}),xt&&pt.includes(Sr)||!xt&&Pt!=Sr?(f(1,je=f(25,wr=Sr)),We.setFeatureState({source:A,sourceLayer:E,id:je},{hovered:!0}),We.getCanvas().style.cursor="pointer",w.setLngLat(He.lngLat).setHTML(`<strong>${He.features[0].properties[ze]?He.features[0].properties[ze]:He.features[0].properties[ue]}</strong>`).addTo(We)):w.remove()}}),We.on("mouseleave",a,He=>{je&&We.setFeatureState({source:A,sourceLayer:E,id:je},{hovered:!1}),f(1,je=f(25,wr=null)),We.getCanvas().style.cursor="",w.remove()})),c.$$set=He=>{"id"in He&&f(2,a=He.id),"source"in He&&f(3,A=He.source),"sourceLayer"in He&&f(4,E=He.sourceLayer),"type"in He&&f(5,P=He.type),"filter"in He&&f(6,M=He.filter),"layout"in He&&f(7,V=He.layout),"paint"in He&&f(8,B=He.paint),"data"in He&&f(9,N=He.data),"code"in He&&f(10,ue=He.code),"name"in He&&f(11,ze=He.name),"colorCode"in He&&f(12,Ae=He.colorCode),"click"in He&&f(13,Ie=He.click),"ignoreClick"in He&&f(14,Me=He.ignoreClick),"clickCenter"in He&&f(15,ft=He.clickCenter),"selected"in He&&f(0,Pt=He.selected),"hover"in He&&f(16,ve=He.hover),"hovered"in He&&f(1,je=He.hovered),"highlight"in He&&f(17,ur=He.highlight),"highlightKey"in He&&f(18,cr=He.highlightKey),"highlighted"in He&&f(19,pt=He.highlighted),"order"in He&&f(20,hr=He.order),"maxzoom"in He&&f(21,gt=He.maxzoom),"minzoom"in He&&f(22,nt=He.minzoom),"isChild"in He&&f(23,xt=He.isChild)},c.$$.update=()=>{c.$$.dirty[0]&4096&&Ae&&ht(),c.$$.dirty[0]&68026392&&ur&&pt!=Nt&&(Nt[0]&&Nt.forEach(He=>{let Sr={};Sr[cr]=!1,We.setFeatureState({source:A,sourceLayer:E,id:He},Sr)}),f(26,Nt=pt),pt[0]&&pt.forEach(He=>{let Sr={};Sr[cr]=!0,We.setFeatureState({source:A,sourceLayer:E,id:He},Sr)})),c.$$.dirty[0]&16777241&&Pt!=nr&&(nr&&We.setFeatureState({source:A,sourceLayer:E,id:nr},{selected:!1}),Pt&&We.setFeatureState({source:A,sourceLayer:E,id:Pt},{selected:!0}),f(24,nr=Pt)),c.$$.dirty[0]&33619994&&ve&&je!=wr&&(wr&&We.setFeatureState({source:A,sourceLayer:E,id:wr},{hovered:!1}),je&&We.setFeatureState({source:A,sourceLayer:E,id:je},{hovered:!0}),f(25,wr=je))},[Pt,je,a,A,E,P,M,V,B,N,ue,ze,Ae,Ie,Me,ft,ve,ur,cr,pt,hr,gt,nt,xt,nr,wr,Nt]}class Uu extends ea{constructor(h){super(),ta(this,h,G0,null,ra,{id:2,source:3,sourceLayer:4,type:5,filter:6,layout:7,paint:8,data:9,code:10,name:11,colorCode:12,click:13,ignoreClick:14,clickCenter:15,selected:0,hover:16,hovered:1,highlight:17,highlightKey:18,highlighted:19,order:20,maxzoom:21,minzoom:22,isChild:23},null,[-1,-1])}}function ym(c,h,f){const y=c.slice();return y[22]=h[f],y[24]=f,y}function gm(c,h,f){const y=c.slice();return y[25]=h[f],y[24]=f,y}function _m(c,h,f){const y=c.slice();return y[27]=h[f],y}function vm(c,h,f){const y=c.slice();return y[27]=h[f],y}function xm(c,h,f){const y=c.slice();return y[25]=h[f],y[24]=f,y}function bm(c){let h,f,y,v,w=c[1].name+"",a,A,E,P,M,V,B,N,ue,ze,Ae,Ie,Me,ft,Pt,ve,je,ur,cr,pt,hr,gt,nt,xt,er,We,nr,wr,Nt,qt,ht,He,Sr=c[1].data.population.value[2011].all.toLocaleString()+"",Hi,Zn,Gn,mi,vr,Kn,Zt,Vi,So,on,Gt,Cn,ti,oi=c[1].data.density.value[2011].all.toLocaleString()+"",Xn,ji,Ci,yi,an,mn,gi,_i,Fr,kr,Wn,yn,gn,lo,Hn,Ji,Mi,uo,Mn,Yi,sn,ko,Jn=c[1].name+"",_n,ln,un,Qi,Dn,pr,L,O=(c[1].children[0]?Ui[c[1].children[0].type].pl:"Areas")+"",q,W,J=c[1].name+"",se,he,j,Q,me,Be,Ne,Se,Oe=c[1].name+"",rt,et,we,Qe,Ge,Ze,Ct,$e,Kt,sr,Ft,Ot,Xt,Xr=c[1].name+"",tr,Cr,or,Ut,Dt,Wr,Yn,Hr,hi,Lo,vn,zr=c[1].data.agemed.value[2011].all.toLocaleString()+"",Qn,ai,Or,Di,xr,cn,Li,Ti,mr,co,Nr,Jr,xn,vi,ho,Eo,Ro,ia,Os,$n,Ta,Ia,ms,Bo,po,na,To,eo,hn,fo,de,ri,xi,yr,bn,pn,ii,Aa,oa,zl,za,Pa,Ns,Us,Vs,aa,ll,Ca,Fo,$a,ul,Ii,Oo,No,wn,mo,sa,Uo,la,Ln,Vo,ua,es,Er,Pl,ys,ca,Cl,Ri,cl,Ma,si=c[1].parents[0]&&wm(c);M=new O0({props:{options:c[0],group:"typestr",search:!0}}),M.$on("select",c[13]);function Da(ye,ct){return ye[1].type=="ew"||ye[1].type=="ctry"?X0:K0}let js=Da(c),yo=js(c),qi=c[9]&&km(c);const La=[H0,W0],ha=[];function Ra(ye,ct){return ye[4]?ye[9]?1:-1:0}~(mi=Ra(c))&&(vr=ha[mi]=La[mi](c));const Ba=[$0,Q0],pa=[];function gs(ye,ct){return ye[4]?ye[9]?1:-1:0}~(Fr=gs(c))&&(kr=pa[Fr]=Ba[Fr](c));function Ur(ye){c[16](ye)}let qs={location:{bounds:c[1].bounds},options:{fitBoundsOptions:{padding:20}},style:Kg,$$slots:{default:[n1]},$$scope:{ctx:c}};c[6]!==void 0&&(qs.map=c[6]),Mi=new j0({props:qs}),sl.push(()=>Zg(Mi,"map",Ur));function iu(ye,ct){return ye[1].parents[0]?a1:o1}let fa=iu(c),go=fa(c);function nu(ye,ct){return ye[1].children[0]?l1:s1}let Zs=nu(c),Rn=Zs(c);function ts(ye,ct){return ye[1].type=="ew"||ye[1].type=="ctry"?c1:u1}let Fa=ts(c),Bn=Fa(c);const _s=[p1,h1],to=[];function Ml(ye,ct){return ct[0]&18&&(Li=null),Li==null&&(Li=!ye[4]&&!["ew","ctry"].includes(ye[1].type)),Li?0:ye[9]?1:-1}~(Ti=Ml(c,[-1,-1]))&&(mr=to[Ti]=_s[Ti](c)),Ro=new Uv({props:{data:c[1]&&c[11](["age10yr","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null}});let bi=c[10]&&!(c[4]&&!c[9])&&Rm(c);return po=new Yl({props:{data:c[1]&&c[11](["population","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),ri=new Yl({props:{data:c[1]&&c[11](["topic_new","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),oa=new Yl({props:{data:c[1]&&c[11](["ethnicity","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),aa=new Yl({props:{data:c[1]&&c[11](["health","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),Oo=new Yl({props:{data:c[1]&&c[11](["economic","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),Ln=new Yl({props:{data:c[1]&&c[11](["travel","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),ca=new Yl({props:{data:c[1]&&c[11](["tenure","perc","2011"]),zKey:c[4]&&c[9]?"prev":!c[4]&&c[1].type!="ew"?"ew":null,label:c[10]}}),{c(){h=De("div"),f=De("div"),si&&si.c(),y=st(),v=De("span"),a=Pe(w),A=st(),E=De("div"),P=De("div"),jr(M.$$.fragment),V=st(),B=De("div"),N=De("div"),ue=Pe(`Comparison:
		`),ze=De("button"),Ae=Pe("National-level figures"),Ie=st(),Me=De("button"),ft=Pe("Change from 2001"),Pt=st(),ve=De("div"),je=De("div"),ur=De("h3"),cr=Pe("Overview "),pt=De("span"),hr=Pe("Census 2011"),gt=st(),nt=De("div"),yo.c(),xt=st(),qi&&qi.c(),er=st(),We=De("div"),nr=De("span"),wr=Pe("Population"),Nt=st(),qt=De("br"),ht=st(),He=De("span"),Hi=Pe(Sr),Zn=De("br"),Gn=st(),vr&&vr.c(),Kn=st(),Zt=De("div"),Vi=De("span"),So=Pe("Density"),on=st(),Gt=De("br"),Cn=st(),ti=De("span"),Xn=Pe(oi),ji=st(),Ci=De("span"),yi=Pe("people"),an=De("br"),mn=Pe("per hectare"),gi=De("br"),_i=st(),kr&&kr.c(),Wn=st(),yn=De("div"),gn=De("h3"),lo=Pe("Explore related areas"),Hn=st(),Ji=De("div"),jr(Mi.$$.fragment),Mn=st(),Yi=De("div"),sn=De("span"),ko=Pe("Parents of "),_n=Pe(Jn),ln=De("br"),un=st(),Qi=De("span"),go.c(),Dn=st(),pr=De("div"),L=De("span"),q=Pe(O),W=Pe(" within "),se=Pe(J),he=De("br"),j=st(),Q=De("span"),Rn.c(),me=st(),Be=De("div"),Ne=De("h3"),Se=Pe("Key stats for "),rt=Pe(Oe),et=st(),we=De("span"),Qe=Pe("Census 2011"),Ge=st(),Ze=De("div"),Ct=De("span"),$e=Pe("Location"),Kt=De("br"),sr=st(),Bn.c(),Ft=st(),Ot=De("a"),Xt=Pe("Data for "),tr=Pe(Xr),Cr=Pe(" can be downloaded here"),Ut=st(),Dt=De("div"),Wr=De("span"),Yn=Pe("Median age"),Hr=st(),hi=De("br"),Lo=st(),vn=De("span"),Qn=Pe(zr),ai=st(),Or=De("span"),Di=Pe("years"),xr=De("br"),cn=st(),mr&&mr.c(),co=st(),Nr=De("div"),Jr=De("span"),xn=Pe("Age profile"),vi=De("br"),ho=st(),Eo=De("div"),jr(Ro.$$.fragment),ia=st(),bi&&bi.c(),Os=st(),$n=De("div"),Ta=De("span"),Ia=Pe("Sex"),ms=De("br"),Bo=st(),jr(po.$$.fragment),na=st(),To=De("div"),eo=De("span"),hn=Pe("Food adjusted"),fo=De("br"),de=st(),jr(ri.$$.fragment),xi=st(),yr=De("div"),bn=De("span"),pn=Pe("Ethnicity adjusted"),ii=De("br"),Aa=st(),jr(oa.$$.fragment),zl=st(),za=De("div"),Pa=De("span"),Ns=Pe("General Health"),Us=De("br"),Vs=st(),jr(aa.$$.fragment),ll=st(),Ca=De("div"),Fo=De("span"),$a=Pe("Employment"),ul=De("br"),Ii=st(),jr(Oo.$$.fragment),No=st(),wn=De("div"),mo=De("span"),sa=Pe("Travel to work"),Uo=De("br"),la=st(),jr(Ln.$$.fragment),Vo=st(),ua=De("div"),es=De("span"),Er=Pe("Home ownership"),Pl=De("br"),ys=st(),jr(ca.$$.fragment),this.h()},l(ye){h=Le(ye,"DIV",{class:!0});var ct=Ve(h);f=Le(ct,"DIV",{});var Oa=Ve(f);si&&si.l(Oa),y=lt(Oa),v=Le(Oa,"SPAN",{class:!0});var rs=Ve(v);a=Ce(rs,w),rs.forEach(ie),Oa.forEach(ie),A=lt(ct),E=Le(ct,"DIV",{});var _o=Ve(E);P=Le(_o,"DIV",{style:!0,class:!0});var Io=Ve(P);qr(M.$$.fragment,Io),Io.forEach(ie),_o.forEach(ie),ct.forEach(ie),V=lt(ye),B=Le(ye,"DIV",{class:!0});var da=Ve(B);N=Le(da,"DIV",{class:!0});var Ao=Ve(N);ue=Ce(Ao,`Comparison:
		`),ze=Le(Ao,"BUTTON",{class:!0});var jo=Ve(ze);Ae=Ce(jo,"National-level figures"),jo.forEach(ie),Ie=lt(Ao),Me=Le(Ao,"BUTTON",{class:!0});var is=Ve(Me);ft=Ce(is,"Change from 2001"),is.forEach(ie),Ao.forEach(ie),da.forEach(ie),Pt=lt(ye),ve=Le(ye,"DIV",{id:!0,class:!0});var Jt=Ve(ve);je=Le(Jt,"DIV",{style:!0});var ma=Ve(je);ur=Le(ma,"H3",{class:!0});var ya=Ve(ur);cr=Ce(ya,"Overview "),pt=Le(ya,"SPAN",{class:!0});var Na=Ve(pt);hr=Ce(Na,"Census 2011"),Na.forEach(ie),ya.forEach(ie),ma.forEach(ie),gt=lt(Jt),nt=Le(Jt,"DIV",{});var vo=Ve(nt);yo.l(vo),xt=lt(vo),qi&&qi.l(vo),vo.forEach(ie),er=lt(Jt),We=Le(Jt,"DIV",{});var zo=Ve(We);nr=Le(zo,"SPAN",{class:!0});var hl=Ve(nr);wr=Ce(hl,"Population"),hl.forEach(ie),Nt=lt(zo),qt=Le(zo,"BR",{}),ht=lt(zo),He=Le(zo,"SPAN",{class:!0});var pl=Ve(He);Hi=Ce(pl,Sr),pl.forEach(ie),Zn=Le(zo,"BR",{}),Gn=lt(zo),vr&&vr.l(zo),zo.forEach(ie),Kn=lt(Jt),Zt=Le(Jt,"DIV",{});var Sn=Ve(Zt);Vi=Le(Sn,"SPAN",{class:!0});var Dl=Ve(Vi);So=Ce(Dl,"Density"),Dl.forEach(ie),on=lt(Sn),Gt=Le(Sn,"BR",{}),Cn=lt(Sn),ti=Le(Sn,"SPAN",{class:!0});var Ua=Ve(ti);Xn=Ce(Ua,oi),Ua.forEach(ie),ji=lt(Sn),Ci=Le(Sn,"SPAN",{class:!0});var Lr=Ve(Ci);yi=Ce(Lr,"people"),an=Le(Lr,"BR",{}),mn=Ce(Lr,"per hectare"),Lr.forEach(ie),gi=Le(Sn,"BR",{}),_i=lt(Sn),kr&&kr.l(Sn),Sn.forEach(ie),Wn=lt(Jt),yn=Le(Jt,"DIV",{style:!0});var Gs=Ve(yn);gn=Le(Gs,"H3",{class:!0});var Va=Ve(gn);lo=Ce(Va,"Explore related areas"),Va.forEach(ie),Gs.forEach(ie),Hn=lt(Jt),Ji=Le(Jt,"DIV",{id:!0,style:!0,class:!0});var ga=Ve(Ji);qr(Mi.$$.fragment,ga),ga.forEach(ie),Mn=lt(Jt),Yi=Le(Jt,"DIV",{});var $t=Ve(Yi);sn=Le($t,"SPAN",{class:!0});var Mr=Ve(sn);ko=Ce(Mr,"Parents of "),_n=Ce(Mr,Jn),Mr.forEach(ie),ln=Le($t,"BR",{}),un=lt($t),Qi=Le($t,"SPAN",{class:!0});var Fn=Ve(Qi);go.l(Fn),Fn.forEach(ie),$t.forEach(ie),Dn=lt(Jt),pr=Le(Jt,"DIV",{});var _a=Ve(pr);L=Le(_a,"SPAN",{class:!0});var va=Ve(L);q=Ce(va,O),W=Ce(va," within "),se=Ce(va,J),va.forEach(ie),he=Le(_a,"BR",{}),j=lt(_a),Q=Le(_a,"SPAN",{class:!0});var vs=Ve(Q);Rn.l(vs),vs.forEach(ie),_a.forEach(ie),me=lt(Jt),Be=Le(Jt,"DIV",{style:!0});var ou=Ve(Be);Ne=Le(ou,"H3",{class:!0});var Ks=Ve(Ne);Se=Ce(Ks,"Key stats for "),rt=Ce(Ks,Oe),et=lt(Ks),we=Le(Ks,"SPAN",{class:!0});var xs=Ve(we);Qe=Ce(xs,"Census 2011"),xs.forEach(ie),Ks.forEach(ie),ou.forEach(ie),Ge=lt(Jt),Ze=Le(Jt,"DIV",{});var Po=Ve(Ze);Ct=Le(Po,"SPAN",{class:!0});var qo=Ve(Ct);$e=Ce(qo,"Location"),qo.forEach(ie),Kt=Le(Po,"BR",{}),sr=lt(Po),Bn.l(Po),Ft=lt(Po),Ot=Le(Po,"A",{href:!0,class:!0});var ni=Ve(Ot);Xt=Ce(ni,"Data for "),tr=Ce(ni,Xr),Cr=Ce(ni," can be downloaded here"),ni.forEach(ie),Po.forEach(ie),Ut=lt(Jt),Dt=Le(Jt,"DIV",{});var kn=Ve(Dt);Wr=Le(kn,"SPAN",{class:!0});var Ll=Ve(Wr);Yn=Ce(Ll,"Median age"),Ll.forEach(ie),Hr=lt(kn),hi=Le(kn,"BR",{}),Lo=lt(kn),vn=Le(kn,"SPAN",{class:!0});var li=Ve(vn);Qn=Ce(li,zr),li.forEach(ie),ai=lt(kn),Or=Le(kn,"SPAN",{class:!0});var at=Ve(Or);Di=Ce(at,"years"),at.forEach(ie),xr=Le(kn,"BR",{}),cn=lt(kn),mr&&mr.l(kn),kn.forEach(ie),co=lt(Jt),Nr=Le(Jt,"DIV",{});var Ai=Ve(Nr);Jr=Le(Ai,"SPAN",{class:!0});var Xs=Ve(Jr);xn=Ce(Xs,"Age profile"),Xs.forEach(ie),vi=Le(Ai,"BR",{}),ho=lt(Ai),Eo=Le(Ai,"DIV",{class:!0,style:!0});var ns=Ve(Eo);qr(Ro.$$.fragment,ns),ns.forEach(ie),ia=lt(Ai),bi&&bi.l(Ai),Ai.forEach(ie),Os=lt(Jt),$n=Le(Jt,"DIV",{});var En=Ve($n);Ta=Le(En,"SPAN",{class:!0});var Tn=Ve(Ta);Ia=Ce(Tn,"Sex"),Tn.forEach(ie),ms=Le(En,"BR",{}),Bo=lt(En),qr(po.$$.fragment,En),En.forEach(ie),na=lt(Jt),To=Le(Jt,"DIV",{});var os=Ve(To);eo=Le(os,"SPAN",{class:!0});var Ye=Ve(eo);hn=Ce(Ye,"Food adjusted"),Ye.forEach(ie),fo=Le(os,"BR",{}),de=lt(os),qr(ri.$$.fragment,os),os.forEach(ie),xi=lt(Jt),yr=Le(Jt,"DIV",{});var as=Ve(yr);bn=Le(as,"SPAN",{class:!0});var Ws=Ve(bn);pn=Ce(Ws,"Ethnicity adjusted"),Ws.forEach(ie),ii=Le(as,"BR",{}),Aa=lt(as),qr(oa.$$.fragment,as),as.forEach(ie),zl=lt(Jt),za=Le(Jt,"DIV",{});var ss=Ve(za);Pa=Le(ss,"SPAN",{class:!0});var ro=Ve(Pa);Ns=Ce(ro,"General Health"),ro.forEach(ie),Us=Le(ss,"BR",{}),Vs=lt(ss),qr(aa.$$.fragment,ss),ss.forEach(ie),ll=lt(Jt),Ca=Le(Jt,"DIV",{});var Zi=Ve(Ca);Fo=Le(Zi,"SPAN",{class:!0});var Hs=Ve(Fo);$a=Ce(Hs,"Employment"),Hs.forEach(ie),ul=Le(Zi,"BR",{}),Ii=lt(Zi),qr(Oo.$$.fragment,Zi),Zi.forEach(ie),No=lt(Jt),wn=Le(Jt,"DIV",{});var ja=Ve(wn);mo=Le(ja,"SPAN",{class:!0});var In=Ve(mo);sa=Ce(In,"Travel to work"),In.forEach(ie),Uo=Le(ja,"BR",{}),la=lt(ja),qr(Ln.$$.fragment,ja),ja.forEach(ie),Vo=lt(Jt),ua=Le(Jt,"DIV",{});var io=Ve(ua);es=Le(io,"SPAN",{class:!0});var Rl=Ve(es);Er=Ce(Rl,"Home ownership"),Rl.forEach(ie),Pl=Le(io,"BR",{}),ys=lt(io),qr(ca.$$.fragment,io),io.forEach(ie),Jt.forEach(ie),this.h()},h(){ce(v,"class","text-big title svelte-s16wkg"),Qt(P,"width","260px"),Qt(P,"padding-top","5px"),ce(P,"class","svelte-s16wkg"),Pi(P,"float-right",c[5]>1),ce(h,"class","grid mtl svelte-s16wkg"),ce(ze,"class","btn svelte-s16wkg"),Pi(ze,"btn-active",!c[4]),ce(Me,"class","btn svelte-s16wkg"),Pi(Me,"btn-active",c[4]),ce(N,"class","text-small"),ce(B,"class","grid mts svelte-s16wkg"),ce(pt,"class","title-inset muted svelte-s16wkg"),ce(ur,"class","svelte-s16wkg"),Qt(je,"grid-column","span "+c[5]),ce(nr,"class","text-bold"),ce(He,"class","text-big"),ce(Vi,"class","text-bold"),ce(ti,"class","inline text-big svelte-s16wkg"),ce(Ci,"class","inline condensed text-small svelte-s16wkg"),ce(gn,"class","svelte-s16wkg"),Qt(yn,"grid-column","span "+c[5]),ce(Ji,"id","map"),Qt(Ji,"grid-column","span "+(c[5]==2?2:c[5]&&c[5]>2?c[5]-1:1)),ce(Ji,"class","svelte-s16wkg"),ce(sn,"class","text-bold"),ce(Qi,"class","text-small"),ce(L,"class","text-bold"),ce(Q,"class","text-small"),ce(we,"class","title-inset muted svelte-s16wkg"),ce(Ne,"class","svelte-s16wkg"),Qt(Be,"grid-column","span "+c[5]),ce(Ct,"class","text-bold"),ce(Ot,"href",or="http://www.nisra.gov.uk/census/data_download/"+c[1].code+".xlsx"),ce(Ot,"class","svelte-s16wkg"),ce(Wr,"class","text-bold"),ce(vn,"class","inline text-big svelte-s16wkg"),ce(Or,"class","inline condensed text-small svelte-s16wkg"),ce(Jr,"class","text-bold"),ce(Eo,"class","chart svelte-s16wkg"),Qt(Eo,"height","100px"),ce(Ta,"class","text-bold"),ce(eo,"class","text-bold"),ce(bn,"class","text-bold"),ce(Pa,"class","text-bold"),ce(Fo,"class","text-bold"),ce(mo,"class","text-bold"),ce(es,"class","text-bold"),ce(ve,"id","grid"),ce(ve,"class","grid mt svelte-s16wkg"),Np(()=>c[17].call(ve))},m(ye,ct){Fe(ye,h,ct),re(h,f),si&&si.m(f,null),re(f,y),re(f,v),re(v,a),re(h,A),re(h,E),re(E,P),Zr(M,P,null),Fe(ye,V,ct),Fe(ye,B,ct),re(B,N),re(N,ue),re(N,ze),re(ze,Ae),re(N,Ie),re(N,Me),re(Me,ft),Fe(ye,Pt,ct),Fe(ye,ve,ct),re(ve,je),re(je,ur),re(ur,cr),re(ur,pt),re(pt,hr),re(ve,gt),re(ve,nt),yo.m(nt,null),re(nt,xt),qi&&qi.m(nt,null),re(ve,er),re(ve,We),re(We,nr),re(nr,wr),re(We,Nt),re(We,qt),re(We,ht),re(We,He),re(He,Hi),re(We,Zn),re(We,Gn),~mi&&ha[mi].m(We,null),re(ve,Kn),re(ve,Zt),re(Zt,Vi),re(Vi,So),re(Zt,on),re(Zt,Gt),re(Zt,Cn),re(Zt,ti),re(ti,Xn),re(Zt,ji),re(Zt,Ci),re(Ci,yi),re(Ci,an),re(Ci,mn),re(Zt,gi),re(Zt,_i),~Fr&&pa[Fr].m(Zt,null),re(ve,Wn),re(ve,yn),re(yn,gn),re(gn,lo),re(ve,Hn),re(ve,Ji),Zr(Mi,Ji,null),re(ve,Mn),re(ve,Yi),re(Yi,sn),re(sn,ko),re(sn,_n),re(Yi,ln),re(Yi,un),re(Yi,Qi),go.m(Qi,null),re(ve,Dn),re(ve,pr),re(pr,L),re(L,q),re(L,W),re(L,se),re(pr,he),re(pr,j),re(pr,Q),Rn.m(Q,null),re(ve,me),re(ve,Be),re(Be,Ne),re(Ne,Se),re(Ne,rt),re(Ne,et),re(Ne,we),re(we,Qe),re(ve,Ge),re(ve,Ze),re(Ze,Ct),re(Ct,$e),re(Ze,Kt),re(Ze,sr),Bn.m(Ze,null),re(Ze,Ft),re(Ze,Ot),re(Ot,Xt),re(Ot,tr),re(Ot,Cr),re(ve,Ut),re(ve,Dt),re(Dt,Wr),re(Wr,Yn),re(Dt,Hr),re(Dt,hi),re(Dt,Lo),re(Dt,vn),re(vn,Qn),re(Dt,ai),re(Dt,Or),re(Or,Di),re(Dt,xr),re(Dt,cn),~Ti&&to[Ti].m(Dt,null),re(ve,co),re(ve,Nr),re(Nr,Jr),re(Jr,xn),re(Nr,vi),re(Nr,ho),re(Nr,Eo),Zr(Ro,Eo,null),re(Nr,ia),bi&&bi.m(Nr,null),re(ve,Os),re(ve,$n),re($n,Ta),re(Ta,Ia),re($n,ms),re($n,Bo),Zr(po,$n,null),re(ve,na),re(ve,To),re(To,eo),re(eo,hn),re(To,fo),re(To,de),Zr(ri,To,null),re(ve,xi),re(ve,yr),re(yr,bn),re(bn,pn),re(yr,ii),re(yr,Aa),Zr(oa,yr,null),re(ve,zl),re(ve,za),re(za,Pa),re(Pa,Ns),re(za,Us),re(za,Vs),Zr(aa,za,null),re(ve,ll),re(ve,Ca),re(Ca,Fo),re(Fo,$a),re(Ca,ul),re(Ca,Ii),Zr(Oo,Ca,null),re(ve,No),re(ve,wn),re(wn,mo),re(mo,sa),re(wn,Uo),re(wn,la),Zr(Ln,wn,null),re(ve,Vo),re(ve,ua),re(ua,es),re(es,Er),re(ua,Pl),re(ua,ys),Zr(ca,ua,null),Cl=Up(ve,c[17].bind(ve)),Ri=!0,cl||(Ma=[Ea(ze,"click",c[14]),Ea(Me,"click",c[15])],cl=!0)},p(ye,ct){ye[1].parents[0]?si?si.p(ye,ct):(si=wm(ye),si.c(),si.m(f,y)):si&&(si.d(1),si=null),(!Ri||ct[0]&2)&&w!==(w=ye[1].name+"")&&yt(a,w);const Oa={};ct[0]&1&&(Oa.options=ye[0]),M.$set(Oa),ct[0]&32&&Pi(P,"float-right",ye[5]>1),ct[0]&16&&Pi(ze,"btn-active",!ye[4]),ct[0]&16&&Pi(Me,"btn-active",ye[4]),(!Ri||ct[0]&32)&&Qt(je,"grid-column","span "+ye[5]),js===(js=Da(ye))&&yo?yo.p(ye,ct):(yo.d(1),yo=js(ye),yo&&(yo.c(),yo.m(nt,xt))),ye[9]?qi?qi.p(ye,ct):(qi=km(ye),qi.c(),qi.m(nt,null)):qi&&(qi.d(1),qi=null),(!Ri||ct[0]&2)&&Sr!==(Sr=ye[1].data.population.value[2011].all.toLocaleString()+"")&&yt(Hi,Sr);let rs=mi;mi=Ra(ye),mi===rs?~mi&&ha[mi].p(ye,ct):(vr&&(Ha(),zt(ha[rs],1,1,()=>{ha[rs]=null}),Ja()),~mi?(vr=ha[mi],vr?vr.p(ye,ct):(vr=ha[mi]=La[mi](ye),vr.c()),vt(vr,1),vr.m(We,null)):vr=null),(!Ri||ct[0]&2)&&oi!==(oi=ye[1].data.density.value[2011].all.toLocaleString()+"")&&yt(Xn,oi);let _o=Fr;Fr=gs(ye),Fr===_o?~Fr&&pa[Fr].p(ye,ct):(kr&&(Ha(),zt(pa[_o],1,1,()=>{pa[_o]=null}),Ja()),~Fr?(kr=pa[Fr],kr?kr.p(ye,ct):(kr=pa[Fr]=Ba[Fr](ye),kr.c()),vt(kr,1),kr.m(Zt,null)):kr=null),(!Ri||ct[0]&32)&&Qt(yn,"grid-column","span "+ye[5]);const Io={};ct[0]&2&&(Io.location={bounds:ye[1].bounds}),ct[0]&384|ct[1]&4&&(Io.$$scope={dirty:ct,ctx:ye}),!uo&&ct[0]&64&&(uo=!0,Io.map=ye[6],Gg(()=>uo=!1)),Mi.$set(Io),(!Ri||ct[0]&32)&&Qt(Ji,"grid-column","span "+(ye[5]==2?2:ye[5]&&ye[5]>2?ye[5]-1:1)),(!Ri||ct[0]&2)&&Jn!==(Jn=ye[1].name+"")&&yt(_n,Jn),fa===(fa=iu(ye))&&go?go.p(ye,ct):(go.d(1),go=fa(ye),go&&(go.c(),go.m(Qi,null))),(!Ri||ct[0]&2)&&O!==(O=(ye[1].children[0]?Ui[ye[1].children[0].type].pl:"Areas")+"")&&yt(q,O),(!Ri||ct[0]&2)&&J!==(J=ye[1].name+"")&&yt(se,J),Zs===(Zs=nu(ye))&&Rn?Rn.p(ye,ct):(Rn.d(1),Rn=Zs(ye),Rn&&(Rn.c(),Rn.m(Q,null))),(!Ri||ct[0]&2)&&Oe!==(Oe=ye[1].name+"")&&yt(rt,Oe),(!Ri||ct[0]&32)&&Qt(Be,"grid-column","span "+ye[5]),Fa===(Fa=ts(ye))&&Bn?Bn.p(ye,ct):(Bn.d(1),Bn=Fa(ye),Bn&&(Bn.c(),Bn.m(Ze,Ft))),(!Ri||ct[0]&2)&&Xr!==(Xr=ye[1].name+"")&&yt(tr,Xr),(!Ri||ct[0]&2&&or!==(or="http://www.nisra.gov.uk/census/data_download/"+ye[1].code+".xlsx"))&&ce(Ot,"href",or),(!Ri||ct[0]&2)&&zr!==(zr=ye[1].data.agemed.value[2011].all.toLocaleString()+"")&&yt(Qn,zr);let da=Ti;Ti=Ml(ye,ct),Ti===da?~Ti&&to[Ti].p(ye,ct):(mr&&(Ha(),zt(to[da],1,1,()=>{to[da]=null}),Ja()),~Ti?(mr=to[Ti],mr?mr.p(ye,ct):(mr=to[Ti]=_s[Ti](ye),mr.c()),vt(mr,1),mr.m(Dt,null)):mr=null);const Ao={};ct[0]&2&&(Ao.data=ye[1]&&ye[11](["age10yr","perc","2011"])),ct[0]&530&&(Ao.zKey=ye[4]&&ye[9]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),Ro.$set(Ao),ye[10]&&!(ye[4]&&!ye[9])?bi?bi.p(ye,ct):(bi=Rm(ye),bi.c(),bi.m(Nr,null)):bi&&(bi.d(1),bi=null);const jo={};ct[0]&2&&(jo.data=ye[1]&&ye[11](["population","perc","2011"])),ct[0]&530&&(jo.zKey=ye[4]&&ye[9]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ct[0]&1024&&(jo.label=ye[10]),po.$set(jo);const is={};ct[0]&2&&(is.data=ye[1]&&ye[11](["topic_new","perc","2011"])),ct[0]&530&&(is.zKey=ye[4]&&ye[9]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ct[0]&1024&&(is.label=ye[10]),ri.$set(is);const Jt={};ct[0]&2&&(Jt.data=ye[1]&&ye[11](["ethnicity","perc","2011"])),ct[0]&530&&(Jt.zKey=ye[4]&&ye[9]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ct[0]&1024&&(Jt.label=ye[10]),oa.$set(Jt);const ma={};ct[0]&2&&(ma.data=ye[1]&&ye[11](["health","perc","2011"])),ct[0]&530&&(ma.zKey=ye[4]&&ye[9]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ct[0]&1024&&(ma.label=ye[10]),aa.$set(ma);const ya={};ct[0]&2&&(ya.data=ye[1]&&ye[11](["economic","perc","2011"])),ct[0]&530&&(ya.zKey=ye[4]&&ye[9]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ct[0]&1024&&(ya.label=ye[10]),Oo.$set(ya);const Na={};ct[0]&2&&(Na.data=ye[1]&&ye[11](["travel","perc","2011"])),ct[0]&530&&(Na.zKey=ye[4]&&ye[9]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ct[0]&1024&&(Na.label=ye[10]),Ln.$set(Na);const vo={};ct[0]&2&&(vo.data=ye[1]&&ye[11](["tenure","perc","2011"])),ct[0]&530&&(vo.zKey=ye[4]&&ye[9]?"prev":!ye[4]&&ye[1].type!="ew"?"ew":null),ct[0]&1024&&(vo.label=ye[10]),ca.$set(vo)},i(ye){Ri||(vt(M.$$.fragment,ye),vt(vr),vt(kr),vt(Mi.$$.fragment,ye),vt(mr),vt(Ro.$$.fragment,ye),vt(po.$$.fragment,ye),vt(ri.$$.fragment,ye),vt(oa.$$.fragment,ye),vt(aa.$$.fragment,ye),vt(Oo.$$.fragment,ye),vt(Ln.$$.fragment,ye),vt(ca.$$.fragment,ye),Ri=!0)},o(ye){zt(M.$$.fragment,ye),zt(vr),zt(kr),zt(Mi.$$.fragment,ye),zt(mr),zt(Ro.$$.fragment,ye),zt(po.$$.fragment,ye),zt(ri.$$.fragment,ye),zt(oa.$$.fragment,ye),zt(aa.$$.fragment,ye),zt(Oo.$$.fragment,ye),zt(Ln.$$.fragment,ye),zt(ca.$$.fragment,ye),Ri=!1},d(ye){ye&&ie(h),si&&si.d(),Gr(M),ye&&ie(V),ye&&ie(B),ye&&ie(Pt),ye&&ie(ve),yo.d(),qi&&qi.d(),~mi&&ha[mi].d(),~Fr&&pa[Fr].d(),Gr(Mi),go.d(),Rn.d(),Bn.d(),~Ti&&to[Ti].d(),Gr(Ro),bi&&bi.d(),Gr(po),Gr(ri),Gr(oa),Gr(aa),Gr(Oo),Gr(Ln),Gr(ca),Cl(),cl=!1,Ku(Ma)}}}function wm(c){let h,f,y=c[1].name+"",v,w,a,A=[...c[1].parents].reverse(),E=[];for(let P=0;P<A.length;P+=1)E[P]=Sm(xm(c,A,P));return{c(){h=De("span");for(let P=0;P<E.length;P+=1)E[P].c();f=st(),v=Pe(y),w=st(),a=De("br"),this.h()},l(P){h=Le(P,"SPAN",{class:!0});var M=Ve(h);for(let V=0;V<E.length;V+=1)E[V].l(M);f=lt(M),v=Ce(M,y),w=lt(M),M.forEach(ie),a=Le(P,"BR",{}),this.h()},h(){ce(h,"class","text-small")},m(P,M){Fe(P,h,M);for(let V=0;V<E.length;V+=1)E[V].m(h,null);re(h,f),re(h,v),re(h,w),Fe(P,a,M)},p(P,M){if(M[0]&2){A=[...P[1].parents].reverse();let V;for(V=0;V<A.length;V+=1){const B=xm(P,A,V);E[V]?E[V].p(B,M):(E[V]=Sm(B),E[V].c(),E[V].m(h,f))}for(;V<E.length;V+=1)E[V].d(1);E.length=A.length}M[0]&2&&y!==(y=P[1].name+"")&&yt(v,y)},d(P){P&&ie(h),ds(E,P),P&&ie(a)}}}function Sm(c){let h,f=c[25].name+"",y,v,w,a=" &gt; ",A;return{c(){h=De("a"),y=Pe(f),w=new Um(!1),A=Br(),this.h()},l(E){h=Le(E,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var P=Ve(h);y=Ce(P,f),P.forEach(ie),w=Vm(E,!1),A=Br(),this.h()},h(){ce(h,"href",v=Bs+"/"+c[25].code+"/"),ce(h,"sveltekit:noscroll",""),ce(h,"class","svelte-s16wkg"),w.a=A},m(E,P){Fe(E,h,P),re(h,y),w.m(a,E,P),Fe(E,A,P)},p(E,P){P[0]&2&&f!==(f=E[25].name+"")&&yt(y,f),P[0]&2&&v!==(v=Bs+"/"+E[25].code+"/")&&ce(h,"href",v)},d(E){E&&ie(h),E&&ie(A),E&&w.d()}}}function K0(c){let h=c[1].name+"",f,y,v=Ui[c[1].type].name.toLowerCase()+"",w,a,A=(c[1].parents[0].type=="rgn"?"the "+c[1].parents[0].name:c[1].parents[0].name)+"",E,P,M=Ui[c[1].type].name.toLowerCase()+"",V,B,N=c[1].data.population.value[2011].all.toLocaleString()+"",ue,ze,Ae=c[1].data.population.value_rank[2011].all.toLocaleString()+"",Ie,Me=$o(c[1].data.population.value_rank[2011].all)+"",ft,Pt;return{c(){f=Pe(h),y=Pe(" is a "),w=Pe(v),a=Pe(" in "),E=Pe(A),P=Pe(`.
			The `),V=Pe(M),B=Pe("'s population of "),ue=Pe(N),ze=Pe(" at the time of the 2011 Census made it the country's "),Ie=Pe(Ae),ft=Pe(Me),Pt=Pe(" largest.")},l(ve){f=Ce(ve,h),y=Ce(ve," is a "),w=Ce(ve,v),a=Ce(ve," in "),E=Ce(ve,A),P=Ce(ve,`.
			The `),V=Ce(ve,M),B=Ce(ve,"'s population of "),ue=Ce(ve,N),ze=Ce(ve," at the time of the 2011 Census made it the country's "),Ie=Ce(ve,Ae),ft=Ce(ve,Me),Pt=Ce(ve," largest.")},m(ve,je){Fe(ve,f,je),Fe(ve,y,je),Fe(ve,w,je),Fe(ve,a,je),Fe(ve,E,je),Fe(ve,P,je),Fe(ve,V,je),Fe(ve,B,je),Fe(ve,ue,je),Fe(ve,ze,je),Fe(ve,Ie,je),Fe(ve,ft,je),Fe(ve,Pt,je)},p(ve,je){je[0]&2&&h!==(h=ve[1].name+"")&&yt(f,h),je[0]&2&&v!==(v=Ui[ve[1].type].name.toLowerCase()+"")&&yt(w,v),je[0]&2&&A!==(A=(ve[1].parents[0].type=="rgn"?"the "+ve[1].parents[0].name:ve[1].parents[0].name)+"")&&yt(E,A),je[0]&2&&M!==(M=Ui[ve[1].type].name.toLowerCase()+"")&&yt(V,M),je[0]&2&&N!==(N=ve[1].data.population.value[2011].all.toLocaleString()+"")&&yt(ue,N),je[0]&2&&Ae!==(Ae=ve[1].data.population.value_rank[2011].all.toLocaleString()+"")&&yt(Ie,Ae),je[0]&2&&Me!==(Me=$o(ve[1].data.population.value_rank[2011].all)+"")&&yt(ft,Me)},d(ve){ve&&ie(f),ve&&ie(y),ve&&ie(w),ve&&ie(a),ve&&ie(E),ve&&ie(P),ve&&ie(V),ve&&ie(B),ve&&ie(ue),ve&&ie(ze),ve&&ie(Ie),ve&&ie(ft),ve&&ie(Pt)}}}function X0(c){let h,f=c[1].name+"",y,v,w=c[1].data.population.value[2011].all.toLocaleString()+"",a,A;return{c(){h=Pe("The population of "),y=Pe(f),v=Pe(" was "),a=Pe(w),A=Pe(" at the time of the 2011 Census.")},l(E){h=Ce(E,"The population of "),y=Ce(E,f),v=Ce(E," was "),a=Ce(E,w),A=Ce(E," at the time of the 2011 Census.")},m(E,P){Fe(E,h,P),Fe(E,y,P),Fe(E,v,P),Fe(E,a,P),Fe(E,A,P)},p(E,P){P[0]&2&&f!==(f=E[1].name+"")&&yt(y,f),P[0]&2&&w!==(w=E[1].data.population.value[2011].all.toLocaleString()+"")&&yt(a,w)},d(E){E&&ie(h),E&&ie(y),E&&ie(v),E&&ie(a),E&&ie(A)}}}function km(c){let h=c[1].name+"",f,y,v=c[1].data.population.value.change.all>0?"increase":"decrease",w,a,A=Fs(c[1].data.population.value.change.all,"%",1)+"",E,P;return{c(){f=Pe(h),y=Pe(" saw a population "),w=Pe(v),a=Pe(" of "),E=Pe(A),P=Pe(" from 2001.")},l(M){f=Ce(M,h),y=Ce(M," saw a population "),w=Ce(M,v),a=Ce(M," of "),E=Ce(M,A),P=Ce(M," from 2001.")},m(M,V){Fe(M,f,V),Fe(M,y,V),Fe(M,w,V),Fe(M,a,V),Fe(M,E,V),Fe(M,P,V)},p(M,V){V[0]&2&&h!==(h=M[1].name+"")&&yt(f,h),V[0]&2&&v!==(v=M[1].data.population.value.change.all>0?"increase":"decrease")&&yt(w,v),V[0]&2&&A!==(A=Fs(M[1].data.population.value.change.all,"%",1)+"")&&yt(E,A)},d(M){M&&ie(f),M&&ie(y),M&&ie(w),M&&ie(a),M&&ie(E),M&&ie(P)}}}function W0(c){let h,f,y,v,w=!["ew","ctry"].includes(c[1].type),a,A;f=new Xu({props:{$$slots:{default:[J0]},$$scope:{ctx:c}}});let E=w&&Em(c);return{c(){h=De("span"),jr(f.$$.fragment),y=Pe(" since 2001"),v=st(),E&&E.c(),a=Br(),this.h()},l(P){h=Le(P,"SPAN",{class:!0});var M=Ve(h);qr(f.$$.fragment,M),y=Ce(M," since 2001"),M.forEach(ie),v=lt(P),E&&E.l(P),a=Br(),this.h()},h(){ce(h,"class","text-small")},m(P,M){Fe(P,h,M),Zr(f,h,null),re(h,y),Fe(P,v,M),E&&E.m(P,M),Fe(P,a,M),A=!0},p(P,M){const V={};M[0]&2|M[1]&4&&(V.$$scope={dirty:M,ctx:P}),f.$set(V),M[0]&2&&(w=!["ew","ctry"].includes(P[1].type)),w?E?E.p(P,M):(E=Em(P),E.c(),E.m(a.parentNode,a)):E&&(E.d(1),E=null)},i(P){A||(vt(f.$$.fragment,P),A=!0)},o(P){zt(f.$$.fragment,P),A=!1},d(P){P&&ie(h),Gr(f),P&&ie(v),E&&E.d(P),P&&ie(a)}}}function H0(c){let h,f,y=c[1].type!="ew"&&Tm(c);return{c(){y&&y.c(),h=Br()},l(v){y&&y.l(v),h=Br()},m(v,w){y&&y.m(v,w),Fe(v,h,w),f=!0},p(v,w){v[1].type!="ew"?y?(y.p(v,w),w[0]&2&&vt(y,1)):(y=Tm(v),y.c(),vt(y,1),y.m(h.parentNode,h)):y&&(Ha(),zt(y,1,1,()=>{y=null}),Ja())},i(v){f||(vt(y),f=!0)},o(v){zt(y),f=!1},d(v){y&&y.d(v),v&&ie(h)}}}function J0(c){let h,f=Fs(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=De("span"),y=Pe(f),this.h()},l(w){h=Le(w,"SPAN",{class:!0});var a=Ve(h);y=Ce(a,f),a.forEach(ie),this.h()},h(){ce(h,"class",v=Il(Al(c[1].data.population.value.change.all))+" svelte-s16wkg")},m(w,a){Fe(w,h,a),re(h,y)},p(w,a){a[0]&2&&f!==(f=Fs(w[1].data.population.value.change.all,"%",1)+"")&&yt(y,f),a[0]&2&&v!==(v=Il(Al(w[1].data.population.value.change.all))+" svelte-s16wkg")&&ce(h,"class",v)},d(w){w&&ie(h)}}}function Em(c){let h,f=c[1].data.population.value_rank.change.all.toLocaleString()+"",y,v=$o(c[1].data.population.value_rank.change.all)+"",w,a,A=c[1].count.toLocaleString()+"",E,P,M=Ui[c[1].type].pl.toLowerCase()+"",V;return{c(){h=De("div"),y=Pe(f),w=Pe(v),a=Pe(" largest increase of "),E=Pe(A),P=st(),V=Pe(M),this.h()},l(B){h=Le(B,"DIV",{class:!0});var N=Ve(h);y=Ce(N,f),w=Ce(N,v),a=Ce(N," largest increase of "),E=Ce(N,A),P=lt(N),V=Ce(N,M),N.forEach(ie),this.h()},h(){ce(h,"class","text-small muted")},m(B,N){Fe(B,h,N),re(h,y),re(h,w),re(h,a),re(h,E),re(h,P),re(h,V)},p(B,N){N[0]&2&&f!==(f=B[1].data.population.value_rank.change.all.toLocaleString()+"")&&yt(y,f),N[0]&2&&v!==(v=$o(B[1].data.population.value_rank.change.all)+"")&&yt(w,v),N[0]&2&&A!==(A=B[1].count.toLocaleString()+"")&&yt(E,A),N[0]&2&&M!==(M=Ui[B[1].type].pl.toLowerCase()+"")&&yt(V,M)},d(B){B&&ie(h)}}}function Tm(c){let h,f,y,v,w,a;f=new Xu({props:{$$slots:{default:[Y0]},$$scope:{ctx:c}}});let A=c[1].type!="ctry"&&Im(c);return{c(){h=De("span"),jr(f.$$.fragment),y=Pe(" of Northern Ireland population"),v=st(),A&&A.c(),w=Br(),this.h()},l(E){h=Le(E,"SPAN",{class:!0});var P=Ve(h);qr(f.$$.fragment,P),y=Ce(P," of Northern Ireland population"),P.forEach(ie),v=lt(E),A&&A.l(E),w=Br(),this.h()},h(){ce(h,"class","text-small")},m(E,P){Fe(E,h,P),Zr(f,h,null),re(h,y),Fe(E,v,P),A&&A.m(E,P),Fe(E,w,P),a=!0},p(E,P){const M={};P[0]&6|P[1]&4&&(M.$$scope={dirty:P,ctx:E}),f.$set(M),E[1].type!="ctry"?A?A.p(E,P):(A=Im(E),A.c(),A.m(w.parentNode,w)):A&&(A.d(1),A=null)},i(E){a||(vt(f.$$.fragment,E),a=!0)},o(E){zt(f.$$.fragment,E),a=!1},d(E){E&&ie(h),Gr(f),E&&ie(v),A&&A.d(E),E&&ie(w)}}}function Y0(c){let h=(c[1].data.population.value[2011].all/c[2].data.population.value[2011].all>=.001?(c[1].data.population.value[2011].all/c[2].data.population.value[2011].all*100).toFixed(1):"<0.1")+"",f,y;return{c(){f=Pe(h),y=Pe("%")},l(v){f=Ce(v,h),y=Ce(v,"%")},m(v,w){Fe(v,f,w),Fe(v,y,w)},p(v,w){w[0]&6&&h!==(h=(v[1].data.population.value[2011].all/v[2].data.population.value[2011].all>=.001?(v[1].data.population.value[2011].all/v[2].data.population.value[2011].all*100).toFixed(1):"<0.1")+"")&&yt(f,h)},d(v){v&&ie(f),v&&ie(y)}}}function Im(c){let h,f=c[1].data.population.value_rank[2011].all.toLocaleString()+"",y,v=$o(c[1].data.population.value_rank[2011].all)+"",w,a,A=c[1].count.toLocaleString()+"",E,P,M=Ui[c[1].type].pl.toLowerCase()+"",V;return{c(){h=De("div"),y=Pe(f),w=Pe(v),a=Pe(" largest population of "),E=Pe(A),P=st(),V=Pe(M),this.h()},l(B){h=Le(B,"DIV",{class:!0});var N=Ve(h);y=Ce(N,f),w=Ce(N,v),a=Ce(N," largest population of "),E=Ce(N,A),P=lt(N),V=Ce(N,M),N.forEach(ie),this.h()},h(){ce(h,"class","text-small muted")},m(B,N){Fe(B,h,N),re(h,y),re(h,w),re(h,a),re(h,E),re(h,P),re(h,V)},p(B,N){N[0]&2&&f!==(f=B[1].data.population.value_rank[2011].all.toLocaleString()+"")&&yt(y,f),N[0]&2&&v!==(v=$o(B[1].data.population.value_rank[2011].all)+"")&&yt(w,v),N[0]&2&&A!==(A=B[1].count.toLocaleString()+"")&&yt(E,A),N[0]&2&&M!==(M=Ui[B[1].type].pl.toLowerCase()+"")&&yt(V,M)},d(B){B&&ie(h)}}}function Q0(c){let h,f,y,v,w=!["ew","ctry"].includes(c[1].type),a,A;f=new Xu({props:{$$slots:{default:[e1]},$$scope:{ctx:c}}});let E=w&&Am(c);return{c(){h=De("span"),jr(f.$$.fragment),y=Pe(" since 2001"),v=st(),E&&E.c(),a=Br(),this.h()},l(P){h=Le(P,"SPAN",{class:!0});var M=Ve(h);qr(f.$$.fragment,M),y=Ce(M," since 2001"),M.forEach(ie),v=lt(P),E&&E.l(P),a=Br(),this.h()},h(){ce(h,"class","text-small")},m(P,M){Fe(P,h,M),Zr(f,h,null),re(h,y),Fe(P,v,M),E&&E.m(P,M),Fe(P,a,M),A=!0},p(P,M){const V={};M[0]&2|M[1]&4&&(V.$$scope={dirty:M,ctx:P}),f.$set(V),M[0]&2&&(w=!["ew","ctry"].includes(P[1].type)),w?E?E.p(P,M):(E=Am(P),E.c(),E.m(a.parentNode,a)):E&&(E.d(1),E=null)},i(P){A||(vt(f.$$.fragment,P),A=!0)},o(P){zt(f.$$.fragment,P),A=!1},d(P){P&&ie(h),Gr(f),P&&ie(v),E&&E.d(P),P&&ie(a)}}}function $0(c){let h=!["ew","ctry"].includes(c[1].type),f,y,v=h&&zm(c);return{c(){v&&v.c(),f=Br()},l(w){v&&v.l(w),f=Br()},m(w,a){v&&v.m(w,a),Fe(w,f,a),y=!0},p(w,a){a[0]&2&&(h=!["ew","ctry"].includes(w[1].type)),h?v?(v.p(w,a),a[0]&2&&vt(v,1)):(v=zm(w),v.c(),vt(v,1),v.m(f.parentNode,f)):v&&(Ha(),zt(v,1,1,()=>{v=null}),Ja())},i(w){y||(vt(v),y=!0)},o(w){zt(v),y=!1},d(w){v&&v.d(w),w&&ie(f)}}}function e1(c){let h,f=Fs(c[1].data.population.value.change.all,"%",1)+"",y,v;return{c(){h=De("span"),y=Pe(f),this.h()},l(w){h=Le(w,"SPAN",{class:!0});var a=Ve(h);y=Ce(a,f),a.forEach(ie),this.h()},h(){ce(h,"class",v=Il(Al(c[1].data.population.value.change.all))+" svelte-s16wkg")},m(w,a){Fe(w,h,a),re(h,y)},p(w,a){a[0]&2&&f!==(f=Fs(w[1].data.population.value.change.all,"%",1)+"")&&yt(y,f),a[0]&2&&v!==(v=Il(Al(w[1].data.population.value.change.all))+" svelte-s16wkg")&&ce(h,"class",v)},d(w){w&&ie(h)}}}function Am(c){let h,f=c[1].data.population.value_rank.change.all.toLocaleString()+"",y,v=$o(c[1].data.population.value_rank.change.all)+"",w,a,A=c[1].count.toLocaleString()+"",E,P,M=Ui[c[1].type].pl.toLowerCase()+"",V;return{c(){h=De("div"),y=Pe(f),w=Pe(v),a=Pe(" largest increase of "),E=Pe(A),P=st(),V=Pe(M),this.h()},l(B){h=Le(B,"DIV",{class:!0});var N=Ve(h);y=Ce(N,f),w=Ce(N,v),a=Ce(N," largest increase of "),E=Ce(N,A),P=lt(N),V=Ce(N,M),N.forEach(ie),this.h()},h(){ce(h,"class","text-small muted")},m(B,N){Fe(B,h,N),re(h,y),re(h,w),re(h,a),re(h,E),re(h,P),re(h,V)},p(B,N){N[0]&2&&f!==(f=B[1].data.population.value_rank.change.all.toLocaleString()+"")&&yt(y,f),N[0]&2&&v!==(v=$o(B[1].data.population.value_rank.change.all)+"")&&yt(w,v),N[0]&2&&A!==(A=B[1].count.toLocaleString()+"")&&yt(E,A),N[0]&2&&M!==(M=Ui[B[1].type].pl.toLowerCase()+"")&&yt(V,M)},d(B){B&&ie(h)}}}function zm(c){let h,f,y,v,w,a=c[1].data.density.value_rank[2011].all.toLocaleString()+"",A,E=$o(c[1].data.density.value_rank[2011].all)+"",P,M,V=c[1].count.toLocaleString()+"",B,N,ue=Ui[c[1].type].pl.toLowerCase()+"",ze,Ae;return f=new Xu({props:{$$slots:{default:[t1]},$$scope:{ctx:c}}}),{c(){h=De("span"),jr(f.$$.fragment),y=Pe(" average density"),v=st(),w=De("div"),A=Pe(a),P=Pe(E),M=Pe(" highest density of "),B=Pe(V),N=st(),ze=Pe(ue),this.h()},l(Ie){h=Le(Ie,"SPAN",{class:!0});var Me=Ve(h);qr(f.$$.fragment,Me),y=Ce(Me," average density"),Me.forEach(ie),v=lt(Ie),w=Le(Ie,"DIV",{class:!0});var ft=Ve(w);A=Ce(ft,a),P=Ce(ft,E),M=Ce(ft," highest density of "),B=Ce(ft,V),N=lt(ft),ze=Ce(ft,ue),ft.forEach(ie),this.h()},h(){ce(h,"class","text-small"),ce(w,"class","text-small muted")},m(Ie,Me){Fe(Ie,h,Me),Zr(f,h,null),re(h,y),Fe(Ie,v,Me),Fe(Ie,w,Me),re(w,A),re(w,P),re(w,M),re(w,B),re(w,N),re(w,ze),Ae=!0},p(Ie,Me){const ft={};Me[0]&2|Me[1]&4&&(ft.$$scope={dirty:Me,ctx:Ie}),f.$set(ft),(!Ae||Me[0]&2)&&a!==(a=Ie[1].data.density.value_rank[2011].all.toLocaleString()+"")&&yt(A,a),(!Ae||Me[0]&2)&&E!==(E=$o(Ie[1].data.density.value_rank[2011].all)+"")&&yt(P,E),(!Ae||Me[0]&2)&&V!==(V=Ie[1].count.toLocaleString()+"")&&yt(B,V),(!Ae||Me[0]&2)&&ue!==(ue=Ui[Ie[1].type].pl.toLowerCase()+"")&&yt(ze,ue)},i(Ie){Ae||(vt(f.$$.fragment,Ie),Ae=!0)},o(Ie){zt(f.$$.fragment,Ie),Ae=!1},d(Ie){Ie&&ie(h),Gr(f),Ie&&ie(v),Ie&&ie(w)}}}function t1(c){let h=Rh(c[1].count,c[1].data.density.value_rank[2011].all)+"",f;return{c(){f=Pe(h)},l(y){f=Ce(y,h)},m(y,v){Fe(y,f,v)},p(y,v){v[0]&2&&h!==(h=Rh(y[1].count,y[1].data.density.value_rank[2011].all)+"")&&yt(f,h)},d(y){y&&ie(f)}}}function r1(c){let h,f,y,v,w,a;const A=[Yo[c[27]],{id:c[27]+"-fill"},{type:"fill"},{isChild:c[8][c[27]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[27]||c[7].childType==c[27]?"visible":"none"}},{paint:c[7].type==c[27]?Ar["fill-self"]:c[7].childType==c[27]?Ar["fill-child"]:Ar.fill}];let E={};for(let N=0;N<A.length;N+=1)E=kl(E,A[N]);h=new Uu({props:E}),h.$on("select",c[12]);const P=[Yo[c[27]],{id:c[27]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[27]||c[7].childType==c[27]?"visible":"none"}},{paint:c[7].type==c[27]?Ar["line-active"]:c[7].childType==c[27]?Ar["line-child"]:Ar.line}];let M={};for(let N=0;N<P.length;N+=1)M=kl(M,P[N]);y=new Uu({props:M});const V=[Yo[c[27]],{id:c[27]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[27]?"visible":"none"}},{paint:c[7].type==c[27]?Ar["line-self"]:Ar.line}];let B={};for(let N=0;N<V.length;N+=1)B=kl(B,V[N]);return w=new Uu({props:B}),{c(){jr(h.$$.fragment),f=st(),jr(y.$$.fragment),v=st(),jr(w.$$.fragment)},l(N){qr(h.$$.fragment,N),f=lt(N),qr(y.$$.fragment,N),v=lt(N),qr(w.$$.fragment,N)},m(N,ue){Zr(h,N,ue),Fe(N,f,ue),Zr(y,N,ue),Fe(N,v,ue),Zr(w,N,ue),a=!0},p(N,ue){const ze=ue[0]&384?El(A,[ue&0&&Tl(Yo[N[27]]),A[1],A[2],ue[0]&256&&{isChild:N[8][N[27]]},A[4],ue[0]&128&&{selected:N[7].selected},A[6],ue[0]&128&&{highlighted:N[7].highlighted},A[8],ue[0]&128&&{hovered:N[7].hovered},ue[0]&128&&{layout:{visibility:N[7].type==N[27]||N[7].childType==N[27]?"visible":"none"}},ue[0]&128&&{paint:N[7].type==N[27]?Ar["fill-self"]:N[7].childType==N[27]?Ar["fill-child"]:Ar.fill}]):{};h.$set(ze);const Ae=ue[0]&128?El(P,[ue&0&&Tl(Yo[N[27]]),P[1],P[2],ue[0]&128&&{selected:N[7].selected},P[4],ue[0]&128&&{highlighted:N[7].highlighted},ue[0]&128&&{layout:{visibility:N[7].type==N[27]||N[7].childType==N[27]?"visible":"none"}},ue[0]&128&&{paint:N[7].type==N[27]?Ar["line-active"]:N[7].childType==N[27]?Ar["line-child"]:Ar.line}]):{};y.$set(Ae);const Ie=ue[0]&128?El(V,[ue&0&&Tl(Yo[N[27]]),V[1],V[2],ue[0]&128&&{selected:N[7].selected},ue[0]&128&&{layout:{visibility:N[7].type==N[27]?"visible":"none"}},ue[0]&128&&{paint:N[7].type==N[27]?Ar["line-self"]:Ar.line}]):{};w.$set(Ie)},i(N){a||(vt(h.$$.fragment,N),vt(y.$$.fragment,N),vt(w.$$.fragment,N),a=!0)},o(N){zt(h.$$.fragment,N),zt(y.$$.fragment,N),zt(w.$$.fragment,N),a=!1},d(N){Gr(h,N),N&&ie(f),Gr(y,N),N&&ie(v),Gr(w,N)}}}function Pm(c){let h,f;const y=[Lh[c[27]]];let v={$$slots:{default:[r1]},$$scope:{ctx:c}};for(let w=0;w<y.length;w+=1)v=kl(v,y[w]);return h=new cy({props:v}),{c(){jr(h.$$.fragment)},l(w){qr(h.$$.fragment,w)},m(w,a){Zr(h,w,a),f=!0},p(w,a){const A=a&0?El(y,[Tl(Lh[w[27]])]):{};a[0]&384|a[1]&4&&(A.$$scope={dirty:a,ctx:w}),h.$set(A)},i(w){f||(vt(h.$$.fragment,w),f=!0)},o(w){zt(h.$$.fragment,w),f=!1},d(w){Gr(h,w)}}}function Cm(c){let h,f,y,v,w,a;const A=[Yo[c[27]],{id:c[27]+"-fill"},{type:"fill"},{isChild:c[8][c[27]]},{click:!0},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{hover:!0},{hovered:c[7].hovered},{layout:{visibility:c[7].type==c[27]||c[7].childType==c[27]?"visible":"none"}},{paint:c[7].type==c[27]?Ar["fill-active"]:c[7].childType==c[27]?Ar["fill-child"]:Ar.fill}];let E={};for(let N=0;N<A.length;N+=1)E=kl(E,A[N]);h=new Uu({props:E}),h.$on("select",c[12]);const P=[Yo[c[27]],{id:c[27]+"-bounds"},{type:"line"},{selected:c[7].selected},{highlight:!0},{highlighted:c[7].highlighted},{layout:{visibility:c[7].type==c[27]||c[7].childType==c[27]?"visible":"none"}},{paint:c[7].type==c[27]?Ar["line-active"]:c[7].childType==c[27]?Ar["line-child"]:Ar.line}];let M={};for(let N=0;N<P.length;N+=1)M=kl(M,P[N]);y=new Uu({props:M});const V=[Yo[c[27]],{id:c[27]+"-self"},{type:"line"},{selected:c[7].selected},{layout:{visibility:c[7].type==c[27]?"visible":"none"}},{paint:c[7].type==c[27]?Ar["line-self"]:Ar.line}];let B={};for(let N=0;N<V.length;N+=1)B=kl(B,V[N]);return w=new Uu({props:B}),{c(){jr(h.$$.fragment),f=st(),jr(y.$$.fragment),v=st(),jr(w.$$.fragment)},l(N){qr(h.$$.fragment,N),f=lt(N),qr(y.$$.fragment,N),v=lt(N),qr(w.$$.fragment,N)},m(N,ue){Zr(h,N,ue),Fe(N,f,ue),Zr(y,N,ue),Fe(N,v,ue),Zr(w,N,ue),a=!0},p(N,ue){const ze=ue[0]&384?El(A,[ue&0&&Tl(Yo[N[27]]),A[1],A[2],ue[0]&256&&{isChild:N[8][N[27]]},A[4],ue[0]&128&&{selected:N[7].selected},A[6],ue[0]&128&&{highlighted:N[7].highlighted},A[8],ue[0]&128&&{hovered:N[7].hovered},ue[0]&128&&{layout:{visibility:N[7].type==N[27]||N[7].childType==N[27]?"visible":"none"}},ue[0]&128&&{paint:N[7].type==N[27]?Ar["fill-active"]:N[7].childType==N[27]?Ar["fill-child"]:Ar.fill}]):{};h.$set(ze);const Ae=ue[0]&128?El(P,[ue&0&&Tl(Yo[N[27]]),P[1],P[2],ue[0]&128&&{selected:N[7].selected},P[4],ue[0]&128&&{highlighted:N[7].highlighted},ue[0]&128&&{layout:{visibility:N[7].type==N[27]||N[7].childType==N[27]?"visible":"none"}},ue[0]&128&&{paint:N[7].type==N[27]?Ar["line-active"]:N[7].childType==N[27]?Ar["line-child"]:Ar.line}]):{};y.$set(Ae);const Ie=ue[0]&128?El(V,[ue&0&&Tl(Yo[N[27]]),V[1],V[2],ue[0]&128&&{selected:N[7].selected},ue[0]&128&&{layout:{visibility:N[7].type==N[27]?"visible":"none"}},ue[0]&128&&{paint:N[7].type==N[27]?Ar["line-self"]:Ar.line}]):{};w.$set(Ie)},i(N){a||(vt(h.$$.fragment,N),vt(y.$$.fragment,N),vt(w.$$.fragment,N),a=!0)},o(N){zt(h.$$.fragment,N),zt(y.$$.fragment,N),zt(w.$$.fragment,N),a=!1},d(N){Gr(h,N),N&&ie(f),Gr(y,N),N&&ie(v),Gr(w,N)}}}function i1(c){let h,f,y=["lgd"],v=[];for(let a=0;a<1;a+=1)v[a]=Cm(_m(c,y,a));const w=a=>zt(v[a],1,1,()=>{v[a]=null});return{c(){for(let a=0;a<1;a+=1)v[a].c();h=Br()},l(a){for(let A=0;A<1;A+=1)v[A].l(a);h=Br()},m(a,A){for(let E=0;E<1;E+=1)v[E].m(a,A);Fe(a,h,A),f=!0},p(a,A){if(A[0]&4480){y=["lgd"];let E;for(E=0;E<1;E+=1){const P=_m(a,y,E);v[E]?(v[E].p(P,A),vt(v[E],1)):(v[E]=Cm(P),v[E].c(),vt(v[E],1),v[E].m(h.parentNode,h))}for(Ha(),E=1;E<1;E+=1)w(E);Ja()}},i(a){if(!f){for(let A=0;A<1;A+=1)vt(v[A]);f=!0}},o(a){v=v.filter(Boolean);for(let A=0;A<1;A+=1)zt(v[A]);f=!1},d(a){ds(v,a),a&&ie(h)}}}function n1(c){let h,f,y,v=["dea"],w=[];for(let P=0;P<1;P+=1)w[P]=Pm(vm(c,v,P));const a=P=>zt(w[P],1,1,()=>{w[P]=null}),A=[Lh.crd];let E={$$slots:{default:[i1]},$$scope:{ctx:c}};for(let P=0;P<A.length;P+=1)E=kl(E,A[P]);return f=new cy({props:E}),{c(){for(let P=0;P<1;P+=1)w[P].c();h=st(),jr(f.$$.fragment)},l(P){for(let M=0;M<1;M+=1)w[M].l(P);h=lt(P),qr(f.$$.fragment,P)},m(P,M){for(let V=0;V<1;V+=1)w[V].m(P,M);Fe(P,h,M),Zr(f,P,M),y=!0},p(P,M){if(M[0]&4480){v=["dea"];let B;for(B=0;B<1;B+=1){const N=vm(P,v,B);w[B]?(w[B].p(N,M),vt(w[B],1)):(w[B]=Pm(N),w[B].c(),vt(w[B],1),w[B].m(h.parentNode,h))}for(Ha(),B=1;B<1;B+=1)a(B);Ja()}const V=M&0?El(A,[Tl(Lh.crd)]):{};M[0]&384|M[1]&4&&(V.$$scope={dirty:M,ctx:P}),f.$set(V)},i(P){if(!y){for(let M=0;M<1;M+=1)vt(w[M]);vt(f.$$.fragment,P),y=!0}},o(P){w=w.filter(Boolean);for(let M=0;M<1;M+=1)zt(w[M]);zt(f.$$.fragment,P),y=!1},d(P){ds(w,P),P&&ie(h),Gr(f,P)}}}function o1(c){let h,f,y=c[1].name+"",v;return{c(){h=De("span"),f=Pe("No parents for "),v=Pe(y),this.h()},l(w){h=Le(w,"SPAN",{class:!0});var a=Ve(h);f=Ce(a,"No parents for "),v=Ce(a,y),a.forEach(ie),this.h()},h(){ce(h,"class","muted")},m(w,a){Fe(w,h,a),re(h,f),re(h,v)},p(w,a){a[0]&2&&y!==(y=w[1].name+"")&&yt(v,y)},d(w){w&&ie(h)}}}function a1(c){let h,f=[...c[1].parents].reverse(),y=[];for(let v=0;v<f.length;v+=1)y[v]=Mm(gm(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Br()},l(v){for(let w=0;w<y.length;w+=1)y[w].l(v);h=Br()},m(v,w){for(let a=0;a<y.length;a+=1)y[a].m(v,w);Fe(v,h,w)},p(v,w){if(w[0]&2){f=[...v[1].parents].reverse();let a;for(a=0;a<f.length;a+=1){const A=gm(v,f,a);y[a]?y[a].p(A,w):(y[a]=Mm(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){ds(y,v),v&&ie(h)}}}function Mm(c){let h,f,y=c[24]>0?"\u21B3 ":"",v,w=c[25].name+"",a,A;return{c(){h=De("span"),f=new Um(!1),v=De("a"),a=Pe(w),this.h()},l(E){h=Le(E,"SPAN",{style:!0});var P=Ve(h);f=Vm(P,!1),v=Le(P,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var M=Ve(v);a=Ce(M,w),M.forEach(ie),P.forEach(ie),this.h()},h(){f.a=v,ce(v,"href",A=Bs+"/"+c[25].code+"/"),ce(v,"sveltekit:noscroll",""),ce(v,"class","svelte-s16wkg"),Qt(h,"display","block"),Qt(h,"margin-left",(c[24]>0?(c[24]-1)*15:0)+"px")},m(E,P){Fe(E,h,P),f.m(y,h),re(h,v),re(v,a)},p(E,P){P[0]&2&&w!==(w=E[25].name+"")&&yt(a,w),P[0]&2&&A!==(A=Bs+"/"+E[25].code+"/")&&ce(v,"href",A)},d(E){E&&ie(h)}}}function s1(c){let h,f,y=c[1].name+"",v;return{c(){h=De("span"),f=Pe("No areas within "),v=Pe(y),this.h()},l(w){h=Le(w,"SPAN",{class:!0});var a=Ve(h);f=Ce(a,"No areas within "),v=Ce(a,y),a.forEach(ie),this.h()},h(){ce(h,"class","muted")},m(w,a){Fe(w,h,a),re(h,f),re(h,v)},p(w,a){a[0]&2&&y!==(y=w[1].name+"")&&yt(v,y)},d(w){w&&ie(h)}}}function l1(c){let h,f=c[1].children,y=[];for(let v=0;v<f.length;v+=1)y[v]=Dm(ym(c,f,v));return{c(){for(let v=0;v<y.length;v+=1)y[v].c();h=Br()},l(v){for(let w=0;w<y.length;w+=1)y[w].l(v);h=Br()},m(v,w){for(let a=0;a<y.length;a+=1)y[a].m(v,w);Fe(v,h,w)},p(v,w){if(w[0]&2){f=v[1].children;let a;for(a=0;a<f.length;a+=1){const A=ym(v,f,a);y[a]?y[a].p(A,w):(y[a]=Dm(A),y[a].c(),y[a].m(h.parentNode,h))}for(;a<y.length;a+=1)y[a].d(1);y.length=f.length}},d(v){ds(y,v),v&&ie(h)}}}function Dm(c){let h,f=c[22].name+"",y,v,w=c[24]<c[1].children.length-1?", ":"",a;return{c(){h=De("a"),y=Pe(f),a=Pe(w),this.h()},l(A){h=Le(A,"A",{href:!0,"sveltekit:noscroll":!0,class:!0});var E=Ve(h);y=Ce(E,f),E.forEach(ie),a=Ce(A,w),this.h()},h(){ce(h,"href",v=Bs+"/"+c[22].code+"/"),ce(h,"sveltekit:noscroll",""),ce(h,"class","svelte-s16wkg")},m(A,E){Fe(A,h,E),re(h,y),Fe(A,a,E)},p(A,E){E[0]&2&&f!==(f=A[22].name+"")&&yt(y,f),E[0]&2&&v!==(v=Bs+"/"+A[22].code+"/")&&ce(h,"href",v),E[0]&2&&w!==(w=A[24]<A[1].children.length-1?", ":"")&&yt(a,w)},d(A){A&&ie(h),A&&ie(a)}}}function u1(c){let h=c[1].name+"",f,y,v=Ui[c[1].type].name+"",w,a,A=(c[1].parents[0].type=="rgn"?"the "+c[1].parents[0].name:c[1].parents[0].name)+"",E,P;return{c(){f=Pe(h),y=Pe(" is a "),w=Pe(v),a=Pe(" in "),E=Pe(A),P=Pe(".")},l(M){f=Ce(M,h),y=Ce(M," is a "),w=Ce(M,v),a=Ce(M," in "),E=Ce(M,A),P=Ce(M,".")},m(M,V){Fe(M,f,V),Fe(M,y,V),Fe(M,w,V),Fe(M,a,V),Fe(M,E,V),Fe(M,P,V)},p(M,V){V[0]&2&&h!==(h=M[1].name+"")&&yt(f,h),V[0]&2&&v!==(v=Ui[M[1].type].name+"")&&yt(w,v),V[0]&2&&A!==(A=(M[1].parents[0].type=="rgn"?"the "+M[1].parents[0].name:M[1].parents[0].name)+"")&&yt(E,A)},d(M){M&&ie(f),M&&ie(y),M&&ie(w),M&&ie(a),M&&ie(E),M&&ie(P)}}}function c1(c){let h;return{c(){h=Pe("Northern Ireland.")},l(f){h=Ce(f,"Northern Ireland.")},m(f,y){Fe(f,h,y)},p:ka,d(f){f&&ie(h)}}}function h1(c){let h,f,y,v,w=!["ew","ctry"].includes(c[1].type),a,A;f=new Xu({props:{$$slots:{default:[f1]},$$scope:{ctx:c}}});let E=w&&Lm(c);return{c(){h=De("span"),jr(f.$$.fragment),y=Pe(" since 2001"),v=st(),E&&E.c(),a=Br(),this.h()},l(P){h=Le(P,"SPAN",{class:!0});var M=Ve(h);qr(f.$$.fragment,M),y=Ce(M," since 2001"),M.forEach(ie),v=lt(P),E&&E.l(P),a=Br(),this.h()},h(){ce(h,"class","text-small")},m(P,M){Fe(P,h,M),Zr(f,h,null),re(h,y),Fe(P,v,M),E&&E.m(P,M),Fe(P,a,M),A=!0},p(P,M){const V={};M[0]&2|M[1]&4&&(V.$$scope={dirty:M,ctx:P}),f.$set(V),M[0]&2&&(w=!["ew","ctry"].includes(P[1].type)),w?E?E.p(P,M):(E=Lm(P),E.c(),E.m(a.parentNode,a)):E&&(E.d(1),E=null)},i(P){A||(vt(f.$$.fragment,P),A=!0)},o(P){zt(f.$$.fragment,P),A=!1},d(P){P&&ie(h),Gr(f),P&&ie(v),E&&E.d(P),P&&ie(a)}}}function p1(c){let h,f,y,v,w,a=c[1].data.agemed.value_rank[2011].all.toLocaleString()+"",A,E=$o(c[1].data.agemed.value_rank[2011].all)+"",P,M,V=c[1].count.toLocaleString()+"",B,N,ue=Ui[c[1].type].pl.toLowerCase()+"",ze,Ae;return f=new Xu({props:{$$slots:{default:[d1]},$$scope:{ctx:c}}}),{c(){h=De("span"),jr(f.$$.fragment),y=Pe(" average age"),v=st(),w=De("div"),A=Pe(a),P=Pe(E),M=Pe(" oldest median age of "),B=Pe(V),N=st(),ze=Pe(ue),this.h()},l(Ie){h=Le(Ie,"SPAN",{class:!0});var Me=Ve(h);qr(f.$$.fragment,Me),y=Ce(Me," average age"),Me.forEach(ie),v=lt(Ie),w=Le(Ie,"DIV",{class:!0});var ft=Ve(w);A=Ce(ft,a),P=Ce(ft,E),M=Ce(ft," oldest median age of "),B=Ce(ft,V),N=lt(ft),ze=Ce(ft,ue),ft.forEach(ie),this.h()},h(){ce(h,"class","text-small"),ce(w,"class","text-small muted")},m(Ie,Me){Fe(Ie,h,Me),Zr(f,h,null),re(h,y),Fe(Ie,v,Me),Fe(Ie,w,Me),re(w,A),re(w,P),re(w,M),re(w,B),re(w,N),re(w,ze),Ae=!0},p(Ie,Me){const ft={};Me[0]&2|Me[1]&4&&(ft.$$scope={dirty:Me,ctx:Ie}),f.$set(ft),(!Ae||Me[0]&2)&&a!==(a=Ie[1].data.agemed.value_rank[2011].all.toLocaleString()+"")&&yt(A,a),(!Ae||Me[0]&2)&&E!==(E=$o(Ie[1].data.agemed.value_rank[2011].all)+"")&&yt(P,E),(!Ae||Me[0]&2)&&V!==(V=Ie[1].count.toLocaleString()+"")&&yt(B,V),(!Ae||Me[0]&2)&&ue!==(ue=Ui[Ie[1].type].pl.toLowerCase()+"")&&yt(ze,ue)},i(Ie){Ae||(vt(f.$$.fragment,Ie),Ae=!0)},o(Ie){zt(f.$$.fragment,Ie),Ae=!1},d(Ie){Ie&&ie(h),Gr(f),Ie&&ie(v),Ie&&ie(w)}}}function f1(c){let h,f=Fs(c[1].data.agemed.value[2011].all-c[1].data.agemed.value[2001].all," years",0)+"",y,v;return{c(){h=De("span"),y=Pe(f),this.h()},l(w){h=Le(w,"SPAN",{class:!0});var a=Ve(h);y=Ce(a,f),a.forEach(ie),this.h()},h(){ce(h,"class",v=Il(Al(c[1].data.agemed.value[2011].all-c[1].data.agemed.value[2001].all))+" svelte-s16wkg")},m(w,a){Fe(w,h,a),re(h,y)},p(w,a){a[0]&2&&f!==(f=Fs(w[1].data.agemed.value[2011].all-w[1].data.agemed.value[2001].all," years",0)+"")&&yt(y,f),a[0]&2&&v!==(v=Il(Al(w[1].data.agemed.value[2011].all-w[1].data.agemed.value[2001].all))+" svelte-s16wkg")&&ce(h,"class",v)},d(w){w&&ie(h)}}}function Lm(c){let h,f=c[1].data.agemed.value_rank.change.all.toLocaleString()+"",y,v=$o(c[1].data.agemed.value_rank.change.all)+"",w,a,A=c[1].count.toLocaleString()+"",E,P,M=Ui[c[1].type].pl.toLowerCase()+"",V;return{c(){h=De("div"),y=Pe(f),w=Pe(v),a=Pe(" largest increase of "),E=Pe(A),P=st(),V=Pe(M),this.h()},l(B){h=Le(B,"DIV",{class:!0});var N=Ve(h);y=Ce(N,f),w=Ce(N,v),a=Ce(N," largest increase of "),E=Ce(N,A),P=lt(N),V=Ce(N,M),N.forEach(ie),this.h()},h(){ce(h,"class","text-small muted")},m(B,N){Fe(B,h,N),re(h,y),re(h,w),re(h,a),re(h,E),re(h,P),re(h,V)},p(B,N){N[0]&2&&f!==(f=B[1].data.agemed.value_rank.change.all.toLocaleString()+"")&&yt(y,f),N[0]&2&&v!==(v=$o(B[1].data.agemed.value_rank.change.all)+"")&&yt(w,v),N[0]&2&&A!==(A=B[1].count.toLocaleString()+"")&&yt(E,A),N[0]&2&&M!==(M=Ui[B[1].type].pl.toLowerCase()+"")&&yt(V,M)},d(B){B&&ie(h)}}}function d1(c){let h=Rh(c[1].count,c[1].data.agemed.value_rank[2011].all,["older","younger"])+"",f;return{c(){f=Pe(h)},l(y){f=Ce(y,h)},m(y,v){Fe(y,f,v)},p(y,v){v[0]&2&&h!==(h=Rh(y[1].count,y[1].data.agemed.value_rank[2011].all,["older","younger"])+"")&&yt(f,h)},d(y){y&&ie(f)}}}function Rm(c){let h,f,y,v;return{c(){h=De("div"),f=De("li"),y=st(),v=Pe(c[10]),this.h()},l(w){h=Le(w,"DIV",{class:!0});var a=Ve(h);f=Le(a,"LI",{class:!0}),Ve(f).forEach(ie),y=lt(a),v=Ce(a,c[10]),a.forEach(ie),this.h()},h(){ce(f,"class","line svelte-s16wkg"),ce(h,"class","text-small muted")},m(w,a){Fe(w,h,a),re(h,f),re(h,y),re(h,v)},p(w,a){a[0]&1024&&yt(v,w[10])},d(w){w&&ie(h)}}}function m1(c){let h,f,y=c[1]&&c[2]&&bm(c);return{c(){y&&y.c(),h=Br()},l(v){y&&y.l(v),h=Br()},m(v,w){y&&y.m(v,w),Fe(v,h,w),f=!0},p(v,w){v[1]&&v[2]?y?(y.p(v,w),w[0]&6&&vt(y,1)):(y=bm(v),y.c(),vt(y,1),y.m(h.parentNode,h)):y&&(Ha(),zt(y,1,1,()=>{y=null}),Ja())},i(v){f||(vt(y),f=!0)},o(v){zt(y),f=!1},d(v){y&&y.d(v),v&&ie(h)}}}function y1(c){let h,f,y,v,w,a,A,E,P,M,V,B,N,ue,ze;return document.title=h=c[1].name+" Census Data",ue=new Xg({props:{column:"wide",$$slots:{default:[m1]},$$scope:{ctx:c}}}),{c(){f=De("meta"),y=De("meta"),w=De("meta"),a=De("meta"),E=De("meta"),P=De("meta"),V=De("meta"),N=st(),jr(ue.$$.fragment),this.h()},l(Ae){const Ie=qg('[data-svelte="svelte-18dpdhq"]',document.head);f=Le(Ie,"META",{name:!0,content:!0}),y=Le(Ie,"META",{property:!0,content:!0}),w=Le(Ie,"META",{property:!0,content:!0}),a=Le(Ie,"META",{property:!0,content:!0}),E=Le(Ie,"META",{property:!0,content:!0}),P=Le(Ie,"META",{property:!0,content:!0}),V=Le(Ie,"META",{name:!0,content:!0}),Ie.forEach(ie),N=lt(Ae),qr(ue.$$.fragment,Ae),this.h()},h(){ce(f,"name","description"),ce(f,"content",""),ce(y,"property","og:title"),ce(y,"content",v=c[1].name+" Census Data"),ce(w,"property","og:type"),ce(w,"content","website"),ce(a,"property","og:url"),ce(a,"content",A=Bs+"/"+c[1].code+"/"),ce(E,"property","og:image:type"),ce(E,"content","image/jpeg"),ce(P,"property","og:description"),ce(P,"content",M="Explore census data for "+c[1].name+"."),ce(V,"name","description"),ce(V,"content",B="Explore census data for "+c[1].name+".")},m(Ae,Ie){re(document.head,f),re(document.head,y),re(document.head,w),re(document.head,a),re(document.head,E),re(document.head,P),re(document.head,V),Fe(Ae,N,Ie),Zr(ue,Ae,Ie),ze=!0},p(Ae,Ie){(!ze||Ie[0]&2)&&h!==(h=Ae[1].name+" Census Data")&&(document.title=h),(!ze||Ie[0]&2&&v!==(v=Ae[1].name+" Census Data"))&&ce(y,"content",v),(!ze||Ie[0]&2&&A!==(A=Bs+"/"+Ae[1].code+"/"))&&ce(a,"content",A),(!ze||Ie[0]&2&&M!==(M="Explore census data for "+Ae[1].name+"."))&&ce(P,"content",M),(!ze||Ie[0]&2&&B!==(B="Explore census data for "+Ae[1].name+"."))&&ce(V,"content",B);const Me={};Ie[0]&2047|Ie[1]&4&&(Me.$$scope={dirty:Ie,ctx:Ae}),ue.$set(Me)},i(Ae){ze||(vt(ue.$$.fragment,Ae),ze=!0)},o(Ae){zt(ue.$$.fragment,Ae),ze=!1},d(Ae){ie(f),ie(y),ie(w),ie(a),ie(E),ie(P),ie(V),Ae&&ie(N),Gr(ue,Ae)}}}const S1=!0;async function Bm(c,h){return await(await h(jm.places+c+".json")).json()}async function k1({params:c,fetch:h}){let f=c.code,y=await r_(jm.options,h),v={};y.forEach(E=>v[E.code]=E.name),y.forEach(E=>{E.typepl=Ui[E.type].pl,E.typenm=Ui[E.type].name,E.typestr=v[E.parent]?`${Ui[E.type].name} in ${v[E.parent]}`:""});let w=y.sort((E,P)=>E.name.localeCompare(P.name)),a=await Bm("N92000001",h),A=await Bm(f,h);return{props:{options:w,place:A,ew:a}}}function g1(c,h,f){let y,v,{options:w,place:a,ew:A}=h,E,P,M=null,V=!1,B={selected:null,type:null,childType:null,highlighted:[],hovered:null},N={};Object.keys(Yo).forEach(pt=>f(8,N[pt]=!1,N));function ue(pt){const hr=(qt,ht)=>qt+ht;let gt=pt[0],nt=pt[1],xt=a.data[gt][nt][2011],er=a.data[gt][nt][2001],We=A.data[gt][nt][2011],nr=_d[gt].map(qt=>qt.code),wr=_d[gt].map(qt=>qt.label?qt.label:qt.code);return nr.map((qt,ht)=>Array.isArray(qt)?{x:wr[ht],y:qt.map(He=>xt[He]).reduce(hr,0),ew:qt.map(He=>We[He]).reduce(hr,0),prev:qt.map(He=>er[He]).reduce(hr,0)}:{x:wr[ht],y:xt[qt],ew:We[qt],prev:er[qt]})}function ze(pt){M&&M.fitBounds(pt,{padding:20})}function Ae(pt){let hr=JSON.parse(JSON.stringify(B)),gt=pt.code,nt=pt.type,xt=pt.children[0]?pt.children.map(Nt=>Nt.code):[],er=pt.type=="rgn"?"cty":xt[0]?pt.children[0].type:null;f(7,B.selected=gt,B),f(7,B.type=nt,B),f(7,B.childType=er,B),f(7,B.highlighted=xt,B);let We=Object.keys(Yo),nr=["fill-color","fill-opacity"],wr=["line-color","line-width","line-opacity"];M&&(B.type!=hr.type||B.childType!=hr.childType)&&(We.forEach(Nt=>{let qt=Nt==nt||er&&Nt==er?"visible":"none";M.setLayoutProperty(Nt+"-fill","visibility",qt),M.setLayoutProperty(Nt+"-bounds","visibility",qt),pt.parents[0]&&M.setLayoutProperty(Nt+"-self","visibility",qt),f(8,N[Nt]=Nt==er,N)}),pt.parents[0]&&(nr.forEach(Nt=>M.setPaintProperty(nt+"-fill",Nt,Ar[xt[0]?"fill-active":"fill-self"][Nt])),wr.forEach(Nt=>{M.setPaintProperty(nt+"-bounds",Nt,Ar["line-active"][Nt]),M.setPaintProperty(nt+"-self",Nt,Ar["line-self"][Nt])})),er&&(nr.forEach(Nt=>M.setPaintProperty(er+"-fill",Nt,Ar["fill-child"][Nt])),wr.forEach(Nt=>M.setPaintProperty(er+"-bounds",Nt,Ar["line-child"][Nt]))))}function Ie(pt){Ae(pt),ze(pt.bounds)}function Me(pt){bd(`${Bs}/${pt.detail.code}/`,{noscroll:!0})}function ft(pt){bd(`${Bs}/${pt.detail.value}/`,{noscroll:!0})}function Pt(){f(5,P=E<575?1:window.getComputedStyle(grid).getPropertyValue("grid-template-columns").split(" ").length)}const ve=()=>f(4,V=!1),je=()=>f(4,V=!0);function ur(pt){M=pt,f(6,M)}function cr(){E=this.clientWidth,f(3,E)}return c.$$set=pt=>{"options"in pt&&f(0,w=pt.options),"place"in pt&&f(1,a=pt.place),"ew"in pt&&f(2,A=pt.ew)},c.$$.update=()=>{c.$$.dirty[0]&8&&E&&Pt(),c.$$.dirty[0]&18&&f(10,y=V?"2001 comparison":a&&a.parents[0]?"Northern Ireland comparison":null),c.$$.dirty[0]&2&&a&&Ie(a),c.$$.dirty[0]&2&&f(9,v=a&&a.data.population.value.change.all!=null)},[w,a,A,E,V,P,M,B,N,v,y,ue,Me,ft,ve,je,ur,cr]}class E1 extends ea{constructor(h){super(),ta(this,h,g1,y1,ra,{options:0,place:1,ew:2},null,[-1,-1])}}export{E1 as default,k1 as load,S1 as prerender};
